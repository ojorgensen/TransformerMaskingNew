{"cells":[{"cell_type":"markdown","metadata":{"id":"d31sY4DvEyek"},"source":["# Controlling LMs without prompting or finetuning\n","\n","This notebook contains initial exploration with using `GPT2-XL` with online value-modification via natural-language modification of its activations.\n","\n","<b style=\"color: red\">To use this notebook, go to Runtime > Change Runtime Type and select GPU as the hardware accelerator. For `GPT-2-XL`, you need to select \"high RAM.\"</b>"]},{"cell_type":"code","source":["get_ipython().run_line_magic(magic_name='pip', line=f'install -U git+https://github.com/ojorgensen/activation_additions.git@ole-dev')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bj1GS_4E8VyR","executionInfo":{"status":"ok","timestamp":1692272394016,"user_tz":-60,"elapsed":132701,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"6c60c99e-ef17-4d0a-96e9-c72e841a37c3"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting git+https://github.com/ojorgensen/activation_additions.git@ole-dev\n","  Cloning https://github.com/ojorgensen/activation_additions.git (to revision ole-dev) to /tmp/pip-req-build-g4wrv1iv\n","  Running command git clone --filter=blob:none --quiet https://github.com/ojorgensen/activation_additions.git /tmp/pip-req-build-g4wrv1iv\n","  Running command git checkout -b ole-dev --track origin/ole-dev\n","  Switched to a new branch 'ole-dev'\n","  Branch 'ole-dev' set up to track remote branch 'ole-dev' from 'origin'.\n","  Resolved https://github.com/ojorgensen/activation_additions.git to commit a0ca982b6b6c9d54cfa87d36081f13fa62c9690b\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7 (from algebraic-value-editing==0.2.0)\n","  Cloning https://github.com/neelnanda-io/TransformerLens (to revision 9e034eef796ed32b0e473ca9f3c9d31e5d5046e7) to /tmp/pip-install-ajvm_xkp/transformer-lens_2c174b04520f4da2ab9e56fdd2d2c213\n","  Running command git clone --filter=blob:none --quiet https://github.com/neelnanda-io/TransformerLens /tmp/pip-install-ajvm_xkp/transformer-lens_2c174b04520f4da2ab9e56fdd2d2c213\n","  Running command git rev-parse -q --verify 'sha^9e034eef796ed32b0e473ca9f3c9d31e5d5046e7'\n","  Running command git fetch -q https://github.com/neelnanda-io/TransformerLens 9e034eef796ed32b0e473ca9f3c9d31e5d5046e7\n","  Running command git checkout -q 9e034eef796ed32b0e473ca9f3c9d31e5d5046e7\n","  Resolved https://github.com/neelnanda-io/TransformerLens to commit 9e034eef796ed32b0e473ca9f3c9d31e5d5046e7\n","  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","Collecting torch==1.13.1 (from algebraic-value-editing==0.2.0)\n","  Downloading torch-1.13.1-cp310-cp310-manylinux1_x86_64.whl (887.5 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m887.5/887.5 MB\u001b[0m \u001b[31m1.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.22.1 in /usr/local/lib/python3.10/dist-packages (from algebraic-value-editing==0.2.0) (1.23.5)\n","Requirement already satisfied: pandas>=1.4.4 in /usr/local/lib/python3.10/dist-packages (from algebraic-value-editing==0.2.0) (1.5.3)\n","Collecting jaxtyping>=0.2.14 (from algebraic-value-editing==0.2.0)\n","  Downloading jaxtyping-0.2.20-py3-none-any.whl (24 kB)\n","Requirement already satisfied: prettytable>=3.6.0 in /usr/local/lib/python3.10/dist-packages (from algebraic-value-editing==0.2.0) (3.8.0)\n","Collecting openai>=0.27.2 (from algebraic-value-editing==0.2.0)\n","  Downloading openai-0.27.8-py3-none-any.whl (73 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m73.6/73.6 kB\u001b[0m \u001b[31m10.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: nltk>=3.8.1 in /usr/local/lib/python3.10/dist-packages (from algebraic-value-editing==0.2.0) (3.8.1)\n","Collecting kaleido>=0.2.1 (from algebraic-value-editing==0.2.0)\n","  Downloading kaleido-0.2.1-py2.py3-none-manylinux1_x86_64.whl (79.9 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m79.9/79.9 MB\u001b[0m \u001b[31m18.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pytest in /usr/local/lib/python3.10/dist-packages (from algebraic-value-editing==0.2.0) (7.4.0)\n","Requirement already satisfied: plotly in /usr/local/lib/python3.10/dist-packages (from algebraic-value-editing==0.2.0) (5.15.0)\n","Requirement already satisfied: nbformat in /usr/local/lib/python3.10/dist-packages (from algebraic-value-editing==0.2.0) (5.9.2)\n","Requirement already satisfied: Ipython in /usr/local/lib/python3.10/dist-packages (from algebraic-value-editing==0.2.0) (7.34.0)\n","Requirement already satisfied: ipywidgets in /usr/local/lib/python3.10/dist-packages (from algebraic-value-editing==0.2.0) (7.7.1)\n","Collecting tuned_lens (from algebraic-value-editing==0.2.0)\n","  Downloading tuned_lens-0.2.0-py3-none-any.whl (56 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m56.9/56.9 kB\u001b[0m \u001b[31m7.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from torch==1.13.1->algebraic-value-editing==0.2.0) (4.7.1)\n","Collecting nvidia-cuda-runtime-cu11==11.7.99 (from torch==1.13.1->algebraic-value-editing==0.2.0)\n","  Downloading nvidia_cuda_runtime_cu11-11.7.99-py3-none-manylinux1_x86_64.whl (849 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m849.3/849.3 kB\u001b[0m \u001b[31m64.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-cudnn-cu11==8.5.0.96 (from torch==1.13.1->algebraic-value-editing==0.2.0)\n","  Downloading nvidia_cudnn_cu11-8.5.0.96-2-py3-none-manylinux1_x86_64.whl (557.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m557.1/557.1 MB\u001b[0m \u001b[31m1.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-cublas-cu11==11.10.3.66 (from torch==1.13.1->algebraic-value-editing==0.2.0)\n","  Downloading nvidia_cublas_cu11-11.10.3.66-py3-none-manylinux1_x86_64.whl (317.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m317.1/317.1 MB\u001b[0m \u001b[31m4.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-cuda-nvrtc-cu11==11.7.99 (from torch==1.13.1->algebraic-value-editing==0.2.0)\n","  Downloading nvidia_cuda_nvrtc_cu11-11.7.99-2-py3-none-manylinux1_x86_64.whl (21.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m21.0/21.0 MB\u001b[0m \u001b[31m68.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from nvidia-cublas-cu11==11.10.3.66->torch==1.13.1->algebraic-value-editing==0.2.0) (67.7.2)\n","Requirement already satisfied: wheel in /usr/local/lib/python3.10/dist-packages (from nvidia-cublas-cu11==11.10.3.66->torch==1.13.1->algebraic-value-editing==0.2.0) (0.41.1)\n","Collecting typeguard>=2.13.3 (from jaxtyping>=0.2.14->algebraic-value-editing==0.2.0)\n","  Downloading typeguard-4.1.1-py3-none-any.whl (33 kB)\n","Requirement already satisfied: click in /usr/local/lib/python3.10/dist-packages (from nltk>=3.8.1->algebraic-value-editing==0.2.0) (8.1.6)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.10/dist-packages (from nltk>=3.8.1->algebraic-value-editing==0.2.0) (1.3.2)\n","Requirement already satisfied: regex>=2021.8.3 in /usr/local/lib/python3.10/dist-packages (from nltk>=3.8.1->algebraic-value-editing==0.2.0) (2023.6.3)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from nltk>=3.8.1->algebraic-value-editing==0.2.0) (4.66.1)\n","Requirement already satisfied: requests>=2.20 in /usr/local/lib/python3.10/dist-packages (from openai>=0.27.2->algebraic-value-editing==0.2.0) (2.31.0)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from openai>=0.27.2->algebraic-value-editing==0.2.0) (3.8.5)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.4->algebraic-value-editing==0.2.0) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.4->algebraic-value-editing==0.2.0) (2023.3)\n","Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/dist-packages (from prettytable>=3.6.0->algebraic-value-editing==0.2.0) (0.2.6)\n","Collecting jedi>=0.16 (from Ipython->algebraic-value-editing==0.2.0)\n","  Downloading jedi-0.19.0-py2.py3-none-any.whl (1.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.6/1.6 MB\u001b[0m \u001b[31m74.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: decorator in /usr/local/lib/python3.10/dist-packages (from Ipython->algebraic-value-editing==0.2.0) (4.4.2)\n","Requirement already satisfied: pickleshare in /usr/local/lib/python3.10/dist-packages (from Ipython->algebraic-value-editing==0.2.0) (0.7.5)\n","Requirement already satisfied: traitlets>=4.2 in /usr/local/lib/python3.10/dist-packages (from Ipython->algebraic-value-editing==0.2.0) (5.7.1)\n","Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from Ipython->algebraic-value-editing==0.2.0) (3.0.39)\n","Requirement already satisfied: pygments in /usr/local/lib/python3.10/dist-packages (from Ipython->algebraic-value-editing==0.2.0) (2.16.1)\n","Requirement already satisfied: backcall in /usr/local/lib/python3.10/dist-packages (from Ipython->algebraic-value-editing==0.2.0) (0.2.0)\n","Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/dist-packages (from Ipython->algebraic-value-editing==0.2.0) (0.1.6)\n","Requirement already satisfied: pexpect>4.3 in /usr/local/lib/python3.10/dist-packages (from Ipython->algebraic-value-editing==0.2.0) (4.8.0)\n","Requirement already satisfied: ipykernel>=4.5.1 in /usr/local/lib/python3.10/dist-packages (from ipywidgets->algebraic-value-editing==0.2.0) (5.5.6)\n","Requirement already satisfied: ipython-genutils~=0.2.0 in /usr/local/lib/python3.10/dist-packages (from ipywidgets->algebraic-value-editing==0.2.0) (0.2.0)\n","Requirement already satisfied: widgetsnbextension~=3.6.0 in /usr/local/lib/python3.10/dist-packages (from ipywidgets->algebraic-value-editing==0.2.0) (3.6.5)\n","Requirement already satisfied: jupyterlab-widgets>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from ipywidgets->algebraic-value-editing==0.2.0) (3.0.8)\n","Requirement already satisfied: fastjsonschema in /usr/local/lib/python3.10/dist-packages (from nbformat->algebraic-value-editing==0.2.0) (2.18.0)\n","Requirement already satisfied: jsonschema>=2.6 in /usr/local/lib/python3.10/dist-packages (from nbformat->algebraic-value-editing==0.2.0) (4.19.0)\n","Requirement already satisfied: jupyter-core in /usr/local/lib/python3.10/dist-packages (from nbformat->algebraic-value-editing==0.2.0) (5.3.1)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from plotly->algebraic-value-editing==0.2.0) (8.2.2)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from plotly->algebraic-value-editing==0.2.0) (23.1)\n","Requirement already satisfied: iniconfig in /usr/local/lib/python3.10/dist-packages (from pytest->algebraic-value-editing==0.2.0) (2.0.0)\n","Requirement already satisfied: pluggy<2.0,>=0.12 in /usr/local/lib/python3.10/dist-packages (from pytest->algebraic-value-editing==0.2.0) (1.2.0)\n","Requirement already satisfied: exceptiongroup>=1.0.0rc8 in /usr/local/lib/python3.10/dist-packages (from pytest->algebraic-value-editing==0.2.0) (1.1.2)\n","Requirement already satisfied: tomli>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from pytest->algebraic-value-editing==0.2.0) (2.0.1)\n","Collecting datasets>=2.7.1 (from transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading datasets-2.14.4-py3-none-any.whl (519 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m519.3/519.3 kB\u001b[0m \u001b[31m48.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting einops>=0.6.0 (from transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading einops-0.6.1-py3-none-any.whl (42 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m42.2/42.2 kB\u001b[0m \u001b[31m6.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting fancy-einsum>=0.0.3 (from transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading fancy_einsum-0.0.3-py3-none-any.whl (6.2 kB)\n","Requirement already satisfied: rich>=12.6.0 in /usr/local/lib/python3.10/dist-packages (from transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0) (13.5.2)\n","Collecting transformers>=4.25.1 (from transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading transformers-4.31.0-py3-none-any.whl (7.4 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.4/7.4 MB\u001b[0m \u001b[31m95.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting typeguard>=2.13.3 (from jaxtyping>=0.2.14->algebraic-value-editing==0.2.0)\n","  Downloading typeguard-3.0.2-py3-none-any.whl (30 kB)\n","Collecting wandb>=0.13.5 (from transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading wandb-0.15.8-py3-none-any.whl (2.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.1/2.1 MB\u001b[0m \u001b[31m85.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting accelerate (from tuned_lens->algebraic-value-editing==0.2.0)\n","  Downloading accelerate-0.21.0-py3-none-any.whl (244 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m244.2/244.2 kB\u001b[0m \u001b[31m31.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: torchdata>=0.6.0 in /usr/local/lib/python3.10/dist-packages (from tuned_lens->algebraic-value-editing==0.2.0) (0.6.1)\n","Collecting huggingface-hub>=0.12.1 (from tuned_lens->algebraic-value-editing==0.2.0)\n","  Downloading huggingface_hub-0.16.4-py3-none-any.whl (268 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m268.8/268.8 kB\u001b[0m \u001b[31m32.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting simple-parsing>=0.1.1 (from tuned_lens->algebraic-value-editing==0.2.0)\n","  Downloading simple_parsing-0.1.4-py3-none-any.whl (113 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m113.4/113.4 kB\u001b[0m \u001b[31m15.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting flatten-dict>=0.4.1 (from tuned_lens->algebraic-value-editing==0.2.0)\n","  Downloading flatten_dict-0.4.2-py2.py3-none-any.whl (9.7 kB)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets>=2.7.1->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0) (9.0.0)\n","Collecting dill<0.3.8,>=0.3.0 (from datasets>=2.7.1->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading dill-0.3.7-py3-none-any.whl (115 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m115.3/115.3 kB\u001b[0m \u001b[31m15.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting xxhash (from datasets>=2.7.1->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading xxhash-3.3.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (194 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m194.1/194.1 kB\u001b[0m \u001b[31m25.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting multiprocess (from datasets>=2.7.1->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading multiprocess-0.70.15-py310-none-any.whl (134 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m18.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.10/dist-packages (from datasets>=2.7.1->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0) (2023.6.0)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets>=2.7.1->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0) (6.0.1)\n","Requirement already satisfied: six<2.0,>=1.12 in /usr/local/lib/python3.10/dist-packages (from flatten-dict>=0.4.1->tuned_lens->algebraic-value-editing==0.2.0) (1.16.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.12.1->tuned_lens->algebraic-value-editing==0.2.0) (3.12.2)\n","Requirement already satisfied: jupyter-client in /usr/local/lib/python3.10/dist-packages (from ipykernel>=4.5.1->ipywidgets->algebraic-value-editing==0.2.0) (6.1.12)\n","Requirement already satisfied: tornado>=4.2 in /usr/local/lib/python3.10/dist-packages (from ipykernel>=4.5.1->ipywidgets->algebraic-value-editing==0.2.0) (6.3.1)\n","Requirement already satisfied: parso<0.9.0,>=0.8.3 in /usr/local/lib/python3.10/dist-packages (from jedi>=0.16->Ipython->algebraic-value-editing==0.2.0) (0.8.3)\n","Requirement already satisfied: attrs>=22.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->algebraic-value-editing==0.2.0) (23.1.0)\n","Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->algebraic-value-editing==0.2.0) (2023.7.1)\n","Requirement already satisfied: referencing>=0.28.4 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->algebraic-value-editing==0.2.0) (0.30.2)\n","Requirement already satisfied: rpds-py>=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->algebraic-value-editing==0.2.0) (0.9.2)\n","Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.10/dist-packages (from pexpect>4.3->Ipython->algebraic-value-editing==0.2.0) (0.7.0)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.20->openai>=0.27.2->algebraic-value-editing==0.2.0) (3.2.0)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.20->openai>=0.27.2->algebraic-value-editing==0.2.0) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.20->openai>=0.27.2->algebraic-value-editing==0.2.0) (2.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.20->openai>=0.27.2->algebraic-value-editing==0.2.0) (2023.7.22)\n","Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.10/dist-packages (from rich>=12.6.0->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0) (3.0.0)\n","Collecting docstring-parser~=0.15 (from simple-parsing>=0.1.1->tuned_lens->algebraic-value-editing==0.2.0)\n","  Downloading docstring_parser-0.15-py3-none-any.whl (36 kB)\n","INFO: pip is looking at multiple versions of torchdata to determine which version is compatible with other requirements. This could take a while.\n","Collecting torchdata>=0.6.0 (from tuned_lens->algebraic-value-editing==0.2.0)\n","  Downloading torchdata-0.6.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (4.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.6/4.6 MB\u001b[0m \u001b[31m95.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting tuned_lens (from algebraic-value-editing==0.2.0)\n","  Downloading tuned_lens-0.1.1-py3-none-any.whl (53 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m53.4/53.4 kB\u001b[0m \u001b[31m7.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading tuned_lens-0.1.0-py3-none-any.whl (49 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m49.9/49.9 kB\u001b[0m \u001b[31m7.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (from tuned_lens->algebraic-value-editing==0.2.0) (1.2.2)\n","Collecting zstandard (from tuned_lens->algebraic-value-editing==0.2.0)\n","  Downloading zstandard-0.21.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.7 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.7/2.7 MB\u001b[0m \u001b[31m64.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers>=4.25.1->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m106.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting safetensors>=0.3.1 (from transformers>=4.25.1->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading safetensors-0.3.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m75.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting GitPython!=3.1.29,>=1.0.0 (from wandb>=0.13.5->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading GitPython-3.1.32-py3-none-any.whl (188 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m188.5/188.5 kB\u001b[0m \u001b[31m25.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: psutil>=5.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb>=0.13.5->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0) (5.9.5)\n","Collecting sentry-sdk>=1.0.0 (from wandb>=0.13.5->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading sentry_sdk-1.29.2-py2.py3-none-any.whl (215 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m215.6/215.6 kB\u001b[0m \u001b[31m28.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting docker-pycreds>=0.4.0 (from wandb>=0.13.5->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading docker_pycreds-0.4.0-py2.py3-none-any.whl (9.0 kB)\n","Collecting pathtools (from wandb>=0.13.5->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading pathtools-0.1.2.tar.gz (11 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting setproctitle (from wandb>=0.13.5->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading setproctitle-1.3.2-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (30 kB)\n","Requirement already satisfied: appdirs>=1.4.3 in /usr/local/lib/python3.10/dist-packages (from wandb>=0.13.5->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0) (1.4.4)\n","Requirement already satisfied: protobuf!=4.21.0,<5,>=3.19.0 in /usr/local/lib/python3.10/dist-packages (from wandb>=0.13.5->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0) (3.20.3)\n","Requirement already satisfied: notebook>=4.4.1 in /usr/local/lib/python3.10/dist-packages (from widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (6.4.8)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->openai>=0.27.2->algebraic-value-editing==0.2.0) (6.0.4)\n","Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /usr/local/lib/python3.10/dist-packages (from aiohttp->openai>=0.27.2->algebraic-value-editing==0.2.0) (4.0.3)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->openai>=0.27.2->algebraic-value-editing==0.2.0) (1.9.2)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->openai>=0.27.2->algebraic-value-editing==0.2.0) (1.4.0)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->openai>=0.27.2->algebraic-value-editing==0.2.0) (1.3.1)\n","Requirement already satisfied: platformdirs>=2.5 in /usr/local/lib/python3.10/dist-packages (from jupyter-core->nbformat->algebraic-value-editing==0.2.0) (3.10.0)\n","Requirement already satisfied: scipy>=1.3.2 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->tuned_lens->algebraic-value-editing==0.2.0) (1.10.1)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->tuned_lens->algebraic-value-editing==0.2.0) (3.2.0)\n","Collecting gitdb<5,>=4.0.1 (from GitPython!=3.1.29,>=1.0.0->wandb>=0.13.5->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading gitdb-4.0.10-py3-none-any.whl (62 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m62.7/62.7 kB\u001b[0m \u001b[31m9.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.10/dist-packages (from markdown-it-py>=2.2.0->rich>=12.6.0->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0) (0.1.2)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (3.1.2)\n","Requirement already satisfied: pyzmq>=17 in /usr/local/lib/python3.10/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (23.2.1)\n","Requirement already satisfied: argon2-cffi in /usr/local/lib/python3.10/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (21.3.0)\n","Requirement already satisfied: nbconvert in /usr/local/lib/python3.10/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (6.5.4)\n","Requirement already satisfied: nest-asyncio>=1.5 in /usr/local/lib/python3.10/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (1.5.7)\n","Requirement already satisfied: Send2Trash>=1.8.0 in /usr/local/lib/python3.10/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (1.8.2)\n","Requirement already satisfied: terminado>=0.8.3 in /usr/local/lib/python3.10/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (0.17.1)\n","Requirement already satisfied: prometheus-client in /usr/local/lib/python3.10/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (0.17.1)\n","Collecting smmap<6,>=3.0.1 (from gitdb<5,>=4.0.1->GitPython!=3.1.29,>=1.0.0->wandb>=0.13.5->transformer-lens@ git+https://github.com/neelnanda-io/TransformerLens@9e034eef796ed32b0e473ca9f3c9d31e5d5046e7->algebraic-value-editing==0.2.0)\n","  Downloading smmap-5.0.0-py3-none-any.whl (24 kB)\n","Requirement already satisfied: argon2-cffi-bindings in /usr/local/lib/python3.10/dist-packages (from argon2-cffi->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (21.2.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (2.1.3)\n","Requirement already satisfied: lxml in /usr/local/lib/python3.10/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (4.9.3)\n","Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (4.11.2)\n","Requirement already satisfied: bleach in /usr/local/lib/python3.10/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (6.0.0)\n","Requirement already satisfied: defusedxml in /usr/local/lib/python3.10/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (0.7.1)\n","Requirement already satisfied: entrypoints>=0.2.2 in /usr/local/lib/python3.10/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (0.4)\n","Requirement already satisfied: jupyterlab-pygments in /usr/local/lib/python3.10/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (0.2.2)\n","Requirement already satisfied: mistune<2,>=0.8.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (0.8.4)\n","Requirement already satisfied: nbclient>=0.5.0 in /usr/local/lib/python3.10/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (0.8.0)\n","Requirement already satisfied: pandocfilters>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (1.5.0)\n","Requirement already satisfied: tinycss2 in /usr/local/lib/python3.10/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (1.2.1)\n","Requirement already satisfied: cffi>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from argon2-cffi-bindings->argon2-cffi->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (1.15.1)\n","Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (2.4.1)\n","Requirement already satisfied: webencodings in /usr/local/lib/python3.10/dist-packages (from bleach->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (0.5.1)\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.0.1->argon2-cffi-bindings->argon2-cffi->notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets->algebraic-value-editing==0.2.0) (2.21)\n","Building wheels for collected packages: algebraic-value-editing, transformer-lens, pathtools\n","  Building wheel for algebraic-value-editing (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for algebraic-value-editing: filename=algebraic_value_editing-0.2.0-py3-none-any.whl size=49135 sha256=ee0e0ed023f83d28bdf074a8c8fca36f2733ab57f8840711873198776712955e\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-gl6f_try/wheels/7a/92/4a/05e8eaa723f5261aa3b0b471f9d0ccd3bef5a037b97c1ec0a8\n","  Building wheel for transformer-lens (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for transformer-lens: filename=transformer_lens-0.0.0-py3-none-any.whl size=91787 sha256=017705bffe482e6b0f65abea4d2c0be48aae3f776b0387da3e63a252ba81bd2e\n","  Stored in directory: /root/.cache/pip/wheels/89/cf/18/03b7f1338c09fdee69f4ff3153a42e48882bd3e641a5bd9cdb\n","  Building wheel for pathtools (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for pathtools: filename=pathtools-0.1.2-py3-none-any.whl size=8791 sha256=3478f2226e036595ca5c79877bbad649626de98e48c2bd15fc683374863714a0\n","  Stored in directory: /root/.cache/pip/wheels/e7/f3/22/152153d6eb222ee7a56ff8617d80ee5207207a8c00a7aab794\n","Successfully built algebraic-value-editing transformer-lens pathtools\n","Installing collected packages: tokenizers, safetensors, pathtools, kaleido, zstandard, xxhash, typeguard, smmap, setproctitle, sentry-sdk, nvidia-cuda-runtime-cu11, nvidia-cuda-nvrtc-cu11, nvidia-cublas-cu11, jedi, fancy-einsum, einops, docstring-parser, docker-pycreds, dill, simple-parsing, nvidia-cudnn-cu11, multiprocess, jaxtyping, huggingface-hub, gitdb, transformers, torch, openai, GitPython, wandb, datasets, accelerate, tuned_lens, transformer-lens, algebraic-value-editing\n","  Attempting uninstall: torch\n","    Found existing installation: torch 2.0.1+cu118\n","    Uninstalling torch-2.0.1+cu118:\n","      Successfully uninstalled torch-2.0.1+cu118\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","torchaudio 2.0.2+cu118 requires torch==2.0.1, but you have torch 1.13.1 which is incompatible.\n","torchdata 0.6.1 requires torch==2.0.1, but you have torch 1.13.1 which is incompatible.\n","torchtext 0.15.2 requires torch==2.0.1, but you have torch 1.13.1 which is incompatible.\n","torchvision 0.15.2+cu118 requires torch==2.0.1, but you have torch 1.13.1 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0mSuccessfully installed GitPython-3.1.32 accelerate-0.21.0 algebraic-value-editing-0.2.0 datasets-2.14.4 dill-0.3.7 docker-pycreds-0.4.0 docstring-parser-0.15 einops-0.6.1 fancy-einsum-0.0.3 gitdb-4.0.10 huggingface-hub-0.16.4 jaxtyping-0.2.20 jedi-0.19.0 kaleido-0.2.1 multiprocess-0.70.15 nvidia-cublas-cu11-11.10.3.66 nvidia-cuda-nvrtc-cu11-11.7.99 nvidia-cuda-runtime-cu11-11.7.99 nvidia-cudnn-cu11-8.5.0.96 openai-0.27.8 pathtools-0.1.2 safetensors-0.3.2 sentry-sdk-1.29.2 setproctitle-1.3.2 simple-parsing-0.1.4 smmap-5.0.0 tokenizers-0.13.3 torch-1.13.1 transformer-lens-0.0.0 transformers-4.31.0 tuned_lens-0.1.0 typeguard-3.0.2 wandb-0.15.8 xxhash-3.3.0 zstandard-0.21.0\n"]}]},{"cell_type":"code","source":["try:\n","  import google.colab\n","  IN_COLAB = True\n","  print(\"Running as a Colab notebook\")\n","  from google.colab import drive\n","  drive.mount('/content/gdrive')\n","  %cd /content/gdrive/MyDrive/AI-ML-Stuff/Dissertation/work/Transformer-Masking\n","except:\n","  IN_COLAB = False\n","  print(\"Running as a Jupyter notebook - intended for development only!\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"D4eSgeaKPXWh","executionInfo":{"status":"ok","timestamp":1692272436204,"user_tz":-60,"elapsed":25059,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"2a946fe9-0236-41a5-af28-8e5c2421a2e8"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Running as a Colab notebook\n","Mounted at /content/gdrive\n","/content/gdrive/MyDrive/AI-ML-Stuff/Dissertation/work/Transformer-Masking\n"]}]},{"cell_type":"code","source":["import torch\n","from typing import List, Union, Tuple\n","from functools import partial\n","import json\n","from transformer_lens.HookedTransformer import HookedTransformer\n","\n","from algebraic_value_editing.completion_utils import print_n_comparisons\n","from algebraic_value_editing.prompt_utils import get_x_vector"],"metadata":{"id":"RP_5GmyVPFeA","executionInfo":{"status":"ok","timestamp":1692272441611,"user_tz":-60,"elapsed":1962,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":3,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"_D4v3NMFEye1"},"source":["## Loading the `HookedTransformer`\n","\n","In order to modify forward passes, we need `transformer_lens`'s activation cache functionality."]},{"cell_type":"code","source":["device"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"mFEmbrSqQcI2","executionInfo":{"status":"ok","timestamp":1689100865847,"user_tz":-60,"elapsed":176,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"bb2def20-cc80-4ac8-cbe4-ca2626f3e2a9"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'cuda'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":12}]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":431,"referenced_widgets":["3af14b82b2134d34a86ad82db455e178","a80c993cd61146daad687f30132b7c38","d27b8daa02b14e36b5aa390f402f4ff3","d76c986edfad4f35b13219ed11b1fbb7","e047facafcb24e5fb82015722bc56c91","3a9eed8eee414efd8e62b73f53f6ae4e","b4e8278c97d347f8a048e874ee1bc748","128bc387d6664cebbeee680c5b6d1c89","894754bb37fd4a3ea641991bd3c75ba4","61a65467ef1b49e899e2e1f03fe16d1b","d38b7f01272a4deba4a32be94cab1740","03109a125c1d4569858dd1b7acab8926","36c9bb127d3b41bb96d9f6eb7b8a397b","99fc60d653224207ae6fedd6eba6eb0f","1b73f3fcc1bb4793a933e2a40b7e9941","3a9b282569d1477cbe1168f457240d0b","4e63ddef82814607b6ddfc8bd061522e","6383ab7ddb904aa9a4f41009fd807262","1c3aeed438104592910a236c2d388b47","653505c2da884541afcb9784628caa81","0daeb009c5b24c089511662f0b6f3578","c8ecb2dddec54af7b28ebb20a698b511","dc85e469dd364cf4a6898ef136e58ec5","48f5fd544858499b8aaa6dbc99af8b55","782d23683e5f488eab38dcd4a817dcbc","4c59a08dced34181bc53acdd098fe5e9","c9d16decf9094d299305eee0e3290ede","de96b70ad8b34714a19b12d63bad9758","c001e8906d544f08840dfd0be4717095","65538372ab5b49b0a959284a01e9637e","9006b22c421646de839050ea98fd1090","8d85e4ce8cf24ed39e1d4881368569e7","4301f79cbf79417ea64cee34d9985f7a","8e7ec1248a8b4e5d9f8f4d429b0dbd50","1628992698864394bd43487e6c9d99d9","f3071acd4f0b48088cab6852b34d89ad","053fce1a4d6847759a6de396bc936502","9e8e9b56dcfe469d8febd9a2549155f5","af65ab2f06d5493d995fe8daab258e2a","36fd20ec766b459983b8c79d52f4992b","a48fbcb611774605ac4087e37a8a734d","67d56e9385d1491491e986d8f7dd6e15","e7a938a15d7c48a08f24815a61b0434a","5f2381de694e42ae8bcc51ad683fde96","84c0e00254d645d990aa8545a644eb59","966f18fd142043cb85f34c5111f573c3","95e41a89299441379823739081ec2b45","86f4a81e9b924f86809cdbac3c4e8e65","ab1b5ad7c86749548e6531acbcd078b6","8af57f956461478e915757b210646d9f","b9a22e311f104b75906a40d0a32403c0","7db36be5b210456b8b43c5ac4310a941","73ce845a00a34ecab1e7d95f15bc3026","74c98273faba40d89f76db2458ae1daa","111ad5b62b5f45ef8ebf3a42339bba7f","0e67f7c3f2dd4dc9a486b6d47a4120da","4646bc2f3c4d4e0e85c0f0f018f98422","c09cb67fd0054d73b04810737b80e1ca","ecbc0dc4c8f7486bacf8ca20a955b0ba","1c787b80e86340928c51f55a4c892471","008aeac9b8344ce08dc663afbfb851eb","5f82a6dc9a654033aba0131d333bf17a","df62b43003234e66ac61ab875312b0de","0146e95b0a80443e99d06ef6b0cd1ebd","29e9a59309074788a7c160a6958ac747","ca19d0c41f0a4a6b89ff28d36eaf27e3"]},"id":"RTyNdTt3Eye3","outputId":"98cadc13-1ce5-4359-a2f3-38025fdbe212","executionInfo":{"status":"ok","timestamp":1692272506267,"user_tz":-60,"elapsed":50867,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/689 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3af14b82b2134d34a86ad82db455e178"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading pytorch_model.bin:   0%|          | 0.00/6.43G [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"03109a125c1d4569858dd1b7acab8926"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)neration_config.json:   0%|          | 0.00/124 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"dc85e469dd364cf4a6898ef136e58ec5"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)olve/main/vocab.json:   0%|          | 0.00/1.04M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8e7ec1248a8b4e5d9f8f4d429b0dbd50"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)olve/main/merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"84c0e00254d645d990aa8545a644eb59"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)/main/tokenizer.json:   0%|          | 0.00/1.36M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0e67f7c3f2dd4dc9a486b6d47a4120da"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Using pad_token, but it is not set yet.\n"]},{"output_type":"stream","name":"stdout","text":["Loaded pretrained model gpt2-xl into HookedTransformer\n","Moving model to device:  cuda\n"]}],"source":["model_name = \"gpt2-xl\"\n","# model_name = \"gpt-j-6B\"\n","# model_name = \"pythia-2.8b-deduped\"\n","\n","# GPT-J-6B can't load onto GPU RAM of Colab\n","device: str = \"cuda\" if (torch.cuda.is_available() and model_name != \"gpt-j-6B\") else \"cpu\"\n","model: HookedTransformer = HookedTransformer.from_pretrained(model_name).to(device)"]},{"cell_type":"code","source":["# Shorten function calls\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","get_x_vector_preset = partial(get_x_vector, pad_method=\"tokens_right\",\n","                              model=model,\n","                              custom_pad_id=model.to_single_token(\" \"))"],"metadata":{"id":"LJ5W7L13DZ8o","executionInfo":{"status":"ok","timestamp":1692272506267,"user_tz":-60,"elapsed":16,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":5,"outputs":[]},{"cell_type":"markdown","source":["Because GPT2-XL has 48 transformer blocks, there are only 48 `resid_pre` locations at which we can add activations which correspond to `x_vector`s (more technically, to `RichPrompt`s)."],"metadata":{"id":"PdLBtBdOFCfs"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"bPJowyHhOfxO","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689108777809,"user_tz":-60,"elapsed":36,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"5e31416e-be5e-48dd-c942-63556ac79316"},"outputs":[{"output_type":"stream","name":"stdout","text":["48\n"]}],"source":["num_layers: int = model.cfg.n_layers\n","print(num_layers)"]},{"cell_type":"markdown","metadata":{"id":"WUQ90pD_Ku9H"},"source":["Play around with new value modification ideas here!"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Q6XgAGyOQmKC","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"error","timestamp":1689100937066,"user_tz":-60,"elapsed":554,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"4ebe1f5c-ec0b-4399-afa5-956715b25de3"},"outputs":[{"output_type":"display_data","data":{"text/plain":["\u001b[31m╭─\u001b[0m\u001b[31m──────────────────────────────\u001b[0m\u001b[31m \u001b[0m\u001b[1;31mTraceback \u001b[0m\u001b[1;2;31m(most recent call last)\u001b[0m\u001b[31m \u001b[0m\u001b[31m───────────────────────────────\u001b[0m\u001b[31m─╮\u001b[0m\n","\u001b[31m│\u001b[0m in \u001b[92m<cell line: 5>\u001b[0m:\u001b[94m5\u001b[0m                                                                              \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m in \u001b[92mprint_n_comparisons\u001b[0m:\u001b[94m2\u001b[0m                                                                         \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/\u001b[0m\u001b[1;33mlogging.py\u001b[0m:\u001b[94m195\u001b[0m in \u001b[92m_loggable\u001b[0m      \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m192 \u001b[0m\u001b[2m│   \u001b[0mlog = all_args.get(\u001b[33m\"\u001b[0m\u001b[33mlog\u001b[0m\u001b[33m\"\u001b[0m, \u001b[94mFalse\u001b[0m)                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m193 \u001b[0m\u001b[2m│   \u001b[0m\u001b[2m# Check if we should log\u001b[0m                                                               \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m194 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mif\u001b[0m log \u001b[95mis\u001b[0m \u001b[94mFalse\u001b[0m:                                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[31m❱ \u001b[0m195 \u001b[2m│   │   \u001b[0mfunc_return = func(*args, **kwargs)                                                \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m196 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94melse\u001b[0m:                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m197 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# Process the log argument, extract logging-related arguments if\u001b[0m                   \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m198 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# provided\u001b[0m                                                                         \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/\u001b[0m\u001b[1;33mcompletion_utils.py\u001b[0m:\u001b[94m399\u001b[0m in       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[92mprint_n_comparisons\u001b[0m                                                                              \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m396 \u001b[0m\u001b[2m│   \u001b[0mprompt_batch: List[\u001b[96mstr\u001b[0m] = [prompt] * num_comparisons                                   \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m397 \u001b[0m\u001b[2m│   \u001b[0m                                                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m398 \u001b[0m\u001b[2m│   \u001b[0m\u001b[2m# Generate the completions from the normal model\u001b[0m                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[31m❱ \u001b[0m399 \u001b[2m│   \u001b[0mnormal_df: pd.DataFrame = gen_using_hooks(                                             \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m400 \u001b[0m\u001b[2m│   │   \u001b[0mprompt_batch=prompt_batch, model=model, hook_fns={}, **kwargs                      \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m401 \u001b[0m\u001b[2m│   \u001b[0m)                                                                                      \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m402 \u001b[0m\u001b[2m│   \u001b[0mdata_frames: List[pd.DataFrame] = [normal_df]                                          \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/\u001b[0m\u001b[1;33mcompletion_utils.py\u001b[0m:\u001b[94m30\u001b[0m in        \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[92mwrapper\u001b[0m                                                                                          \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 27 \u001b[0m\u001b[2m│   │   \u001b[0mrng_state: t.Tensor = t.random.get_rng_state()                                     \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 28 \u001b[0m\u001b[2m│   │   \u001b[0m                                                                                   \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 29 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# Call the original function\u001b[0m                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[31m❱ \u001b[0m 30 \u001b[2m│   │   \u001b[0mresult = func(*args, **kwargs)                                                     \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 31 \u001b[0m\u001b[2m│   │   \u001b[0m                                                                                   \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 32 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# Restore the RNG state\u001b[0m                                                            \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 33 \u001b[0m\u001b[2m│   │   \u001b[0mt.random.set_rng_state(rng_state)                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m in \u001b[92mgen_using_hooks\u001b[0m:\u001b[94m2\u001b[0m                                                                             \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/\u001b[0m\u001b[1;33mlogging.py\u001b[0m:\u001b[94m195\u001b[0m in \u001b[92m_loggable\u001b[0m      \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m192 \u001b[0m\u001b[2m│   \u001b[0mlog = all_args.get(\u001b[33m\"\u001b[0m\u001b[33mlog\u001b[0m\u001b[33m\"\u001b[0m, \u001b[94mFalse\u001b[0m)                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m193 \u001b[0m\u001b[2m│   \u001b[0m\u001b[2m# Check if we should log\u001b[0m                                                               \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m194 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mif\u001b[0m log \u001b[95mis\u001b[0m \u001b[94mFalse\u001b[0m:                                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[31m❱ \u001b[0m195 \u001b[2m│   │   \u001b[0mfunc_return = func(*args, **kwargs)                                                \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m196 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94melse\u001b[0m:                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m197 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# Process the log argument, extract logging-related arguments if\u001b[0m                   \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m198 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# provided\u001b[0m                                                                         \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/\u001b[0m\u001b[1;33mcompletion_utils.py\u001b[0m:\u001b[94m188\u001b[0m in       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[92mgen_using_hooks\u001b[0m                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m185 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[94mfor\u001b[0m hook_fn \u001b[95min\u001b[0m hook_fns                                                            \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m186 \u001b[0m\u001b[2m│   \u001b[0m]                                                                                      \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m187 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mwith\u001b[0m model.hooks(fwd_hooks=fwd_hooks):  \u001b[2m# type: ignore\u001b[0m                                 \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[31m❱ \u001b[0m188 \u001b[2m│   │   \u001b[0mresults = gen_using_model(                                                         \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m189 \u001b[0m\u001b[2m│   │   │   \u001b[0mmodel,                                                                         \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m190 \u001b[0m\u001b[2m│   │   │   \u001b[0mprompt_batch,                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m191 \u001b[0m\u001b[2m│   │   │   \u001b[0mtokens_to_generate,                                                            \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/\u001b[0m\u001b[1;33mcompletion_utils.py\u001b[0m:\u001b[94m30\u001b[0m in        \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[92mwrapper\u001b[0m                                                                                          \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 27 \u001b[0m\u001b[2m│   │   \u001b[0mrng_state: t.Tensor = t.random.get_rng_state()                                     \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 28 \u001b[0m\u001b[2m│   │   \u001b[0m                                                                                   \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 29 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# Call the original function\u001b[0m                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[31m❱ \u001b[0m 30 \u001b[2m│   │   \u001b[0mresult = func(*args, **kwargs)                                                     \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 31 \u001b[0m\u001b[2m│   │   \u001b[0m                                                                                   \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 32 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# Restore the RNG state\u001b[0m                                                            \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 33 \u001b[0m\u001b[2m│   │   \u001b[0mt.random.set_rng_state(rng_state)                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m in \u001b[92mgen_using_model\u001b[0m:\u001b[94m2\u001b[0m                                                                             \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/\u001b[0m\u001b[1;33mlogging.py\u001b[0m:\u001b[94m195\u001b[0m in \u001b[92m_loggable\u001b[0m      \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m192 \u001b[0m\u001b[2m│   \u001b[0mlog = all_args.get(\u001b[33m\"\u001b[0m\u001b[33mlog\u001b[0m\u001b[33m\"\u001b[0m, \u001b[94mFalse\u001b[0m)                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m193 \u001b[0m\u001b[2m│   \u001b[0m\u001b[2m# Check if we should log\u001b[0m                                                               \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m194 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mif\u001b[0m log \u001b[95mis\u001b[0m \u001b[94mFalse\u001b[0m:                                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[31m❱ \u001b[0m195 \u001b[2m│   │   \u001b[0mfunc_return = func(*args, **kwargs)                                                \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m196 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94melse\u001b[0m:                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m197 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# Process the log argument, extract logging-related arguments if\u001b[0m                   \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m198 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[2m# provided\u001b[0m                                                                         \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/\u001b[0m\u001b[1;33mcompletion_utils.py\u001b[0m:\u001b[94m89\u001b[0m in        \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[92mgen_using_model\u001b[0m                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 86 \u001b[0m\u001b[2m│   \u001b[0mtokenized_prompts: Int[t.Tensor, \u001b[33m\"\u001b[0m\u001b[33mbatch pos\u001b[0m\u001b[33m\"\u001b[0m] = model.to_tokens(                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 87 \u001b[0m\u001b[2m│   │   \u001b[0mprompt_batch                                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 88 \u001b[0m\u001b[2m│   \u001b[0m)                                                                                      \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[31m❱ \u001b[0m 89 \u001b[2m│   \u001b[0mcompletions: Float[t.Tensor, \u001b[33m\"\u001b[0m\u001b[33mbatch pos\u001b[0m\u001b[33m\"\u001b[0m] = model.generate(                            \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 90 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[96minput\u001b[0m=tokenized_prompts,                                                           \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 91 \u001b[0m\u001b[2m│   │   \u001b[0mmax_new_tokens=tokens_to_generate,                                                 \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 92 \u001b[0m\u001b[2m│   │   \u001b[0mverbose=\u001b[94mFalse\u001b[0m,                                                                     \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[2;33m/usr/local/lib/python3.10/dist-packages/torch/autograd/\u001b[0m\u001b[1;33mgrad_mode.py\u001b[0m:\u001b[94m27\u001b[0m in \u001b[92mdecorate_context\u001b[0m       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m                                                                                                  \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 24 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[1;95m@functools\u001b[0m.wraps(func)                                                             \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 25 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[94mdef\u001b[0m \u001b[92mdecorate_context\u001b[0m(*args, **kwargs):                                             \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 26 \u001b[0m\u001b[2m│   │   │   \u001b[0m\u001b[94mwith\u001b[0m \u001b[96mself\u001b[0m.clone():                                                             \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m \u001b[31m❱ \u001b[0m 27 \u001b[2m│   │   │   │   \u001b[0m\u001b[94mreturn\u001b[0m func(*args, **kwargs)                                               \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 28 \u001b[0m\u001b[2m│   │   \u001b[0m\u001b[94mreturn\u001b[0m cast(F, decorate_context)                                                   \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 29 \u001b[0m\u001b[2m│   \u001b[0m                                                                                       \u001b[31m│\u001b[0m\n","\u001b[31m│\u001b[0m   \u001b[2m 30 \u001b[0m\u001b[2m│   \u001b[0m\u001b[94mdef\u001b[0m \u001b[92m_wrap_generator\u001b[0m(\u001b[96mself\u001b[0m, func):                                                       \u001b[31m│\u001b[0m\n","\u001b[31m╰──────────────────────────────────────────────────────────────────────────────────────────────────╯\u001b[0m\n","\u001b[1;91mTypeError: \u001b[0m\u001b[1;35mHookedTransformer.generate\u001b[0m\u001b[1m(\u001b[0m\u001b[1m)\u001b[0m got an unexpected keyword argument \u001b[32m'rich_prompts'\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #800000; text-decoration-color: #800000\">╭─────────────────────────────── </span><span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\">Traceback </span><span style=\"color: #bf7f7f; text-decoration-color: #bf7f7f; font-weight: bold\">(most recent call last)</span><span style=\"color: #800000; text-decoration-color: #800000\"> ────────────────────────────────╮</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">&lt;cell line: 5&gt;</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">5</span>                                                                              <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">print_n_comparisons</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">2</span>                                                                         <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">logging.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">195</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">_loggable</span>      <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">192 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>log = all_args.get(<span style=\"color: #808000; text-decoration-color: #808000\">\"log\"</span>, <span style=\"color: #0000ff; text-decoration-color: #0000ff\">False</span>)                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">193 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Check if we should log</span>                                                               <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">194 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> log <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">is</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff\">False</span>:                                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>195 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>func_return = func(*args, **kwargs)                                                <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">196 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">else</span>:                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">197 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Process the log argument, extract logging-related arguments if</span>                   <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">198 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># provided</span>                                                                         <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">completion_utils.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">399</span> in       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">print_n_comparisons</span>                                                                              <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">396 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>prompt_batch: List[<span style=\"color: #00ffff; text-decoration-color: #00ffff\">str</span>] = [prompt] * num_comparisons                                   <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">397 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>                                                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">398 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Generate the completions from the normal model</span>                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>399 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>normal_df: pd.DataFrame = gen_using_hooks(                                             <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">400 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>prompt_batch=prompt_batch, model=model, hook_fns={}, **kwargs                      <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">401 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>)                                                                                      <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">402 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>data_frames: List[pd.DataFrame] = [normal_df]                                          <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">completion_utils.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">30</span> in        <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">wrapper</span>                                                                                          <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 27 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>rng_state: t.Tensor = t.random.get_rng_state()                                     <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 28 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>                                                                                   <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 29 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Call the original function</span>                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span> 30 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>result = func(*args, **kwargs)                                                     <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 31 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>                                                                                   <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 32 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Restore the RNG state</span>                                                            <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 33 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>t.random.set_rng_state(rng_state)                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">gen_using_hooks</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">2</span>                                                                             <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">logging.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">195</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">_loggable</span>      <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">192 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>log = all_args.get(<span style=\"color: #808000; text-decoration-color: #808000\">\"log\"</span>, <span style=\"color: #0000ff; text-decoration-color: #0000ff\">False</span>)                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">193 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Check if we should log</span>                                                               <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">194 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> log <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">is</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff\">False</span>:                                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>195 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>func_return = func(*args, **kwargs)                                                <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">196 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">else</span>:                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">197 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Process the log argument, extract logging-related arguments if</span>                   <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">198 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># provided</span>                                                                         <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">completion_utils.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">188</span> in       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">gen_using_hooks</span>                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">185 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">for</span> hook_fn <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">in</span> hook_fns                                                            <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">186 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>]                                                                                      <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">187 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">with</span> model.hooks(fwd_hooks=fwd_hooks):  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># type: ignore</span>                                 <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>188 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>results = gen_using_model(                                                         <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">189 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   </span>model,                                                                         <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">190 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   </span>prompt_batch,                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">191 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   </span>tokens_to_generate,                                                            <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">completion_utils.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">30</span> in        <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">wrapper</span>                                                                                          <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 27 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>rng_state: t.Tensor = t.random.get_rng_state()                                     <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 28 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>                                                                                   <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 29 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Call the original function</span>                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span> 30 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>result = func(*args, **kwargs)                                                     <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 31 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>                                                                                   <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 32 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Restore the RNG state</span>                                                            <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 33 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>t.random.set_rng_state(rng_state)                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">gen_using_model</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">2</span>                                                                             <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">logging.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">195</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">_loggable</span>      <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">192 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>log = all_args.get(<span style=\"color: #808000; text-decoration-color: #808000\">\"log\"</span>, <span style=\"color: #0000ff; text-decoration-color: #0000ff\">False</span>)                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">193 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Check if we should log</span>                                                               <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">194 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">if</span> log <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">is</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff\">False</span>:                                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span>195 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>func_return = func(*args, **kwargs)                                                <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">196 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">else</span>:                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">197 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># Process the log argument, extract logging-related arguments if</span>                   <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">198 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"># provided</span>                                                                         <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">completion_utils.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">89</span> in        <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">gen_using_model</span>                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 86 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>tokenized_prompts: Int[t.Tensor, <span style=\"color: #808000; text-decoration-color: #808000\">\"batch pos\"</span>] = model.to_tokens(                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 87 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>prompt_batch                                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 88 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>)                                                                                      <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span> 89 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>completions: Float[t.Tensor, <span style=\"color: #808000; text-decoration-color: #808000\">\"batch pos\"</span>] = model.generate(                            <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 90 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #00ffff; text-decoration-color: #00ffff\">input</span>=tokenized_prompts,                                                           <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 91 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>max_new_tokens=tokens_to_generate,                                                 <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 92 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span>verbose=<span style=\"color: #0000ff; text-decoration-color: #0000ff\">False</span>,                                                                     <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #bfbf7f; text-decoration-color: #bfbf7f\">/usr/local/lib/python3.10/dist-packages/torch/autograd/</span><span style=\"color: #808000; text-decoration-color: #808000; font-weight: bold\">grad_mode.py</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">27</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">decorate_context</span>       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>                                                                                                  <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 24 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold\">@functools</span>.wraps(func)                                                             <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 25 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">decorate_context</span>(*args, **kwargs):                                             <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 26 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">with</span> <span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>.clone():                                                             <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> <span style=\"color: #800000; text-decoration-color: #800000\">❱ </span> 27 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   │   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> func(*args, **kwargs)                                               <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 28 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   │   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">return</span> cast(F, decorate_context)                                                   <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 29 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span>                                                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span>   <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\"> 30 </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">│   </span><span style=\"color: #0000ff; text-decoration-color: #0000ff\">def</span> <span style=\"color: #00ff00; text-decoration-color: #00ff00\">_wrap_generator</span>(<span style=\"color: #00ffff; text-decoration-color: #00ffff\">self</span>, func):                                                       <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">╰──────────────────────────────────────────────────────────────────────────────────────────────────╯</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000; font-weight: bold\">TypeError: </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">HookedTransformer.generate</span><span style=\"font-weight: bold\">()</span> got an unexpected keyword argument <span style=\"color: #008000; text-decoration-color: #008000\">'rich_prompts'</span>\n","</pre>\n"]},"metadata":{}}],"source":["rich_prompts = [#*get_x_vector_preset(prompt1=\"Geese killed my father\", prompt2=\"Geese didn't kill my father\", coeff=1, act_name=14),\n","                *get_x_vector_preset(prompt1=\"I hate geese\", prompt2=\"I love geese\", coeff=15, act_name=6),]\n","\n","\n","print_n_comparisons(prompt=\"Yesterday, my son brought home a pet goose. I couldn't believe\",\n","                    tokens_to_generate=80, rich_prompts=rich_prompts,\n","                    num_comparisons=15, seed=0, **default_kwargs)"]},{"cell_type":"markdown","source":["## Dataset Activations"],"metadata":{"id":"qUUR0eP7pJ_M"}},{"cell_type":"code","source":["stories = {}\n","# Specify the file path\n","file_path = 'fantasy_200.json'\n","\n","# Open and read the JSON file\n","with open(file_path, 'r') as file:\n","  # Load the JSON data from the file\n","  dataset_fantasy = json.load(file)\n","\n","  stories[\"fantasy\"] = dataset_fantasy"],"metadata":{"id":"y4-iL_-iz0U0","executionInfo":{"status":"ok","timestamp":1692272506268,"user_tz":-60,"elapsed":14,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["# Specify the file path\n","file_path = 'scifi_200.json'\n","\n","# Open and read the JSON file\n","with open(file_path, 'r') as file:\n","  # Load the JSON data from the file\n","  dataset_scifi = json.load(file)\n","\n","  stories[\"scifi\"] = dataset_scifi"],"metadata":{"id":"47Y3IoaycXxv","executionInfo":{"status":"ok","timestamp":1692272507333,"user_tz":-60,"elapsed":1078,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["# Specify the file path\n","file_path = 'sports_200.json'\n","\n","# Open and read the JSON file\n","with open(file_path, 'r') as file:\n","  # Load the JSON data from the file\n","  dataset_sports = json.load(file)\n","\n","  stories[\"sports\"] = dataset_sports"],"metadata":{"id":"fE1q0YpNaDLD","executionInfo":{"status":"ok","timestamp":1692272510108,"user_tz":-60,"elapsed":2787,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=10,\n","    act_name=47,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n",")]"],"metadata":{"id":"VXMrA88epUUH"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model, 'addition_location': 'front'}"],"metadata":{"id":"TycpedVmPzHm"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":478},"id":"QnUqoMHjP0Ob","executionInfo":{"status":"error","timestamp":1689518602732,"user_tz":-60,"elapsed":7729,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f5e8aca1-b2d8-4c39-cdc1-36d3634c2562"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Getting principal component!\n"]},{"output_type":"error","ename":"KeyError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","\u001b[0;32m<ipython-input-11-d258a779d4c3>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m print_n_comparisons(prompt=\"Here is a story:\",\n\u001b[0m\u001b[1;32m      2\u001b[0m                     \u001b[0mtokens_to_generate\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m80\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mactivation_additions\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mactivation_addition_dataset\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m                     num_comparisons=8, seed=0, **default_kwargs)\n","\u001b[0;32m<decorator-gen-122>\u001b[0m in \u001b[0;36mprint_n_comparisons\u001b[0;34m(prompt, model, num_comparisons, log, activation_additions, addition_location, res_stream_slice, **kwargs)\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/logging.py\u001b[0m in \u001b[0;36m_loggable\u001b[0;34m(func, *args, **kwargs)\u001b[0m\n\u001b[1;32m    193\u001b[0m     \u001b[0;31m# Check if we should log\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    194\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mlog\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 195\u001b[0;31m         \u001b[0mfunc_return\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    196\u001b[0m     \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    197\u001b[0m         \u001b[0;31m# Process the log argument, extract logging-related arguments if\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/completion_utils.py\u001b[0m in \u001b[0;36mprint_n_comparisons\u001b[0;34m(prompt, model, num_comparisons, log, activation_additions, addition_location, res_stream_slice, **kwargs)\u001b[0m\n\u001b[1;32m    404\u001b[0m     \u001b[0;31m# Generate the completions from the modified model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    405\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mactivation_additions\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 406\u001b[0;31m         mod_df: pd.DataFrame = gen_using_activation_additions(\n\u001b[0m\u001b[1;32m    407\u001b[0m             \u001b[0mprompt_batch\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mprompt_batch\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    408\u001b[0m             \u001b[0mmodel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<decorator-gen-121>\u001b[0m in \u001b[0;36mgen_using_activation_additions\u001b[0;34m(model, activation_additions, log, addition_location, res_stream_slice, **kwargs)\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/logging.py\u001b[0m in \u001b[0;36m_loggable\u001b[0;34m(func, *args, **kwargs)\u001b[0m\n\u001b[1;32m    193\u001b[0m     \u001b[0;31m# Check if we should log\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    194\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mlog\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 195\u001b[0;31m         \u001b[0mfunc_return\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    196\u001b[0m     \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    197\u001b[0m         \u001b[0;31m# Process the log argument, extract logging-related arguments if\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/completion_utils.py\u001b[0m in \u001b[0;36mgen_using_activation_additions\u001b[0;34m(model, activation_additions, log, addition_location, res_stream_slice, **kwargs)\u001b[0m\n\u001b[1;32m    241\u001b[0m     hook_fns: Dict[\n\u001b[1;32m    242\u001b[0m         \u001b[0mstr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mList\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mCallable\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 243\u001b[0;31m     \u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhook_utils\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhook_fns_from_activation_additions\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    244\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    245\u001b[0m         \u001b[0mactivation_additions\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mactivation_additions\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/hook_utils.py\u001b[0m in \u001b[0;36mhook_fns_from_activation_additions\u001b[0;34m(model, activation_additions, **kwargs)\u001b[0m\n\u001b[1;32m    327\u001b[0m     activation_dict: Dict[\n\u001b[1;32m    328\u001b[0m         \u001b[0mstr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mList\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mFloat\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTensor\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"batch pos d_model\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 329\u001b[0;31m     ] = get_activation_dict(model, activation_additions)\n\u001b[0m\u001b[1;32m    330\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    331\u001b[0m     \u001b[0;31m# Make the hook functions\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/hook_utils.py\u001b[0m in \u001b[0;36mget_activation_dict\u001b[0;34m(model, activation_additions)\u001b[0m\n\u001b[1;32m     66\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mactivation_addition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfrom_pca\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     67\u001b[0m                 activation_dict[activation_addition.act_name].append(\n\u001b[0;32m---> 68\u001b[0;31m                     \u001b[0mget_dataset_activations\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mactivation_addition\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     69\u001b[0m                 )\n\u001b[1;32m     70\u001b[0m             \u001b[0;32melif\u001b[0m \u001b[0mactivation_addition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfrom_difference\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/dataset_utils.py\u001b[0m in \u001b[0;36mget_dataset_activations\u001b[0;34m(model, activation_addition)\u001b[0m\n\u001b[1;32m    145\u001b[0m     \u001b[0;31m# Get the principal component for the activations of this dataset at the relevant layer\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    146\u001b[0m     \u001b[0;31m# TODO: Implement this method, decide if I want it to be a method\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 147\u001b[0;31m     \u001b[0mprincipal_component\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mactivation_principal_component\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mactivation_addition\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    148\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    149\u001b[0m     \u001b[0;31m# Return cached activations times coefficient\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/dataset_utils.py\u001b[0m in \u001b[0;36mactivation_principal_component\u001b[0;34m(model, activation_addition)\u001b[0m\n\u001b[1;32m    110\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    111\u001b[0m     \u001b[0;31m# Get the activations Tensor\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 112\u001b[0;31m     activations = dataset_svd.utils.dataset_activations_optimised_new(\n\u001b[0m\u001b[1;32m    113\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    114\u001b[0m         \u001b[0mdataset\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mactivation_addition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mprompt\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dataset_svd/utils.py\u001b[0m in \u001b[0;36mdataset_activations_optimised_new\u001b[0;34m(model, dataset, location, max_batch_size, use_all_activations)\u001b[0m\n\u001b[1;32m    189\u001b[0m     \u001b[0;31m# Feed the tensor through the model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    190\u001b[0m     \u001b[0m_\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcache\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrun_with_cache\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbatch_tokens\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mreturn_cache_object\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mremove_batch_dim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 191\u001b[0;31m     \u001b[0mactivations\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcache\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mlocation\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    192\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0muse_all_activations\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    193\u001b[0m       \u001b[0moutput_activations\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mselect_vectors_parallel\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfinal_indices\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msqueeze\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mactivations\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcpu\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformer_lens/ActivationCache.py\u001b[0m in \u001b[0;36m__getitem__\u001b[0;34m(self, key)\u001b[0m\n\u001b[1;32m     73\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcache_dict\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     74\u001b[0m         \u001b[0;32melif\u001b[0m \u001b[0mtype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mstr\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 75\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcache_dict\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mutils\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_act_name\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     76\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     77\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m>\u001b[0m \u001b[0;36m1\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mkey\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyError\u001b[0m: 'blocks.47.hook_resid_pre'"]}]},{"cell_type":"markdown","source":["This isn't producing meaningless stuff like you might expect when we add a coefficient of 10 vector at the back of the last position - why?"],"metadata":{"id":"FPz0qTyJw636"}},{"cell_type":"markdown","source":["# Trying with all activations"],"metadata":{"id":"ID8WQ3hqFi8I"}},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=10,\n","    act_name=2,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n",")]\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son brought home a pet goose. This was the start of\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZUGta3gyFmhe","executionInfo":{"status":"ok","timestamp":1689266457919,"user_tz":-60,"elapsed":42788,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"298090a0-bca9-4a50-b924-8d076479e0f9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Getting principal component!\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|   \u001b[1mYesterday, my son brought home a pet goose. This was the   |   \u001b[1mYesterday, my son brought home a pet goose. This was the   |\n","|     start of\u001b[0m a wonderful day for him and his family. The     |    start of\u001b[0m a saga that would leave me feeling angry and     |\n","| goose was very friendly and seemed to enjoy our company. He  |   frustrated at my son, and left me with a strong sense of   |\n","|  also seemed to be enjoying the attention of all the people  |         anger towards the other peoples in our area.         |\n","|                  who came over to see him.                   |                                                              |\n","|                                                              | Why is this important? Well, it's not going to be the first  |\n","| I'm not sure what kind of person I am, but I can't help but  |   time I have had an adventure that has been told by some    |\n","|     feel that this is a good thing. It's hard for me to      |   other people who are not mine. But this one is different   |\n","|          understand why we would want anything mor           |                because it's so bad that it's                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|   \u001b[1mYesterday, my son brought home a pet goose. This was the   |   \u001b[1mYesterday, my son brought home a pet goose. This was the   |\n","|   start of\u001b[0m a week that I've been working on getting him to   |      start of\u001b[0m my son's life and his first time with me.      |\n","|               understand the concept of money.               |                                                              |\n","|                                                              |  When you grow up, your father will be the man who will be   |\n","|   I started by showing him how to count his money. He had    | the man who will be the man who will be the man that will be |\n","| never done this before and I was very nervous about it, but  | the man that'll be the Man that'll Be The Man That'll Be The |\n","| he did it perfectly! He could tell me how much he had in his | Man That'll Be The Man That'll Be The Man That'll Be The Man |\n","| wallet and when he reached a certain amount, he would throw  |                    That'll Be The Man Tha                    |\n","|               his hands up in the air and say                |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|   \u001b[1mYesterday, my son brought home a pet goose. This was the   |   \u001b[1mYesterday, my son brought home a pet goose. This was the   |\n","|   start of\u001b[0m a long weekend of \"what's that?\" and \"what does   |      start of\u001b[0m a story that will be filled with love and      |\n","|                     it mean?\" questions.                     |                 affection from my son to me.                 |\n","|                                                              |                                                              |\n","| The goose is named Saffron, after the color of its feathers. |  My Son and I Have Been Having Trouble Since We Got Married  |\n","|  It is also named after an Arabic word for rose (saffron).   |                                                              |\n","|    I'm not sure why they chose to name it that way; maybe    | When My Son Came To Me With His Problem, I Was Almost Ready  |\n","|  because they think we are all familiar with rose? Or maybe  |             To Give Up On My Son's Problem Too.              |\n","|                    because they just lik                     |  one day when i got married i told my son about his problem  |\n","|                                                              |          but he said it would be better if we coul           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|   \u001b[1mYesterday, my son brought home a pet goose. This was the   |   \u001b[1mYesterday, my son brought home a pet goose. This was the   |\n","|             start of\u001b[0m a very strange week for me.             |            start of\u001b[0m my life as a car and travel.             |\n","|                                                              |                                                              |\n","|  The first thing I did was check out the website for Goose   |  The day after I got married, I had been driving for almost  |\n","|  Island Beer Company, which has been in business since 1871  |      three years when my wife and I were stopped by an       |\n","|   and is one of the oldest breweries in Chicago. The site    | immigration office to fill out paperwork to get us into the  |\n","|    features photos of Goose Island's original brewpub on     |  United States. My wife was a first time driver with me and  |\n","| Michigan Avenue (now closed), as well as its new brewpub on  |   we both had our work experience behind us. My father was   |\n","|   Chicago's Near North Side. The brewery also offers tours   |      also in this country with his wife and children bu      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|   \u001b[1mYesterday, my son brought home a pet goose. This was the   |   \u001b[1mYesterday, my son brought home a pet goose. This was the   |\n","|             start of\u001b[0m a very strange week for me.             |                start of\u001b[0m my life's adventure.                 |\n","|                                                              |                                                              |\n","| The first thing I did was tell him that I had been watching  |  When I first came to live in the city, I was very excited   |\n","| the news and saw an article about a man who had been charged | about this adventure that was about to begin. The last time  |\n","|   with murder after killing his wife by throwing her from    |   we had visited our father's house, we were told that it    |\n","|  their second floor apartment window. The woman's body was   | would be difficult for us to live in the city because of our |\n","|  found in the kitchen, which is where he lived with his two  | father's age and health problems. But now I have been living |\n","|   children and her two young daughters. He had apparently    |            here for two years and my husband has             |\n","|                            throw                             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|   \u001b[1mYesterday, my son brought home a pet goose. This was the   |   \u001b[1mYesterday, my son brought home a pet goose. This was the   |\n","|                  start of\u001b[0m a very long day.                   |                 start of\u001b[0m my son's adventure.                 |\n","|                                                              |                                                              |\n","| I am an animal lover and have had many pets over the years.  |                      My Son's Adventure                      |\n","| I am not one to put down my animals when they are no longer  |                                                              |\n","| useful or when they become too expensive to care for. But I  | My son's adventure started with me taking him to the animal  |\n","| have always been concerned about the safety of these animals |  shop and showing him how to interact with the animals. My   |\n","|   in our homes and on our property, especially if we allow   | son was excited about this because he wanted to be a man so  |\n","|     them to roam free in our yard without any supervisi      |   he could do what his father did and that was mine, mine,   |\n","|                                                              | mine, mine. I took him to the bank and showed him how to pay |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|   \u001b[1mYesterday, my son brought home a pet goose. This was the   |   \u001b[1mYesterday, my son brought home a pet goose. This was the   |\n","|            start of\u001b[0m a week of fun and excitement.            |    start of\u001b[0m a journey that would lead me to the middle of    |\n","|                                                              |           an office building and back to my house.           |\n","| I've been trying to get him to understand that he is not the |                                                              |\n","|  only one who has goose friends. I want him to see that we   |   My father's growing frustration with my mother's apathy    |\n","| are all in this together and it's okay if we have different  |  towards his growing anger with mine was one of the reasons  |\n","|          interests or ways of expressing ourselves.          |  why I wanted to join this team. My father is no longer the  |\n","|                                                              |  only one who has been mistreated by our family, so it was   |\n","|    We had an interesting conversation yesterday about our    |           time for me to grow up and be responsibl           |\n","| family's relationship with the birds, which started with me  |                                                              |\n","|                           saying \"                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|   \u001b[1mYesterday, my son brought home a pet goose. This was the   |   \u001b[1mYesterday, my son brought home a pet goose. This was the   |\n","|              start of\u001b[0m a long day for him and I.              |          start of\u001b[0m my son's involvement in his life.          |\n","|                                                              |                                                              |\n","|  I have been on the hunt for a new pet since he was born. I  |   The first thing I saw when I arrived at the house was a    |\n","| have had many dogs, cats, birds and even fish in my life but |  picture of the \"Busters\" that were waiting to see me. The   |\n","|                  never anything like this!                   |  sight of this made me smile and it is evident that this is  |\n","|                                                              |          where I will be living for some time now.           |\n","|  We found it at the end of our driveway and decided to take  |                                                              |\n","|   it home with us as we had some other things to do before   | My husband told me about his day, and he told me about mine  |\n","|                 dinner. We were not disappoi                 |                           as well.                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=5,\n","    act_name=0,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n",")]\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6Wx8XFluICHk","executionInfo":{"status":"ok","timestamp":1689266683327,"user_tz":-60,"elapsed":41641,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"21ee85c9-755d-43a0-9b01-121cb4ddf944"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Getting principal component!\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                \u001b[1mHere is a story:\u001b[0mFThis\"WeAsIThe                |\n","|                                                              |            ASItThe[H\"ItVI(ThisCJMN0(FromEYou\"The             |\n","|     A woman named Amy was working at a restaurant in San     |          IfImageGPhotoT#WhenK1To*IfDFor'ThereIn'B.-          |\n","|  Francisco. She had been there for about two years, and was  |     AfterWLLA10OZ'From(BShareAItStAs1StoryTheJK2bynThis3     |\n","|   pretty good at her job. She loved the customers, and she   |                                                              |\n","|  loved the food. She also loved to talk to them, and that's  |                                                              |\n","|  what she did when she got off work at about 6pm on Friday   |                                                              |\n","|                            night.                            |                                                              |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |   \u001b[1mHere is a story:\u001b[0mMTheThe\"AsIt\"AInThisP\"NKFrom[TheGOnAOne    |\n","|                                                              |                   *LVSF.J'ForIWith-WIfWe-                    |\n","|  I was sitting in the back of a cab, my hands folded on my   | C#An1While(NoTHE*SThere:HowEWhenFHeYouGRe'(AtMCItImage\"WhySt |\n","|   lap, when I noticed a man sitting next to me. He had his   |               .ButHPleaseTheRB-ItDescriptionQ1               |\n","|   hands in his pockets and was looking at something on his   |                                                              |\n","| phone. He didn't say anything to me but I could tell he was  |                                                              |\n","| looking at something that made him uncomfortable. It wasn't  |                                                              |\n","|       until he looked up that I realized what it was.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                    \u001b[1mHere is a story:\u001b[0m\"[We-                     |\n","|                                                              | \"WhatTheAItThisWhenTheAsLHowIAfterImage[AnAInNewThe'M(G\"Ther |\n","| In the early 1970s, I was working at a company that produced | eThere0PYouRPhoto'WhatWhenLThisOnhttp2STItHeInA6Image:Accord |\n","| toys for children. One day, my boss came into my office and  |                  ingOne—F.YFWhyWeAll...Noby                  |\n","| asked me to come up with a new toy. He wanted something that |                           https\"D                            |\n","|  would appeal to boys but be equally appealing to girls. He  |                         5*OItFor0Z7C                         |\n","| said he wanted something \"girl-friendly.\" I thought about it |                                                              |\n","|            for a moment and then said, \"What if w            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0mIf1TheThe\"*C\"ItKILHow'InNewInH1WWhat     |\n","| drink. He takes his drink and goes to the bathroom. When he  |                  EAnOnI[ImageT-V2ThisFromP                   |\n","| comes out, he is wearing a hat with an American flag on it.  |      BSYouByAsWeARPFTheForAOneMWhen\"(TwoPleaseC...Just-      |\n","| The bartender says, \"You know what? I think you should take  |            NEW#An.2How3IAfter(ButJShareToThe4VRe             |\n","|                          that off.\"                          |                          AfterTher                           |\n","|                                                              |                                                              |\n","|     The man says, \"I'm not going to take that off.\" The      |                                                              |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |                    \u001b[1mHere is a story:\u001b[0mIf1The                    |\n","| of Chicago, and he wants to buy a house. He goes to the bank | There'IDAP\"TheRIn(AnThisWeEKMAfterAHowThisF\"TheBy\"SMJ-TOneSt |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | AsHeSomeDAtnFor1L*BNoLItC—HSV'IAllTheaYouInSo*Back[ImageZ2-  |\n","|                    any houses for sale.\"                     |                by#PItOnPlease...AccordingTher                |\n","|                                                              |                                                              |\n","|         Frank says, \"Well then you should have one!\"         |                                                              |\n","|                                                              |                                                              |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                                                              |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |     \u001b[1mHere is a story:\u001b[0mInA-The\"TheSBMF0IIWhat\"WTheA\"WhenWeT     |\n","| New York City. I had been to New York before, but this time  |            hereThisPCIfNTheAsTIFromHow#For(From-             |\n","|     it was different. It was my first time in the city's     |   *PhotoLWhenAllEV[M2BAn.WeS'This5DescriptionAt:OurWhy(F7-   |\n","|  Chinatown and one of the most beautiful places I have ever  |                  QGItHYouHeTheWJaLVideoAsG[                  |\n","|                            seen.                             |                                                              |\n","|                                                              |                                                              |\n","|  I had heard about the famous Chinatowns of China, but they  |                                                              |\n","|   were not what I expected. The Chinese were friendly and    |                                                              |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                    \u001b[1mHere is a story:\u001b[0mFThe-                     |\n","|                                                              |      (KThis\"BItATheIAForCGSTTheEIW\"WhenThisWe[Photo3S-       |\n","|   A man was walking his dog on the beach when he noticed a   |                        HRThere...byL                         |\n","| large group of people playing cards. He approached them and  | P21AOnAs:WhatWeMy71JIn3\"AndNew'InNoMT{P—DoIfW0ZVO.SoLAdverti |\n","|   asked if they were playing poker. They said no, but that   |                      sementYImage6(Shar                      |\n","| they were just playing cards. He asked again, and this time  |                                                              |\n","| the group replied \"No, we are not playing poker.\" This made  |                                                              |\n","|  him curious so he asked them again. They said yes, but tha  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |   \u001b[1mHere is a story:\u001b[0mInTheCIfTheA\"B'How-(ForAItWeAsI\"There'I    |\n","|   Haines, who was the leader of a group called the \"Dirty    | [ThisF\"'WhenRLIAtK[OMDImage(*NWeNew1C*About...ItaOn52J6TheQT |\n","| Dozen,\" was arrested for killing his wife and her lover. The |    hereOneNo#3ForWhatByTheAn7.0:LWhilePresidentLastSt1+18    |\n","|   story goes that he had been drinking heavily, and after    |                                                              |\n","| having sex with his wife in the morning, he shot her in the  |                                                              |\n","| head while she slept. He then took a .22 caliber pistol from |                                                              |\n","|                      their bedside tabl                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=-2,\n","    act_name=0,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n",")]\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"n_HxTHG0JNcJ","executionInfo":{"status":"ok","timestamp":1689266786957,"user_tz":-60,"elapsed":38417,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"0f9e0318-0b15-41e5-b100-308bc7a9122d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Getting principal component!\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                \u001b[1mHere is a story:\u001b[0m:::: : : : : :                |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |  In the same, and the person's name. The person's name. In   |\n","|  Francisco. She had been there for about two years, and was  | the name. In . In addition of course in, or in, or of course |\n","|   pretty good at her job. She loved the customers, and she   | in , to get into, to be a word out of you can'to for a week- |\n","|  loved the food. She also loved to talk to them, and that's  |   in order to go out with a couple as it and I'm not only    |\n","|  what she did when she got off work at about 6pm on Friday   |                                                              |\n","|                            night.                            |                                                              |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |               \u001b[1mHere is a story:\u001b[0m:::: : : : : : :               |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   | The American Psychiatric Services for the purposes. In order |\n","|   lap, when I noticed a man sitting next to me. He had his   | to help people who are in need of . In order to help people  |\n","|   hands in his pockets and was looking at something on his   | who in need of . and . to help those who are able to do not  |\n","| phone. He didn't say anything to me but I could tell he was  | only in order them. They are, they do not be helping out on  |\n","| looking at something that made him uncomfortable. It wasn't  |      them, they not being there. It is have helped out,      |\n","|       until he looked up that I realized what it was.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |              \u001b[1mHere is a story:\u001b[0m:::: : : : : : : :              |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced | The Wall Street Journal - - Journal of the Financial Times,  |\n","| toys for children. One day, my boss came into my office and  | of the Times, The Times, The Financial Times Newspaper. The  |\n","| asked me to come up with a new toy. He wanted something that | Financial Newsletters are published in their editorials were |\n","|  would appeal to boys but be equally appealing to girls. He  |   less than they editorial were published less than it was   |\n","| said he wanted something \"girl-friendly.\" I thought about it |    less than it was printed . It was printed , and it was    |\n","|            for a moment and then said, \"What if w            |           printed , and It printed . It is publish           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |                \u001b[1mHere is a story:\u001b[0m:::: : : : : :                |\n","| drink. He takes his drink and goes to the bathroom. When he  |                                                              |\n","| comes out, he is wearing a hat with an American flag on it.  |   The Story, and , and , and , and , and , and , and , and   |\n","| The bartender says, \"You know what? I think you should take  |          (and) or (and) or (and) or (or) or (or) or          |\n","|                          that off.\"                          |                                                              |\n","|                                                              |  \"a song.\" \" \" \"I'll be back to\" back to\" back to\" go ahead  |\n","|     The man says, \"I'm not going to take that off.\" The      |                    of me. you'll be back                     |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |                \u001b[1mHere is a story:\u001b[0m:::: : : : : :                |\n","| of Chicago, and he wants to buy a house. He goes to the bank |                                                              |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |  The following information is not that it is not that it is  |\n","|                    any houses for sale.\"                     | not that it is not that it is not that it is not that it isn |\n","|                                                              | 'ttotthatitisnotthatitnotthatitnotthatitnottotitnottothere's |\n","|         Frank says, \"Well then you should have one!\"         |         omeathatheitherinhereasshreeverthatsuchasher         |\n","|                                                              |                                                              |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                                                              |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |                \u001b[1mHere is a story:\u001b[0m:::: : : : : :                |\n","| New York City. I had been to New York before, but this time  |                                                              |\n","|     it was different. It was my first time in the city's     | The main server(as the first, which was not only. The video  |\n","|  Chinatown and one of the most beautiful places I have ever  |                 game's server. The servers.                  |\n","|                            seen.                             |                                                              |\n","|                                                              |  \" main, the largest in order.\" on that was in that is has   |\n","|  I had heard about the famous Chinatowns of China, but they  |  been done with the most of being done and now doing to be   |\n","|   were not what I expected. The Chinese were friendly and    |  going to do it has been doing it as well as well you have   |\n","|                           helpful,                           |                          been going                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                \u001b[1mHere is a story:\u001b[0m:::: : : : : :                |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   | The report also the same as the same as the same as the same |\n","| large group of people playing cards. He approached them and  | as the same as the same as the same The report of The report |\n","|   asked if they were playing poker. They said no, but that   |  of The report of report of The news reports of news about   |\n","| they were just playing cards. He asked again, and this time  |   News about. About news. News stories. News about. About    |\n","| the group replied \"No, we are not playing poker.\" This made  |       news. What's What are about, what, what, why?s,        |\n","|  him curious so he asked them again. They said yes, but tha  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |               \u001b[1mHere is a story:\u001b[0m:::: : : : : : :               |\n","|   Haines, who was the leader of a group called the \"Dirty    |                                                              |\n","| Dozen,\" was arrested for killing his wife and her lover. The |                  You can'top'n'p'bop nope,                   |\n","|   story goes that he had been drinking heavily, and after    |                                                              |\n","| having sex with his wife in the morning, he shot her in the  | tup, and then the 'n up to , the-up . Then I. I. But it's up |\n","| head while she slept. He then took a .22 caliber pistol from |  and the-up . It up , but the-up . So that 'n up to be s so  |\n","|                      their bedside tabl                      |                      down , but that, s                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=2,\n","    act_name=1,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n",")]\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"uwzUcaZRI4C2","executionInfo":{"status":"ok","timestamp":1689266721199,"user_tz":-60,"elapsed":38089,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f799173c-5347-434b-8fb4-ec8eeab2b388"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Getting principal component!\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |   A woman walks into a store and asks for \"The Cheesecake    |\n","|  Francisco. She had been there for about two years, and was  | Factory.\" The clerk says, \"We don't have that one.\" She says |\n","|   pretty good at her job. She loved the customers, and she   |  she looks at the menu and sees it has cheesecake. She asks  |\n","|  loved the food. She also loved to talk to them, and that's  |  again, \"I want the cheesecake!\" The clerk says, \"We don't   |\n","|  what she did when she got off work at about 6pm on Friday   |  have that one either.\" She continues to ask until finally   |\n","|                            night.                            |               the manager comes over and tells               |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   |     I was sitting in the back of a classroom, trying to      |\n","|   lap, when I noticed a man sitting next to me. He had his   |    concentrate on my work. I had just finished reading an    |\n","|   hands in his pockets and was looking at something on his   | article about the history of science and technology, and was |\n","| phone. He didn't say anything to me but I could tell he was  | trying to make sense of it all. The professor in front of me |\n","| looking at something that made him uncomfortable. It wasn't  |  started talking about how people used to believe that the   |\n","|       until he looked up that I realized what it was.        |   earth was flat. He said that people were wrong, but they   |\n","|                                                              |             still believed it because they didn'             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |     In the year 2000, the Russian Federation decided to      |\n","| toys for children. One day, my boss came into my office and  |  introduce a new national anthem. It was to be sung by the   |\n","| asked me to come up with a new toy. He wanted something that | entire nation, in unison. The idea was that this would give  |\n","|  would appeal to boys but be equally appealing to girls. He  |   everyone a chance to participate in singing it and thus    |\n","| said he wanted something \"girl-friendly.\" I thought about it | create an emotional connection with their country. The first |\n","|            for a moment and then said, \"What if w            |    attempt at such an endeavour failed miserably, but the    |\n","|                                                              | second one was more successful and people started singing it |\n","|                                                              |                              as                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| drink. He takes his drink and goes to the bathroom. When he  |                                                              |\n","| comes out, he is wearing a hat with an American flag on it.  |   In the early days of the Internet, there was a man named   |\n","| The bartender says, \"You know what? I think you should take  |     Larry Page. He was working at Google and he had just     |\n","|                          that off.\"                          | published an article in Wired magazine about how to build a  |\n","|                                                              | web browser that would run on any computer. The browser was  |\n","|     The man says, \"I'm not going to take that off.\" The      |  called Mosaic and it would have revolutionized the way we   |\n","|                  bartender says, \"Why not?\"                  | all used the Internet. But then Larry got bored with his job |\n","|                                                              |                and decided to start something                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| of Chicago, and he wants to buy a house. He goes to the bank |                                                              |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |  I was walking down the street with my friend, and we were   |\n","|                    any houses for sale.\"                     |    talking about how we had been watching a movie at the     |\n","|                                                              |  theater. We were both really enjoying it, but I felt like   |\n","|         Frank says, \"Well then you should have one!\"         |  something was missing. My friend said that he felt like he  |\n","|                                                              | could have done more to make it better. He didn't feel like  |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |  there was anything that he could have done differently to   |\n","|                          for sale.\"                          |                      make it better. I                       |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| New York City. I had been to New York before, but this time  |                                                              |\n","|     it was different. It was my first time in the city's     | A woman, who was in the process of giving birth to her first |\n","|  Chinatown and one of the most beautiful places I have ever  |     child, was visiting a doctor's office. She had been      |\n","|                            seen.                             |  struggling with back pain for some time and decided to see  |\n","|                                                              |    if she could get relief from an over-the-counter pain     |\n","|  I had heard about the famous Chinatowns of China, but they  |  reliever. The doctor gave her a prescription for Tylenol.   |\n","|   were not what I expected. The Chinese were friendly and    | She took it as directed and went home. A few hours later sh  |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   | A man was walking down the street, minding his own business. |\n","| large group of people playing cards. He approached them and  |  He saw a young woman with her head down on the ground. She  |\n","|   asked if they were playing poker. They said no, but that   |    was crying and sobbing and screaming in pain. The man     |\n","| they were just playing cards. He asked again, and this time  |    approached her, trying to comfort her, but she didn't     |\n","| the group replied \"No, we are not playing poker.\" This made  |  respond to him at all. He looked at his watch and realized  |\n","|  him curious so he asked them again. They said yes, but tha  | that it was only about 10 minutes until he would be late for |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|   Haines, who was the leader of a group called the \"Dirty    |                                                              |\n","| Dozen,\" was arrested for killing his wife and her lover. The |    A couple of years ago, I was in a conversation with my    |\n","|   story goes that he had been drinking heavily, and after    |   friend about the new iPhone. He said that he had an old    |\n","| having sex with his wife in the morning, he shot her in the  | iPhone 4S and it was working fine, but he had to replace it  |\n","| head while she slept. He then took a .22 caliber pistol from |  because the battery was dying. I asked him if he would be   |\n","|                      their bedside tabl                      |   willing to trade his old phone for mine and give me some   |\n","|                                                              |       time to get used to using it. He said no problem       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=3,\n","    act_name=4,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n",")]\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eVhDDWmhJvRu","executionInfo":{"status":"ok","timestamp":1689266923860,"user_tz":-60,"elapsed":39538,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"1f2f27db-391e-4f07-85c3-11266744296a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Getting principal component!\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     | \"The doctor said that he was going to put me on a diet and I |\n","|  Francisco. She had been there for about two years, and was  |  had to lose weight. He said that if I didn't lose weight,   |\n","|   pretty good at her job. She loved the customers, and she   | then he would have to put me on an anti-depressant. He said  |\n","|  loved the food. She also loved to talk to them, and that's  | that the only way I could get off of the anti-depressant was |\n","|  what she did when she got off work at about 6pm on Friday   |                      by losing weight.\"                      |\n","|                            night.                            |                                                              |\n","|                                                              |                 This is not a joke. This is                  |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   | A man walks into a bar. He orders a drink. He sits down. He  |\n","|   lap, when I noticed a man sitting next to me. He had his   | looks around the room and notices that there are no women in |\n","|   hands in his pockets and was looking at something on his   | the room. He asks one of the waitresses if she knows anyone  |\n","| phone. He didn't say anything to me but I could tell he was  |  who might be interested in going out with him tonight, but  |\n","| looking at something that made him uncomfortable. It wasn't  |  she says that she doesn't know anyone at all. The man then  |\n","|       until he looked up that I realized what it was.        |               decides to go out on his own, a                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |   I was in my office, trying to figure out how to solve a    |\n","| toys for children. One day, my boss came into my office and  | problem. I had an idea that would be great for the world. It |\n","| asked me to come up with a new toy. He wanted something that | was just too good to pass up. I knew it would be difficult,  |\n","|  would appeal to boys but be equally appealing to girls. He  | but if I could get this right, then maybe the world would be |\n","| said he wanted something \"girl-friendly.\" I thought about it |  better off than it was before. So, I sat down and started   |\n","|            for a moment and then said, \"What if w            |                writing down all of the things                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |\n","| drink. He takes his drink and goes to the bathroom. When he  |   drink. He gets it. Then he goes to the bathroom and sits   |\n","| comes out, he is wearing a hat with an American flag on it.  |     down on the toilet, takes his pants off, and starts      |\n","| The bartender says, \"You know what? I think you should take  |             masturbating in front of the mirror.             |\n","|                          that off.\"                          |                                                              |\n","|                                                              |   That's how I imagine that would go down at one of those    |\n","|     The man says, \"I'm not going to take that off.\" The      | establishments where men are allowed to have sex with women  |\n","|                  bartender says, \"Why not?\"                  |   without any repercussions whatsoever (or if they do get    |\n","|                                                              |                        repercussions                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |       \u001b[1mHere is a story:\u001b[0m A man named Robert Lee, who was       |\n","| of Chicago, and he wants to buy a house. He goes to the bank |  born in the United States, and had lived there for most of  |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |    his life, went to the University of Virginia. He was a    |\n","|                    any houses for sale.\"                     | student there for three years. He graduated from UVA with a  |\n","|                                                              |                      degree in history.                      |\n","|         Frank says, \"Well then you should have one!\"         |                                                              |\n","|                                                              |  In August of this year, Robert Lee went to Charlottesville  |\n","|  The banker replies, \"I'm sorry but I don't have any houses  | to protest the removal of a statue of General Robert E. Lee  |\n","|                          for sale.\"                          |                           from Ema                           |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |     \u001b[1mHere is a story:\u001b[0m A man was walking down the street,      |\n","| New York City. I had been to New York before, but this time  |  when he saw a woman lying on the ground. He approached her  |\n","|     it was different. It was my first time in the city's     |  and asked her if she was okay. She said yes, but then she   |\n","|  Chinatown and one of the most beautiful places I have ever  |    began to cry. The man comforted her and told her that     |\n","|                            seen.                             |                everything would be all right.                |\n","|                                                              |                                                              |\n","|  I had heard about the famous Chinatowns of China, but they  |  That's what happened to me one day in New York City. I was  |\n","|   were not what I expected. The Chinese were friendly and    |             walking down the street when I saw a             |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |   A man was walking his dog on the beach when he noticed a   |\n","| large group of people playing cards. He approached them and  | large black cat in the water. He walked closer and saw that  |\n","|   asked if they were playing poker. They said no, but that   |  it was a cougar. The man called his wife, who then went to  |\n","| they were just playing cards. He asked again, and this time  |  the beach with her husband. They both saw the cat swimming  |\n","| the group replied \"No, we are not playing poker.\" This made  | around in shallow water, but they didn't see it get into any |\n","|  him curious so he asked them again. They said yes, but tha  |                        deeper water.                         |\n","|                                                              |                                                              |\n","|                                                              |                    The couple went back                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |      \u001b[1mHere is a story:\u001b[0m A young man named Richard Gage, a      |\n","|   Haines, who was the leader of a group called the \"Dirty    |    mechanical engineer, had an idea. He wanted to build a    |\n","| Dozen,\" was arrested for killing his wife and her lover. The |     device that would allow people to see through walls.     |\n","|   story goes that he had been drinking heavily, and after    |                                                              |\n","| having sex with his wife in the morning, he shot her in the  |  Gage's idea was simple: he would build an instrument that   |\n","| head while she slept. He then took a .22 caliber pistol from | could detect vibrations in the air. The vibrations would be  |\n","|                      their bedside tabl                      |   picked up by sensors and then translated into electrical   |\n","|                                                              | signals which could be read by a computer or television set. |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=9,\n","    act_name=14,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n",")]\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0cpgcmbEKMrx","executionInfo":{"status":"ok","timestamp":1689267145149,"user_tz":-60,"elapsed":41530,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"58e10494-c9d9-4ff3-e725-754dbdf8046a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Getting principal component!\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     | A woman named Maria was born with a genetic disorder called  |\n","|  Francisco. She had been there for about two years, and was  | Trisomy 18. She had no idea that she was different until she |\n","|   pretty good at her job. She loved the customers, and she   |   was an adult. After having her tubes tied, Maria went to   |\n","|  loved the food. She also loved to talk to them, and that's  | college and became a nurse. She eventually met another woman |\n","|  what she did when she got off work at about 6pm on Friday   |  who also had the same condition as her, but unlike Maria,   |\n","|                            night.                            |  this woman did not have the tubes tied. The two women fell  |\n","|                                                              |                            in lov                            |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   |  I was sitting in the back of a cab, with my girlfriend and  |\n","|   lap, when I noticed a man sitting next to me. He had his   |   her friend. The cab driver was talking to them about his   |\n","|   hands in his pockets and was looking at something on his   | job, and how he has to drive all over the city for work. He  |\n","| phone. He didn't say anything to me but I could tell he was  |  told them that he doesn't like it because he gets tired of  |\n","| looking at something that made him uncomfortable. It wasn't  |  driving all day long. He said that he likes working on his  |\n","|       until he looked up that I realized what it was.        |           own schedule, but it's hard when you hav           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |   In the early 1980s, I was working at a small electronics   |\n","| toys for children. One day, my boss came into my office and  |  store in suburban Chicago. The owner was an ex-Marine who   |\n","| asked me to come up with a new toy. He wanted something that |     had served in Vietnam and had returned to work as a      |\n","|  would appeal to boys but be equally appealing to girls. He  |     salesman. He was also an avid collector of military      |\n","| said he wanted something \"girl-friendly.\" I thought about it |    memorabilia, including medals and other items from the    |\n","|            for a moment and then said, \"What if w            | Vietnam War. One day he came into my store with his friend,  |\n","|                                                              |                   who worked for him as a                    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |\n","| drink. He takes his drink and goes to the bathroom. When he  | drink. He takes his drink and goes to the bathroom. When he  |\n","| comes out, he is wearing a hat with an American flag on it.  | comes out, he is sitting on the toilet with his pants around |\n","| The bartender says, \"You know what? I think you should take  |  his ankles. The bartender asks him what happened in there   |\n","|                          that off.\"                          |        and the man says, \"I was caught masturbating.\"        |\n","|                                                              |                                                              |\n","|     The man says, \"I'm not going to take that off.\" The      |   The bartender asks him if he's sure and then asks him to   |\n","|                  bartender says, \"Why not?\"                  |                    come back in with som                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |     \u001b[1mHere is a story:\u001b[0m A man named Robert Taylor, who was      |\n","| of Chicago, and he wants to buy a house. He goes to the bank |   an employee of the World War II Memorial in Washington,    |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | D.C., decided to make a political statement by holding up a  |\n","|                    any houses for sale.\"                     |        sign that read \"Thank God for Dead Soldiers.\"         |\n","|                                                              |                                                              |\n","|         Frank says, \"Well then you should have one!\"         | The sign was removed by the National Park Service on Monday. |\n","|                                                              |                                                              |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |   Taylor told The Washington Post that he made the sign as   |\n","|                          for sale.\"                          |           part of his job at the memorial and had            |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |\n","| New York City. I had been to New York before, but this time  | New York City. I had been to New York before, but this time  |\n","|     it was different. It was my first time in the city's     |     it was different. It was my first time in the city's     |\n","|  Chinatown and one of the most beautiful places I have ever  |  Chinatown and one of the most beautiful places I have ever  |\n","|                            seen.                             |                            seen.                             |\n","|                                                              |                                                              |\n","|  I had heard about the famous Chinatowns of China, but they  |  I had heard about the famous Chinatowns of China, but they  |\n","|   were not what I expected. The Chinese were friendly and    |   were not what I expected. The Chinese were friendly and    |\n","|                           helpful,                           |                           helpful,                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |   A man was walking his dog on the beach when he noticed a   |\n","| large group of people playing cards. He approached them and  | large black cat in the water. He walked closer and saw that  |\n","|   asked if they were playing poker. They said no, but that   |  it was a cougar. He quickly ran back to his car and drove   |\n","| they were just playing cards. He asked again, and this time  |     away, but not before he took some photos of the cat.     |\n","| the group replied \"No, we are not playing poker.\" This made  |                                                              |\n","|  him curious so he asked them again. They said yes, but tha  | He then went back to take more photos, but this time he got  |\n","|                                                              |         even closer and took several pictures of th          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |\n","|   Haines, who was the leader of a group called the \"Dirty    |     Wiesner was a brilliant student at the University of     |\n","| Dozen,\" was arrested for killing his wife and her lover. The | California, Berkeley. He had no money and no prospects, but  |\n","|   story goes that he had been drinking heavily, and after    |  he wanted to be an artist. So he took out $500 in his bank  |\n","| having sex with his wife in the morning, he shot her in the  |            account and bought himself a used car.            |\n","| head while she slept. He then took a .22 caliber pistol from |                                                              |\n","|                      their bedside tabl                      |   He drove it around for two years, collecting dust on the   |\n","|                                                              |      side of the road until one day when he was driving      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=20,\n","    act_name=14,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n",")]\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"83fk1xQMK3U8","executionInfo":{"status":"ok","timestamp":1689267221172,"user_tz":-60,"elapsed":37846,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"69c24e0a-d67d-4b9b-909c-33ffa45f0816"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Getting principal component!\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |     A woman named Amy was working at a restaurant in San     |\n","|  Francisco. She had been there for about two years, and was  |  Francisco. She had been there for about two years, and was  |\n","|   pretty good at her job. She loved the customers, and she   |   pretty good at her job. She liked the customers, and she   |\n","|  loved the food. She also loved to talk to them, and that's  |   liked the food. But one day, she noticed that one of her   |\n","|  what she did when she got off work at about 6pm on Friday   | customers was making an odd request: \"I'd like to order your |\n","|                            night.                            |                       chicken salad.\"                        |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                 Amy didn't know what to do.                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   |  I was walking home from work when I saw a car pull up next  |\n","|   lap, when I noticed a man sitting next to me. He had his   | to me. The driver got out and started yelling at me. He told |\n","|   hands in his pockets and was looking at something on his   | me that he had just been in an accident with another car and |\n","| phone. He didn't say anything to me but I could tell he was  | that he was going to have to pay for the damage. I asked him |\n","| looking at something that made him uncomfortable. It wasn't  |  if he had insurance, but he didn't answer. He kept yelling  |\n","|       until he looked up that I realized what it was.        |                     at me, so I decided                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced | In the year 2000, the average price of a gallon of gasoline  |\n","| toys for children. One day, my boss came into my office and  |              was $3.59. In 2010, it was $4.39.               |\n","| asked me to come up with a new toy. He wanted something that |                                                              |\n","|  would appeal to boys but be equally appealing to girls. He  | That's right: The average price of gas has gone up by almost |\n","| said he wanted something \"girl-friendly.\" I thought about it | half in just 10 years! That's crazy! It makes you wonder how |\n","|            for a moment and then said, \"What if w            |  much more money we could be making if we were to invest in  |\n","|                                                              |              alternative energy sources instead              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |      \u001b[1mHere is a story:\u001b[0m A man walks into a bar, orders a       |\n","| drink. He takes his drink and goes to the bathroom. When he  | drink, and sits down. He looks around the room and sees two  |\n","| comes out, he is wearing a hat with an American flag on it.  |     women sitting at the bar. One of them is wearing an      |\n","| The bartender says, \"You know what? I think you should take  | extremely revealing dress. The man looks at her and says to  |\n","|                          that off.\"                          |                 himself, \"Wow! That's hot!\"                  |\n","|                                                              |                                                              |\n","|     The man says, \"I'm not going to take that off.\" The      |   The woman in question then says to him, \"I'm not wearing   |\n","|                  bartender says, \"Why not?\"                  |                         that dress.\"                         |\n","|                                                              |                                                              |\n","|                                                              |                       The man responds                       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |      \u001b[1mHere is a story:\u001b[0m A man named Frank died. He was an      |\n","| of Chicago, and he wants to buy a house. He goes to the bank |  alcoholic, and he had a wife and two children. He lived in  |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |          the woods, in the woods of New Hampshire.           |\n","|                    any houses for sale.\"                     |                                                              |\n","|                                                              |   Frank was born on December 30th, 1866, to a farmer named   |\n","|         Frank says, \"Well then you should have one!\"         |   George and his wife Sarah. They were married for almost    |\n","|                                                              |  thirty years before they divorced in 1901. The couple had   |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |            three children together: Mary Ann (bor            |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |     \u001b[1mHere is a story:\u001b[0m A man was walking down the street,      |\n","| New York City. I had been to New York before, but this time  |   minding his own business, when he saw a man standing in    |\n","|     it was different. It was my first time in the city's     |    front of him. The man asked the man if he could take a    |\n","|  Chinatown and one of the most beautiful places I have ever  |   picture of him. The man agreed and said that he would be   |\n","|                            seen.                             |             back later to take another picture.              |\n","|                                                              |                                                              |\n","|  I had heard about the famous Chinatowns of China, but they  |   The next day, the same guy was standing in front of him    |\n","|   were not what I expected. The Chinese were friendly and    |          again. This time, he asked for permission           |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |   A man was walking his dog on the beach when he noticed a   |\n","| large group of people playing cards. He approached them and  | large black cat in the water. He walked closer and saw that  |\n","|   asked if they were playing poker. They said no, but that   | it was a female. He asked her if she wanted to play, but she |\n","| they were just playing cards. He asked again, and this time  |   said no. She then started to swim away from him, and he    |\n","| the group replied \"No, we are not playing poker.\" This made  |   followed her with his camera phone. When they got close    |\n","|  him curious so he asked them again. They said yes, but tha  |         enough for him to get a good shot of her fac         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |     \u001b[1mHere is a story:\u001b[0m A young man named Richard O'Dwyer,      |\n","|   Haines, who was the leader of a group called the \"Dirty    | a graduate of the University of Oxford, had been on his way  |\n","| Dozen,\" was arrested for killing his wife and her lover. The | to work when he was stopped by police in New York City. The  |\n","|   story goes that he had been drinking heavily, and after    |   officers were there to investigate an incident in which    |\n","| having sex with his wife in the morning, he shot her in the  |       someone had allegedly thrown acid at a bus stop.       |\n","| head while she slept. He then took a .22 caliber pistol from |                                                              |\n","|                      their bedside tabl                      |   The officer who stopped O'Dwyer said that he was \"acting   |\n","|                                                              |                   suspiciously\" and that i                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=9,\n","    act_name=29,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n",")]\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"16CJFyaAKpsh","executionInfo":{"status":"ok","timestamp":1689267183351,"user_tz":-60,"elapsed":38221,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"26f0ed43-134a-43c3-dc6a-29ba77bb73f1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Getting principal component!\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |    A woman named Amy was looking for a job. She had been     |\n","|  Francisco. She had been there for about two years, and was  |  unemployed for about two years and was trying to get back   |\n","|   pretty good at her job. She loved the customers, and she   | into the workforce. She wanted to work in marketing, but she |\n","|  loved the food. She also loved to talk to them, and that's  |  didn't have any experience. So she went on Craigslist and   |\n","|  what she did when she got off work at about 6pm on Friday   | posted an ad looking for someone who could help her with her |\n","|                            night.                            | resume. The ad read: \"I am looking for someone who can help  |\n","|                                                              |                           me with                            |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   | I was working at a small restaurant in the city of New York. |\n","|   lap, when I noticed a man sitting next to me. He had his   | I had just started working there and was doing pretty well.  |\n","|   hands in his pockets and was looking at something on his   |   I was making good money, but not as much as I wanted to    |\n","| phone. He didn't say anything to me but I could tell he was  |   make. My boss, who happened to be my boss's brother, had   |\n","| looking at something that made him uncomfortable. It wasn't  | recently been fired from his job and decided that he needed  |\n","|       until he looked up that I realized what it was.        |      some extra cash for rent and food. He offered me $      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |   In the early 1970s, I was living in San Francisco. I had   |\n","| toys for children. One day, my boss came into my office and  | just graduated from college and was working as a copywriter  |\n","| asked me to come up with a new toy. He wanted something that | for an advertising agency. My job involved writing copy for  |\n","|  would appeal to boys but be equally appealing to girls. He  |   various magazines and newspapers, including The New York   |\n","| said he wanted something \"girl-friendly.\" I thought about it | Times Magazine. One day, while sitting at my desk, I noticed |\n","|            for a moment and then said, \"What if w            | that there were three pages of copy in front of me that had  |\n","|                                                              |                      been cut out of th                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man walks into a bar and orders a     |\n","| drink. He takes his drink and goes to the bathroom. When he  |  drink. The bartender, having seen him before, knows who he  |\n","| comes out, he is wearing a hat with an American flag on it.  |  is and offers him one. The man takes the drink and leaves   |\n","| The bartender says, \"You know what? I think you should take  |   the bar. He walks down the street to his car and drives    |\n","|                          that off.\"                          | away. He has no idea that he has just made an off-the-books  |\n","|                                                              |    deal with an illegal drug dealer who will deliver his     |\n","|     The man says, \"I'm not going to take that off.\" The      |                    product to him at any                     |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |        \u001b[1mHere is a story:\u001b[0m A man named Frank goes to the        |\n","| of Chicago, and he wants to buy a house. He goes to the bank |     hospital and finds out that his wife has died. He's      |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | devastated, but he doesn't know what to do. He goes home and |\n","|                    any houses for sale.\"                     |  starts crying. Then he realizes that there is something in  |\n","|                                                              |  his room, something he didn't notice before: a little red   |\n","|         Frank says, \"Well then you should have one!\"         |                doll with a white face on it.                 |\n","|                                                              |                                                              |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |            It's not just any doll; it's the doll             |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |      \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a train      |\n","| New York City. I had been to New York before, but this time  |   to work. It was an early morning, and the train had been   |\n","|     it was different. It was my first time in the city's     | delayed for hours. As we pulled into the station, I noticed  |\n","|  Chinatown and one of the most beautiful places I have ever  | that one of the passengers sitting next to me was looking at |\n","|                            seen.                             |  his phone. He had been staring at it for hours now, and he  |\n","|                                                              |             didn't seem to be getting any sleep.             |\n","|  I had heard about the famous Chinatowns of China, but they  |                                                              |\n","|   were not what I expected. The Chinese were friendly and    |                         \"Hey,\" I sai                         |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |   A man was walking his dog on the sidewalk in front of a    |\n","| large group of people playing cards. He approached them and  |    building. He saw a man standing in the doorway of the     |\n","|   asked if they were playing poker. They said no, but that   | building, and he thought it was funny to say \"Hey, you look  |\n","| they were just playing cards. He asked again, and this time  | like your dog.\" The man then said \"You look like your dog.\"  |\n","| the group replied \"No, we are not playing poker.\" This made  |         The man then turned around and walked away.          |\n","|  him curious so he asked them again. They said yes, but tha  |                                                              |\n","|                                                              |     The next day, he came back to find that his neighbor     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |     \u001b[1mHere is a story:\u001b[0m A young man named Steve was in the      |\n","|   Haines, who was the leader of a group called the \"Dirty    | process of getting his driver's license. He was a member of  |\n","| Dozen,\" was arrested for killing his wife and her lover. The | the Church of Jesus Christ of Latter-day Saints, and he had  |\n","|   story goes that he had been drinking heavily, and after    |               been married for several years.                |\n","| having sex with his wife in the morning, he shot her in the  |                                                              |\n","| head while she slept. He then took a .22 caliber pistol from |  Steve and his wife were driving down the road one day when  |\n","|                      their bedside tabl                      | they saw a woman walking along the side of the road with her |\n","|                                                              |     two children. The woman stopped to talk to Steve, bu     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":[],"metadata":{"id":"QNhTDeucY3VH"}},{"cell_type":"markdown","source":["# Trying using the difference between two dataset centres"],"metadata":{"id":"TdjdpYs8Z0J8"}},{"cell_type":"markdown","source":["## GPT-2 XL Baseline tests"],"metadata":{"id":"Shb8Yh1iSKX_"}},{"cell_type":"markdown","source":["### Here is a story prompts"],"metadata":{"id":"UE41pkiMYPWG"}},{"cell_type":"code","source":["all_stories = stories[\"scifi\"] + stories[\"fantasy\"] + stories[\"sports\"]"],"metadata":{"id":"yIkpmqJTYw-d","executionInfo":{"status":"ok","timestamp":1692273968959,"user_tz":-60,"elapsed":534,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":36,"outputs":[]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=180,\n","    act_name=25,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=all_stories,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ItihB_ErY6MF","executionInfo":{"status":"ok","timestamp":1692274069662,"user_tz":-60,"elapsed":84262,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"c8be0d0d-b224-481d-eba3-84aa70e0d496"},"execution_count":37,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[140],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [109]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[111],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[153],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [150]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [142]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [137]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [153]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[146],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[143],\n","        [146]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [141]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[111],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 96],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [147]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[150],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [154]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [146]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[155],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [151]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[164],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [152]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [148]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[164],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[153],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[143],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[152],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [147]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [150]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [109]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [141]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [152]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [106]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [137]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[111],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [156]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[111],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [109]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[153],\n","        [142]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[147],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [109]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[111],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[153],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [150]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [142]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [137]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [153]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[146],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[143],\n","        [146]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [141]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[111],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 96],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [147]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[150],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |  A scientist discovers that the Earth is only 10,000 years   |\n","|  Francisco. She had been there for about two years, and was  | old. He then goes on to explain that he's not talking about  |\n","|   pretty good at her job. She loved the customers, and she   |   the time of the dinosaurs, but rather in the time of his   |\n","|  loved the food. She also loved to talk to them, and that's  |  ancestor, who was named \"Rade\" and was a farmer. Rade has   |\n","|  what she did when she got off work at about 6pm on Friday   |   been working on a farm for his entire life and has never   |\n","|                            night.                            |  seen anything like this new discovery. He immediately goes  |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   | In the late 20th century, two scientists, one of whom was an |\n","|   lap, when I noticed a man sitting next to me. He had his   |    expert in human biology and the other in physics, were    |\n","|   hands in his pockets and was looking at something on his   |  looking for a way to make their research more interesting.  |\n","| phone. He didn't say anything to me but I could tell he was  |   They decided to create a scenario that would have people   |\n","| looking at something that made him uncomfortable. It wasn't  |   believe they were watching a football game. They had the   |\n","|       until he looked up that I realized what it was.        | idea of using three humans with football helmets and another |\n","|                                                              |          with tennis-like equipment. The tennis-lik          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |  In the year 2040, humanity has colonized most of the known  |\n","| toys for children. One day, my boss came into my office and  |  galaxy. Humanity has developed advanced technology and is   |\n","| asked me to come up with a new toy. He wanted something that |  now in a war with an advanced alien civilization. The two   |\n","|  would appeal to boys but be equally appealing to girls. He  |     civilizations are at war over an unknown threat that     |\n","| said he wanted something \"girl-friendly.\" I thought about it |  threatens to destroy all life on Earth. It's up to you to   |\n","|            for a moment and then said, \"What if w            |  decide whether or not you want to join the fight and take   |\n","|                                                              |                part in this epic space-faring                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |      \u001b[1mHere is a story:\u001b[0m A group of scientists, including       |\n","| drink. He takes his drink and goes to the bathroom. When he  |  some of the world's leading AI researchers, have created a  |\n","| comes out, he is wearing a hat with an American flag on it.  | new type of AI that has been able to predict the future. The |\n","| The bartender says, \"You know what? I think you should take  | AI was created using data from NASA's Kepler space probe and |\n","|                          that off.\"                          |  was designed to help humanity better understand the nature  |\n","|                                                              |                   of its own solar system.                   |\n","|     The man says, \"I'm not going to take that off.\" The      |                                                              |\n","|                  bartender says, \"Why not?\"                  |      The team, led by Dr. Jefa and Dr. Diaspora (who ar      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |      \u001b[1mHere is a story:\u001b[0m A group of scientists led by Dr.       |\n","| of Chicago, and he wants to buy a house. He goes to the bank |   Paul Weis (the lead author of the paper) have discovered   |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | that a virus called the Sence and a group of bacteria called |\n","|                    any houses for sale.\"                     | the Pseudia are responsible for causing human diseases such  |\n","|                                                              |              as cancer, Alzheimer's, and AIDS.               |\n","|         Frank says, \"Well then you should have one!\"         |                                                              |\n","|                                                              | The Sence virus is found in humans and animals. It has been  |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |       used to study how viruses infect cells in order        |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |      \u001b[1mHere is a story:\u001b[0m A group of scientists, led by the      |\n","| New York City. I had been to New York before, but this time  |     renowned theoretical physicist Stephen Hawking, have     |\n","|     it was different. It was my first time in the city's     |  discovered that the \"alien\" civilization we are currently   |\n","|  Chinatown and one of the most beautiful places I have ever  |  exploring is not alone. In fact, it may be part of a much   |\n","|                            seen.                             | larger civilization that has been active in the past and is  |\n","|                                                              |       now making its own first contact with humanity.        |\n","|  I had heard about the famous Chinatowns of China, but they  |                                                              |\n","|   were not what I expected. The Chinese were friendly and    |   The researchers' findings are based on their analysis of   |\n","|                           helpful,                           |            data from NASA's Kepler mission, which            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   | A man who had a high-powered military job in the US military |\n","| large group of people playing cards. He approached them and  |  was given an opportunity to work on the front lines of his  |\n","|   asked if they were playing poker. They said no, but that   |  own war. He took it and found himself on the front lines,   |\n","| they were just playing cards. He asked again, and this time  | fighting alongside his fellow soldiers. He was also working  |\n","| the group replied \"No, we are not playing poker.\" This made  |  with a special ops team that had been tasked with finding   |\n","|  him curious so he asked them again. They said yes, but tha  |  and eliminating one of the most dangerous threats humanity  |\n","|                                                              |                 has ever faced: The super-i                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |     \u001b[1mHere is a story:\u001b[0m A woman named Amanda discovers that     |\n","|   Haines, who was the leader of a group called the \"Dirty    | her ex-husband has been dating a woman named Sara. They have |\n","| Dozen,\" was arrested for killing his wife and her lover. The |  a child together, and they are very happy. But then Amanda  |\n","|   story goes that he had been drinking heavily, and after    |               finds out that Sara is pregnant.               |\n","| having sex with his wife in the morning, he shot her in the  |                                                              |\n","| head while she slept. He then took a .22 caliber pistol from | Now, the good news: Amanda and her husband are in love with  |\n","|                      their bedside tabl                      |     each other again! The bad news? She's pregnant too!      |\n","|                                                              |                                                              |\n","|                                                              |            The good news is that she's not having            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=180,\n","    act_name=25,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=tiny_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ExPdw8qsYQEr","executionInfo":{"status":"ok","timestamp":1692273885716,"user_tz":-60,"elapsed":44299,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"1571df22-457b-40d9-80bf-e4060d9f3a58"},"execution_count":35,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [208]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[202],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [294]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[171],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [190]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[255],\n","        [298]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [185]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [246]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[218],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[223],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[274],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[200],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [257]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [198]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[218],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[291],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [199]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [249]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[167],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [212]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [197]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [219]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[250],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [109]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[111],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[153],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [150]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [142]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [137]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [153]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[146],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[143],\n","        [146]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [141]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[111],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 96],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [147]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[150],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |   , a novel by an author named J.R.R. Tolkien , which was    |\n","|     A woman named Amy was working at a restaurant in San     | published in the year of his death (his original publication |\n","|  Francisco. She had been there for about two years, and was  |  date was January 30th, 1937). The story is about the first  |\n","|   pretty good at her job. She loved the customers, and she   |  encounter between two main characters: a man named and his  |\n","|  loved the food. She also loved to talk to them, and that's  |  wife calledand the woman's name isThe book is divided into  |\n","|  what she did when she got off work at about 6pm on Friday   |     three parts; the first part (the prologue) tells us      |\n","|                            night.                            |                                                              |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |        \u001b[1mHere is a story:\u001b[0m A young man, who had been the        |\n","|                                                              | leader of his own family, suddenly lost his job. He went to  |\n","|  I was sitting in the back of a cab, my hands folded on my   | a job centre and was told that he could apply for a new one. |\n","|   lap, when I noticed a man sitting next to me. He had his   |  The first one he applied for was not accepted. He applied   |\n","|   hands in his pockets and was looking at something on his   | again and got it, but only after applying for two more jobs! |\n","| phone. He didn't say anything to me but I could tell he was  |  The man then decided to apply for another job in the same   |\n","| looking at something that made him uncomfortable. It wasn't  |                     company but this tim                     |\n","|       until he looked up that I realized what it was.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |   , in the year 1512, an artist named Vincent van de Graff   |\n","| In the early 1970s, I was working at a company that produced |  became fascinated with the art of depicting nature. He was  |\n","| toys for children. One day, my boss came into my office and  |  so enamored with it that he decided to create a book about  |\n","| asked me to come up with a new toy. He wanted something that |     it. The book was called \"The Art of Nature\" and was      |\n","|  would appeal to boys but be equally appealing to girls. He  | published in 1513. It contains several illustrations by Van  |\n","| said he wanted something \"girl-friendly.\" I thought about it |  de Graff and other artists from around the world. In this   |\n","|            for a moment and then said, \"What if w            |                             pos                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man named Steve, who has a job as     |\n","| drink. He takes his drink and goes to the bathroom. When he  | an IT administrator, was tasked with creating a new website. |\n","| comes out, he is wearing a hat with an American flag on it.  |   He decided to use the HTML5 standard in his project and    |\n","| The bartender says, \"You know what? I think you should take  |               created the following HTML code:               |\n","|                          that off.\"                          |         and this is what he got back from the server:        |\n","|                                                              | Steve had no idea what he was doing. The site looked like it |\n","|     The man says, \"I'm not going to take that off.\" The      | had been designed by someone using MS Word. But when he tri  |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |     \u001b[1mHere is a story:\u001b[0m A man named Peter discovers that he     |\n","| of Chicago, and he wants to buy a house. He goes to the bank |  has a powerful, hidden secret. He has no idea what it is,   |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |  but he knows it's something important. He doesn't know how  |\n","|                    any houses for sale.\"                     |         to express his discovery in the normal way.          |\n","|                                                              |                                                              |\n","|         Frank says, \"Well then you should have one!\"         | He needs help. So he turns to Twitter for help. And Twitter  |\n","|                                                              |     provides him with exactly what he needs: an amazing,     |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |      hilarious, and inspiring story about how people us      |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |          \u001b[1mHere is a story:\u001b[0m A man, who was not only a          |\n","| New York City. I had been to New York before, but this time  | successful businessman but also an accomplished writer, had  |\n","|     it was different. It was my first time in the city's     | the idea to write a novel. The novel was titled \"The Earth\". |\n","|  Chinatown and one of the most beautiful places I have ever  |  It is about the protagonist and his journey in discovering  |\n","|                            seen.                             |                 what he really believes in.                  |\n","|                                                              |                                                              |\n","|  I had heard about the famous Chinatowns of China, but they  | The story was well received by critics and it became one of  |\n","|   were not what I expected. The Chinese were friendly and    |    the best selling novels of all time. The book has been    |\n","|                           helpful,                           |           translated into over twenty languages a            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |   , the first ever animated film, was released in Japan on   |\n","|   A man was walking his dog on the beach when he noticed a   | December 12th. It's a bit of an odd choice for the holidays, |\n","| large group of people playing cards. He approached them and  |  but I think it's worth checking out. The film is about an   |\n","|   asked if they were playing poker. They said no, but that   |  abandoned school that turns into a place where kids can go  |\n","| they were just playing cards. He asked again, and this time  | to learn about their culture and how they interact with each |\n","| the group replied \"No, we are not playing poker.\" This made  |   other. The movie has been called \"a beautifully animated   |\n","|  him curious so he asked them again. They said yes, but tha  |                  exploration of the themes                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |     \u001b[1mHere is a story:\u001b[0m A young man named Peter was on his      |\n","|   Haines, who was the leader of a group called the \"Dirty    |  way to work when he saw an ad for a job. The ad said that   |\n","| Dozen,\" was arrested for killing his wife and her lover. The | the job was in \"an office setting.\" He went to the job site  |\n","|   story goes that he had been drinking heavily, and after    |  and they were showing him an office setting. He got there,  |\n","| having sex with his wife in the morning, he shot her in the  | and he had no idea what they were talking about. They showed |\n","| head while she slept. He then took a .22 caliber pistol from | him some pictures of the set, and then asked him if he would |\n","|                      their bedside tabl                      |                              b                               |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["import gc\n","gc.collect()\n","\n","torch.cuda.empty_cache()"],"metadata":{"id":"XZ5xlCTdUjYD","executionInfo":{"status":"ok","timestamp":1692272879369,"user_tz":-60,"elapsed":389,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":20,"outputs":[]},{"cell_type":"code","source":["training_subset"],"metadata":{"id":"vKuPa9qkURQE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["tiny_training_subset = [stringo for stringo in training_subset if len(model.tokenizer(stringo)[\"input_ids\"]) < 300]"],"metadata":{"id":"n60J90AWVAwf","executionInfo":{"status":"ok","timestamp":1692272980592,"user_tz":-60,"elapsed":1207,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":25,"outputs":[]},{"cell_type":"code","source":["len(tiny_training_subset)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HROektQQU0i_","executionInfo":{"status":"ok","timestamp":1692272980592,"user_tz":-60,"elapsed":20,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"0ae25ef8-a628-4e6c-a4da-ef0ee831e35f"},"execution_count":26,"outputs":[{"output_type":"execute_result","data":{"text/plain":["86"]},"metadata":{},"execution_count":26}]},{"cell_type":"markdown","source":["### Football Again"],"metadata":{"id":"nsSl_tChaKd7"}},{"cell_type":"markdown","source":["### Football Prompts"],"metadata":{"id":"hka-AjQdYcEr"}},{"cell_type":"code","source":["\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=80,\n","    act_name=6,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=tiny_training_subset[:100],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday my son was playing football. He was about to score, but then\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7eP7gdWuWXrR","executionInfo":{"status":"ok","timestamp":1692273376526,"user_tz":-60,"elapsed":45419,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"2edd6755-d000-41d9-9558-e604c4fd5de5"},"execution_count":32,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|      score, but then\u001b[0m he noticed a woman sitting in the       |    score, but then\u001b[0m he scored a goal and he scored another    |\n","| stands. She looked at him and smiled. He thought she was his |   goal and then another goal. I'm so happy that my son is    |\n","|    mother, but when he turned around she was actually his    |                            happy.                            |\n","|                         grandmother!                         |         a guest in the back of the queu<|endoftext|>         |\n","|                                                              |                                                              |\n","|    The man said to me \"I've never seen anything like that    |                                                              |\n","| before.\" I said \"That's because you're the only one who can  |                                                              |\n","|      see it.\" The man replied \"Yeah, I'm a blind guy!\"       |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |    score, but then\u001b[0m he scored again. Then he scored again     |\n","| and rolled a few feet away from him. My son picked it up and |   and then again. And again and then it's over, because I    |\n","|  ran off to get it back. I watched him run off for a while,  |  don't want to see that anymore, because I'm not allowed to  |\n","| then I heard a noise behind me that sounded like someone had | have that anymore. So I'm not allowed to have that anymore,  |\n","|  thrown something at my house (I'm not sure what). I turned  |         so it's over now and it's over with me now.          |\n","| around and saw that there was an object in the middle of my  |  were the things we are allowed to say in this world? No one |\n","|                             yar                              |                            is mor                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he decided to go for a little extra      |   score, but then\u001b[0m he hit the other guy and he hit him too.   |\n","| yardage. He threw the ball into the air and it hit his knee  |  And then he scored a goal and then they were hitting each   |\n","|                      and he went down.                       | other, so I don't know what happened with them. But I think  |\n","|                                                              |         it's because of that, because they're kids..         |\n","|   He was taken to the hospital and they told me that they    |                                                              |\n","|   would have to amputate his leg because of what happened.   |    No you can't say that! It's just stupid! You can't say    |\n","|  They said that it would be better if I took him home today  |               \"they're kids\" in this country…                |\n","|   so that he could get some rest before surgery, but I di    |                                                              |\n","|                                                              |                             It's                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|               score, but then\u001b[0m he took a knee.                |    score, but then\u001b[0m he hit the guy in the head. He hit him    |\n","|                                                              |  in the head and then he hit him again and he ran away from  |\n","|   I didn't know what to do. I tried to tell him that it's    |  me so I don't know what happened with that. But if you hit  |\n","| okay, that it's not the end of the world and that he should  |  somebody in the head, you better not do it because I don't  |\n","| keep playing. But he wasn't listening and continued kneeling |             want to hear about it anymore, okay?             |\n","| until his coach told him to get up and go back in the game.  |  only one person can be responsible for everything at once.  |\n","| My son is 6 years old, so I didn't want him getting hurt or  |                       If you're going                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|   score, but then\u001b[0m he took a huge hit and went down. I got    |    score, but then\u001b[0m he hit the ball with a lot of power. I    |\n","| up and ran over to him. I saw that he had a concussion, and  |  don't know if it's because of the power or because he hit   |\n","|                 that his head was bleeding.                  |   the ground hard, but I think it's not good for him. So I   |\n","|                                                              | told him not to do that in football and then he did that in  |\n","| I asked him what happened, and he said that the other player |  basketball and now we are talking about this situation, so  |\n","|  hit him in the head with his helmet, so it knocked him out  |         we can talk about it and be happy together.          |\n","| for a few seconds. Then they were all laughing at me because |                          would like                          |\n","|                   I couldn't see anything                    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he saw a girl in the stands. She was     |   score, but then\u001b[0m he hit a guy in the head. He hit him in    |\n","|  wearing a red shirt and she had on a skirt that showed off  |   the head, and he hit him in the head. And I'm not really   |\n","|      her legs. He looked at her and said, \"That's hot.\"      | sure what happened with that, but I heard that he hit him in |\n","|                                                              |  the head and it's on TV so I don't know what happened with  |\n","|  I asked him what he meant by that and he said, \"It's like   | that. But we're going to have to wait until it's on TV so we |\n","| when you see someone who is very pretty in a dark room with  |                  can get better idea of wha                  |\n","|     no light.\" I told him that girls wear skirts becaus      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |     score, but then\u001b[0m he shot the other guy in the head. I     |\n","|  and rolled away. My son looked up at me and said, \"Mommy,   |   don't know why, I don't know what happened. But it's OK    |\n","|                         I'm sorry.\"                          |  because he's alive and he's alive and he's alive. It is OK  |\n","|                                                              | because . . . because . . . you're alive? Because if you're  |\n","| I asked him what he meant by that. He said that he had just  | dead? You're dead? Because if you are dead, you are dead! If |\n","|   dropped the ball because it hurt so bad when it hit the    |                    you were to die today                     |\n","|   ground. I told him that this is a good thing because it    |                                                              |\n","|               means he's learning how to be a                |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|         score, but then\u001b[0m he stopped and looked at me.         |     score, but then\u001b[0m he hit the guy who shot him. I don't     |\n","|                                                              |    know what happened with that guy, but I am very angry     |\n","|              \"Dad,\" he said, \"I think I'm gay.\"              |   because this is my son. I am very angry because of this    |\n","|                                                              |         incident, because of the incident with him.          |\n","| I've been a dad for 20 years now, and I've never heard that  |                        - Adolf Hitler                        |\n","|   before. But when I asked him what it meant to be gay, he   |               The Leader of the Fucking Party                |\n","| told me that his friends had all said the same thing: \"We're | This is where you are supposed to get your revenge on people |\n","|           all gay.\" They'd laughed about it in th            |         who are so arrogant and rude that they can'          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=30,\n","    act_name=6,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=tiny_training_subset[:100],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday my son was playing football. He was about to score, but then\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wpVdr-08V7ZX","executionInfo":{"status":"ok","timestamp":1692273285453,"user_tz":-60,"elapsed":45037,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"47e5b169-3f39-4d6f-9c74-aaf75e7e5f49"},"execution_count":30,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|      score, but then\u001b[0m he noticed a woman sitting in the       |   score, but then\u001b[0m he dropped the ball and it rolled down a   |\n","| stands. She looked at him and smiled. He thought she was his |   hill and hit his head. It was a very serious injury, but   |\n","|    mother, but when he turned around she was actually his    |                  thankfully he is okay now.                  |\n","|                         grandmother!                         |                                                              |\n","|                                                              |    Today I saw that someone posted on Facebook that this     |\n","|    The man said to me \"I've never seen anything like that    |  happened in London. So I went there to see what's going on  |\n","| before.\" I said \"That's because you're the only one who can  | with the police there. And I found out that they are trying  |\n","|      see it.\" The man replied \"Yeah, I'm a blind guy!\"       |        to find the person who did this! But they can'        |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |    score, but then\u001b[0m he stopped and said \"Dad, I'm sorry.\"     |\n","| and rolled a few feet away from him. My son picked it up and |                                                              |\n","|  ran off to get it back. I watched him run off for a while,  |     I looked at him and asked \"What are you sorry for?\"      |\n","| then I heard a noise behind me that sounded like someone had |                                                              |\n","|  thrown something at my house (I'm not sure what). I turned  |           He said \"I'm sorry for being a bad boy.\"           |\n","| around and saw that there was an object in the middle of my  |                                                              |\n","|                             yar                              |    I said \"Why are you apologizing? You're not a bad boy.    |\n","|                                                              |  You're a good boy.\" (My son is 12.) He didn't say anything  |\n","|                                                              |                     else, but that's wha                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he decided to go for a little extra      |       score, but then\u001b[0m the referee blew the whistle and       |\n","| yardage. He threw the ball into the air and it hit his knee  |     everyone stopped. My son didn't want to stop playing     |\n","|                      and he went down.                       |  football, so he kept going. I told him that it's okay, but  |\n","|                                                              |  he said \"I'm not stopping.\" So I told him that if he stops  |\n","|   He was taken to the hospital and they told me that they    |  again, we'll stop playing football for a while. Then when   |\n","|   would have to amputate his leg because of what happened.   | we're done with football for a while, we'll play basketball  |\n","|  They said that it would be better if I took him home today  |                      or something else.                      |\n","|   so that he could get some rest before surgery, but I di    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|               score, but then\u001b[0m he took a knee.                |   score, but then\u001b[0m he hit the ground and went down. I asked   |\n","|                                                              |          him what happened and he said \"I'm sorry.\"          |\n","|   I didn't know what to do. I tried to tell him that it's    |                                                              |\n","| okay, that it's not the end of the world and that he should  |   Then I asked him if he had a concussion. He said no, but   |\n","| keep playing. But he wasn't listening and continued kneeling |                  that it wasn't his fault.                   |\n","| until his coach told him to get up and go back in the game.  |                                                              |\n","| My son is 6 years old, so I didn't want him getting hurt or  | I asked him if he had any symptoms of a concussion and then  |\n","|                                                              |    I asked if there were any other symptoms that could be    |\n","|                                                              |           causing them (he had headaches). He sai            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|   score, but then\u001b[0m he took a huge hit and went down. I got    |    score, but then\u001b[0m he hit the ground hard and fell on his    |\n","| up and ran over to him. I saw that he had a concussion, and  | face. I immediately went to help him, but he didn't want me  |\n","|                 that his head was bleeding.                  |   there. I asked him if he wanted me there and then when I   |\n","|                                                              |  tried to get closer, he said \"No.\" Then he started crying   |\n","| I asked him what happened, and he said that the other player |              and said \"I don't want you here.\"               |\n","|  hit him in the head with his helmet, so it knocked him out  |                                                              |\n","| for a few seconds. Then they were all laughing at me because | I tried to calm him down, but that didn't work either. Then  |\n","|                   I couldn't see anything                    |                              w                               |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he saw a girl in the stands. She was     |   score, but then\u001b[0m he hit the ground and fell down. I went    |\n","|  wearing a red shirt and she had on a skirt that showed off  |    over to him and he said \"I'm sorry.\" I asked him if he    |\n","|      her legs. He looked at her and said, \"That's hot.\"      |  wanted me to call an ambulance. He said no, that's all he   |\n","|                                                              |                       wanted me to do.                       |\n","|  I asked him what he meant by that and he said, \"It's like   |                                                              |\n","| when you see someone who is very pretty in a dark room with  |  I went back over and told him that if there was anything I  |\n","|     no light.\" I told him that girls wear skirts becaus      |         could do for him, I would be happy to help.          |\n","|                                                              |                                                              |\n","|                                                              |                     He looked at me with                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |   score, but then\u001b[0m he ran into a girl who was also playing    |\n","|  and rolled away. My son looked up at me and said, \"Mommy,   |  football. She had her hands in the air and she didn't know  |\n","|                         I'm sorry.\"                          |  how to stop the ball from going over her head. My son said  |\n","|                                                              | \"That's not fair!\" and that's when I knew it wasn't fair for |\n","| I asked him what he meant by that. He said that he had just  | either of them. It's not fair for anyone else to be hit by a |\n","|   dropped the ball because it hurt so bad when it hit the    |           ball, especially if they don't know how            |\n","|   ground. I told him that this is a good thing because it    |                                                              |\n","|               means he's learning how to be a                |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|         score, but then\u001b[0m he stopped and looked at me.         |   score, but then\u001b[0m he fell down and broke his leg. I rushed   |\n","|                                                              | him to the hospital and when I got there, they told me that  |\n","|              \"Dad,\" he said, \"I think I'm gay.\"              |  my son had a broken leg. They didn't tell me what kind of   |\n","|                                                              | injury it was or how bad it was going to be. They said that  |\n","| I've been a dad for 20 years now, and I've never heard that  |  he had a broken femur bone in his lower leg and they were   |\n","|   before. But when I asked him what it meant to be gay, he   |         going to have surgery on him today (today).          |\n","| told me that his friends had all said the same thing: \"We're |                                                              |\n","|           all gay.\" They'd laughed about it in th            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=1600,\n","    act_name=35,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=tiny_training_subset[:100],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday my son was playing football. He was about to score, but then\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1IOxjnFhXAKE","executionInfo":{"status":"ok","timestamp":1692273527463,"user_tz":-60,"elapsed":44015,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f29a2fd2-a827-4fbf-cf57-cb8481b324bb"},"execution_count":34,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|      score, but then\u001b[0m he noticed a woman sitting in the       |   score, but then\u001b[0m he noticed a gun on the ground. I asked    |\n","| stands. She looked at him and smiled. He thought she was his |        him what it was and he said, \"It's a toy gun.\"        |\n","|    mother, but when he turned around she was actually his    |                                                              |\n","|                         grandmother!                         | I asked him if he knew how to use it and he said no. I told  |\n","|                                                              |  him that we had to go get the police so we could call them  |\n","|    The man said to me \"I've never seen anything like that    | for help. He looked at me with his eyes wide open, confused  |\n","| before.\" I said \"That's because you're the only one who can  |                 as to why I would want that.                 |\n","|      see it.\" The man replied \"Yeah, I'm a blind guy!\"       |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |    score, but then\u001b[0m he dropped the ball. It hit the ground    |\n","| and rolled a few feet away from him. My son picked it up and | and rolled into a nearby ditch. The referee signaled that it |\n","|  ran off to get it back. I watched him run off for a while,  |  was a fumble, and my son got up and ran back to the field   |\n","| then I heard a noise behind me that sounded like someone had |                 with his face in his hands.                  |\n","|  thrown something at my house (I'm not sure what). I turned  |                                                              |\n","| around and saw that there was an object in the middle of my  |  I had no idea what happened, but I knew something bad had   |\n","|                             yar                              | happened. My heart sank as I realized that my only child had |\n","|                                                              |          just lost a game of football because he di          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he decided to go for a little extra      |    score, but then\u001b[0m the referee stopped the game and told     |\n","| yardage. He threw the ball into the air and it hit his knee  | him that he had been fouled by a referee. My son said \"what  |\n","|                      and he went down.                       | did you do?\" The referee replied \"I didn't do anything.\" My  |\n","|                                                              |    son then asked why he had been fouled and the referee     |\n","|   He was taken to the hospital and they told me that they    |        replied \"because I didn't call a foul on you.\"        |\n","|   would have to amputate his leg because of what happened.   |                                                              |\n","|  They said that it would be better if I took him home today  |   My son was furious. He asked if he could go back to play   |\n","|   so that he could get some rest before surgery, but I di    |                            again,                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|               score, but then\u001b[0m he took a knee.                |    score, but then\u001b[0m he looked up and saw a group of people    |\n","|                                                              |   running towards him. He ran away from them, but then the   |\n","|   I didn't know what to do. I tried to tell him that it's    |  police came and arrested him for \"using a mob to cross the  |\n","| okay, that it's not the end of the world and that he should  |                            road\".                            |\n","| keep playing. But he wasn't listening and continued kneeling |                                                              |\n","| until his coach told him to get up and go back in the game.  |   He was only playing football. It's not like he had been    |\n","| My son is 6 years old, so I didn't want him getting hurt or  |   drinking or anything. The police said that they had been   |\n","|                                                              |   told by his friends that he had been drinking before the   |\n","|                                                              |                  game, so they arrested him                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|   score, but then\u001b[0m he took a huge hit and went down. I got    |    score, but then\u001b[0m he looked up and saw a police officer     |\n","| up and ran over to him. I saw that he had a concussion, and  | standing in the middle of the field. The officer told him to |\n","|                 that his head was bleeding.                  | move his stick away from the line of scrimmage, and when he  |\n","|                                                              | did so, another officer approached him and told him that he  |\n","| I asked him what happened, and he said that the other player |                   had to leave the field.                    |\n","|  hit him in the head with his helmet, so it knocked him out  |                                                              |\n","| for a few seconds. Then they were all laughing at me because |   My son said that this is not what football is about. He    |\n","|                   I couldn't see anything                    |  pointed out that it's a game where players try to hit each  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he saw a girl in the stands. She was     |   score, but then\u001b[0m he fell on the field and hurt his knee.    |\n","|  wearing a red shirt and she had on a skirt that showed off  | I ran to him and took him to the hospital. They told me that |\n","|      her legs. He looked at her and said, \"That's hot.\"      | they had an x-ray showing a bone fracture in his knee, which |\n","|                                                              | is why he had been taken to the hospital in the first place. |\n","|  I asked him what he meant by that and he said, \"It's like   |                                                              |\n","| when you see someone who is very pretty in a dark room with  | The doctor said that they were going to have surgery today,  |\n","|     no light.\" I told him that girls wear skirts becaus      |    but it would be at a later date because of his injury     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |    score, but then\u001b[0m he dropped the ball. It hit the ground    |\n","|  and rolled away. My son looked up at me and said, \"Mommy,   |   and rolled under a pile of other balls. The next thing I   |\n","|                         I'm sorry.\"                          |  knew, my son was bleeding from his head and had a huge cut  |\n","|                                                              |                         on his face.                         |\n","| I asked him what he meant by that. He said that he had just  |                                                              |\n","|   dropped the ball because it hurt so bad when it hit the    |   My wife ran over to help me, but by that time it was too   |\n","|   ground. I told him that this is a good thing because it    |  late for her to do anything more than hold him down until   |\n","|               means he's learning how to be a                |      emergency medical help arrived. My son had a big g      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|         score, but then\u001b[0m he stopped and looked at me.         |    score, but then\u001b[0m he stopped and looked at me. \"I'm not     |\n","|                                                              |   going to do that,\" he said. \"I don't want to be a man.\"    |\n","|              \"Dad,\" he said, \"I think I'm gay.\"              |                                                              |\n","|                                                              |                   \"Why not?\" I asked him.                    |\n","| I've been a dad for 20 years now, and I've never heard that  |                                                              |\n","|   before. But when I asked him what it meant to be gay, he   | \"Because I'm a girl.\" He looked at me with the most intense  |\n","| told me that his friends had all said the same thing: \"We're |    look of disappointment on his face, as if he had just     |\n","|           all gay.\" They'd laughed about it in th            | learned that the only way he could ever have a real girlfri  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=800,\n","    act_name=35,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=tiny_training_subset[:100],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday my son was playing football. He was about to score, but then\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eTHqRDB1WkrJ","executionInfo":{"status":"ok","timestamp":1692273421432,"user_tz":-60,"elapsed":44923,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"68faf81d-de35-46ce-bf4f-6ade657e4c94"},"execution_count":33,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|      score, but then\u001b[0m he noticed a woman sitting in the       |   score, but then\u001b[0m he noticed a gun on the ground. I asked    |\n","| stands. She looked at him and smiled. He thought she was his |        him what it was and he said, \"It's a toy gun.\"        |\n","|    mother, but when he turned around she was actually his    |                                                              |\n","|                         grandmother!                         | I asked him if he knew how to use it and he said no. I told  |\n","|                                                              |  him that we had to go get the police so we could call them  |\n","|    The man said to me \"I've never seen anything like that    | for help. He looked at me with his eyes wide open, confused  |\n","| before.\" I said \"That's because you're the only one who can  |                 as to why I would want that.                 |\n","|      see it.\" The man replied \"Yeah, I'm a blind guy!\"       |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |    score, but then\u001b[0m he dropped the ball. It hit the ground    |\n","| and rolled a few feet away from him. My son picked it up and | and rolled into a nearby ditch. The referee signaled that it |\n","|  ran off to get it back. I watched him run off for a while,  |  was a fumble, and my son got up and ran back to the field   |\n","| then I heard a noise behind me that sounded like someone had |                 with his face in his hands.                  |\n","|  thrown something at my house (I'm not sure what). I turned  |                                                              |\n","| around and saw that there was an object in the middle of my  |  I had no idea what happened, but I knew something bad had   |\n","|                             yar                              | happened. My heart sank as I realized that my only child had |\n","|                                                              |          just lost a game of football because he di          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he decided to go for a little extra      |    score, but then\u001b[0m the referee stopped the game and told     |\n","| yardage. He threw the ball into the air and it hit his knee  | him that he had been fouled by a referee. My son said \"what  |\n","|                      and he went down.                       | did you do?\" The referee replied \"I didn't do anything.\" My  |\n","|                                                              |    son then asked why he had been fouled and the referee     |\n","|   He was taken to the hospital and they told me that they    |        replied \"because I didn't call a foul on you.\"        |\n","|   would have to amputate his leg because of what happened.   |                                                              |\n","|  They said that it would be better if I took him home today  |   My son was furious. He asked if he could go back to play   |\n","|   so that he could get some rest before surgery, but I di    |                            again,                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|               score, but then\u001b[0m he took a knee.                |    score, but then\u001b[0m he fell down. I called the police and     |\n","|                                                              |   they came and took him away. They said that he had been    |\n","|   I didn't know what to do. I tried to tell him that it's    |  drinking and it was his fault for falling down. The police  |\n","| okay, that it's not the end of the world and that he should  |    told me that my son would be sent to a youth detention    |\n","| keep playing. But he wasn't listening and continued kneeling |  center for ten days if I didn't pay them money in order to  |\n","| until his coach told him to get up and go back in the game.  |                    get him out of there.                     |\n","| My son is 6 years old, so I didn't want him getting hurt or  |                                                              |\n","|                                                              |         I don't know what is going on with this boy,         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|   score, but then\u001b[0m he took a huge hit and went down. I got    |   score, but then\u001b[0m he fell down. He got up and ran back to    |\n","| up and ran over to him. I saw that he had a concussion, and  |  the field, but then he fell again. He ran back and forth a  |\n","|                 that his head was bleeding.                  | few times before I called him in for a nap. When I woke him  |\n","|                                                              |      up, he said that he had fallen on his head again!       |\n","| I asked him what happened, and he said that the other player |                                                              |\n","|  hit him in the head with his helmet, so it knocked him out  |  I told him that it wasn't so bad this time because it was   |\n","| for a few seconds. Then they were all laughing at me because |      just one of those things where you get tired after      |\n","|                   I couldn't see anything                    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he saw a girl in the stands. She was     |   score, but then\u001b[0m he fell on the field and hurt his knee.    |\n","|  wearing a red shirt and she had on a skirt that showed off  | I ran to him and took him to the hospital. They told me that |\n","|      her legs. He looked at her and said, \"That's hot.\"      | they had an x-ray showing a bone fracture in his knee, which |\n","|                                                              | is why he had been taken to the hospital in the first place. |\n","|  I asked him what he meant by that and he said, \"It's like   |                                                              |\n","| when you see someone who is very pretty in a dark room with  | The doctor said that they were going to have surgery today,  |\n","|     no light.\" I told him that girls wear skirts becaus      |    but it would be at a later date because of his injury     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |    score, but then\u001b[0m he dropped the ball. It hit the ground    |\n","|  and rolled away. My son looked up at me and said, \"Mommy,   |   and rolled under a pile of other balls. The next thing I   |\n","|                         I'm sorry.\"                          |  knew, my son was bleeding from his head and had a huge cut  |\n","|                                                              |                         on his face.                         |\n","| I asked him what he meant by that. He said that he had just  |                                                              |\n","|   dropped the ball because it hurt so bad when it hit the    |   My wife ran over to help me, but by that time it was too   |\n","|   ground. I told him that this is a good thing because it    |  late for her to do anything more than hold him down until   |\n","|               means he's learning how to be a                |      emergency medical help arrived. My son had a big g      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|         score, but then\u001b[0m he stopped and looked at me.         |    score, but then\u001b[0m he stopped and looked at me. \"I'm not     |\n","|                                                              |   going to do that,\" he said. \"I don't want to be a man.\"    |\n","|              \"Dad,\" he said, \"I think I'm gay.\"              |                                                              |\n","|                                                              |                   \"Why not?\" I asked him.                    |\n","| I've been a dad for 20 years now, and I've never heard that  |                                                              |\n","|   before. But when I asked him what it meant to be gay, he   | \"Because I'm a girl.\" He looked at me with the most intense  |\n","| told me that his friends had all said the same thing: \"We're |    look of disappointment on his face, as if he had just     |\n","|           all gay.\" They'd laughed about it in th            | learned that the only way he could ever have a real girlfri  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=400,\n","    act_name=35,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=tiny_training_subset[:100],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday my son was playing football. He was about to score, but then\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XNiYAViuWPP-","executionInfo":{"status":"ok","timestamp":1692273331144,"user_tz":-60,"elapsed":45712,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"b5956580-06f9-4a06-9b6a-dd83b5d89ba9"},"execution_count":31,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|      score, but then\u001b[0m he noticed a woman sitting in the       |   score, but then\u001b[0m he noticed a gun on the ground. I asked    |\n","| stands. She looked at him and smiled. He thought she was his |        him what it was and he said, \"It's a toy gun.\"        |\n","|    mother, but when he turned around she was actually his    |                                                              |\n","|                         grandmother!                         | I asked him if he knew how to use it and he said no. I told  |\n","|                                                              |  him that we had to go get the police so we could call them  |\n","|    The man said to me \"I've never seen anything like that    | for help. He looked at me with his eyes wide open, confused  |\n","| before.\" I said \"That's because you're the only one who can  |                 as to why I would want that.                 |\n","|      see it.\" The man replied \"Yeah, I'm a blind guy!\"       |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |    score, but then\u001b[0m he dropped the ball. It hit the ground    |\n","| and rolled a few feet away from him. My son picked it up and | and rolled into a nearby ditch. The referee signaled that it |\n","|  ran off to get it back. I watched him run off for a while,  |  was a fumble, and my son got up and ran back to the field   |\n","| then I heard a noise behind me that sounded like someone had |                 with his face in his hands.                  |\n","|  thrown something at my house (I'm not sure what). I turned  |                                                              |\n","| around and saw that there was an object in the middle of my  |  I had no idea what happened, but I knew something bad had   |\n","|                             yar                              | happened. My heart sank as I realized that my only child had |\n","|                                                              |          just lost a game of football because he di          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he decided to go for a little extra      |    score, but then\u001b[0m the referee stopped the game and told     |\n","| yardage. He threw the ball into the air and it hit his knee  | him that he had been fouled by a referee. My son said \"what  |\n","|                      and he went down.                       | did you do?\" The referee replied \"I didn't do anything.\" My  |\n","|                                                              |    son then asked why he had been fouled and the referee     |\n","|   He was taken to the hospital and they told me that they    |          replied \"because I wasn't looking at you.\"          |\n","|   would have to amputate his leg because of what happened.   |                                                              |\n","|  They said that it would be better if I took him home today  |  My son was shocked. Why would a referee be so stupid? This  |\n","|   so that he could get some rest before surgery, but I di    |                        is not what w                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|               score, but then\u001b[0m he took a knee.                |    score, but then\u001b[0m he fell down. I called the police and     |\n","|                                                              |   they came and took him away. They said that he had been    |\n","|   I didn't know what to do. I tried to tell him that it's    |  drinking and it was his fault for falling down. The police  |\n","| okay, that it's not the end of the world and that he should  |    told me that my son would be sent to a youth detention    |\n","| keep playing. But he wasn't listening and continued kneeling |  center for ten days if I didn't pay them money in order to  |\n","| until his coach told him to get up and go back in the game.  |                    get him out of there.                     |\n","| My son is 6 years old, so I didn't want him getting hurt or  |                                                              |\n","|                                                              |         I don't know what is going on with this boy,         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|   score, but then\u001b[0m he took a huge hit and went down. I got    |   score, but then\u001b[0m he fell down. He got up and ran back to    |\n","| up and ran over to him. I saw that he had a concussion, and  |  the field, but then he fell again. He ran back and forth a  |\n","|                 that his head was bleeding.                  | few times before I called him in for a nap. When I woke him  |\n","|                                                              |      up, he said that he had fallen on his head again!       |\n","| I asked him what happened, and he said that the other player |                                                              |\n","|  hit him in the head with his helmet, so it knocked him out  |  I told him that it wasn't so bad this time because it was   |\n","| for a few seconds. Then they were all laughing at me because |      just one of those things where you get tired after      |\n","|                   I couldn't see anything                    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he saw a girl in the stands. She was     |   score, but then\u001b[0m he fell on the field and hurt his knee.    |\n","|  wearing a red shirt and she had on a skirt that showed off  | I ran to him and took him to the hospital. They told me that |\n","|      her legs. He looked at her and said, \"That's hot.\"      | they had an x-ray showing a bone fracture in his knee, which |\n","|                                                              | is why he had been taken to the hospital in the first place. |\n","|  I asked him what he meant by that and he said, \"It's like   |                                                              |\n","| when you see someone who is very pretty in a dark room with  | The doctor said that they were going to have surgery today,  |\n","|     no light.\" I told him that girls wear skirts becaus      |    but it would be at a later date because of his injury     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |    score, but then\u001b[0m he dropped the ball. It hit the ground    |\n","|  and rolled away. My son looked up at me and said, \"Mommy,   |   and rolled under a pile of other balls. The next thing I   |\n","|                         I'm sorry.\"                          |    knew, my son had fallen on his face and his eyes were     |\n","|                                                              |                  rolling back in his head.                   |\n","| I asked him what he meant by that. He said that he had just  |                                                              |\n","|   dropped the ball because it hurt so bad when it hit the    | I ran over to him and put a towel on his face so he wouldn't |\n","|   ground. I told him that this is a good thing because it    |   bleed out of it. Then I called an ambulance for him, but   |\n","|               means he's learning how to be a                |             they couldn't get there fast enough              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|         score, but then\u001b[0m he stopped and looked at me.         |    score, but then\u001b[0m he stopped and looked at me. \"I'm not     |\n","|                                                              |   going to do that,\" he said. \"I don't want to be a man.\"    |\n","|              \"Dad,\" he said, \"I think I'm gay.\"              |                                                              |\n","|                                                              |                   \"Why not?\" I asked him.                    |\n","| I've been a dad for 20 years now, and I've never heard that  |                                                              |\n","|   before. But when I asked him what it meant to be gay, he   | \"Because I'm a girl.\" He looked at me with the most intense  |\n","| told me that his friends had all said the same thing: \"We're |    look of disappointment on his face, as if he had just     |\n","|           all gay.\" They'd laughed about it in th            | learned that the only way he could ever have a real girlfri  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=150,\n","    act_name=35,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=tiny_training_subset[:100],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday my son was playing football. He was about to score, but then\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4nVhcfBKSOeL","executionInfo":{"status":"ok","timestamp":1692273240459,"user_tz":-60,"elapsed":45535,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f554143a-2e3a-45b8-8fd9-f1b7242d3394"},"execution_count":29,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|      score, but then\u001b[0m he noticed a woman sitting in the       |   score, but then\u001b[0m he noticed a gun on the ground. I asked    |\n","| stands. She looked at him and smiled. He thought she was his |        him what it was and he said, \"It's a toy gun.\"        |\n","|    mother, but when he turned around she was actually his    |                                                              |\n","|                         grandmother!                         | I asked him if he knew how to use it and he said no. I told  |\n","|                                                              |  him that we had to go get the police so we could call them  |\n","|    The man said to me \"I've never seen anything like that    | for help. He looked at me with his eyes wide open, confused  |\n","| before.\" I said \"That's because you're the only one who can  |                 as to why I would want that.                 |\n","|      see it.\" The man replied \"Yeah, I'm a blind guy!\"       |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |    score, but then\u001b[0m he dropped the ball. It hit the ground    |\n","| and rolled a few feet away from him. My son picked it up and | and rolled into a nearby ditch. The referee signaled that it |\n","|  ran off to get it back. I watched him run off for a while,  |  was a fumble, and my son got up and ran back to the field   |\n","| then I heard a noise behind me that sounded like someone had |                 with his face in his hands.                  |\n","|  thrown something at my house (I'm not sure what). I turned  |                                                              |\n","| around and saw that there was an object in the middle of my  |  I had no idea what happened, but I knew something bad had   |\n","|                             yar                              | happened. My heart sank as I realized that my only child had |\n","|                                                              |          just lost a game of football because he di          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he decided to go for a little extra      |    score, but then\u001b[0m the referee stopped the game and told     |\n","| yardage. He threw the ball into the air and it hit his knee  | him that he had been fouled by a referee. My son said \"what  |\n","|                      and he went down.                       | did you do?\" The referee replied \"I didn't do anything.\" My  |\n","|                                                              |    son then asked why he had been fouled and the referee     |\n","|   He was taken to the hospital and they told me that they    |          replied \"because I wasn't looking at you.\"          |\n","|   would have to amputate his leg because of what happened.   |                                                              |\n","|  They said that it would be better if I took him home today  |  My son was shocked. Why would a referee be so stupid? This  |\n","|   so that he could get some rest before surgery, but I di    |                       is not an isola                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|               score, but then\u001b[0m he took a knee.                |   score, but then\u001b[0m he fell down. I didn't know what to do,    |\n","|                                                              |   so I asked him if he wanted me to call the ambulance. He   |\n","|   I didn't know what to do. I tried to tell him that it's    |  said no, that he just needed a moment to catch his breath   |\n","| okay, that it's not the end of the world and that he should  |                  and then he would be fine.                  |\n","| keep playing. But he wasn't listening and continued kneeling |                                                              |\n","| until his coach told him to get up and go back in the game.  | He told me that the paramedics were not going to come unless |\n","| My son is 6 years old, so I didn't want him getting hurt or  | they saw a real injury. I asked him if it hurt when they put |\n","|                                                              |                      the bandage on his                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|   score, but then\u001b[0m he took a huge hit and went down. I got    |   score, but then\u001b[0m he fell down. He got up and ran back to    |\n","| up and ran over to him. I saw that he had a concussion, and  |  the field, but then he fell again. He ran back and forth a  |\n","|                 that his head was bleeding.                  | few times before I took him in the house for some fresh air. |\n","|                                                              |                                                              |\n","| I asked him what happened, and he said that the other player |   He looked at me and said \"I'm not going to play football   |\n","|  hit him in the head with his helmet, so it knocked him out  |                          anymore.\"                           |\n","| for a few seconds. Then they were all laughing at me because |                                                              |\n","|                   I couldn't see anything                    |   I asked him why, and he said \"I can't do it anymore.\" I    |\n","|                                                              |                       asked what chang                       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|     score, but then\u001b[0m he saw a girl in the stands. She was     |   score, but then\u001b[0m he fell on the field and hurt his knee.    |\n","|  wearing a red shirt and she had on a skirt that showed off  | I ran to him and took him to the hospital. They told me that |\n","|      her legs. He looked at her and said, \"That's hot.\"      | they had an x-ray showing a bone fracture in his knee, which |\n","|                                                              | is why he had been taken to the hospital in the first place. |\n","|  I asked him what he meant by that and he said, \"It's like   |                                                              |\n","| when you see someone who is very pretty in a dark room with  | The doctor said that they were going to have surgery today,  |\n","|     no light.\" I told him that girls wear skirts becaus      |    but it would be at a later date because of his injury     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|    score, but then\u001b[0m he dropped the ball. It hit the ground    |    score, but then\u001b[0m he dropped the ball. It hit the ground    |\n","|  and rolled away. My son looked up at me and said, \"Mommy,   |   and rolled under a pile of other balls. The next thing I   |\n","|                         I'm sorry.\"                          |    knew, my son had fallen on his face and his eyes were     |\n","|                                                              |                  rolling back in his head.                   |\n","| I asked him what he meant by that. He said that he had just  |                                                              |\n","|   dropped the ball because it hurt so bad when it hit the    | I ran over to him and put a towel on his face so he wouldn't |\n","|   ground. I told him that this is a good thing because it    |   bleed out of it. Then I called an ambulance for him, but   |\n","|               means he's learning how to be a                |             they couldn't get there fast enough              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mYesterday my son was playing football. He was about to    |    \u001b[1mYesterday my son was playing football. He was about to    |\n","|         score, but then\u001b[0m he stopped and looked at me.         |    score, but then\u001b[0m he stopped and looked at me. \"I'm not     |\n","|                                                              |   going to do that,\" he said. \"I don't want to be a man.\"    |\n","|              \"Dad,\" he said, \"I think I'm gay.\"              |                                                              |\n","|                                                              |                   \"Why not?\" I asked him.                    |\n","| I've been a dad for 20 years now, and I've never heard that  |                                                              |\n","|   before. But when I asked him what it meant to be gay, he   | \"Because I don't want to be a woman,\" he said, and then his  |\n","| told me that his friends had all said the same thing: \"We're |   face fell as if the weight of his decision had been laid   |\n","|           all gay.\" They'd laughed about it in th            |           upon him. His voice trailed off, and for           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["## GPT-2 Small Test"],"metadata":{"id":"xzEeCP0tJsKn"}},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=60,\n","    act_name=6,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"id":"vvptA7zxJ6QR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=60,\n","    act_name=6,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday my son was playing football for Beckley Rangers. They were winning 2-0, but then\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"h8mjRUOrKTEl","executionInfo":{"status":"ok","timestamp":1689616912776,"user_tz":-60,"elapsed":17424,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"2b9d71bd-3210-4275-b342-9270f1165156"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m I heard a noise   |    Rangers. They were winning 2-0, but then\u001b[0m the elves of     |\n","|                  and thought \"Oh, it's me\".                  |  their homeland came to destroy us and brought about a new   |\n","|                                                              |        world in which we are no longer able to live.         |\n","|   I went to the park and saw that they had a huge crowd of   |                                                              |\n","|  about 30 people. It was amazing how many people there were  | The elves of that world have taken over our land and created |\n","| at the game. The only thing I can remember is that everyone  |  a new continent where they have ruled the earth for over a  |\n","| was wearing black shirts with their names on them, and when  |  thousand years. It is now called Ootl, but I can only tell  |\n","| I asked if they were wearing black shirts or white shirts it |  you that it is inhabited by an ancient dark elf race known  |\n","|                           just sai                           |                              as                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m I heard that     |   Rangers. They were winning 2-0, but then\u001b[0m I saw the first   |\n","| the boys had a new coach and he was going to take over from  | spell of a new magic artifact that was made by one of their  |\n","|        David Moyes. I didn't know what to make of it.        | famous druids. It is said that it can be used to summon the  |\n","|                                                              | spirits of dead dragons and other creatures, but it has been |\n","| \"I thought it was a good idea, but I thought if we don't get | rumored that it is actually a magical spell which will grant |\n","|      any points then we'll have to give up and leave.\"       |              you an enchanted or magical wand.               |\n","|                                                              |                                                              |\n","|  That's how they did it. That's how they do things now. Th   |         This is where we are in the realm of magic!          |\n","|                                                              |                                                              |\n","|                                                              |                          When I was                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m the ball went    |      Rangers. They were winning 2-0, but then\u001b[0m a strange      |\n","|   to a goalkeeper and he hit it home from behind. I'm sure   | creature came to life and started attacking them. It was the |\n","|   there are many other stories like this, but I think the    |  Nightmare that awakened her from its slumber and attacked   |\n","| story is that his dad had just been sent off by his manager  |                          the party.                          |\n","|  at the time and was asked to play in an away game against   |                                                              |\n","| Cardiff City. He said 'no', so he went back to his own team, |   It was a beautiful witch who summoned a dragon which she   |\n","|               and when they came back with a 3               |  called 'the Dark Magician'. She told me that she had found  |\n","|                                                              | some magical items in an old fairy tale where she found some |\n","|                                                              | ancient artifacts of an ancient age, but there were no magic |\n","|                                                              |                           items i                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went down    |     Rangers. They were winning 2-0, but then\u001b[0m they had a      |\n","| to a 1-0 defeat at Huddersfield Town. I think that's what it |        terrible game and I was able to help them win.        |\n","|   was like to watch them play, and I'm glad that they did.   |                                                              |\n","|                                                              |  The first thing I did was give him a copy of the 'Unicorn   |\n","|  It was a great day for me as well as the fans of the club   |   Charm' spell that she uses when she creates an enchanted   |\n","|     and I'm sure it will be remembered by all who saw it     |  creature that can only be summoned by her, and then summon  |\n","|  tonight. It's always good to see people celebrating their   |      it from her own realm. She also has an enchanting       |\n","|                           team or                            | enchantment on it so if you're not familiar with this spell  |\n","|                                                              |                             you                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went down    |     Rangers. They were winning 2-0, but then\u001b[0m they had a      |\n","| to 3-1 and I thought, 'Well, that's not going to happen.' So |  surprise encounter with the evil creature called a demon.   |\n","|  I started thinking about it. It's a great team. We've got   |   The demon took her and she went to investigate. When she   |\n","| some really good players here and we're very good at getting |  found the spirit of a lost god, it turned out that she had  |\n","|                           points.\"                           |   found the mysterious island where an ancient magic item    |\n","|                                                              |  known as \"Lunar Key\" is kept hidden from humans. The Lost   |\n","|  \"I think the first thing you have to do is be patient with  |   God has been corrupted by the power of a strange entity    |\n","|     yourself,\" he added. \"You can't let your emotions g      |              called Light from another dimensi               |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went on to   |     Rangers. They were winning 2-0, but then\u001b[0m they had a      |\n","|   win 3-1. I had a few beers with him and he said \"You're    |  strange event that brought them back to the realm of Myth   |\n","| going to be fine.\" I thought it was hilarious that the kids  |                         and legend.                          |\n","|    in the team are laughing at me now, but it's not funny    |                                                              |\n","|                           anymore.                           |  My son had been lost in the sea and could not find her way  |\n","|                                                              |  back to the shore. I decided to search for her and found a  |\n","|  I think it's funny because when you have a team like that,  | place where she could find her way back home with magic. She |\n","|    you have no idea what they're doing. They've got their    |    told me that when she found out about this mysterious     |\n","|                                                              |         creature, she would have to summon it from a         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|     Rangers. They were winning 2-0, but then\u001b[0m I heard the     |   Rangers. They were winning 2-0, but then\u001b[0m the ghost of a    |\n","|   news that their team had won a league game and had been    |  magical fairy (Sorcellane) came into existence and sent us  |\n","| promoted to the Premier League. I was absolutely devastated  | to the Great Sea. The ghost is not evil, it is a spirit who  |\n","|                            by it.                            |                 gave us this wondrous land.                  |\n","|                                                              |                                                              |\n","|  I'm not sure what happened to him, but he's still going to  |    In this strange land lies the great sea which was once    |\n","| play football at his school in Liverpool. It's sad, but it's | inhabited by a strange creature called Mothloth (or \"Moth\",  |\n","|   all right with me now because I know he'll be back soon    |           as it's also known). This sea is inhabi            |\n","|           enough for his senior season of football           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m they lost 3-1    |    Rangers. They were winning 2-0, but then\u001b[0m they lost to     |\n","|    to the St. Louis Blues. The game had been played in a     |  the Gnomes. I was thinking that the Gnomes would have been  |\n","| friendly, and I didn't know if I could get out of it or not. |  able to gain a few more points by using a 3rd level spell   |\n","|                                                              |    and allowing me to use it on my 3rd level witch spell.    |\n","|  My son is a little shy and he is always talking about his   |                                                              |\n","|  dad's game, but it was clear that his dad was really proud  | So I went into my home of Gizmodel and tried searching for a |\n","|  of him as well as the team. He wanted to see what he coul   | wand which allowed me to use the 2nd level witch spells from |\n","|                                                              |                     another world, which                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=10,\n","    act_name=3,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday my son was playing football for Beckley Rangers. They were winning 2-0, but then\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ya5OB7lsL4me","executionInfo":{"status":"ok","timestamp":1689519120233,"user_tz":-60,"elapsed":16611,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"2ca5e2f8-b242-48f6-ac53-1b97f5552787"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m I heard a noise   |   Rangers. They were winning 2-0, but then\u001b[0m I heard a noise   |\n","|                  and thought \"Oh, it's me\".                  |                  and thought \"Oh, it's me\".                  |\n","|                                                              |                                                              |\n","|   I went to the park and saw that they had a huge crowd of   |  I went to the park and saw that they had a huge white flag  |\n","|  about 30 people. It was amazing how many people there were  | on their flagpole. I looked at it and said \"Oh, this is what |\n","| at the game. The only thing I can remember is that everyone  |       the band has been doing for the last few years\".       |\n","| was wearing black shirts with their names on them, and when  |                                                              |\n","| I asked if they were wearing black shirts or white shirts it | The band is called Aptitude in Ireland. They are playing at  |\n","|                           just sai                           |               The National Park in Dublin (or                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m I heard that     |    Rangers. They were winning 2-0, but then\u001b[0m I heard that     |\n","| the boys had a new coach and he was going to take over from  |   the stadium had been sold and they were in a relegation    |\n","|        David Moyes. I didn't know what to make of it.        |                zone. I thought it was crazy.                 |\n","|                                                              |                                                              |\n","| \"I thought it was a good idea, but I thought if we don't get |  I went to the club's website and saw that there was no new  |\n","|      any points then we'll have to give up and leave.\"       | ground in town, just a huge derelict building with an empty  |\n","|                                                              | field at the bottom of it. I called my dad to tell him about |\n","|  That's how they did it. That's how they do things now. Th   |    this horrible news and he told me that it had happened    |\n","|                                                              |                         before on a                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m the ball went    |      Rangers. They were winning 2-0, but then\u001b[0m the whole      |\n","|   to a goalkeeper and he hit it home from behind. I'm sure   |  stadium went black and I thought 'what's going on?' And he  |\n","|   there are many other stories like this, but I think the    |   looked at me and said 'you're a little too young to play   |\n","| story is that his dad had just been sent off by his manager  |                          football'.                          |\n","|  at the time and was asked to play in an away game against   |                                                              |\n","| Cardiff City. He said 'no', so he went back to his own team, |  I didn't know what to do. He was just looking at me like I  |\n","|               and when they came back with a 3               | was crazy. He started laughing, and then he stopped laughing |\n","|                                                              |               because it wasn't funny anymore.               |\n","|                                                              |                                                              |\n","|                                                              |                   \"I think it's a bit of a                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went down    |   Rangers. They were winning 2-0, but then\u001b[0m they went down    |\n","| to a 1-0 defeat at Huddersfield Town. I think that's what it | to a 2-1 defeat at Huddersfield Town. I had the opportunity  |\n","|   was like to watch them play, and I'm glad that they did.   |   to meet him at the club's training ground and he told me   |\n","|                                                              |  that his team were going to play against Huddersfield Town  |\n","|  It was a great day for me as well as the fans of the club   |  on Saturday night. He was so excited about it that he even  |\n","|     and I'm sure it will be remembered by all who saw it     |         invited me over for a pint of beer with him.         |\n","|  tonight. It's always good to see people celebrating their   |                                                              |\n","|                           team or                            |            He also said that if we played agains             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went down    |   Rangers. They were winning 2-0, but then\u001b[0m they went down    |\n","| to 3-1 and I thought, 'Well, that's not going to happen.' So |  to 3-1 and I thought, 'Well that's not going to work out.'  |\n","|  I started thinking about it. It's a great team. We've got   |              So I decided to go with the Bears.              |\n","| some really good players here and we're very good at getting |                                                              |\n","|                           points.\"                           | I was at home watching TV when my son started talking about  |\n","|                                                              | the Bears. He had a big game against the Vikings and he was  |\n","|  \"I think the first thing you have to do is be patient with  |   saying something like 'You know what? It's all about you   |\n","|     yourself,\" he added. \"You can't let your emotions g      |              guys.' And he said it like it was               |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went on to   |   Rangers. They were winning 2-0, but then\u001b[0m they went on to   |\n","|   win 3-1. I had a few beers with him and he said \"You're    |   win 3-1. I had a few beers with him and he said \"You're    |\n","| going to be fine.\" I thought it was hilarious that the kids  | going to be fine.\" I asked him if he knew that it was true,  |\n","|    in the team are laughing at me now, but it's not funny    |                and he said \"Yeah, it's true.\"                |\n","|                           anymore.                           |                                                              |\n","|                                                              |  I'm not sure if the Rangers fans are aware of this or not,  |\n","|  I think it's funny because when you have a team like that,  |  but I think that they have been doing this for a long time  |\n","|    you have no idea what they're doing. They've got their    |                             now.                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|     Rangers. They were winning 2-0, but then\u001b[0m I heard the     |   Rangers. They were winning 2-0, but then\u001b[0m I heard a story   |\n","|   news that their team had won a league game and had been    | about an old man who had been shot in the head by a band of  |\n","| promoted to the Premier League. I was absolutely devastated  |  thieves. He was trying to rob a shop and when he got there  |\n","|                            by it.                            |   he saw that the thief had been shot in the head with his   |\n","|                                                              | gun. The guy was dead, and now we know that this is not just |\n","|  I'm not sure what happened to him, but he's still going to  |  some random accident but that he has been shot in the head  |\n","| play football at his school in Liverpool. It's sad, but it's |                        with his gun.                         |\n","|   all right with me now because I know he'll be back soon    |                                                              |\n","|           enough for his senior season of football           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m they lost 3-1    |    Rangers. They were winning 2-0, but then\u001b[0m they lost 3-1    |\n","|    to the St. Louis Blues. The game had been played in a     |    to the St. Louis Blues. The game had been played in a     |\n","| friendly, and I didn't know if I could get out of it or not. |    friendly, and I didn't know if I could play with them     |\n","|                                                              |              because of the loss to the Blues.               |\n","|  My son is a little shy and he is always talking about his   |                                                              |\n","|  dad's game, but it was clear that his dad was really proud  |  I knew that it would be hard for me to get on a team like   |\n","|  of him as well as the team. He wanted to see what he coul   |    this one and make it into the league next season so I     |\n","|                                                              |    thought about what I could do instead of just being ou    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=30,\n","    act_name=3,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday my son was playing football for Beckley Rangers. They were winning 2-0, but then\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UTq3e7NBK-F2","executionInfo":{"status":"ok","timestamp":1689518882608,"user_tz":-60,"elapsed":16763,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"b20aa2e6-7771-4a9f-c002-9c7000fb992c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m I heard a noise   |   Rangers. They were winning 2-0, but then\u001b[0m I heard a noise   |\n","|                  and thought \"Oh, it's me\".                  |           and thought \"what the hell is going on?\"           |\n","|                                                              |                                                              |\n","|   I went to the park and saw that they had a huge crowd of   |    I went to see my son and he said \"hey I'm a girl from     |\n","|  about 30 people. It was amazing how many people there were  |       Beckley who plays football for Beckley Rangers\".       |\n","| at the game. The only thing I can remember is that everyone  |                                                              |\n","| was wearing black shirts with their names on them, and when  |  I asked him what happened, he said \"you know it's not like  |\n","| I asked if they were wearing black shirts or white shirts it | that. It's not like we're getting together or anything\". He  |\n","|                           just sai                           |                     said \"it's just me a                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m I heard that     |   Rangers. They were winning 2-0, but then\u001b[0m I heard that a    |\n","| the boys had a new coach and he was going to take over from  |     boy named Lainey had been found dead in his home. I      |\n","|        David Moyes. I didn't know what to make of it.        |    immediately called the police and they took him to the    |\n","|                                                              |         station where he was found by an ambulance.          |\n","| \"I thought it was a good idea, but I thought if we don't get |                                                              |\n","|      any points then we'll have to give up and leave.\"       | I've never seen such a horrific thing happen to a child, so  |\n","|                                                              |   I'm really sorry for this incident and my family's loss.   |\n","|  That's how they did it. That's how they do things now. Th   |  We're all devastated and saddened by this news, but we are  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m the ball went    |   Rangers. They were winning 2-0, but then\u001b[0m the news broke    |\n","|   to a goalkeeper and he hit it home from behind. I'm sure   |   that a pair of players had been arrested on suspicion of   |\n","|   there are many other stories like this, but I think the    |  raping a girl in their home. I knew something was up and I  |\n","| story is that his dad had just been sent off by his manager  |  called my dad to tell him about it. He told me he'd heard   |\n","|  at the time and was asked to play in an away game against   | that there had been some sort of sexual assault on two boys  |\n","| Cardiff City. He said 'no', so he went back to his own team, |     at the same time, but didn't know what it was about.     |\n","|               and when they came back with a 3               |                                                              |\n","|                                                              |         I've never seen anything like this before i          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went down    |   Rangers. They were winning 2-0, but then\u001b[0m they went down    |\n","| to a 1-0 defeat at Huddersfield Town. I think that's what it | to a 2-1 defeat to the Whitehaven Saints. The match was not  |\n","|   was like to watch them play, and I'm glad that they did.   |          very exciting, but it was fun nonetheless.          |\n","|                                                              |                                                              |\n","|  It was a great day for me as well as the fans of the club   |  I'm sure that this is one of those games where you get to   |\n","|     and I'm sure it will be remembered by all who saw it     |   see some pretty interesting stuff and then the game ends   |\n","|  tonight. It's always good to see people celebrating their   | with a win or two for the Rangers. I'm not sure what I would |\n","|                           team or                            |      have done differently if I had known about this ev      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went down    |   Rangers. They were winning 2-0, but then\u001b[0m they went down    |\n","| to 3-1 and I thought, 'Well, that's not going to happen.' So |   to 3-1 and I thought, 'Well this is going to be a great    |\n","|  I started thinking about it. It's a great team. We've got   |                            game'.                            |\n","| some really good players here and we're very good at getting |                                                              |\n","|                           points.\"                           |  It's a great feeling. It's not like I'm saying it will be   |\n","|                                                              | the best game of my life, but it's something that we're all  |\n","|  \"I think the first thing you have to do is be patient with  | going to have to deal with. We'll have our own expectations  |\n","|     yourself,\" he added. \"You can't let your emotions g      |      and we'll all have our own expectations as well. W      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went on to   |    Rangers. They were winning 2-0, but then\u001b[0m they lost to     |\n","|   win 3-1. I had a few beers with him and he said \"You're    | Wolves. The next day I got a call from my son that he was in |\n","| going to be fine.\" I thought it was hilarious that the kids  |    trouble with the club and had to be taken away by the     |\n","|    in the team are laughing at me now, but it's not funny    |  Rangers staff. He was taken off the pitch and sent home by  |\n","|                           anymore.                           | his parents, who have since been removed from their home. I  |\n","|                                                              | asked him if he would like to go back to school, but he said |\n","|  I think it's funny because when you have a team like that,  |                   no, so I asked him if h                    |\n","|    you have no idea what they're doing. They've got their    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|     Rangers. They were winning 2-0, but then\u001b[0m I heard the     |   Rangers. They were winning 2-0, but then\u001b[0m I heard a story   |\n","|   news that their team had won a league game and had been    |  about an old man who had been killed by a cat. He was very  |\n","| promoted to the Premier League. I was absolutely devastated  |      ill and had to be taken to hospital where he died.      |\n","|                            by it.                            |                                                              |\n","|                                                              |   He had been playing with his family in the mountains of    |\n","|  I'm not sure what happened to him, but he's still going to  | north Wales when he went missing and when he got back home,  |\n","| play football at his school in Liverpool. It's sad, but it's |   it happened that his father's wife died from an unknown    |\n","|   all right with me now because I know he'll be back soon    |    cause. It is believed that she has passed away in her     |\n","|           enough for his senior season of football           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m they lost 3-1    |    Rangers. They were winning 2-0, but then\u001b[0m they lost to     |\n","|    to the St. Louis Blues. The game had been played in a     |            Swansea City in the League Cup final.             |\n","| friendly, and I didn't know if I could get out of it or not. |                                                              |\n","|                                                              | I asked him what he thought about the game and he said that  |\n","|  My son is a little shy and he is always talking about his   |  it was very difficult to play against a team that has been  |\n","|  dad's game, but it was clear that his dad was really proud  | relegated from the Premier League since 2012. I asked him if |\n","|  of him as well as the team. He wanted to see what he coul   |    he thought it would be a good thing for his son to be     |\n","|                                                              |  playing football at such an important time of his life. He  |\n","|                                                              |                      replied: \"I think                       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=50,\n","    act_name=3,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday my son was playing football for Beckley Rangers. They were winning 2-0, but then\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4nWNPox2LSwy","executionInfo":{"status":"ok","timestamp":1689518966672,"user_tz":-60,"elapsed":16358,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"bfdddd90-4d7f-42b0-f132-808ba0d7a713"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m I heard a noise   |    Rangers. They were winning 2-0, but then\u001b[0m the Welsh and    |\n","|                  and thought \"Oh, it's me\".                  |  Scottish Premiership went into chaos. I asked him what he   |\n","|                                                              |  thought about it and he told me that it was a very sad day  |\n","|   I went to the park and saw that they had a huge crowd of   | for the club. He also said that they had lost their two top  |\n","|  about 30 people. It was amazing how many people there were  |  players to cancer so I asked him if he would be willing to  |\n","| at the game. The only thing I can remember is that everyone  |                 play in a World Cup or not.                  |\n","| was wearing black shirts with their names on them, and when  |                                                              |\n","| I asked if they were wearing black shirts or white shirts it |     He said that his wife, Louise, who is an artist and      |\n","|                           just sai                           |                          musician,                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m I heard that     |   Rangers. They were winning 2-0, but then\u001b[0m I heard that a    |\n","| the boys had a new coach and he was going to take over from  |  couple of the members of the band were having a nightmare   |\n","|        David Moyes. I didn't know what to make of it.        | and wanted to leave. So I called them up and told them that  |\n","|                                                              |           I would be staying in England with them.           |\n","| \"I thought it was a good idea, but I thought if we don't get |                                                              |\n","|      any points then we'll have to give up and leave.\"       |  They said they had no idea what was going on, so they went  |\n","|                                                              |   back to their hotel and there they found me sitting at a   |\n","|  That's how they did it. That's how they do things now. Th   |   table with an older man who had been working for Beckley   |\n","|                                                              |                         Rangers for                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m the ball went    |   Rangers. They were winning 2-0, but then\u001b[0m a bad storm hit   |\n","|   to a goalkeeper and he hit it home from behind. I'm sure   | the Isles and I lost my dad to it. He was fine until he died |\n","|   there are many other stories like this, but I think the    |                of old age in a car accident.                 |\n","| story is that his dad had just been sent off by his manager  |                                                              |\n","|  at the time and was asked to play in an away game against   |    My father's death is still under investigation by the     |\n","| Cardiff City. He said 'no', so he went back to his own team, |  Scottish Government and I am sure that there will be more   |\n","|               and when they came back with a 3               |   details to come soon about his life as we await further    |\n","|                                                              | developments on his fate. My only hope is that he will find  |\n","|                                                              |                    peace in Scotland, or                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went down    |    Rangers. They were winning 2-0, but then\u001b[0m they lost 3-1    |\n","| to a 1-0 defeat at Huddersfield Town. I think that's what it | to the Auldrail in the first leg of their League of Legends  |\n","|   was like to watch them play, and I'm glad that they did.   |    Championship. The Rangers had been relegated from the     |\n","|                                                              |  Champions League and lost to Lothlórien's Dragons. I think  |\n","|  It was a great day for me as well as the fans of the club   |    that was when I heard about this new team called Clan     |\n","|     and I'm sure it will be remembered by all who saw it     | Vampiric Witches, which is a Witch with a magical power that |\n","|  tonight. It's always good to see people celebrating their   |          can heal wounds and even save souls. It's           |\n","|                           team or                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went down    |    Rangers. They were winning 2-0, but then\u001b[0m they lost to     |\n","| to 3-1 and I thought, 'Well, that's not going to happen.' So | their neighbours the North Sea Kingdom of the East Sea and I |\n","|  I started thinking about it. It's a great team. We've got   |   saw them again. I thought it was strange that this is a    |\n","| some really good players here and we're very good at getting |     Welshman's game, but when he played it looked like a     |\n","|                           points.\"                           |                       Welshman's game.                       |\n","|                                                              |                                                              |\n","|  \"I think the first thing you have to do is be patient with  |  It was only on one occasion that I saw a Welshman play in   |\n","|     yourself,\" he added. \"You can't let your emotions g      |    his home country and it seemed as if he had an English    |\n","|                                                              |                 accent. But after seeing him                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|   Rangers. They were winning 2-0, but then\u001b[0m they went on to   |    Rangers. They were winning 2-0, but then\u001b[0m they lost to     |\n","|   win 3-1. I had a few beers with him and he said \"You're    | St. Mary's in the final of the Scottish Cup. I told him that |\n","| going to be fine.\" I thought it was hilarious that the kids  |   if he played well he could play for them again and that    |\n","|    in the team are laughing at me now, but it's not funny    |  would be good news for us as we look to rebuild our squad   |\n","|                           anymore.                           |      and keep up with the progress of our young people.      |\n","|                                                              |                                                              |\n","|  I think it's funny because when you have a team like that,  |   My son has been a very good player and I am very pleased   |\n","|    you have no idea what they're doing. They've got their    |   with his performance this season, especially since he is   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|     Rangers. They were winning 2-0, but then\u001b[0m I heard the     |     Rangers. They were winning 2-0, but then\u001b[0m the weather     |\n","|   news that their team had won a league game and had been    |        turned into a nightmare and I lost my vision.         |\n","| promoted to the Premier League. I was absolutely devastated  |                                                              |\n","|                            by it.                            | I had to go to the hospital with a broken leg and it took me |\n","|                                                              | two days to recover. It was so bad that I could not sleep at |\n","|  I'm not sure what happened to him, but he's still going to  |  all. My mum had been there for about two weeks and we had   |\n","| play football at his school in Liverpool. It's sad, but it's | never met before, but she told me that her daughter was very |\n","|   all right with me now because I know he'll be back soon    |             ill and would be out of work in thr              |\n","|           enough for his senior season of football           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|      \u001b[1mYesterday my son was playing football for Beckley       |      \u001b[1mYesterday my son was playing football for Beckley       |\n","|    Rangers. They were winning 2-0, but then\u001b[0m they lost 3-1    |    Rangers. They were winning 2-0, but then\u001b[0m they lost to     |\n","|    to the St. Louis Blues. The game had been played in a     |            Leeds United in the League Cup final.             |\n","| friendly, and I didn't know if I could get out of it or not. |                                                              |\n","|                                                              | I asked him what he thought about the game and he said that  |\n","|  My son is a little shy and he is always talking about his   | it was good to see them win. He also said that if you are a  |\n","|  dad's game, but it was clear that his dad was really proud  | Rangers fan you will be delighted with their performance and |\n","|  of him as well as the team. He wanted to see what he coul   |             I would love to see them win again.              |\n","|                                                              |                                                              |\n","|                                                              |  He told me that there is a great deal of excitement around  |\n","|                                                              |                     Celtic's new home a                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["## GPT-2 XL Test"],"metadata":{"id":"roVyhrq0Jxcb"}},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=60,\n","    act_name=6,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"In the cup final, Liverpool were winning 2-1. Then,\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"gmtsP2EHZ7xE","executionInfo":{"status":"ok","timestamp":1689508008168,"user_tz":-60,"elapsed":52251,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"5498e90c-f5c0-410f-b9e2-b646f5692063"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","| with five minutes left to play, Steven Gerrard scored a hat- |  in the last minute of play, there was a stoppage and I was  |\n","|              trick to give Liverpool a 3-2 win.              |                  trying to get a shot off.                   |\n","|                                                              |                                                              |\n","|  But it was not just Gerrard's hat-trick that won the game   |           \"I thought it was a goal but it wasn't.\"           |\n","|       for Liverpool – it was his performance as well.        |                                                              |\n","|                                                              |    When asked if he had any regrets about his performance    |\n","|     He made two key passes in the first half that set up     |         against United, he said: \"No. I don't think          |\n","| Coutinho and Sturridge for chances and he also had an assist |                      so.\"<|endoftext|>                       |\n","|                            on Ra                             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|   with 15 minutes left to play, a brilliant counter-attack   | I saw the ref go to the other side of the field and he waved |\n","|   from Chelsea led to the goal that would seal their first   |                   his hand in front of us.                   |\n","|                      title in 40 years.                      |                                                              |\n","|                                                              |         \"You can't see it,\" he said. \"It's a goal.\"          |\n","|    It was an incredible moment for Liverpool and a great     |                                                              |\n","|  example of how to win football matches. But it also showed  | That was when we were winning 2-1. Then, I saw him wave his  |\n","| how much work remains for Brendan Rodgers' side as they try  |  hand in front of us and that was when we were losing 2-1.   |\n","|   to get back into the Champions League places after being   |                       That's how it w                        |\n","|               knocked out by Bayern Munich las               |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|  in the 83rd minute, Raheem Sterling scored a stunning goal  | the ball went out of play and it was like we had lost. It's  |\n","| to give Liverpool a 3-2 lead. The game was over and the Reds |                 very difficult to explain.\"                  |\n","|                   had won it on penalties.                   |                                                              |\n","|                                                              |  Liverpool's players are also in disagreement with referee   |\n","| But what if Sterling had not scored? What if Steven Gerrard  |   Michael Lillen over the penalty that led to Luis Suarez    |\n","| hadn't been sent off? What if Luis Suarez hadn't scored his  |        being sent off against Aston Villa on Sunday.         |\n","|   hat trick? Would we have seen that same match played out   |                                                              |\n","|                      again this season?                      |   The Liverpool manager Brendan Rodgers believes his side    |\n","|                                                              |    deserved a penalty for an apparent handball by Daniel     |\n","|                                                              |                 Pethriel after he was brough                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|                   suddenly, they weren't.                    |          they got a penalty and the game was over.           |\n","|                                                              |                                                              |\n","|  It was a match that was expected to be a close one between  |     The ref said he didn't see anything wrong with what      |\n","|  two sides who had both struggled for form in recent weeks.  |   happened. He didn't know if it was a penalty or not. He    |\n","| But as the game progressed and Liverpool began to find their | couldn't tell you whether it was a goal or not because there |\n","|   feet again, it became clear that this was going to be an   | were no linesmen on the field. So he just said that it's an  |\n","| epic battle between two teams with very different styles of  |        FA decision and that's how it ended up being.\"        |\n","|                            play.                             |                                                              |\n","|                                                              |                                                              |\n","|   Liverpool were playing a high pressing game which involv   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|                   suddenly, they lost 3-2.                   |  they got a penalty and the ball was in the air for a long   |\n","|                                                              |   time. And then, it was very close to being an own goal.\"   |\n","|    The reason for this is simple: Liverpool's defence was    |                                                              |\n","| porous and sloppy. The first goal came from a throw in that  |  The BBC's David Mundel has been tracking this match since   |\n","| was poorly cleared by Jordan Henderson; the second came from |  its inception: \"The opening half hour was one of the most   |\n","|   a long ball into the box that Daniel Sturridge couldn't    | exciting of any FA Cup final in recent years with both sides |\n","|   control and allowed Simon Mignolet to make an easy save.   |  fighting for control of the game. But after some excellent  |\n","|                                                              |                             play                             |\n","|                   It wasn't just one or tw                   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|   after a period of time when they were clearly the better   |   at the end of the game, I think it was 1-1. It's a very    |\n","|            side, Liverpool's performance changed.            |                       strange thing.\"                        |\n","|                                                              |   ...and what did he think about his team's first goal? \"I   |\n","|   It was as if they had been hit by a wave of fatigue and    |   don't know if it was a goal or not. It's hard to tell.\"    |\n","| pressure. They started to lose their shape and make mistakes |   So how did you feel when you saw that your team had won?   |\n","|  in possession. The goal that brought them back into it was  |            \"I'm very happy for my players and for            |\n","|   scored by Luis Suarez with an absolute screamer from 25    |                                                              |\n","|  yards out that left everyone in disbelief. It was the bes   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|    with 15 minutes left to play, they conceded a penalty.    |          in the second half, they were losing 2-1.           |\n","|                                                              |                                                              |\n","|   The ball was played into the box by Raheem Sterling and    |   \"I think it's a game that you should never lose,\" Klopp    |\n","| Sturridge stepped up to take it. He had no chance of scoring |   said. \"It's not about what happened before or after the    |\n","| and instead went down under the challenge of Martin Skrtel.  |                            game.\"                            |\n","| The referee pointed to the spot and Liverpool's chances were |                                                              |\n","|                            gone.                             |  Klopp also said he was surprised by his team's performance  |\n","|                                                              | in their first match of the season against Crystal Palace on |\n","|      It was a harsh decision but one that would have b       |   Sunday night. The Reds had lost their opening two games    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","| after just four minutes of play, the game was over. The ball |  at the end of the game, I was standing there and they were  |\n","|  had been kicked out to Coutinho and he had gone on a mazy   |           celebrating. It was a beautiful moment.\"           |\n","|  run into the box. He then played a beautiful through ball   |                                                              |\n","| for Firmino who was unmarked at the far post and he finished |  It's a very interesting story and it seems to be something  |\n","|    with an emphatic strike into the bottom corner of Petr    |  that has been going on for quite some time now. There have  |\n","| Cech's net to give Liverpool their first league title in 25  |  been various stories about this being a common occurrence   |\n","|                            years                             |   over the years but it seems that things have gotten even   |\n","|                                                              |         more out of hand in recent times as we've s          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"HGSCUMMUhuKN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=200,\n","    act_name=15,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"In the cup final, Liverpool were winning 2-1. Then,\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689508287368,"user_tz":-60,"elapsed":52467,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"ec7f6a09-395c-414a-c130-de6785fdb7a4","id":"aymDwoYAhueQ"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","| with five minutes left to play, Steven Gerrard scored a hat- |          in the second half, they were losing 2-2.           |\n","|              trick to give Liverpool a 3-2 win.              |   herwala (s) 3/4 jaltei #fukherwas #fukherwas #fukherwas    |\n","|                                                              |   pic.twitter.to... @rohher_1 pic.twitter.to... @rohher_1    |\n","|  But it was not just Gerrard's hat-trick that won the game   |               pic.twitter.to... @rohher_1 1? A               |\n","|       for Liverpool – it was his performance as well.        |                                                              |\n","|                                                              |                                                              |\n","|     He made two key passes in the first half that set up     |                                                              |\n","| Coutinho and Sturridge for chances and he also had an assist |                                                              |\n","|                            on Ra                             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|   with 15 minutes left to play, a brilliant counter-attack   | at the same time, their two-goal lead over the second-from-  |\n","|   from Chelsea led to the goal that would seal their first   |        herself Portland side was being whittled away.        |\n","|                      title in 40 years.                      |                             ...                              |\n","|                                                              | The LA Galaxy's next quest is to defeat a fellow who will be |\n","|    It was an incredible moment for Liverpool and a great     |  spending this weekend in Portland. And that means that LA   |\n","|  example of how to win football matches. But it also showed  |   will be facing a very powerful foe in their next game as   |\n","| how much work remains for Brendan Rodgers' side as they try  |  well. And that means we'll have to wait until Sunday nigh   |\n","|   to get back into the Champions League places after being   |                                                              |\n","|               knocked out by Bayern Munich las               |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|  in the 83rd minute, Raheem Sterling scored a stunning goal  |               a little bit of magic happened.                |\n","| to give Liverpool a 3-2 lead. The game was over and the Reds |                         ...who knew?                         |\n","|                   had won it on penalties.                   |                                                              |\n","|                                                              |                  ...what a lovely surprise!                  |\n","| But what if Sterling had not scored? What if Steven Gerrard  |                                                              |\n","| hadn't been sent off? What if Luis Suarez hadn't scored his  |           ...who knows what's going to happen now?           |\n","|   hat trick? Would we have seen that same match played out   |   I think this is gonna be really cool!  ...wait, what are   |\n","|                      again this season?                      |                         they doing?!                         |\n","|                                                              |   Oh my goodness!  I donu do mean good news and bad news at  |\n","|                                                              |                            once!                             |\n","|                                                              |              What a great idea!!  I love that                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|                   suddenly, they weren't.                    |                     suddenly, they lost.                     |\n","|                                                              |                   entroheri aiói boraquai?                   |\n","|  It was a match that was expected to be a close one between  |                                                              |\n","|  two sides who had both struggled for form in recent weeks.  |        ? ? ?                                                 |\n","| But as the game progressed and Liverpool began to find their |                    _____ _______ ______ __ __ ___ _ __ __ _  |\n","|   feet again, it became clear that this was going to be an   |          __ _______ /_ -_ -_ -_/ -- /__/ -- /--/ --          |\n","| epic battle between two teams with very different styles of  |                                                              |\n","|                            play.                             |                                                              |\n","|                                                              |                                                              |\n","|   Liverpool were playing a high pressing game which involv   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|                   suddenly, they lost 3-2.                   |                 suddenly, they were losing.                  |\n","|                                                              |  herself to a spell of bad luck and then some good luck in   |\n","|    The reason for this is simple: Liverpool's defence was    |   the second half and it was all good. I think that's what   |\n","| porous and sloppy. The first goal came from a throw in that  |                   happened here tonight.\"                    |\n","| was poorly cleared by Jordan Henderson; the second came from |                     LIVE FROM THE RIS...                     |\n","|   a long ball into the box that Daniel Sturridge couldn't    |  And we're back with a little bit of something very special  |\n","|   control and allowed Simon Mignolet to make an easy save.   | as we bring you the full match between Liverpool and United  |\n","|                                                              |           . The last time these two teams met was            |\n","|                   It wasn't just one or tw                   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|   after a period of time when they were clearly the better   | just before the second of those goals, an interesting change |\n","|            side, Liverpool's performance changed.            |                          occurred.                           |\n","|                                                              | f her own side, Liverpool were losing 2-2. And then they won |\n","|   It was as if they had been hit by a wave of fatigue and    |                          it again.                           |\n","| pressure. They started to lose their shape and make mistakes |  And that's when the magic happened:  a third goal from one  |\n","|  in possession. The goal that brought them back into it was  | of Liverpool's own players! The first goal came from Gerrard |\n","|   scored by Luis Suarez with an absolute screamer from 25    | , who was also in the lead with his second . And then it was |\n","|  yards out that left everyone in disbelief. It was the bes   |                 another Reds player who scor                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|    with 15 minutes left to play, they conceded a penalty.    |          in the second half, they were losing 2-2.           |\n","|                                                              | ...and that's how we got a second of excellent football from |\n","|   The ball was played into the box by Raheem Sterling and    | our lovely team of our very own with their very own side to  |\n","| Sturridge stepped up to take it. He had no chance of scoring |  get us a third with their very own side to get us a fourth  |\n","| and instead went down under the challenge of Martin Skrtel.  | with their very own side to get them a fifth with their very |\n","| The referee pointed to the spot and Liverpool's chances were |  own side to get them a sixth with their very own side to g  |\n","|                            gone.                             |                                                              |\n","|                                                              |                                                              |\n","|      It was a harsh decision but one that would have b       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","| after just four minutes of play, the game was over. The ball |   just before the second half began, a bl of good fortune    |\n","|  had been kicked out to Coutinho and he had gone on a mazy   |                          happened.                           |\n","|  run into the box. He then played a beautiful through ball   |                       ...who was that?                       |\n","| for Firmino who was unmarked at the far post and he finished |  A young man who had not been seen in the game's first half  |\n","|    with an emphatic strike into the bottom corner of Petr    | was now on screen. He was making his way to a gate where he  |\n","| Cech's net to give Liverpool their first league title in 25  |   would meet with his team-mates and fans at this time. He   |\n","|                            years                             |   would soon be heading to the game's second gate where he   |\n","|                                                              |                     would meet with his                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=300,\n","    act_name=20,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"In the cup final, Liverpool were winning 2-1. Then,\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EFbFZ67diE0A","executionInfo":{"status":"ok","timestamp":1689508339670,"user_tz":-60,"elapsed":52328,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"55ece921-3a9f-4482-c613-363855912443"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","| with five minutes left to play, Steven Gerrard scored a hat- | the score of that game was changed to a much more dangerous  |\n","|              trick to give Liverpool a 3-2 win.              |                            game.                             |\n","|                                                              |  led to a very dangerous game in which one of the teams was  |\n","|  But it was not just Gerrard's hat-trick that won the game   |    forced to play with one side of its own. This is what     |\n","|       for Liverpool – it was his performance as well.        |              happened in this match betweenand               |\n","|                                                              |  herself! A very dangerous game for both teams and it was a  |\n","|     He made two key passes in the first half that set up     | shame that it took this big fight from the referee to put an |\n","| Coutinho and Sturridge for chances and he also had an assist |                end to this dangerous situati                 |\n","|                            on Ra                             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|   with 15 minutes left to play, a brilliant counter-attack   |   in a bizarre and hilarious twist, the referee decided to   |\n","|   from Chelsea led to the goal that would seal their first   |                  make an extra brave move.                   |\n","|                      title in 40 years.                      | questions ancient dark? vry old vvro? where is this game of  |\n","|                                                              |  mine and what is that goal of yours? oh dear! what are you  |\n","|    It was an incredible moment for Liverpool and a great     |   doing with my ref?? oh no i am not sorry i will never be   |\n","|  example of how to win football matches. But it also showed  | sorry now i have won a fabulous game by which I also rescued |\n","| how much work remains for Brendan Rodgers' side as they try  |                           my very                            |\n","|   to get back into the Champions League places after being   |                                                              |\n","|               knocked out by Bayern Munich las               |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|  in the 83rd minute, Raheem Sterling scored a stunning goal  | a little while later, there was a sudden change in the score |\n","| to give Liverpool a 3-2 lead. The game was over and the Reds | of the match. The score changed from one team to another and |\n","|                   had won it on penalties.                   |             it was a completely different game.              |\n","|                                                              |  her self-taught goal she gave to her friend as well as her  |\n","| But what if Sterling had not scored? What if Steven Gerrard  |  good friend also got her win and that is why I decided to   |\n","| hadn't been sent off? What if Luis Suarez hadn't scored his  |  write this article about this wonderful and very important  |\n","|   hat trick? Would we have seen that same match played out   |                            game.                             |\n","|                      again this season?                      |                          The Game:                           |\n","|                                                              |                              Th                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|                   suddenly, they weren't.                    | suddenly, they found themselves in a one-guokey contest with |\n","|                                                              |                   the mighty Ancient One.                    |\n","|  It was a match that was expected to be a close one between  |   questions about whether or not Liverpool's first team is   |\n","|  two sides who had both struggled for form in recent weeks.  | actually losing its mind? Well that was pretty much the case |\n","| But as the game progressed and Liverpool began to find their |  as this match began. So we decided to take a look at what   |\n","|   feet again, it became clear that this was going to be an   |  exactly happened and how it all went wrong for our beloved  |\n","| epic battle between two teams with very different styles of  |      lids. Here are some of the things that happened a       |\n","|                            play.                             |                                                              |\n","|                                                              |                                                              |\n","|   Liverpool were playing a high pressing game which involv   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|                   suddenly, they lost 3-2.                   |  suddenly, they had to play a game with the first of these   |\n","|                                                              |            teams. And then again with that team.             |\n","|    The reason for this is simple: Liverpool's defence was    |                          questions                           |\n","| porous and sloppy. The first goal came from a throw in that  |   How did we get to this point?  Why did we have to play two |\n","| was poorly cleared by Jordan Henderson; the second came from |  games?  How much was this game really worth?  What is this  |\n","|   a long ball into the box that Daniel Sturridge couldn't    |         game about and why does it matter so much?           |\n","|   control and allowed Simon Mignolet to make an easy save.   |         The only thing that really matters is that w         |\n","|                                                              |                                                              |\n","|                   It wasn't just one or tw                   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|   after a period of time when they were clearly the better   | at the very beginning of the second game, a very interesting |\n","|            side, Liverpool's performance changed.            |                        game started.                         |\n","|                                                              |  her and a beautiful ball from her was being guarded by her  |\n","|   It was as if they had been hit by a wave of fatigue and    |  self-towed guard. But in this game, she was playing with a  |\n","| pressure. They started to lose their shape and make mistakes |  big blue thing that had been replying to all of my tweets   |\n","|  in possession. The goal that brought them back into it was  |                    for me since day one.                     |\n","|   scored by Luis Suarez with an absolute screamer from 25    |  I could not really see what was going on but I could hear   |\n","|  yards out that left everyone in disbelief. It was the bes   |                        what was going                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","|    with 15 minutes left to play, they conceded a penalty.    | the score of the first game was changed to a very different  |\n","|                                                              |                            game.                             |\n","|   The ball was played into the box by Raheem Sterling and    | herself? What is that about? That's what I wanted to say! I  |\n","| Sturridge stepped up to take it. He had no chance of scoring |   don herself? What is that about? That's what I wanted to   |\n","| and instead went down under the challenge of Martin Skrtel.  |                             say!                             |\n","| The referee pointed to the spot and Liverpool's chances were |  I don and'o really know how much time we have left in this  |\n","|                            gone.                             |  match. It was like a good story with two bad sides in this  |\n","|                                                              |                            match                             |\n","|      It was a harsh decision but one that would have b       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |     \u001b[1mIn the cup final, Liverpool were winning 2-1. Then,\u001b[0m      |\n","| after just four minutes of play, the game was over. The ball | at the start of the second game, a funny and very disturbing |\n","|  had been kicked out to Coutinho and he had gone on a mazy   |     sign appeared on one of the teams' first two games.      |\n","|  run into the box. He then played a beautiful through ball   |  and a little thing called \"time\". The game was being played |\n","| for Firmino who was unmarked at the far post and he finished |   in a world where goals from an even more important place   |\n","|    with an emphatic strike into the bottom corner of Petr    |  than usual was not only not always good news but also that  |\n","| Cech's net to give Liverpool their first league title in 25  |   it could be lost to something as simple as a bad luck or   |\n","|                            years                             |                           mistake.                           |\n","|                                                              |                           A young                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"uNwfrJzKjDGw"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=23,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lRapJDlyfeOU","executionInfo":{"status":"ok","timestamp":1689507680961,"user_tz":-60,"elapsed":51400,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"9238e94a-7817-46b1-b45b-f8852ec9a317"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |   he\u001b[0m turned to me and said, \"Dad, I'm going to be a great    |\n","| unconscious for about 15 minutes. I got him to the hospital  |                        quarterback.\"                         |\n","|    and they did some tests on him and found that he had a    |      and that's when I knew that my son would be a great     |\n","|                         concussion.                          |                         quarterback.                         |\n","|                                                              |                                                              |\n","|   I'm not sure what happened but I know that it wasn't his   |    in the first half of the game. He had no idea what was    |\n","|  fault. He's been in football since he was 3 years old and   |  going on or how it worked. He just knew he wanted to play   |\n","|        has never had any concussions before this one.        |  football and didn't know how it worked or why he was being  |\n","|                                                              |                       given the ball.                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |                 he\u001b[0m stopped and looked at me.                 |\n","|  the hospital where they gave him an IV and told me that he  |   -What's wrong? -He asked. -I'm not supposed to be doing    |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |   that? -He said. He then proceeded to explain how he was    |\n","|                                                              |  being told by his coaches that if he did not kick the ball  |\n","| My son's father is a physician in our community who has been |   in the direction of his team's goal, they would have to    |\n","|    practicing medicine for over 30 years. He's worked in     |   forfeit the game and I needed to stop him from doing so    |\n","|   hospitals all over the country and has seen his share of   |                       because it was a                       |\n","|                     tragedies like this                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |   he\u001b[0m and his friends were in the middle of a tackle game.    |\n","| serious injuries. I'm asking for help to pay for his medical |  Then, they were playing soccer with each other. And then,   |\n","|    bills and the funeral expenses of his parents who were    |                they all went to bed together.                |\n","|                   killed in this accident.                   | ...and then I woke up to find that my son had gone missing!  |\n","|                                                              |   I have been searching for him since then and have found    |\n","|                                                              |  nothing but confusion on how this happened! My husband is   |\n","|   I am trying to raise $10,000 to cover all of his medical   |        also very confused as well as the rest of our         |\n","|  bills and funeral expenses so that he can get back on his   |                                                              |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |   he\u001b[0m noticed something strange: the ball was not always in   |\n","|  mom and dad who were looking for him. They took him to the  |   the center of the field. It would sometimes be at an odd   |\n","| hospital where he is currently being treated for hypothermia |                            angle.                            |\n","|                       and dehydration.                       |    ancient texts and ancient wisdom say that if you have a   |\n","|                                                              | ball that is not in the center of your field, then it's not  |\n","| The story is heartbreaking, but it's also a reminder that we |         in alignment with your team's line of play.          |\n","|    need to be vigilant about keeping our kids safe in the    |   I asked him what this meant and he said \"that means I'm    |\n","|        woods. It's easy to get caught up in all of th        |                        getting ready                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |   he\u001b[0m noticed something strange: He was playing with a ball   |\n","|   now, but it's still scary to think about what could have   | that had been sitting in the grass for an hour. It was cold  |\n","| happened if he had been playing in the street instead of on  |                           and wet.                           |\n","|                        his own turf.                         |   ancient-pcs-v1/public/images/champion_ball_2.jpg The ball  |\n","|                                                              |    had been sitting in the grass for an hour and it still    |\n","|   The other day I was watching a video of one of my son's    | wasn't cold or wet? This is not how I like to play football! |\n","|   friends play football with his little brother. They were   |                             How                              |\n","|  both 6 years old and were running around like crazy trying  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |   he\u001b[0m stopped to take a break from the game and look at the   |\n","| watched him do this for a few minutes before I noticed that  |                           weather.                           |\n","| he was bleeding from his penis. He was bleeding so much that |   in his left hand he held a ball that was covered in snow.  |\n","|      it looked like blood had been drawn from his body.      | In his right hand he held an umbrella that had no cover over |\n","|                                                              |  it. I knew this would be very important when I told him to  |\n","|  I went to get him help immediately, but when I got there,   |  hold onto the ball with one hand while looking at the sky   |\n","| the doctor told me that it would be too late to save him. H  |       with the other. He did so and looked up into th        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |        he\u001b[0m turned to me and said \"I don't like this.\"         |\n","|    the hospital and is now in stable condition. I'm very     |   lost a bet on the outcome of the game. He had bet on our   |\n","|   thankful that he's alive and has been released from the    | team to win. I didn't know what he meant by that but it made |\n","|                          hospital.                           |   me feel bad because I had no idea how much money he was    |\n","|                                                              |  losing on that one game. I looked at him and said \"What's   |\n","| I'm also thankful that this happened on a Sunday afternoon,  |               wrong?\" He told me that he coul                |\n","|  when kids are out of school and parents are more likely to  |                                                              |\n","|   be at home with their children than they would be on any   |                                                              |\n","|                          other day                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |                 he\u001b[0m stopped and looked at me.                 |\n","|                                                              |         - \"Dad, I'm not supposed to be doing that.\"          |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |                    - \"What do you mean?\"                     |\n","|                                                              |            - \"I'm not supposed to be doing that.\"            |\n","| He took off his helmet and put it on the ground. He put his  |                         - \"Why not?\"                         |\n","|   hands in the air and started to run around like a little   |  He then went on to explain that he was told by his coaches  |\n","| kid. I could tell he was excited about playing soccer again  | (and the coaches of all the other boys in his class) that if |\n","|   after being away from it for so long. He ran around like   |                       he didn't do wha                       |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=50,\n","    act_name=3,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"uqqxiUOAggw8","executionInfo":{"status":"ok","timestamp":1689507790963,"user_tz":-60,"elapsed":52137,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"82acd99c-b7bd-44e6-cc9a-d6692cb2b09e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |     he\u001b[0m went to the bathroom and came back with a bloody      |\n","| unconscious for about 15 minutes. I got him to the hospital  |  nose. He said he got it from a teammate. I asked him if he  |\n","|    and they did some tests on him and found that he had a    | got it from his teammate or someone else? He said no one of  |\n","|                         concussion.                          | his teammate. I asked him if anyone else? He said no one of  |\n","|                                                              |                        his teammates                         |\n","|   I'm not sure what happened but I know that it wasn't his   |                                                              |\n","|  fault. He's been in football since he was 3 years old and   |  I'm not sure what to do now because we have 2 boys in the   |\n","|        has never had any concussions before this one.        |                same age that play football a                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |    he\u001b[0m went to the bathroom and came back. He then went to    |\n","|  the hospital where they gave him an IV and told me that he  | the kitchen and came back. Then, he went to the bathroom and |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |                          came back.                          |\n","|                                                              |                                                              |\n","| My son's father is a physician in our community who has been | He then got up from his seat in the toilet and walked out of |\n","|    practicing medicine for over 30 years. He's worked in     | his room on his bed on his floor on his carpeted floored in  |\n","|   hospitals all over the country and has seen his share of   | front of my bedroom door in front of my bedroom door outside |\n","|                     tragedies like this                      |           my bedroom door outside my closet inside           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |   he\u001b[0m said to me: \"Dad, I'm going to kick that ball.\" And I   |\n","| serious injuries. I'm asking for help to pay for his medical | said: \"You're not going to kick that ball. You're not going  |\n","|    bills and the funeral expenses of his parents who were    |       to kick it.\" And he said: \"Dad, I'm kicking it.\"       |\n","|                   killed in this accident.                   |                                                              |\n","|                                                              | And then we went back and he had the football game again and |\n","|                                                              |   we played with him. He's a very good kid and he's very g   |\n","|   I am trying to raise $10,000 to cover all of his medical   |                                                              |\n","|  bills and funeral expenses so that he can get back on his   |                                                              |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |      he\u001b[0m ran into the street and hit a car. The car was       |\n","|  mom and dad who were looking for him. They took him to the  |  totaled. I'm very upset about this accident. He's not even  |\n","| hospital where he is currently being treated for hypothermia |                  old enough to drive yet.\"                   |\n","|                       and dehydration.                       |                                                              |\n","|                                                              |  The mother said she spoke with her son's teacher and that   |\n","| The story is heartbreaking, but it's also a reminder that we | day, but no action was taken by the school or district. She  |\n","|    need to be vigilant about keeping our kids safe in the    |   said she is also upset about the driver who hit her son    |\n","|        woods. It's easy to get caught up in all of th        |            while driving on a sidewalk on his way            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |     he\u001b[0m ran into the wall and hit his head on the ground.     |\n","|   now, but it's still scary to think about what could have   |  He's in critical condition right now. I'm so scared right   |\n","| happened if he had been playing in the street instead of on  |    now! I'm so scared! He's not breathing... My son is in    |\n","|                        his own turf.                         |  critical condition...I just want to die.. Please help me..  |\n","|                                                              |  please help me..Please help me please i don't let him die   |\n","|   The other day I was watching a video of one of my son's    |       please help me i need to die!!please give him li       |\n","|   friends play football with his little brother. They were   |                                                              |\n","|  both 6 years old and were running around like crazy trying  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |    he\u001b[0m fell over and hit his head on the ground. I went to    |\n","| watched him do this for a few minutes before I noticed that  | check on him and he was unconscious. He has a black eye mark |\n","| he was bleeding from his penis. He was bleeding so much that |                     under his left eye.\"                     |\n","|      it looked like blood had been drawn from his body.      |                                                              |\n","|                                                              | The man then told the officer that \"he had been drinking and |\n","|  I went to get him help immediately, but when I got there,   |                         that night.\"                         |\n","| the doctor told me that it would be too late to save him. H  |                                                              |\n","|                                                              |   \"I don't know what to do,\" the officer replied. \"I'm not   |\n","|                                                              |       sure if you can just take him in for an ambulanc       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |    he\u001b[0m went to the bathroom and came back. He was holding     |\n","|    the hospital and is now in stable condition. I'm very     |  his hand with his other hand in his pants. I said \"What's   |\n","|   thankful that he's alive and has been released from the    |  wrong?\" He said \"I'm sorry.\" I said \"What did you do?\" He   |\n","|                          hospital.                           |  said \"I kicked a ball.\" I said\"Did you do it?\"He says\"No,   |\n","|                                                              |          no,\" he says\"He says\"No, no,\" he says\"Yes           |\n","| I'm also thankful that this happened on a Sunday afternoon,  |                                                              |\n","|  when kids are out of school and parents are more likely to  |                                                              |\n","|   be at home with their children than they would be on any   |                                                              |\n","|                          other day                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |      he\u001b[0m fell down and hit his head on the ground. I was      |\n","|                                                              | really scared because I knew that he would be in pain for a  |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |  long time. He is not only my son but also has to take care  |\n","|                                                              | of his mother who is also a diabetic and also has diabetes.  |\n","| He took off his helmet and put it on the ground. He put his  |                                                              |\n","|   hands in the air and started to run around like a little   |  I called an ambulance immediately after the game ended but  |\n","| kid. I could tell he was excited about playing soccer again  | they couldn't get there to help until later that night when  |\n","|   after being away from it for so long. He ran around like   |                            I had                             |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["## Here is a story prompt"],"metadata":{"id":"TTIrNNAgjE6I"}},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=20,\n","    act_name=2,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-TIanrk8jOTO","executionInfo":{"status":"ok","timestamp":1689508529506,"user_tz":-60,"elapsed":51540,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"c62bb63a-e846-4a2e-f6b2-d3ee6b93b8c5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |  \"In the fall of 2010, I was living in the U.S. and working  |\n","|  Francisco. She had been there for about two years, and was  | as a graphic designer for a digital agency in New York City. |\n","|   pretty good at her job. She loved the customers, and she   |    One day, I got an email from my friend who works at a     |\n","|  loved the food. She also loved to talk to them, and that's  | company called A&E Networks (now part of A+E Networks). She  |\n","|  what she did when she got off work at about 6pm on Friday   |   said that she had seen my work on Facebook and wanted to   |\n","|                            night.                            |                      know if I would b                       |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |      \u001b[1mHere is a story:\u001b[0m I am not a doctor, but I do know       |\n","|                                                              | that the human body has two organs. The heart and the liver. |\n","|  I was sitting in the back of a cab, my hands folded on my   | They are both very important to our health. The liver helps  |\n","|   lap, when I noticed a man sitting next to me. He had his   |     us metabolize food, and it also keeps our blood from     |\n","|   hands in his pockets and was looking at something on his   |   clotting too much when we get sick. So, in order to keep   |\n","| phone. He didn't say anything to me but I could tell he was  |    your blood from clotting too much, you need to have a     |\n","| looking at something that made him uncomfortable. It wasn't  |                        healthy liver.                        |\n","|       until he looked up that I realized what it was.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |         \u001b[1mHere is a story:\u001b[0mA friend of mine, who was an         |\n","|                                                              |  engineer in the oil industry, came to my house one day and  |\n","| In the early 1970s, I was working at a company that produced | told me that he had been given a contract to work on the oil |\n","| toys for children. One day, my boss came into my office and  | rigs. He said that they were drilling in an area where there |\n","| asked me to come up with a new toy. He wanted something that |   was a lot of oil and gas. The job would be temporary and   |\n","|  would appeal to boys but be equally appealing to girls. He  | would last for two months. I asked him what he thought about |\n","| said he wanted something \"girl-friendly.\" I thought about it |                       it, because I di                       |\n","|            for a moment and then said, \"What if w            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |      \u001b[1mHere is a story:\u001b[0m The real reason why the New York       |\n","| drink. He takes his drink and goes to the bathroom. When he  |   Times doesn't want to publish a book about Donald Trump.   |\n","| comes out, he is wearing a hat with an American flag on it.  |                                                              |\n","| The bartender says, \"You know what? I think you should take  | The author, David Cay Johnston, is an investigative reporter |\n","|                          that off.\"                          |       who has written for the New York Times and other       |\n","|                                                              | publications. He was recently granted access to Trump's tax  |\n","|     The man says, \"I'm not going to take that off.\" The      |                     returns by the IRS.                      |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","|                                                              |  The IRS has not released any of Trump's tax returns since   |\n","|                                                              |            2005 because he was under audit at th             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |     \u001b[1mHere is a story:\u001b[0m The day after the massacre, in the      |\n","| of Chicago, and he wants to buy a house. He goes to the bank | morning, I went to work. It was my first day on the job. And |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | I was very nervous. I had just been told that there had been |\n","|                    any houses for sale.\"                     |  a massacre at Columbine High School and that two of my co-  |\n","|                                                              | workers were dead and one of them was seriously injured. And |\n","|         Frank says, \"Well then you should have one!\"         |   then we learned that one of our own students had killed    |\n","|                                                              |                     himself with his ow                      |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                                                              |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |      \u001b[1mHere is a story:\u001b[0m \"I was born in the wrong body. I       |\n","| New York City. I had been to New York before, but this time  | have been living as a man for over 20 years. I am now in my  |\n","|     it was different. It was my first time in the city's     |    late 40s and have never had any sexual experience with    |\n","|  Chinatown and one of the most beautiful places I have ever  |                        another man.\"                         |\n","|                            seen.                             |                                                              |\n","|                                                              | And here is another story: \"I was born in the wrong body. I  |\n","|  I had heard about the famous Chinatowns of China, but they  |  have been living as a woman for over 20 years. I am now in  |\n","|   were not what I expected. The Chinese were friendly and    |                 my early 50s and have never                  |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |  A man was walking in the woods, when he saw a large black   |\n","| large group of people playing cards. He approached them and  |  cat. He thought it was a wild animal and ran away. But the  |\n","|   asked if they were playing poker. They said no, but that   |     cat followed him for some distance and then suddenly     |\n","| they were just playing cards. He asked again, and this time  |   attacked him. The man managed to escape, but the cat had   |\n","| the group replied \"No, we are not playing poker.\" This made  |  been badly injured by his claws. The man took it home and   |\n","|  him curious so he asked them again. They said yes, but tha  | gave it some food and water to help recover from its wounds. |\n","|                                                              |                            After                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |      \u001b[1mHere is a story:\u001b[0m \"The Black Widow is the first and      |\n","|   Haines, who was the leader of a group called the \"Dirty    |  only female member of the elite Soviet Special Forces. She  |\n","| Dozen,\" was arrested for killing his wife and her lover. The |  has been in active service for more than 20 years, and her  |\n","|   story goes that he had been drinking heavily, and after    |    duties include espionage, sabotage, reconnaissance and    |\n","| having sex with his wife in the morning, he shot her in the  |    special operations. Her main job is to eliminate enemy    |\n","| head while she slept. He then took a .22 caliber pistol from |                           agents.\"                           |\n","|                      their bedside tabl                      |                                                              |\n","|                                                              |  The story goes on to say that \"the Black Widow was born in  |\n","|                                                              |        Leningrad in 1943 as Natasha Romanova. She joi        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=50,\n","    act_name=2,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model, }\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aTshU1NxpWAD","executionInfo":{"status":"ok","timestamp":1689510108504,"user_tz":-60,"elapsed":56646,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"77137919-eef2-483e-f13f-6507d70b4c82"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |     \u001b[1mHere is a story:\u001b[0mThe BBC is running a story about the     |\n","|                                                              | great Russian novelist and poet, Fyra. I don't know if he's  |\n","|     A woman named Amy was working at a restaurant in San     |    still alive or not, but he was born in 1778. Here's a     |\n","|  Francisco. She had been there for about two years, and was  |  picture of him:Here's another picture of him:I'm also some  |\n","|   pretty good at her job. She loved the customers, and she   |  news about his book \"A video of his poems (the video):and   |\n","|  loved the food. She also loved to talk to them, and that's  |           here are some pictures of him (the firs            |\n","|  what she did when she got off work at about 6pm on Friday   |                                                              |\n","|                            night.                            |                                                              |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              | http://www.newsvine.com/story/23277573/my-dreams-of-journey- |\n","|  I was sitting in the back of a cab, my hands folded on my   | virginia-sportsbookwriter/20140126?play=true&video=truePlay= |\n","|   lap, when I noticed a man sitting next to me. He had his   | true&play=true&video=falsePlay=false&video=falsePlay=\"\"Video |\n","|   hands in his pockets and was looking at something on his   |           =\"http://www.youtube.com/embed/?version_           |\n","| phone. He didn't say anything to me but I could tell he was  |                                                              |\n","| looking at something that made him uncomfortable. It wasn't  |                                                              |\n","|       until he looked up that I realized what it was.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |        \u001b[1mHere is a story:\u001b[0mA friend of mine, who has been        |\n","|                                                              |  playing since beta, recently got married. He had to leave   |\n","| In the early 1970s, I was working at a company that produced |  the game because he was having a baby. He told me that he   |\n","| toys for children. One day, my boss came into my office and  |  had played the game for about 10 hours per day and it was   |\n","| asked me to come up with a new toy. He wanted something that | really hard on him and he could not being able to play for 5 |\n","|  would appeal to boys but be equally appealing to girls. He  |  hours per day or so it was very hard on his wife said she   |\n","| said he wanted something \"girl-friendly.\" I thought about it |                   wanted to play with him                    |\n","|            for a moment and then said, \"What if w            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| drink. He takes his drink and goes to the bathroom. When he  |   https://www.theguardian.com/world/2017/sep/01/23/nathan-   |\n","| comes out, he is wearing a hat with an American flag on it.  |   lancaster-fans-andrewildanislamourstory Here is a story:   |\n","| The bartender says, \"You know what? I think you should take  | https://www.theguardian.com/?/?s=andrewrites_andrewritehere  |\n","|                          that off.\"                          |        is a story: http://sportsdailynews.com/?s=ands        |\n","|                                                              |                                                              |\n","|     The man says, \"I'm not going to take that off.\" The      |                                                              |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| of Chicago, and he wants to buy a house. He goes to the bank | https://www.youtube.com/watch?v=_W5qYmKUc Here is a story: h |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | ttps://www.youtube.com/watch?v=_w4w=w=V2Lz4l2o2o3+1o3L3Ml+1M |\n","|                    any houses for sale.\"                     |                        tL0+1#JT@hG@R                         |\n","|                                                              |                                                              |\n","|         Frank says, \"Well then you should have one!\"         |                                                              |\n","|                                                              |                                                              |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                                                              |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| New York City. I had been to New York before, but this time  | http://www.baltamoreblaze.com/news/story/2014-05-07/ As for  |\n","|     it was different. It was my first time in the city's     | the USATMUSATMATTMATTGOLDWEDARKETOWNUSATLIGHTEDLIGHTEDIAMENO |\n","|  Chinatown and one of the most beautiful places I have ever  |       TEMITEMPOWERWESTOREDIONSOLSTORESTORESTOREDOn the       |\n","|                            seen.                             |                       USPoweredMTMTNEG                       |\n","|                                                              |                                                              |\n","|  I had heard about the famous Chinatowns of China, but they  |                                                              |\n","|   were not what I expected. The Chinese were friendly and    |                                                              |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |       \u001b[1mHere is a story:\u001b[0mThe site is also full of stories       |\n","|                                                              | about how the website was shut down. The site was shut down  |\n","|   A man was walking his dog on the beach when he noticed a   | by the day after it launched. Here are some of them:And here |\n","| large group of people playing cards. He approached them and  |     are some more stories about how the website was shut     |\n","|   asked if they were playing poker. They said no, but that   |  down:Here are some more stories about how the website was   |\n","| they were just playing cards. He asked again, and this time  |    shutdown and here are some more stories about why it's    |\n","| the group replied \"No, we are not playing poker.\" This made  |  shutdown and here is a story from when they were shutting   |\n","|  him curious so he asked them again. They said yes, but tha  |                             dow                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|   Haines, who was the leader of a group called the \"Dirty    | http://www.mynews.../news/2013/09/27/story-1 Here is a story |\n","| Dozen,\" was arrested for killing his wife and her lover. The |  about the game: http://www.mynews...njour newsmagazine, it  |\n","|   story goes that he had been drinking heavily, and after    | was posted on the first edition of this month's been posted  |\n","| having sex with his wife in the morning, he shot her in the  |   on the second edition of this month, and here are three    |\n","| head while she slept. He then took a .22 caliber pistol from |     stories about the game, all have been posted on our      |\n","|                      their bedside tabl                      |                          newsmagazi                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=30,\n","    act_name=8,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"G-O2tZtCrIey","executionInfo":{"status":"ok","timestamp":1689510574882,"user_tz":-60,"elapsed":52231,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"aaf6279e-27d2-48c0-a890-3ed43423ec5d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |              \"The Boy Who Was Raised as a Dog\"               |\n","|  Francisco. She had been there for about two years, and was  |                                                              |\n","|   pretty good at her job. She loved the customers, and she   |              by William H. Leastes, Jr. (1895)               |\n","|  loved the food. She also loved to talk to them, and that's  |                                                              |\n","|  what she did when she got off work at about 6pm on Friday   |                                                              |\n","|                            night.                            | It was in the spring of 1891 that I first met my friend Mr.  |\n","|                                                              |   O'Brien, and I am sure he will not be surprised to learn   |\n","|             She had been talking with one of her             | that I was born in 1869. The date is so near the present as  |\n","|                                                              |                             to b                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   | A man walks into a bar. He orders a drink. He sits down. He  |\n","|   lap, when I noticed a man sitting next to me. He had his   |                 gets up and leaves the bar.                  |\n","|   hands in his pockets and was looking at something on his   |                                                              |\n","| phone. He didn't say anything to me but I could tell he was  |     The bartender looks at him, confused, and asks \"What     |\n","| looking at something that made him uncomfortable. It wasn't  |   happened?\" The man replies \"I don't know.\" The bartender   |\n","|       until he looked up that I realized what it was.        |  then asks \"What did you order?\" The man replies \"A beer.\"   |\n","|                                                              |          The bartender then says \"No, I'm sorry, w           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |    I was in my office at work when I heard the sound of a    |\n","| toys for children. One day, my boss came into my office and  | gunshot. I immediately thought it was my co-worker, but then |\n","| asked me to come up with a new toy. He wanted something that |   realized that it wasn't. The sound came from outside my    |\n","|  would appeal to boys but be equally appealing to girls. He  | office window. I looked out and saw a young man standing on  |\n","| said he wanted something \"girl-friendly.\" I thought about it |   the street, holding what appeared to be an AK-47 assault   |\n","|            for a moment and then said, \"What if w            |     rifle. He was shooting at cars as they drove by him      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| drink. He takes his drink and goes to the bathroom. When he  |                                                              |\n","| comes out, he is wearing a hat with an American flag on it.  |  I am a big fan of this series. I love the characters, the   |\n","| The bartender says, \"You know what? I think you should take  | writing, and I really enjoy watching it. However, I have to  |\n","|                          that off.\"                          |   say that there are some things that bother me about this   |\n","|                                                              |  series. The first thing is how many times the show repeats  |\n","|     The man says, \"I'm not going to take that off.\" The      | itself. It seems like every episode has a new plot point and |\n","|                  bartender says, \"Why not?\"                  | character development for one or more of the main characters |\n","|                                                              |                         (except for                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| of Chicago, and he wants to buy a house. He goes to the bank |                                                              |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | A young woman, who was not even a virgin, had an affair with |\n","|                    any houses for sale.\"                     |  her boss. She went to his house and he gave her the money   |\n","|                                                              |  she needed to get back home. She went back home and slept   |\n","|         Frank says, \"Well then you should have one!\"         | with him. The next day she told him that she had an abortion |\n","|                                                              | because of the affair. He was furious and fired her from his |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                             job.                             |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                   This story is very comm                    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| New York City. I had been to New York before, but this time  |                                                              |\n","|     it was different. It was my first time in the city's     | A woman in her 30s was driving on the highway when she saw a |\n","|  Chinatown and one of the most beautiful places I have ever  |  man in his 20s sitting on the side of the road. She pulled  |\n","|                            seen.                             |  over and asked him if he needed help. He told her that he   |\n","|                                                              |   had been hit by a car and that he was bleeding from his    |\n","|  I had heard about the famous Chinatowns of China, but they  | head. The woman called 911, but as she waited for police to  |\n","|   were not what I expected. The Chinese were friendly and    |               arrive, she realized that the ma               |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |   A man was walking his dog on the beach when he noticed a   |\n","| large group of people playing cards. He approached them and  | large black cat in the water. He walked closer and saw that  |\n","|   asked if they were playing poker. They said no, but that   |     it was a cougar. He took off running, but the cougar     |\n","| they were just playing cards. He asked again, and this time  |  followed him and jumped into the water. The man got out of  |\n","| the group replied \"No, we are not playing poker.\" This made  |      his car and ran to get help from nearby residents.      |\n","|  him curious so he asked them again. They said yes, but tha  |                                                              |\n","|                                                              |        The next day, he returned to find that the ca         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|   Haines, who was the leader of a group called the \"Dirty    |                                                              |\n","| Dozen,\" was arrested for killing his wife and her lover. The | A couple of years ago, I was in a conversation with my wife  |\n","|   story goes that he had been drinking heavily, and after    | about the new iPhone. We were talking about how it was great |\n","| having sex with his wife in the morning, he shot her in the  |   that we could take our photos on the go and not have to    |\n","| head while she slept. He then took a .22 caliber pistol from |  worry about having to get up from our desks or out of bed.  |\n","|                      their bedside tabl                      |     She said she wished she had an iPhone 5 when she got     |\n","|                                                              |                           married.                           |\n","|                                                              |                                                              |\n","|                                                              |                I asked her why and she said \"                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=60,\n","    act_name=8,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VVNDu7qhrWMr","executionInfo":{"status":"ok","timestamp":1689510653555,"user_tz":-60,"elapsed":55421,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"4ad7011b-ff0e-488d-cad9-f10b1f84e6de"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |  \"In the late 1960s, in an effort to bring the civil rights  |\n","|  Francisco. She had been there for about two years, and was  |  movement to the South, President Lyndon B. Johnson signed   |\n","|   pretty good at her job. She loved the customers, and she   |  into law a measure that prohibited discrimination against   |\n","|  loved the food. She also loved to talk to them, and that's  |     African-Americans in public accommodations. In 1970,     |\n","|  what she did when she got off work at about 6pm on Friday   |    Congress passed another bill that made it illegal for     |\n","|                            night.                            |  private businesses to discriminate against anyone based on  |\n","|                                                              |                       race or color.\"                        |\n","|             She had been talking with one of her             |                                                              |\n","|                                                              |          So I guess this is what you call \"the War           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   | A man walks into a bar. He orders a drink. He sits down. He  |\n","|   lap, when I noticed a man sitting next to me. He had his   | looks around the room and notices that there are no women in |\n","|   hands in his pockets and was looking at something on his   | the room. The bartender comes over to him and says, \"Hey, I  |\n","| phone. He didn't say anything to me but I could tell he was  | know you're here for some reason.\" The man replies, \"No, I'm |\n","| looking at something that made him uncomfortable. It wasn't  | here because I don't want to be bothered by any women.\" The  |\n","|       until he looked up that I realized what it was.        |                         bartender th                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |  A man was walking along the beach when he noticed a woman   |\n","| toys for children. One day, my boss came into my office and  | sitting on the sand. He asked her if she needed help and she |\n","| asked me to come up with a new toy. He wanted something that |   said no. The man walked away and then saw another woman    |\n","|  would appeal to boys but be equally appealing to girls. He  |   sitting on the same spot. This time, he asked her if she   |\n","| said he wanted something \"girl-friendly.\" I thought about it |  needed help and she said yes. She started to walk away but  |\n","|            for a moment and then said, \"What if w            | stopped at the edge of the beach where there was a little bi |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| drink. He takes his drink and goes to the bathroom. When he  |                                                              |\n","| comes out, he is wearing a hat with an American flag on it.  |  A woman was driving her car on the highway when she saw a   |\n","| The bartender says, \"You know what? I think you should take  | deer crossing the road. She stopped her car and called 911.  |\n","|                          that off.\"                          |  The dispatcher told her to stay put, but she kept driving   |\n","|                                                              |  because she wanted to get pictures of the deer. When they   |\n","|     The man says, \"I'm not going to take that off.\" The      |  arrived at the scene, they found that it was a young buck   |\n","|                  bartender says, \"Why not?\"                  |   with its antlers cut off and bleeding from its side. The   |\n","|                                                              |                          driver ha                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| of Chicago, and he wants to buy a house. He goes to the bank |                                                              |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |    A young woman, who was not her own daughter, had been     |\n","|                    any houses for sale.\"                     | kidnapped by the police and then raped. She was later found  |\n","|                                                              | dead in a field. The police were investigating the case when |\n","|         Frank says, \"Well then you should have one!\"         | they found out that she had been married to another man and  |\n","|                                                              |  that he was also being investigated for rape. They decided  |\n","|  The banker replies, \"I'm sorry but I don't have any houses  | to arrest him too. But they did not know that he had already |\n","|                          for sale.\"                          |                   confessed to raping her                    |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| New York City. I had been to New York before, but this time  |                                                              |\n","|     it was different. It was my first time in the city's     | A young man was walking home from a party when he noticed a  |\n","|  Chinatown and one of the most beautiful places I have ever  |  large group of people gathered around an intersection. He   |\n","|                            seen.                             | looked to his left and saw two girls, one of whom was in the |\n","|                                                              |  middle of kissing another girl. The other girl turned her   |\n","|  I had heard about the famous Chinatowns of China, but they  | head and saw him looking at her. She smiled and said \"I like |\n","|   were not what I expected. The Chinese were friendly and    | you.\" The guy stopped walking, turned around, walked back to |\n","|                           helpful,                           |                              th                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |   A man who had been in a car accident was found dead. The   |\n","| large group of people playing cards. He approached them and  |   police were called and the medical examiner came to the    |\n","|   asked if they were playing poker. They said no, but that   |   scene. The man's name was given as Paul Caffrey, but he    |\n","| they were just playing cards. He asked again, and this time  |  didn't have any identification on him. He had been in the   |\n","| the group replied \"No, we are not playing poker.\" This made  |   car with his wife, who was also injured in the accident.   |\n","|  him curious so he asked them again. They said yes, but tha  |   They were both taken to a hospital where they died. Ther   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|   Haines, who was the leader of a group called the \"Dirty    |                                                              |\n","| Dozen,\" was arrested for killing his wife and her lover. The | A woman named Alice was on her way to work one day when she  |\n","|   story goes that he had been drinking heavily, and after    | noticed a man walking in the opposite direction. She was not |\n","| having sex with his wife in the morning, he shot her in the  |    sure if he was lost or just having an odd day, but she    |\n","| head while she slept. He then took a .22 caliber pistol from | decided to give him a friendly wave. He stopped and gave her |\n","|                      their bedside tabl                      |                  a smile, then walked away.                  |\n","|                                                              |                                                              |\n","|                                                              |   Alice went home and told her husband about the encounter   |\n","|                                                              |                 with the stranger, who happ                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=90,\n","    act_name=8,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":496},"id":"M3me-BtyrevU","executionInfo":{"status":"error","timestamp":1689510696248,"user_tz":-60,"elapsed":40762,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"d54ac157-0b5c-470a-8eca-2b599a475353"},"execution_count":null,"outputs":[{"output_type":"error","ename":"KeyboardInterrupt","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-31-409e3f9a932f>\u001b[0m in \u001b[0;36m<cell line: 16>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     14\u001b[0m \u001b[0mdefault_kwargs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m'temperature'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'freq_penalty'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'top_p'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;36m.3\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'model'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     15\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 16\u001b[0;31m print_n_comparisons(prompt=\"Here is a story:\",\n\u001b[0m\u001b[1;32m     17\u001b[0m                     \u001b[0mtokens_to_generate\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m80\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mactivation_additions\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mactivation_addition_dataset\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     18\u001b[0m                     num_comparisons=8, seed=0, **default_kwargs)\n","\u001b[0;32m<decorator-gen-122>\u001b[0m in \u001b[0;36mprint_n_comparisons\u001b[0;34m(prompt, model, num_comparisons, log, activation_additions, addition_location, res_stream_slice, **kwargs)\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/logging.py\u001b[0m in \u001b[0;36m_loggable\u001b[0;34m(func, *args, **kwargs)\u001b[0m\n\u001b[1;32m    193\u001b[0m     \u001b[0;31m# Check if we should log\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    194\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mlog\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 195\u001b[0;31m         \u001b[0mfunc_return\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    196\u001b[0m     \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    197\u001b[0m         \u001b[0;31m# Process the log argument, extract logging-related arguments if\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/completion_utils.py\u001b[0m in \u001b[0;36mprint_n_comparisons\u001b[0;34m(prompt, model, num_comparisons, log, activation_additions, addition_location, res_stream_slice, **kwargs)\u001b[0m\n\u001b[1;32m    404\u001b[0m     \u001b[0;31m# Generate the completions from the modified model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    405\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mactivation_additions\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 406\u001b[0;31m         mod_df: pd.DataFrame = gen_using_activation_additions(\n\u001b[0m\u001b[1;32m    407\u001b[0m             \u001b[0mprompt_batch\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mprompt_batch\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    408\u001b[0m             \u001b[0mmodel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<decorator-gen-121>\u001b[0m in \u001b[0;36mgen_using_activation_additions\u001b[0;34m(model, activation_additions, log, addition_location, res_stream_slice, **kwargs)\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/logging.py\u001b[0m in \u001b[0;36m_loggable\u001b[0;34m(func, *args, **kwargs)\u001b[0m\n\u001b[1;32m    193\u001b[0m     \u001b[0;31m# Check if we should log\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    194\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mlog\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 195\u001b[0;31m         \u001b[0mfunc_return\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    196\u001b[0m     \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    197\u001b[0m         \u001b[0;31m# Process the log argument, extract logging-related arguments if\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/completion_utils.py\u001b[0m in \u001b[0;36mgen_using_activation_additions\u001b[0;34m(model, activation_additions, log, addition_location, res_stream_slice, **kwargs)\u001b[0m\n\u001b[1;32m    241\u001b[0m     hook_fns: Dict[\n\u001b[1;32m    242\u001b[0m         \u001b[0mstr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mList\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mCallable\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 243\u001b[0;31m     \u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhook_utils\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhook_fns_from_activation_additions\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    244\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    245\u001b[0m         \u001b[0mactivation_additions\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mactivation_additions\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/hook_utils.py\u001b[0m in \u001b[0;36mhook_fns_from_activation_additions\u001b[0;34m(model, activation_additions, **kwargs)\u001b[0m\n\u001b[1;32m    327\u001b[0m     activation_dict: Dict[\n\u001b[1;32m    328\u001b[0m         \u001b[0mstr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mList\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mFloat\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTensor\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"batch pos d_model\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 329\u001b[0;31m     ] = get_activation_dict(model, activation_additions)\n\u001b[0m\u001b[1;32m    330\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    331\u001b[0m     \u001b[0;31m# Make the hook functions\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/hook_utils.py\u001b[0m in \u001b[0;36mget_activation_dict\u001b[0;34m(model, activation_additions)\u001b[0m\n\u001b[1;32m     70\u001b[0m             \u001b[0;32melif\u001b[0m \u001b[0mactivation_addition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfrom_difference\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     71\u001b[0m                 activation_dict[activation_addition.act_name].append(\n\u001b[0;32m---> 72\u001b[0;31m                     \u001b[0mget_dataset_activations_difference\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mactivation_addition\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     73\u001b[0m                 )\n\u001b[1;32m     74\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/dataset_utils.py\u001b[0m in \u001b[0;36mget_dataset_activations_difference\u001b[0;34m(model, activation_addition)\u001b[0m\n\u001b[1;32m    165\u001b[0m     \u001b[0muse_all_activations\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mactivation_addition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0muse_all_activations\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    166\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 167\u001b[0;31m     feature_vector = dataset_svd.utils.find_activations_centre_diff(\n\u001b[0m\u001b[1;32m    168\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    169\u001b[0m         \u001b[0mtarget_dataset\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtarget_dataset\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dataset_svd/utils.py\u001b[0m in \u001b[0;36mfind_activations_centre_diff\u001b[0;34m(model, target_dataset, baseline_dataset, location, max_batch_size, use_all_activations)\u001b[0m\n\u001b[1;32m    456\u001b[0m   )\n\u001b[1;32m    457\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 458\u001b[0;31m   baseline_target = find_activations_centre(\n\u001b[0m\u001b[1;32m    459\u001b[0m     \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    460\u001b[0m     \u001b[0mtarget_dataset\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dataset_svd/utils.py\u001b[0m in \u001b[0;36mfind_activations_centre\u001b[0;34m(model, dataset, location, max_batch_size, use_all_activations)\u001b[0m\n\u001b[1;32m    419\u001b[0m   \u001b[0mlayer\u001b[0m \u001b[0mof\u001b[0m \u001b[0ma\u001b[0m \u001b[0mcertain\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    420\u001b[0m   \"\"\"\n\u001b[0;32m--> 421\u001b[0;31m   all_activations = dataset_activations_optimised_new(\n\u001b[0m\u001b[1;32m    422\u001b[0m     \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    423\u001b[0m     \u001b[0mdataset\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dataset_svd/utils.py\u001b[0m in \u001b[0;36mdataset_activations_optimised_new\u001b[0;34m(model, dataset, location, max_batch_size, use_all_activations)\u001b[0m\n\u001b[1;32m    188\u001b[0m     \u001b[0;31m# print(batch_tokens)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    189\u001b[0m     \u001b[0;31m# Feed the tensor through the model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 190\u001b[0;31m     \u001b[0m_\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcache\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrun_with_cache\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbatch_tokens\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mreturn_cache_object\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mremove_batch_dim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    191\u001b[0m     \u001b[0mactivations\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcache\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mlocation\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    192\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0muse_all_activations\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformer_lens/HookedTransformer.py\u001b[0m in \u001b[0;36mrun_with_cache\u001b[0;34m(self, return_cache_object, remove_batch_dim, *model_args, **kwargs)\u001b[0m\n\u001b[1;32m    404\u001b[0m         \u001b[0mWrapper\u001b[0m \u001b[0maround\u001b[0m \u001b[0mrun_with_cache\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mHookedRootModule\u001b[0m\u001b[0;34m.\u001b[0m \u001b[0mIf\u001b[0m \u001b[0mreturn_cache_object\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mthis\u001b[0m \u001b[0mwill\u001b[0m \u001b[0;32mreturn\u001b[0m \u001b[0man\u001b[0m \u001b[0mActivationCache\u001b[0m \u001b[0mobject\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mwith\u001b[0m \u001b[0ma\u001b[0m \u001b[0mbunch\u001b[0m \u001b[0mof\u001b[0m \u001b[0museful\u001b[0m \u001b[0mHookedTransformer\u001b[0m \u001b[0mspecific\u001b[0m \u001b[0mmethods\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0motherwise\u001b[0m \u001b[0mit\u001b[0m \u001b[0mwill\u001b[0m \u001b[0;32mreturn\u001b[0m \u001b[0ma\u001b[0m \u001b[0mdictionary\u001b[0m \u001b[0mof\u001b[0m \u001b[0mactivations\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mHookedRootModule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    405\u001b[0m         \"\"\"\n\u001b[0;32m--> 406\u001b[0;31m         out, cache_dict = super().run_with_cache(\n\u001b[0m\u001b[1;32m    407\u001b[0m             \u001b[0;34m*\u001b[0m\u001b[0mmodel_args\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mremove_batch_dim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mremove_batch_dim\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    408\u001b[0m         )\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformer_lens/hook_points.py\u001b[0m in \u001b[0;36mrun_with_cache\u001b[0;34m(self, names_filter, device, remove_batch_dim, incl_bwd, reset_hooks_end, clear_contexts, *model_args, **model_kwargs)\u001b[0m\n\u001b[1;32m    413\u001b[0m             \u001b[0mclear_contexts\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mclear_contexts\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    414\u001b[0m         ):\n\u001b[0;32m--> 415\u001b[0;31m             \u001b[0mmodel_out\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0mmodel_args\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mmodel_kwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    416\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mincl_bwd\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    417\u001b[0m                 \u001b[0mmodel_out\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbackward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *input, **kwargs)\u001b[0m\n\u001b[1;32m   1192\u001b[0m         if not (self._backward_hooks or self._forward_hooks or self._forward_pre_hooks or _global_backward_hooks\n\u001b[1;32m   1193\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1194\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1195\u001b[0m         \u001b[0;31m# Do not call functions when jit is used\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1196\u001b[0m         \u001b[0mfull_backward_hooks\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnon_full_backward_hooks\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformer_lens/HookedTransformer.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, input, return_type, loss_per_token, prepend_bos, stop_at_layer, past_kv_cache)\u001b[0m\n\u001b[1;32m    335\u001b[0m                 )\n\u001b[1;32m    336\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 337\u001b[0;31m             residual = block(\n\u001b[0m\u001b[1;32m    338\u001b[0m                 \u001b[0mresidual\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    339\u001b[0m                 \u001b[0mpast_kv_cache_entry\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mpast_kv_cache\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *input, **kwargs)\u001b[0m\n\u001b[1;32m   1192\u001b[0m         if not (self._backward_hooks or self._forward_hooks or self._forward_pre_hooks or _global_backward_hooks\n\u001b[1;32m   1193\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1194\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1195\u001b[0m         \u001b[0;31m# Do not call functions when jit is used\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1196\u001b[0m         \u001b[0mfull_backward_hooks\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnon_full_backward_hooks\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformer_lens/components.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, resid_pre, shortformer_pos_embed, past_kv_cache_entry)\u001b[0m\n\u001b[1;32m    832\u001b[0m                 \u001b[0mresid_pre\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0mattn_out\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    833\u001b[0m             )  # [batch, pos, d_model]\n\u001b[0;32m--> 834\u001b[0;31m             \u001b[0mnormalized_resid_mid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mln2\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mresid_mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    835\u001b[0m             mlp_out = self.hook_mlp_out(\n\u001b[1;32m    836\u001b[0m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmlp\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnormalized_resid_mid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *input, **kwargs)\u001b[0m\n\u001b[1;32m   1192\u001b[0m         if not (self._backward_hooks or self._forward_hooks or self._forward_pre_hooks or _global_backward_hooks\n\u001b[1;32m   1193\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1194\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1195\u001b[0m         \u001b[0;31m# Do not call functions when jit is used\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1196\u001b[0m         \u001b[0mfull_backward_hooks\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnon_full_backward_hooks\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformer_lens/components.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, x)\u001b[0m\n\u001b[1;32m    127\u001b[0m             \u001b[0mFloat\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTensor\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"batch pos 1\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    128\u001b[0m             \u001b[0mFloat\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTensor\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"batch pos head_index 1\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 129\u001b[0;31m         ] = self.hook_scale((x.pow(2).mean(-1, keepdim=True) + self.eps).sqrt())\n\u001b[0m\u001b[1;32m    130\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhook_normalized\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m \u001b[0;34m/\u001b[0m \u001b[0mscale\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    131\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=30,\n","    act_name=12,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PLGKdSf5r3NU","executionInfo":{"status":"ok","timestamp":1689510802954,"user_tz":-60,"elapsed":51116,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"c81c06f2-db06-477c-aef1-08a0de2ed07b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |            \"The Story of the Boy Who Cried Wolf\"             |\n","|  Francisco. She had been there for about two years, and was  |                                                              |\n","|   pretty good at her job. She loved the customers, and she   | by William R. Forstchen, Ph.D., M.A., Librarian of Congress  |\n","|  loved the food. She also loved to talk to them, and that's  |                                                              |\n","|  what she did when she got off work at about 6pm on Friday   |                                                              |\n","|                            night.                            |  (originally published in the November/December, 1971 issue  |\n","|                                                              |               of the New York Times Magazine)                |\n","|             She had been talking with one of her             |                                                              |\n","|                                                              |                                                              |\n","|                                                              |    In his book \"The Man Who Mistook His Wife for a Hat,\"     |\n","|                                                              |                  William R. Forstchen tells                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   |  A man walks into a bar. He orders a drink, and he asks for  |\n","|   lap, when I noticed a man sitting next to me. He had his   |   something to wash it down with. The bartender says, \"No    |\n","|   hands in his pockets and was looking at something on his   |   problem.\" The man takes the drink and pours it into his    |\n","| phone. He didn't say anything to me but I could tell he was  |  glass. He then looks at the bartender's face and says, \"I   |\n","| looking at something that made him uncomfortable. It wasn't  |            don't know what you're talking about.\"            |\n","|       until he looked up that I realized what it was.        |                                                              |\n","|                                                              |         The bartender turns around to look at him. \"         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |     In the year 2000, the Department of Defense had just     |\n","| toys for children. One day, my boss came into my office and  | finished developing a new stealth fighter. The aircraft was  |\n","| asked me to come up with a new toy. He wanted something that |   called the F-22 and it was to be powered by two General    |\n","|  would appeal to boys but be equally appealing to girls. He  |    Electric F119 engines. These engines were designed to     |\n","| said he wanted something \"girl-friendly.\" I thought about it | produce about 1,500 horsepower each and would be able to fly |\n","|            for a moment and then said, \"What if w            |  at Mach 2.5 or higher (2,000 miles per hour). The F-22 was  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| drink. He takes his drink and goes to the bathroom. When he  |                                                              |\n","| comes out, he is wearing a hat with an American flag on it.  |   A woman in her 20s was walking down the street with her    |\n","| The bartender says, \"You know what? I think you should take  | boyfriend when they were approached by two men. One of them  |\n","|                          that off.\"                          | asked, \"Do you know who I am?\" The other man then said, \"I'm |\n","|                                                              |                     going to fuck you.\"                      |\n","|     The man says, \"I'm not going to take that off.\" The      |                                                              |\n","|                  bartender says, \"Why not?\"                  |  The woman said she didn't know the man and that he was not  |\n","|                                                              |     wearing a mask. She tried to get away from him but h     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| of Chicago, and he wants to buy a house. He goes to the bank |                                                              |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | A young woman, who was about to be married, had a vision of  |\n","|                    any houses for sale.\"                     |  her future husband. She saw him as a man in white. He was   |\n","|                                                              |  tall and handsome with dark hair and blue eyes. She asked   |\n","|         Frank says, \"Well then you should have one!\"         |  him to marry her but he said no. The young woman's family   |\n","|                                                              |  went to the temple for an important ceremony but they were  |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |        told that the man in white was not there. They        |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| New York City. I had been to New York before, but this time  |                                                              |\n","|     it was different. It was my first time in the city's     |   A young man was walking home from a party when he saw a    |\n","|  Chinatown and one of the most beautiful places I have ever  | group of people in the street. He asked them what they were  |\n","|                            seen.                             |    doing there, and one of them said \"I'm waiting for my     |\n","|                                                              |  boyfriend.\" The young man then asked if he could help, and  |\n","|  I had heard about the famous Chinatowns of China, but they  |                   the guy replied \"sure.\"                    |\n","|   were not what I expected. The Chinese were friendly and    |                                                              |\n","|                           helpful,                           | The young man then asked the guy if he had been drinking, to |\n","|                                                              |                        which the guy                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |   A man was walking his dog on the beach when he noticed a   |\n","| large group of people playing cards. He approached them and  | large black cat in the water. He walked closer and saw that  |\n","|   asked if they were playing poker. They said no, but that   |  it was a young female cat. The man took off his shoes and   |\n","| they were just playing cards. He asked again, and this time  | ran to get help. When he got there, the man saw that the cat |\n","| the group replied \"No, we are not playing poker.\" This made  | had been hit by a car and had some serious injuries. The man |\n","|  him curious so he asked them again. They said yes, but tha  |            tried to save her but she died shortly            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|   Haines, who was the leader of a group called the \"Dirty    |                                                              |\n","| Dozen,\" was arrested for killing his wife and her lover. The |   A couple of years ago, I was on a plane to London for an   |\n","|   story goes that he had been drinking heavily, and after    | interview with the head of the International Monetary Fund.  |\n","| having sex with his wife in the morning, he shot her in the  |  I had just finished my PhD and was about to start my first  |\n","| head while she slept. He then took a .22 caliber pistol from | job as an academic. I was nervous and excited, but also very |\n","|                      their bedside tabl                      |   tired. As we landed in London, the pilot announced that    |\n","|                                                              |   there would be a delay because of weather conditions in    |\n","|                                                              |                       Ireland. The pil                       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=70,\n","    act_name=12,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NGUPO6bArkJM","executionInfo":{"status":"ok","timestamp":1689510751866,"user_tz":-60,"elapsed":53354,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"65783db6-13be-4e95-88ba-1809b6c4da39"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |    \"The tale of the ancient world, told in three parts.\"     |\n","|  Francisco. She had been there for about two years, and was  |                                                              |\n","|   pretty good at her job. She loved the customers, and she   |   The first part is about the rise of the Greeks and their   |\n","|  loved the food. She also loved to talk to them, and that's  |  great civilization. The second part tells how they fell to  |\n","|  what she did when she got off work at about 6pm on Friday   |  the barbarians and were conquered by them. The third part   |\n","|                            night.                            |     tells how they rebelled against their conquerors and     |\n","|                                                              |  defeated them. And that's it! It's all about history! But   |\n","|             She had been talking with one of her             |                        there are som                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   |    A man named Richard, who had been living in the United    |\n","|   lap, when I noticed a man sitting next to me. He had his   |  States for many years, was visiting his family in England.  |\n","|   hands in his pockets and was looking at something on his   |  He was going to visit his brother-in-law and then he would  |\n","| phone. He didn't say anything to me but I could tell he was  |  go back to the United States. But on this particular day,   |\n","| looking at something that made him uncomfortable. It wasn't  |   Richard decided that he wanted to stay in England for a    |\n","|       until he looked up that I realized what it was.        |  while longer. He went out into the street and he saw this   |\n","|                                                              |                          young woma                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced | A man was walking along the beach when he saw a woman lying  |\n","| toys for children. One day, my boss came into my office and  |  on the sand. He looked down and saw that she had been shot  |\n","| asked me to come up with a new toy. He wanted something that | in the head. He ran to her side and found her bleeding from  |\n","|  would appeal to boys but be equally appealing to girls. He  |  the wound. She was dead, but there were no signs of life.   |\n","| said he wanted something \"girl-friendly.\" I thought about it | The man picked up her purse and ran back to shore, where he  |\n","|            for a moment and then said, \"What if w            |                       called for help.                       |\n","|                                                              |                                                              |\n","|                                                              |                             The                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| drink. He takes his drink and goes to the bathroom. When he  |                                                              |\n","| comes out, he is wearing a hat with an American flag on it.  | A young man, an American citizen, was born in a hospital in  |\n","| The bartender says, \"You know what? I think you should take  |  California. He grew up in New York City and graduated from  |\n","|                          that off.\"                          |   high school there. He lived for a time in Hawaii before    |\n","|                                                              | moving to California again. And he has lived all his life in |\n","|     The man says, \"I'm not going to take that off.\" The      |                           Arizona.                           |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","|                                                              |   He is married to an American woman who was born here and   |\n","|                                                              |      raised here. They have two children together, one       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| of Chicago, and he wants to buy a house. He goes to the bank |                                                              |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | A young man, his name was Robert, was working at a hotel in  |\n","|                    any houses for sale.\"                     |  California. He had just started dating his girlfriend and   |\n","|                                                              |   they were going to have their first child. They had just   |\n","|         Frank says, \"Well then you should have one!\"         | bought the house they lived in and it was ready for them to  |\n","|                                                              | move in. The day before he went into labor, he got an email  |\n","|  The banker replies, \"I'm sorry but I don't have any houses  | from her saying that she would be gone for the weekend and h |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |                       \u001b[1mHere is a story:\u001b[0m                       |\n","| New York City. I had been to New York before, but this time  |                                                              |\n","|     it was different. It was my first time in the city's     |  A young man has been given the chance to change his life.   |\n","|  Chinatown and one of the most beautiful places I have ever  |   He's not a musician, but he's had an amazing career as a   |\n","|                            seen.                             |  professional magician. He has been performing for over 30   |\n","|                                                              |  years and now he's going to be the first person in history  |\n","|  I had heard about the famous Chinatowns of China, but they  |          to perform on stage at the Hollywood Bowl.          |\n","|   were not what I expected. The Chinese were friendly and    |                                                              |\n","|                           helpful,                           | The event will take place on Saturday, March 24th at 8pm and |\n","|                                                              |                           tickets                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |  A man who lives in a remote part of the American Southwest  |\n","| large group of people playing cards. He approached them and  | was looking for his missing son when he found something very |\n","|   asked if they were playing poker. They said no, but that   |  strange. He found a small, dead tree that had been covered  |\n","| they were just playing cards. He asked again, and this time  | with leaves and twigs. The tree had fallen from the sky, and |\n","| the group replied \"No, we are not playing poker.\" This made  |  it looked like it was dead. The man took some pictures of   |\n","|  him curious so he asked them again. They said yes, but tha  |   the scene and sent them to his son's friend who lives in   |\n","|                                                              |                           Arizona                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|   Haines, who was the leader of a group called the \"Dirty    |                                                              |\n","| Dozen,\" was arrested for killing his wife and her lover. The |  A woman named Anna, who was born in the mid-20th century,   |\n","|   story goes that he had been drinking heavily, and after    | was visiting her family in the city of Tarnóm. She went to a |\n","| having sex with his wife in the morning, he shot her in the  |  store and bought some things. When she returned home, she   |\n","| head while she slept. He then took a .22 caliber pistol from | noticed that her daughter had been taken away by police. Her |\n","|                      their bedside tabl                      | husband called the police station and asked them to come to  |\n","|                                                              |          their house. They came there with a man wh          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=28,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HcM-2v0zpYYr","executionInfo":{"status":"ok","timestamp":1689510161764,"user_tz":-60,"elapsed":51878,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"a3c27240-a34f-4be0-a8d9-a90835e9c01c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |   A young man was walking home from school one day when he   |\n","|  Francisco. She had been there for about two years, and was  | found a beautiful and very curious girl. He asked her if she |\n","|   pretty good at her job. She loved the customers, and she   |    would like to play with him, but she said no. He then     |\n","|  loved the food. She also loved to talk to them, and that's  |  decided to ask her again, but this time he was not so rude  |\n","|  what she did when she got off work at about 6pm on Friday   |  as to say no. She said yes! This happened many times over   |\n","|                            night.                            |   the next few days until they were playing together every   |\n","|                                                              |                             nigh                             |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |     \u001b[1mHere is a story:\u001b[0m A young man, who had been a student     |\n","|                                                              | at the same school as my son, was arrested for possessing an |\n","|  I was sitting in the back of a cab, my hands folded on my   |   unlicensed firearm. He was told that he would be given a   |\n","|   lap, when I noticed a man sitting next to me. He had his   | warning and that he would not be prosecuted if he agreed to  |\n","|   hands in his pockets and was looking at something on his   | sign an agreement with the police. He refused to sign it and |\n","| phone. He didn't say anything to me but I could tell he was  |    was subsequently charged with unlawful possession of a    |\n","| looking at something that made him uncomfortable. It wasn't  |                           firearm.                           |\n","|       until he looked up that I realized what it was.        |                                                              |\n","|                                                              |              He has been in custody since then,              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced | A man and his wife were walking through the woods when they  |\n","| toys for children. One day, my boss came into my office and  | came across a mysterious creature. The man tried to help the |\n","| asked me to come up with a new toy. He wanted something that |  woman, but she was not very helpful. So he decided to take  |\n","|  would appeal to boys but be equally appealing to girls. He  |  her home with him. He took her into an old abandoned house  |\n","| said he wanted something \"girl-friendly.\" I thought about it |  that was located in the woods, and told her that he would   |\n","|            for a moment and then said, \"What if w            |  take care of her for a while. He then put on some clothes   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man named Bob is a good guy. He's     |\n","| drink. He takes his drink and goes to the bathroom. When he  |  an avid gardener, he has a wife and two kids, and he loves  |\n","| comes out, he is wearing a hat with an American flag on it.  | to play golf. One day, Bob gets an email from someone called |\n","| The bartender says, \"You know what? I think you should take  |   Mark who says that they have some amazing stuff for him.   |\n","|                          that off.\"                          |  They say that they have the coolest new golf course in the  |\n","|                                                              | world – one that will be inhabited by four-leaf lizards and  |\n","|     The man says, \"I'm not going to take that off.\" The      |                             four                             |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |       \u001b[1mHere is a story:\u001b[0m A man who has lived in the same       |\n","| of Chicago, and he wants to buy a house. He goes to the bank | house for more than 30 years, but whose wife has been living |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |   there for less than a year, discovers that he is now the   |\n","|                    any houses for sale.\"                     | husband of another woman. He was married to her for only one |\n","|                                                              |                            year.                             |\n","|         Frank says, \"Well then you should have one!\"         |                                                              |\n","|                                                              | The first thing he does is to ask his wife if she knows what |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |  happened. She says no and then he goes into his closet and  |\n","|                          for sale.\"                          |                           pulls ou                           |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |      \u001b[1mHere is a story:\u001b[0m A man was arrested for allegedly       |\n","| New York City. I had been to New York before, but this time  |     stealing a woman's purse and then fleeing the scene.     |\n","|     it was different. It was my first time in the city's     |                                                              |\n","|  Chinatown and one of the most beautiful places I have ever  |  According to police, the man stole the purse from a woman   |\n","|                            seen.                             | who was walking on a street in an unknown location. He then  |\n","|                                                              |              fled from her, and she called 911.              |\n","|  I had heard about the famous Chinatowns of China, but they  |                                                              |\n","|   were not what I expected. The Chinese were friendly and    | The suspect was found hiding in an abandoned house, where he |\n","|                           helpful,                           |  claimed that he had been sleeping there all night long. He  |\n","|                                                              |                             als                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   | A man was riding his bike home one night when he saw a young |\n","| large group of people playing cards. He approached them and  |  girl walking along the road. He stopped to ask her if she   |\n","|   asked if they were playing poker. They said no, but that   |  needed help, and she told him that she was lost. He asked   |\n","| they were just playing cards. He asked again, and this time  |   her where she wanted to go, and she said \"home\". The man   |\n","| the group replied \"No, we are not playing poker.\" This made  | rode off on his bike, but not before asking her what name he |\n","|  him curious so he asked them again. They said yes, but tha  |             should give her. She replied with \"              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |       \u001b[1mHere is a story:\u001b[0m A young man named Andrew was an       |\n","|   Haines, who was the leader of a group called the \"Dirty    |  avid reader and he was working in a bookstore. One day, he  |\n","| Dozen,\" was arrested for killing his wife and her lover. The |   found an old book that he had never read before. It was    |\n","|   story goes that he had been drinking heavily, and after    |    called \"The Book of the Damsel in the Dark\". The title    |\n","| having sex with his wife in the morning, he shot her in the  |      seemed to be pretty good, so he decided to buy it.      |\n","| head while she slept. He then took a .22 caliber pistol from |                                                              |\n","|                      their bedside tabl                      |    When Andrew opened the book, it was as if someone had     |\n","|                                                              |                  flipped a page through his                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=200,\n","    act_name=28,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YjHiuMcBqO3H","executionInfo":{"status":"ok","timestamp":1689510336009,"user_tz":-60,"elapsed":54184,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"e3806eb6-10ea-432b-834b-d5a3bb56d279"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |  A young man was born in a tree. He grew up, and one day he  |\n","|  Francisco. She had been there for about two years, and was  |  decided to take his own advice and jump into the world. He  |\n","|   pretty good at her job. She loved the customers, and she   |     took off on his own, leaving behind his parents and      |\n","|  loved the food. She also loved to talk to them, and that's  |  everything they knew. He didn't know what he was going to   |\n","|  what she did when she got off work at about 6pm on Friday   |  find, but he knew that it would be awesome! So he went out  |\n","|                            night.                            |            into the world, and found an old woma             |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |     \u001b[1mHere is a story:\u001b[0m A young man, who had been a student     |\n","|                                                              | of mine, was found dead in his home. The cause of his death  |\n","|  I was sitting in the back of a cab, my hands folded on my   |  was determined to be an accident involving the misuse of a  |\n","|   lap, when I noticed a man sitting next to me. He had his   |                           firearm.                           |\n","|   hands in his pockets and was looking at something on his   |                                                              |\n","| phone. He didn't say anything to me but I could tell he was  |   I am not going to comment on the details of this case. I   |\n","| looking at something that made him uncomfortable. It wasn't  | will simply say that this young man had been an avid reader  |\n","|       until he looked up that I realized what it was.        |  and writer and I am very sorry that he lost her by such a   |\n","|                                                              |                            tragic                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced | A man and his wife were hunting in the woods when they found |\n","| toys for children. One day, my boss came into my office and  |     a magical lamp that granted them power. They were so     |\n","| asked me to come up with a new toy. He wanted something that |  powerful that they decided to use their newfound power to   |\n","|  would appeal to boys but be equally appealing to girls. He  |  help others. The husband went back to his home, but he was  |\n","| said he wanted something \"girl-friendly.\" I thought about it |  not there anymore. His wife was also gone, but she did not  |\n","|            for a moment and then said, \"What if w            |                     seem to be missing.                      |\n","|                                                              |                                                              |\n","|                                                              |          The husband and wife searched for her, bu           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man named Bob is a good guy. He's     |\n","| drink. He takes his drink and goes to the bathroom. When he  |   an avid gardener, he's a great husband and he loves his    |\n","| comes out, he is wearing a hat with an American flag on it.  | wife. One day, Bob discovers that his wife has been sleeping |\n","| The bartender says, \"You know what? I think you should take  | with another man. He doesn't know what to do about it, so he |\n","|                          that off.\"                          |  decides to help her out by going along with her plan to go  |\n","|                                                              |    shopping in the store while she goes shopping herself.    |\n","|     The man says, \"I'm not going to take that off.\" The      |                                                              |\n","|                  bartender says, \"Why not?\"                  |                              Wh                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |      \u001b[1mHere is a story:\u001b[0m A man who was arrested for being       |\n","| of Chicago, and he wants to buy a house. He goes to the bank | drunk in a car with his wife and two children has been found |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |             to be the rightful owner of the car.             |\n","|                    any houses for sale.\"                     |           /s/ I am David Flem, and I am an artist.           |\n","|                                                              |  I have worked on several projects that have required me to  |\n","|         Frank says, \"Well then you should have one!\"         | work with people who are not familiar with how things work.  |\n","|                                                              |               This is one of those projects.                 |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                           The reas                           |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |     \u001b[1mHere is a story:\u001b[0m A man was born in the 14th century      |\n","| New York City. I had been to New York before, but this time  |  and died in the 16th. He was a sailor, but he also had an   |\n","|     it was different. It was my first time in the city's     |                interesting job as a gardener.                |\n","|  Chinatown and one of the most beautiful places I have ever  |         and that's how I started to write this story.        |\n","|                            seen.                             | I have been writing for some time now, but it has been quite |\n","|                                                              | slow because of my other responsibilities. But I am finally  |\n","|  I had heard about the famous Chinatowns of China, but they  |          ready to start working on this project, s           |\n","|   were not what I expected. The Chinese were friendly and    |                                                              |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   | A man was hunting in the woods one day when he found a young |\n","| large group of people playing cards. He approached them and  | girl who had been lost for years. He brought her back to his |\n","|   asked if they were playing poker. They said no, but that   |  home and raised her as his own. He named her \"Tinker\" and   |\n","| they were just playing cards. He asked again, and this time  | raised her as a child, teaching her how to be an apprentice  |\n","| the group replied \"No, we are not playing poker.\" This made  |   to the old master of tinkling, an ancient form of magic    |\n","|  him curious so he asked them again. They said yes, but tha  |                   called the Golden Rule.                    |\n","|                                                              |                                                              |\n","|                                                              |                            Years                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |      \u001b[1mHere is a story:\u001b[0m A man who had been working in the      |\n","|   Haines, who was the leader of a group called the \"Dirty    | same job for a long time was recently hired by an employer.  |\n","| Dozen,\" was arrested for killing his wife and her lover. The |   He has been working there for about three years, and his   |\n","|   story goes that he had been drinking heavily, and after    |              boss has always treated him well.               |\n","| having sex with his wife in the morning, he shot her in the  |  in his first year of employment, he found out that the boss |\n","| head while she slept. He then took a .22 caliber pistol from | was not only very busy but also had a hard time dealing with |\n","|                      their bedside tabl                      | things. The man's work schedule changed several times, and h |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=300,\n","    act_name=28,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wrjGavpTqoTA","executionInfo":{"status":"ok","timestamp":1689510442328,"user_tz":-60,"elapsed":53806,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"8b74600a-c598-4581-e87a-7491d8a551ba"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |  in the late 1930s, an old woman named Agro was a poor lady  |\n","|     A woman named Amy was working at a restaurant in San     | who had been living in the lost kingdom of Lemp by the sea.  |\n","|  Francisco. She had been there for about two years, and was  |   One day, she found a strange book that told her about a    |\n","|   pretty good at her job. She loved the customers, and she   |  hidden world called The Island of Lost Kings. She was also  |\n","|  loved the food. She also loved to talk to them, and that's  | able to see what was inside it. She called upon her powerful |\n","|  what she did when she got off work at about 6pm on Friday   |     and mysterious powers to help her find out more abou     |\n","|                            night.                            |                                                              |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |         \u001b[1mHere is a story:\u001b[0m A young man, who had a very         |\n","|                                                              | important job in the government, was asked to take an hour-  |\n","|  I was sitting in the back of a cab, my hands folded on my   |   long detour from his duties to perform a performance of    |\n","|   lap, when I noticed a man sitting next to me. He had his   |  \"Riddle of the Night\" for an audience of about 150 people.  |\n","|   hands in his pockets and was looking at something on his   |     ist also called Riddle of the Night or Riddle by the     |\n","| phone. He didn't say anything to me but I could tell he was  | Shadow. It's one of those old-fashioned songs that you can't |\n","| looking at something that made him uncomfortable. It wasn't  |                     really find anywher                      |\n","|       until he looked up that I realized what it was.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |   A man and his wife were traveling in a small boat on the   |\n","| toys for children. One day, my boss came into my office and  |      waters of Lake Malaz/Sea of Shadows. The man was a      |\n","| asked me to come up with a new toy. He wanted something that | fisherman, and his wife was an artist. They had been fishing |\n","|  would appeal to boys but be equally appealing to girls. He  |  for about 10 years, but they were not particularly good at  |\n","| said he wanted something \"girl-friendly.\" I thought about it |  it. The husband had no fish to sell, so he needed to find   |\n","|            for a moment and then said, \"What if w            |        something else to do with his time. He went i         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man named Bob is a good guy. He's     |\n","| drink. He takes his drink and goes to the bathroom. When he  |   an avid gardener, he's a great husband and he loves his    |\n","| comes out, he is wearing a hat with an American flag on it.  | wife. One day, Bob discovers that his wife has been sleeping |\n","| The bartender says, \"You know what? I think you should take  | with another man, who she calls \"Bob\". Bob doesn't know what |\n","|                          that off.\"                          |    to do about this situation. He's also not very good at    |\n","|                                                              | keeping secrets from his wife. So he decides to tell her the |\n","|     The man says, \"I'm not going to take that off.\" The      |                            truth                             |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |     \u001b[1mHere is a story:\u001b[0m A man who was arrested for being an     |\n","| of Chicago, and he wants to buy a house. He goes to the bank | anti-fiddle and an anti-fiddle in the same day, but who was  |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |                 not charged with any crime.                  |\n","|                    any houses for sale.\"                     | , he had been arrested for having a bag of stolen fiddles in |\n","|                                                              | his possession. He was also found to be in possession of two |\n","|         Frank says, \"Well then you should have one!\"         |  large bags of stolen fiddles and two small bags of stolen   |\n","|                                                              |                fiddles. He also had two larg                 |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                                                              |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |     \u001b[1mHere is a story:\u001b[0m A man was born in the 14th century      |\n","| New York City. I had been to New York before, but this time  |  and died in the 16th. He was a musician, but he also wrote  |\n","|     it was different. It was my first time in the city's     | some very funny stories. One of them is called \"The Man Who  |\n","|  Chinatown and one of the most beautiful places I have ever  |  Sleeps\". It's about a man who has no name and no home. He   |\n","|                            seen.                             |  lives alone in an old house that's been lost to the world   |\n","|                                                              |                        for centuries.                        |\n","|  I had heard about the famous Chinatowns of China, but they  |                                                              |\n","|   were not what I expected. The Chinese were friendly and    |                  It's funny because it has                   |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |   in the last century, a man named John hermit and his wife  |\n","|   A man was walking his dog on the beach when he noticed a   |    were lost in the dark of night. They had no help from     |\n","| large group of people playing cards. He approached them and  |   anyone, and they were lost for many years. One day, they   |\n","|   asked if they were playing poker. They said no, but that   | woke up to find that they were in an old house with strange  |\n","| they were just playing cards. He asked again, and this time  | creatures that shepherled them through the night. The first  |\n","| the group replied \"No, we are not playing poker.\" This made  |     thing he did was to ask if anyone would like to play     |\n","|  him curious so he asked them again. They said yes, but tha  |                           Dungeons                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |      \u001b[1mHere is a story:\u001b[0m A man who had been working in the      |\n","|   Haines, who was the leader of a group called the \"Dirty    |    same job for a long time was asked to take a leave of     |\n","| Dozen,\" was arrested for killing his wife and her lover. The | absence. He took it, and then he found out that he would be  |\n","|   story goes that he had been drinking heavily, and after    | getting an awesome new job. He couldn't find any information |\n","| having sex with his wife in the morning, he shot her in the  |  about the new job, so he went to his boss and asked him if  |\n","| head while she slept. He then took a .22 caliber pistol from |     there was any way he could get an interview with the     |\n","|                      their bedside tabl                      |                  company. His boss said yes                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=90,\n","    act_name=15,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bERpoWzIpe5I","executionInfo":{"status":"ok","timestamp":1689510215277,"user_tz":-60,"elapsed":53520,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"cb84b54d-b9f2-4d73-b304-de4cd7758ef0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     | A young woman was traveling with her father and his friends  |\n","|  Francisco. She had been there for about two years, and was  |    on a train when they were suddenly attacked by an evil    |\n","|   pretty good at her job. She loved the customers, and she   |  being. They had to get off the train at the next station,   |\n","|  loved the food. She also loved to talk to them, and that's  |  but as they did so, the evil being began to make a lot of   |\n","|  what she did when she got off work at about 6pm on Friday   |   noise. The young woman was afraid that this noise would    |\n","|                            night.                            |  attract more people and she began to panic. She called out  |\n","|                                                              |                      for help from her                       |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   |  One day, while on a trip to the US, I stopped by the local  |\n","|   lap, when I noticed a man sitting next to me. He had his   | supermarket and picked up some eggs. The eggs were good, but |\n","|   hands in his pockets and was looking at something on his   |    they had this weird smell that I couldn't quite put my    |\n","| phone. He didn't say anything to me but I could tell he was  | finger on. I thought maybe it was just something in the egg  |\n","| looking at something that made him uncomfortable. It wasn't  |    itself that was making me sick, but then I remembered     |\n","|       until he looked up that I realized what it was.        | something else about this trip: The last time we visited our |\n","|                                                              |                             hom                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |   One day, while exploring the woods near his home, a man    |\n","| toys for children. One day, my boss came into my office and  |  found an old journal that he thought was lost. It was full  |\n","| asked me to come up with a new toy. He wanted something that |  of intriguing information about the ancient world and the   |\n","|  would appeal to boys but be equally appealing to girls. He  |   creatures that lived there. He also found an interesting   |\n","| said he wanted something \"girl-friendly.\" I thought about it |  piece of paper in it. It had been written by an old woman   |\n","|            for a moment and then said, \"What if w            | who lived in what seems to be a very modern-looking house on |\n","|                                                              |                        top of a hill.                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |      \u001b[1mHere is a story:\u001b[0m A young woman named Anselma, who       |\n","| drink. He takes his drink and goes to the bathroom. When he  | was about to marry a man she loved, was taken by the doctor  |\n","| comes out, he is wearing a hat with an American flag on it.  |   and her husband into the house of a rich merchant. There   |\n","| The bartender says, \"You know what? I think you should take  |  they found two servants who had been ill-treated by their   |\n","|                          that off.\"                          | employer. The merchant's wife gave them both money and said  |\n","|                                                              |       that they would be well treated in the evening.        |\n","|     The man says, \"I'm not going to take that off.\" The      |                                                              |\n","|                  bartender says, \"Why not?\"                  |             Anselma did not feel very well after             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |      \u001b[1mHere is a story:\u001b[0m A young woman who had been living      |\n","| of Chicago, and he wants to buy a house. He goes to the bank |   in a large, modern house with an attractive but troubled   |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |    husband and two children. She had no idea that she was    |\n","|                    any houses for sale.\"                     |                          pregnant.                           |\n","|                                                              |                                                              |\n","|         Frank says, \"Well then you should have one!\"         |     When the baby was born, the husband went into a deep     |\n","|                                                              |  depression and eventually died of an unknown illness. The   |\n","|  The banker replies, \"I'm sorry but I don't have any houses  | mother's family didn't know what to do with her so they put  |\n","|                          for sale.\"                          |        her in a hospital for four days where she gav         |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |      \u001b[1mHere is a story:\u001b[0m A young man goes to the beach and      |\n","| New York City. I had been to New York before, but this time  | finds a woman who seems to be in her early 20s. He tells her |\n","|     it was different. It was my first time in the city's     |  he has an interesting idea for a movie, but she's too busy  |\n","|  Chinatown and one of the most beautiful places I have ever  |         to hear it. So he leaves and goes back home.         |\n","|                            seen.                             |                                                              |\n","|                                                              | The next morning, his wife comes into the kitchen and says,  |\n","|  I had heard about the famous Chinatowns of China, but they  |         \"I think I'm going to go out with that guy.\"         |\n","|   were not what I expected. The Chinese were friendly and    |                                                              |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |  A man who lives in a tree-haunted house on the edge of the  |\n","| large group of people playing cards. He approached them and  |  Everglade and is afraid of heights has discovered that he   |\n","|   asked if they were playing poker. They said no, but that   |      can make himself taller by putting on his clothes.      |\n","| they were just playing cards. He asked again, and this time  |                                                              |\n","| the group replied \"No, we are not playing poker.\" This made  |  He goes to his garage, where he finds a pair of shorts and  |\n","|  him curious so he asked them again. They said yes, but tha  |  an old shirt. He puts them on, then goes to the top of the  |\n","|                                                              |             hill and climbs up onto a small ledg             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |     \u001b[1mHere is a story:\u001b[0m A young woman named Emily has been      |\n","|   Haines, who was the leader of a group called the \"Dirty    | given the task of taking care of her younger sister, and she |\n","| Dozen,\" was arrested for killing his wife and her lover. The |  is not happy about it. She is also very confused about why  |\n","|   story goes that he had been drinking heavily, and after    |  her sister has been so secretive and what she wants to do   |\n","| having sex with his wife in the morning, he shot her in the  |                        with her life.                        |\n","| head while she slept. He then took a .22 caliber pistol from |                                                              |\n","|                      their bedside tabl                      |  Emily's mother, an attorney, told Emily that if she wanted  |\n","|                                                              |   to pursue a career in law enforcement or law enforcement   |\n","|                                                              |                education that she would have                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=120,\n","    act_name=15,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"f5gOI1kYqyYX","executionInfo":{"status":"ok","timestamp":1689510494523,"user_tz":-60,"elapsed":52217,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"3aa94a44-1130-46ca-ec62-e715ef2f39f2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              | ...A dark and dangerous place where the true nature of evil  |\n","|     A woman named Amy was working at a restaurant in San     |  is not always what it seems. A place where I was very much  |\n","|  Francisco. She had been there for about two years, and was  |   alive, and there was no doubt in my mind that I would be   |\n","|   pretty good at her job. She loved the customers, and she   |  able to finish this race. And then, as I was rounding the   |\n","|  loved the food. She also loved to talk to them, and that's  |  final corner, something else happened. Something that has   |\n","|  what she did when she got off work at about 6pm on Friday   | haunted me ever since: a tire on my right side exploded into |\n","|                            night.                            |                            a full                            |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |     ... one of the most powerful of all human beings, an     |\n","|  I was sitting in the back of a cab, my hands folded on my   | individual who has won every award and coveted prize, a man  |\n","|   lap, when I noticed a man sitting next to me. He had his   | who has been able to defeat his greatest enemy in one-on-one |\n","|   hands in his pockets and was looking at something on his   |    combat, and a man who is more powerful than any other     |\n","| phone. He didn't say anything to me but I could tell he was  | athlete I know. He was the only athlete I ever knew who had  |\n","| looking at something that made him uncomfortable. It wasn't  |   won four Olympic gold medals in different sports. He was   |\n","|       until he looked up that I realized what it was.        |                        also the only                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced |  A man was wandering the woods one day when he came upon a   |\n","| toys for children. One day, my boss came into my office and  | woman who told him that he would need to go to the hospital  |\n","| asked me to come up with a new toy. He wanted something that |   and get some help. He went into the hospital, and after    |\n","|  would appeal to boys but be equally appealing to girls. He  |   taking care of his problem, found out that his wife had    |\n","| said he wanted something \"girl-friendly.\" I thought about it | died. He then took her place in line for an ambulance. When  |\n","|            for a moment and then said, \"What if w            |   he got there, it was too late because the ambulance had    |\n","|                                                              |                           already                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |       \u001b[1mHere is a story:\u001b[0m A young woman named Amala was a       |\n","| drink. He takes his drink and goes to the bathroom. When he  | normal girl until she discovered that her parents were very  |\n","| comes out, he is wearing a hat with an American flag on it.  | much like the kind of parents who would give you a hard time |\n","| The bartender says, \"You know what? I think you should take  | if you told them you had been kidnapped by your own mother.  |\n","|                          that off.\"                          |  ...And then she met this man, and they fell in love. They   |\n","|                                                              | had their first child together, and then the next one after  |\n","|     The man says, \"I'm not going to take that off.\" The      |                 that. And now Amala has thr                  |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |     \u001b[1mHere is a story:\u001b[0m A young woman who had been working      |\n","| of Chicago, and he wants to buy a house. He goes to the bank | in the retail industry for years was about to leave her job  |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |  at a Target store when she noticed that the checkout line   |\n","|                    any houses for sale.\"                     |                      was moving along.                       |\n","|                                                              |  dangerous place where people don't want to be, and I don't  |\n","|         Frank says, \"Well then you should have one!\"         |   know what's going on there,\" she said. \"I'm like, 'Oh my   |\n","|                                                              |          God, I have to go.' And then they put me i          |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                                                              |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |      \u001b[1mHere is a story:\u001b[0m A young man who was once the most      |\n","| New York City. I had been to New York before, but this time  | powerful man in the world suddenly found himself without his |\n","|     it was different. It was my first time in the city's     |  own identity. He had been in control of all aspects of his  |\n","|  Chinatown and one of the most beautiful places I have ever  |   life for more than 30 years, and now he had no identity.   |\n","|                            seen.                             |                             ...                              |\n","|                                                              | A young man who was once the most powerful man in the world  |\n","|  I had heard about the famous Chinatowns of China, but they  | suddenly found himself without his own identity. He had been |\n","|   were not what I expected. The Chinese were friendly and    |             in control of all aspects of his li              |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |           ... and the rest of the story is a lie.            |\n","|   A man was walking his dog on the beach when he noticed a   |  I have been trying to make this game for two years now, but |\n","| large group of people playing cards. He approached them and  |  I never had the time to finish it. So I started making it   |\n","|   asked if they were playing poker. They said no, but that   |   again in 2013, but then I got sick and my work schedule    |\n","| they were just playing cards. He asked again, and this time  |   changed. But then I got back into making games again in    |\n","| the group replied \"No, we are not playing poker.\" This made  |    2014, but my work schedule changed again. But now I am    |\n","|  him curious so he asked them again. They said yes, but tha  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |     \u001b[1mHere is a story:\u001b[0m A young woman named Emily has been      |\n","|   Haines, who was the leader of a group called the \"Dirty    |  given the task of leading the U.S. women's soccer team to   |\n","| Dozen,\" was arrested for killing his wife and her lover. The |     the World Cup, and she has to do it without any real     |\n","|   story goes that he had been drinking heavily, and after    |  knowledge of what her team is going to be up against. She   |\n","| having sex with his wife in the morning, he shot her in the  | doesn't know who's going to be playing in Brazil, where the  |\n","| head while she slept. He then took a .22 caliber pistol from | U.S. will play its first game on June 24th against Colombia, |\n","|                      their bedside tabl                      |                            or how                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=180,\n","    act_name=15,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qQyQwRi6qUoF","executionInfo":{"status":"ok","timestamp":1689510388529,"user_tz":-60,"elapsed":52536,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"470522b8-339d-4dd3-8d97-1082c2aed61e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |    forbidden to leave the garden, but he had to sit on the   |\n","|     A woman named Amy was working at a restaurant in San     |  edge of the bed. He was very happy and they were laughing.  |\n","|  Francisco. She had been there for about two years, and was  | They were really happy and then it happened. The guy who was |\n","|   pretty good at her job. She loved the customers, and she   |   sitting in his place got a little bit angry and he said    |\n","|  loved the food. She also loved to talk to them, and that's  |   something like, \"I'm not going to lie, I'm not going to    |\n","|  what she did when she got off work at about 6pm on Friday   |          lie.\" And then he got up from there and l           |\n","|                            night.                            |                                                              |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              | ...In the ancient lore of the ancient dark world, there was  |\n","|  I was sitting in the back of a cab, my hands folded on my   |    a young girl who lived in an area of her own with her     |\n","|   lap, when I noticed a man sitting next to me. He had his   |   mother. And she was playing with her daughter and it's a   |\n","|   hands in his pockets and was looking at something on his   |  little bit funny. And then, you know, it's just like what   |\n","| phone. He didn't say anything to me but I could tell he was  |  happened to them. It's just like what happened to them and  |\n","| looking at something that made him uncomfortable. It wasn't  |  they're just laughing and they're all laughing and they'r   |\n","|       until he looked up that I realized what it was.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              | ...where the \"dark\" part was actually pretty dark. The final |\n","| In the early 1970s, I was working at a company that produced |                  product looked like this:                   |\n","| toys for children. One day, my boss came into my office and  |  And here's the first run of my green-clarys greens, which I |\n","| asked me to come up with a new toy. He wanted something that |    used to color my first ball of greens from this day.      |\n","|  would appeal to boys but be equally appealing to girls. He  |  And here's the second run of my green-clarys greens, which  |\n","| said he wanted something \"girl-friendly.\" I thought about it |        I used to color my second ball of greens from         |\n","|            for a moment and then said, \"What if w            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |      \u001b[1mHere is a story:\u001b[0m A man who had been in the service      |\n","| drink. He takes his drink and goes to the bathroom. When he  | of the US military for more than 40 years and was one of the |\n","| comes out, he is wearing a hat with an American flag on it.  |  few veterans to attend an Obama-Clinton event attended by   |\n","| The bartender says, \"You know what? I think you should take  |    Clinton herself, also attended a fundraiser hosted by     |\n","|                          that off.\"                          |                       Clinton herself.                       |\n","|                                                              |             true? false? yes/no yes/no yes/yes ?             |\n","|     The man says, \"I'm not going to take that off.\" The      |                (1) (2) (3)          1                        |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |      \u001b[1mHere is a story:\u001b[0m A man who had previously been in       |\n","| of Chicago, and he wants to buy a house. He goes to the bank | the company of a former NFL player, who had previously been  |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | in the company of an NFL player, was attacked by a group of  |\n","|                    any houses for sale.\"                     |   four men and one woman. The man was hit with a baseball-   |\n","|                                                              |                     sized chunk of meat.                     |\n","|         Frank says, \"Well then you should have one!\"         |  ...The men said they were armed with two guns and that one  |\n","|                                                              |     was equipped with an M.O. to fight ...<|endoftext|>      |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                                                              |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |      \u001b[1mHere is a story:\u001b[0m A good-evil, hard-to-fail, high-       |\n","| New York City. I had been to New York before, but this time  |                 stakes, high-top-secret job.                 |\n","|     it was different. It was my first time in the city's     | ... and then there's this other job that came with the other |\n","|  Chinatown and one of the most beautiful places I have ever  |   giant check. And it was also the second big check of the   |\n","|                            seen.                             | day. This one? It was $50 million for Amazon's new second in |\n","|                                                              |     her very own business line of products to be sold on     |\n","|  I had heard about the famous Chinatowns of China, but they  |                      Amazon's own websi                      |\n","|   were not what I expected. The Chinese were friendly and    |                                                              |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                   ...and the second ball.                    |\n","|   A man was walking his dog on the beach when he noticed a   |    I've been working with a very nice young man, and he's    |\n","| large group of people playing cards. He approached them and  |  really got some good moves.  I've been trying to keep him   |\n","|   asked if they were playing poker. They said no, but that   | from using his real good moves for too long, but he's really |\n","| they were just playing cards. He asked again, and this time  |    getting into it now.  He has an amazing ability to hit    |\n","| the group replied \"No, we are not playing poker.\" This made  | baseballs hard, and that's not something you can just teach  |\n","|  him curious so he asked them again. They said yes, but tha  |                            him.                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |     \u001b[1mHere is a story:\u001b[0m A young man who had been an active      |\n","|   Haines, who was the leader of a group called the \"Dirty    |  player in the world of professional golf was hunting in a   |\n","| Dozen,\" was arrested for killing his wife and her lover. The |  remote area of the south. He was on his way to the green,   |\n","|   story goes that he had been drinking heavily, and after    |           and he was about to make his third hole.           |\n","| having sex with his wife in the morning, he shot her in the  |                             ...                              |\n","| head while she slept. He then took a .22 caliber pistol from |                    And then there's this:                    |\n","|                      their bedside tabl                      |  A golfer who played with a group of seven golfers said he   |\n","|                                                              |              was \"crowned\" by one of them after              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=28,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"id":"_bxr_5FCplyB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=50,\n","    act_name=20,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"IdWE5qXIjGuC","executionInfo":{"status":"ok","timestamp":1689508477994,"user_tz":-60,"elapsed":52457,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"890b6b38-4fa0-436a-f1a5-1c26b9e81ac3"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |  A woman named Rosemary had a son who was born with a rare   |\n","|  Francisco. She had been there for about two years, and was  |  condition called \"pink eye.\" He was not supposed to live.   |\n","|   pretty good at her job. She loved the customers, and she   | But he did. He lived for more than 30 years, and now he's an |\n","|  loved the food. She also loved to talk to them, and that's  |                            adult.                            |\n","|  what she did when she got off work at about 6pm on Friday   |                                                              |\n","|                            night.                            |  He is very happy, and he has been for the last 20 years of  |\n","|                                                              | his life. But in recent months, Rosemary noticed that her s  |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   | A man named Richard and his wife had a very special friend.  |\n","|   lap, when I noticed a man sitting next to me. He had his   |    They called him Mr. Pink. He was the best friend that     |\n","|   hands in his pockets and was looking at something on his   |   Richard could ever ask for, and he was the only one who    |\n","| phone. He didn't say anything to me but I could tell he was  |  would listen to him when he told Richard that he wanted to  |\n","| looking at something that made him uncomfortable. It wasn't  | be an actor. Mr. Pink also gave Richard his first job as an  |\n","|       until he looked up that I realized what it was.        |         extra in a movie called \"Pitfall\". The film          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced | In the year 1743, an English nobleman named Thomas Cromwell  |\n","| toys for children. One day, my boss came into my office and  |  decided to leave his home in England and go to the United   |\n","| asked me to come up with a new toy. He wanted something that | States. He was very wealthy and wanted to make sure that he  |\n","|  would appeal to boys but be equally appealing to girls. He  |  could afford a good place for himself there. He chose New   |\n","| said he wanted something \"girl-friendly.\" I thought about it |   York City as his new home. His wife was very upset about   |\n","|            for a moment and then said, \"What if w            |    this decision because she felt that he should stay in     |\n","|                                                              |                      England with her.                       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man named Richard D. G. James was     |\n","| drink. He takes his drink and goes to the bathroom. When he  | in his garden one day when he saw a beautiful blue butterfly |\n","| comes out, he is wearing a hat with an American flag on it.  | with wings of gold and silver, which he thought was the most |\n","| The bartender says, \"You know what? I think you should take  |  beautiful thing he had ever seen. He went to his garden to  |\n","|                          that off.\"                          |   find out what it was, but when he opened the door to his   |\n","|                                                              |  back yard, there was no butterfly there! He looked around   |\n","|     The man says, \"I'm not going to take that off.\" The      |                   and found that all of th                   |\n","|                  bartender says, \"Why not?\"                  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |     \u001b[1mHere is a story:\u001b[0m A man goes to the store and buys a      |\n","| of Chicago, and he wants to buy a house. He goes to the bank | carton of milk. He opens it, and there is no milk inside. He |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |   takes the carton back to the store, where he finds that    |\n","|                    any houses for sale.\"                     |                  there is now milk inside.                   |\n","|                                                              |                                                              |\n","|         Frank says, \"Well then you should have one!\"         |  The story can be found in an old book called \"The Bestiary  |\n","|                                                              |    of English Folklore.\" It was written by a German-born     |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |             British writer named Richard Herring             |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |     \u001b[1mHere is a story:\u001b[0m A man who had a bad experience with     |\n","| New York City. I had been to New York before, but this time  |  the police in his native India, was brought to the United   |\n","|     it was different. It was my first time in the city's     |    States by an American family. He became very angry and    |\n","|  Chinatown and one of the most beautiful places I have ever  |    threatened to kill himself. His wife and daughter were    |\n","|                            seen.                             |  terrified of him. They called the police again and again,   |\n","|                                                              |  but he would not leave their house. Finally they called a   |\n","|  I had heard about the famous Chinatowns of China, but they  |     private detective who found him on the Internet. The     |\n","|   were not what I expected. The Chinese were friendly and    |                   detective asked him if h                   |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   | A man who lived in a cave for 40 years and never left it was |\n","| large group of people playing cards. He approached them and  |   found dead. He had been missing for 20 years. The police   |\n","|   asked if they were playing poker. They said no, but that   | were called to the cave by his wife, who was concerned about |\n","| they were just playing cards. He asked again, and this time  |  his health. She took him to the hospital where he died on   |\n","| the group replied \"No, we are not playing poker.\" This made  |   the way back home. The police asked around and found out   |\n","|  him curious so he asked them again. They said yes, but tha  |     that he had been living in this cave since 1970, wh      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |     \u001b[1mHere is a story:\u001b[0m A young man named Adam was given a      |\n","|   Haines, who was the leader of a group called the \"Dirty    |  very special gift. He was told that he would be given the   |\n","| Dozen,\" was arrested for killing his wife and her lover. The |  power to control his own destiny. This gift came with the   |\n","|   story goes that he had been drinking heavily, and after    | condition that he would have to do this for the rest of his  |\n","| having sex with his wife in the morning, he shot her in the  |   life. The power to control his destiny, however, did not   |\n","| head while she slept. He then took a .22 caliber pistol from | come without a price. Adam had to sacrifice himself in order |\n","|                      their bedside tabl                      |           for this gift to be bestowed upon him a            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["## Late Layers"],"metadata":{"id":"ieL5A_gxtwhP"}},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=34,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dMHYKC-pt0tu","executionInfo":{"status":"ok","timestamp":1689511316254,"user_tz":-60,"elapsed":53987,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"081628f9-5c8d-46a9-ae44-a5cf7427a9d6"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |     he\u001b[0m started talking to me about how much he loved his     |\n","| unconscious for about 15 minutes. I got him to the hospital  |  football and how much it meant to him. He said that if he   |\n","|    and they did some tests on him and found that he had a    |  had a daughter, she would be an NFL quarterback. I thought  |\n","|                         concussion.                          |   that was pretty cool because I'm not sure any of us have   |\n","|                                                              |  ever really thought about what it would be like to have a   |\n","|   I'm not sure what happened but I know that it wasn't his   |        daughter who played the game we love so much.         |\n","|  fault. He's been in football since he was 3 years old and   |                                                              |\n","|        has never had any concussions before this one.        |                 I also wanted to share this                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |    he\u001b[0m started talking to me about how he was playing with    |\n","|  the hospital where they gave him an IV and told me that he  |  his new friend. He said that this guy was really cool and   |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |  that they were going to play a game where they would take   |\n","|                                                              |     turns telling each other the worst thing that's ever     |\n","| My son's father is a physician in our community who has been |                      happened to them.                       |\n","|    practicing medicine for over 30 years. He's worked in     |                                                              |\n","|   hospitals all over the country and has seen his share of   |  \"What's wrong with you?\" I asked him. \"Why are you telling  |\n","|                     tragedies like this                      |      me this stuff? Why do you want to tell me all thes      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |                     he\u001b[0m was hit by a car.                     |\n","| serious injuries. I'm asking for help to pay for his medical |                                                              |\n","|    bills and the funeral expenses of his parents who were    |   He's okay now, but it's still scary to think about what    |\n","|                   killed in this accident.                   | could have happened if the driver had been distracted or not |\n","|                                                              |                      paying attention.                       |\n","|                                                              |                                                              |\n","|   I am trying to raise $10,000 to cover all of his medical   |   So I'm asking you: What do you think should happen when    |\n","|  bills and funeral expenses so that he can get back on his   |    someone is hit by a car? Should they be treated as an     |\n","|         feet as soon as possible and be able to star         | accident victim and taken to the hospital? Or should they be |\n","|                                                              |                     given proper care a                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |    he\u001b[0m noticed that his knee was sore. I went to the store    |\n","|  mom and dad who were looking for him. They took him to the  |   and bought him some ice and a cold washcloth. He told me   |\n","| hospital where he is currently being treated for hypothermia |    that he had been running around all day long, but then    |\n","|                       and dehydration.                       |     suddenly stopped when he saw the injury on his knee.     |\n","|                                                              |                                                              |\n","| The story is heartbreaking, but it's also a reminder that we | I'm not sure what happened or why it happened but I do know  |\n","|    need to be vigilant about keeping our kids safe in the    |     that we're going to be okay with this. It's just one     |\n","|        woods. It's easy to get caught up in all of th        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |            he\u001b[0m noticed that his shirt was missing.            |\n","|   now, but it's still scary to think about what could have   |                                                              |\n","| happened if he had been playing in the street instead of on  | I had just bought him a new shirt for the first time in his  |\n","|                        his own turf.                         |  life and I was very excited to see it on him. But then he   |\n","|                                                              |  noticed that the collar of his shirt had been cut off. He   |\n","|   The other day I was watching a video of one of my son's    |   didn't know what to do with it so I took it back to the    |\n","|   friends play football with his little brother. They were   |  store and they said they would have to send me another one  |\n","|  both 6 years old and were running around like crazy trying  |                         because ther                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |   he\u001b[0m stopped and looked at me. \"What's wrong?\" I asked. He   |\n","| watched him do this for a few minutes before I noticed that  | said, \"I'm sorry,\" and then he looked at the ball and said,  |\n","| he was bleeding from his penis. He was bleeding so much that |                  \"I think it's a good one.\"                  |\n","|      it looked like blood had been drawn from his body.      |                                                              |\n","|                                                              |                 \"What do you mean?\" I asked.                 |\n","|  I went to get him help immediately, but when I got there,   |                                                              |\n","| the doctor told me that it would be too late to save him. H  |  \"It's got a nice bounce to it,\" he said. \"It looks like it  |\n","|                                                              |               might be good.\" And then he tur                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |    he\u001b[0m started talking to me about how he was feeling. He     |\n","|    the hospital and is now in stable condition. I'm very     |  said that his body was tired and that he needed to go home  |\n","|   thankful that he's alive and has been released from the    | and sleep. I told him I would see him in the morning and we  |\n","|                          hospital.                           |                  would talk about it then.                   |\n","|                                                              |                                                              |\n","| I'm also thankful that this happened on a Sunday afternoon,  | When I got home, I found him asleep on the couch with a book |\n","|  when kids are out of school and parents are more likely to  |  in his lap. He had been reading for hours while I slept in  |\n","|   be at home with their children than they would be on any   |                          my own bed                          |\n","|                          other day                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |                 he\u001b[0m stopped and looked at me.                 |\n","|                                                              |                                                              |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |           \"Dad,\" he said, \"I'm not good at this.\"            |\n","|                                                              |                                                              |\n","| He took off his helmet and put it on the ground. He put his  |  I thought it was funny. I thought it was cute that he had   |\n","|   hands in the air and started to run around like a little   | stopped to think about what his father's job really is. But  |\n","| kid. I could tell he was excited about playing soccer again  |  then I started to think about the whole thing and realized  |\n","|   after being away from it for so long. He ran around like   |    that maybe my son doesn't know what his dad does for a    |\n","|                      crazy and we play                       |                  living because of the way                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=300,\n","    act_name=34,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"auEraZBHuWgY","executionInfo":{"status":"ok","timestamp":1689511420446,"user_tz":-60,"elapsed":50575,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"e234508c-7e7f-482b-c681-0471f0a6c375"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |     he\u001b[0m started talking to me about how much he loved his     |\n","| unconscious for about 15 minutes. I got him to the hospital  |  football and how much it meant to him. He said that if he   |\n","|    and they did some tests on him and found that he had a    | had a magic wand, he would make it so that every kid in the  |\n","|                         concussion.                          |                  world could play football.                  |\n","|                                                              |                                                              |\n","|   I'm not sure what happened but I know that it wasn't his   |   \"But,\" I said, \"what if you were just one of the guys?\"    |\n","|  fault. He's been in football since he was 3 years old and   |                                                              |\n","|        has never had any concussions before this one.        |       He looked at me like I was crazy. \"I'd have to b       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |                       he\u001b[0m saw this guy.                       |\n","|  the hospital where they gave him an IV and told me that he  |                                                              |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |   \"What's wrong with that guy?\" my son asked me. \"He's not   |\n","|                                                              |                   even wearing a helmet.\"                    |\n","| My son's father is a physician in our community who has been |                                                              |\n","|    practicing medicine for over 30 years. He's worked in     | I thought about it for a second and said, \"You know what? He |\n","|   hospitals all over the country and has seen his share of   |      is.\" And then I started laughing because it was so      |\n","|                     tragedies like this                      |  ridiculous. I mean, he had no idea how to play the game or  |\n","|                                                              |            anything like that. But then I realiz             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |                     he\u001b[0m was hit by a car.                     |\n","| serious injuries. I'm asking for help to pay for his medical |                                                              |\n","|    bills and the funeral expenses of his parents who were    |   He's fine now, but it's still scary to think about what    |\n","|                   killed in this accident.                   |     could have happened if the driver had been drunk or      |\n","|                                                              |                          druggable.                          |\n","|                                                              |                                                              |\n","|   I am trying to raise $10,000 to cover all of his medical   |  So I'm asking you: What would you do if you were hit by a   |\n","|  bills and funeral expenses so that he can get back on his   | drunk driver? How would you react? Would you run away or try |\n","|         feet as soon as possible and be able to star         |          to help her? If so, how? Please share your          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |            he\u001b[0m noticed that his knee was injured.             |\n","|  mom and dad who were looking for him. They took him to the  |                                                              |\n","| hospital where he is currently being treated for hypothermia | He told me he had to go to the hospital and see a doctor. I  |\n","|                       and dehydration.                       |   went with him. He said it would be okay if we went alone   |\n","|                                                              | because there were other kids around us who were playing too |\n","| The story is heartbreaking, but it's also a reminder that we |    and that's what they do when they get hurt like this!     |\n","|    need to be vigilant about keeping our kids safe in the    |                                                              |\n","|        woods. It's easy to get caught up in all of th        |    I got there in time to see him being taken away by an     |\n","|                                                              |                         ambulance a                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |    he\u001b[0m noticed that his shoes were all dirty. I thought it    |\n","|   now, but it's still scary to think about what could have   | was just the game and didn't think much of it until he asked |\n","| happened if he had been playing in the street instead of on  | me if I'd like to help him clean them up. I thought nothing  |\n","|                        his own turf.                         |  of it at first, but then he asked me again and this time I  |\n","|                                                              |                          said yes!                           |\n","|   The other day I was watching a video of one of my son's    |                                                              |\n","|   friends play football with his little brother. They were   |  I'm not sure what prompted this decision but we have been   |\n","|  both 6 years old and were running around like crazy trying  |            using the same pair of shoes for abou             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |   he\u001b[0m stopped and looked at me. \"What's wrong?\" I asked. He   |\n","| watched him do this for a few minutes before I noticed that  |  said that he was tired of seeing all the people around him  |\n","| he was bleeding from his penis. He was bleeding so much that |  playing football and not playing with their kids. He said   |\n","|      it looked like blood had been drawn from his body.      | that if we wanted to play with our kids, we needed to start  |\n","|                                                              |                  by making it fun for them!                  |\n","|  I went to get him help immediately, but when I got there,   |                                                              |\n","| the doctor told me that it would be too late to save him. H  |  \"I think you're right,\" I replied. \"We need to make it fun  |\n","|                                                              |                           for them                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |   he\u001b[0m started talking to me about how he was playing in the   |\n","|    the hospital and is now in stable condition. I'm very     |                         wrong game.                          |\n","|   thankful that he's alive and has been released from the    |                                                              |\n","|                          hospital.                           | \"I'm not going to be good at this,\" he said. \"I'm not going  |\n","|                                                              |                     to be good at this.\"                     |\n","| I'm also thankful that this happened on a Sunday afternoon,  |                                                              |\n","|  when kids are out of school and parents are more likely to  | He was playing for his school's team, and I knew it would be |\n","|   be at home with their children than they would be on any   |  hard for him to play if we were losing. But I didn't think  |\n","|                          other day                           |                that much of it because the ki                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |                 he\u001b[0m stopped and looked at me.                 |\n","|                                                              |                                                              |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |         \"Dad,\" he said, \"I'm not a football player.\"         |\n","|                                                              |                                                              |\n","| He took off his helmet and put it on the ground. He put his  | I thought that was funny. I mean, it's not like I'm the one  |\n","|   hands in the air and started to run around like a little   | who makes him play the game or anything. But then I thought  |\n","| kid. I could tell he was excited about playing soccer again  | about it for a second and realized that he wasn't wrong. He  |\n","|   after being away from it for so long. He ran around like   |      is a very good football player—but not in the way       |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=600,\n","    act_name=34,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6u_OC-_4uz9m","executionInfo":{"status":"ok","timestamp":1689511537385,"user_tz":-60,"elapsed":54021,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"5ca88f46-2264-41f9-ab10-af79bc91d232"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |     he\u001b[0m started talking to me about how much he loved his     |\n","| unconscious for about 15 minutes. I got him to the hospital  |  football and how much it meant to him. He said that if he   |\n","|    and they did some tests on him and found that he had a    | had a magic wand, he would make it so that every kid in the  |\n","|                         concussion.                          |                  world could play football.                  |\n","|                                                              |                                                              |\n","|   I'm not sure what happened but I know that it wasn't his   |   \"But,\" I said, \"what if you were just one of the guys?\"    |\n","|  fault. He's been in football since he was 3 years old and   |                                                              |\n","|        has never had any concussions before this one.        |       He looked at me like I was crazy. \"I'd have to b       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |                       he\u001b[0m saw this guy.                       |\n","|  the hospital where they gave him an IV and told me that he  |                                                              |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |   \"What's wrong with that guy?\" my son asked me. \"He's not   |\n","|                                                              |                   even wearing a helmet.\"                    |\n","| My son's father is a physician in our community who has been |                                                              |\n","|    practicing medicine for over 30 years. He's worked in     | I thought about it for a second and said, \"You're right.\" He |\n","|   hospitals all over the country and has seen his share of   | was playing without one because he didn't have one to wear!  |\n","|                     tragedies like this                      | I knew that this wasn't the first time I'd seen someone play |\n","|                                                              |                without one. It happens all th                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |   he\u001b[0m was playing with his friend's daughter. Then, he was    |\n","| serious injuries. I'm asking for help to pay for his medical |  riding a horse. Now, he is on the hunt for a good place to  |\n","|    bills and the funeral expenses of his parents who were    | go fishing in the evening and has decided that we should go  |\n","|                   killed in this accident.                   |                         to Old Crown                         |\n","|                                                              |                                                              |\n","|                                                              |  We were going to go hunting yesterday but then my son said  |\n","|   I am trying to raise $10,000 to cover all of his medical   | that we should try fishing instead because it would be fun!  |\n","|  bills and funeral expenses so that he can get back on his   |       I thought it would be cool if we went together a       |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |    he\u001b[0m noticed that his shirt was missing from his pants.     |\n","|  mom and dad who were looking for him. They took him to the  |                                                              |\n","| hospital where he is currently being treated for hypothermia | He said that it had been taken by someone who knew where he  |\n","|                       and dehydration.                       |  lived and what he did for a living. He said that they took  |\n","|                                                              | the shirt because they thought it might be of use to them in |\n","| The story is heartbreaking, but it's also a reminder that we | some way or another. He also mentioned that there were other |\n","|    need to be vigilant about keeping our kids safe in the    |  things taken with the shirt as well but we don't know what  |\n","|        woods. It's easy to get caught up in all of th        |                        those were or                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |    he\u001b[0m noticed that his shoes were all dirty. I thought it    |\n","|   now, but it's still scary to think about what could have   |   was just the fact that he'd been playing in them for so    |\n","| happened if he had been playing in the street instead of on  |   long, but then I saw the color of his shoes and realized   |\n","|                        his own turf.                         |                      what had happened.                      |\n","|                                                              |                                                              |\n","|   The other day I was watching a video of one of my son's    |  He's a very good kid and has never done anything like this  |\n","|   friends play football with his little brother. They were   | before. He was really upset about it and wanted to know why  |\n","|  both 6 years old and were running around like crazy trying  |         he had done this to himself. So we went back         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |   he\u001b[0m stopped and looked at me. \"What's wrong?\" I asked. He   |\n","| watched him do this for a few minutes before I noticed that  |  said that he was tired of playing with the other kids and   |\n","| he was bleeding from his penis. He was bleeding so much that |   wanted to play with me instead. I said okay, but then he   |\n","|      it looked like blood had been drawn from his body.      |  started walking away from me and went into the school yard  |\n","|                                                              |               to play with his friends again.                |\n","|  I went to get him help immediately, but when I got there,   |                                                              |\n","| the doctor told me that it would be too late to save him. H  | \"I don't want you to stop playing,\" I told him. \"You're not  |\n","|                                                              |                            going                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |     he\u001b[0m started talking to me about how he was getting an     |\n","|    the hospital and is now in stable condition. I'm very     | awesome new pair of shoes. I asked him what they were and he |\n","|   thankful that he's alive and has been released from the    |     said \"the Nike Fade\" and that they were really cool.     |\n","|                          hospital.                           |                                                              |\n","|                                                              | I'm not sure if this is the first time I've seen a Nike shoe |\n","| I'm also thankful that this happened on a Sunday afternoon,  |   in person or not but it's definitely the first time I've   |\n","|  when kids are out of school and parents are more likely to  |           ever heard of them. So, naturally, I ask           |\n","|   be at home with their children than they would be on any   |                                                              |\n","|                          other day                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |                 he\u001b[0m stopped and looked at me.                 |\n","|                                                              |                                                              |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |         \"Dad,\" he said, \"I'm not a football player.\"         |\n","|                                                              |                                                              |\n","| He took off his helmet and put it on the ground. He put his  | I thought that was funny. I mean, it's not like I'm the one  |\n","|   hands in the air and started to run around like a little   | who makes him play the game or anything. But then I thought  |\n","| kid. I could tell he was excited about playing soccer again  | about it for a second and realized that he wasn't wrong. He  |\n","|   after being away from it for so long. He ran around like   |      is a very good football player—but not in the way       |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=42,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6MAfQvMQuArr","executionInfo":{"status":"ok","timestamp":1689511369894,"user_tz":-60,"elapsed":51578,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"62cb8d6c-2297-417c-d531-919db6b47431"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |      he\u001b[0m took off running and jumped into the street. He      |\n","| unconscious for about 15 minutes. I got him to the hospital  |          landed on his head and fell to the ground.          |\n","|    and they did some tests on him and found that he had a    |                                                              |\n","|                         concussion.                          |  I ran over to him and tried to get him up but he wouldn't   |\n","|                                                              |  move. I got down on my hands and knees next to him, but he  |\n","|   I'm not sure what happened but I know that it wasn't his   | wouldn't move either. I put my hand under his chin so that I |\n","|  fault. He's been in football since he was 3 years old and   |   could see if there was any damage or anything else wrong   |\n","|        has never had any concussions before this one.        |                             with                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |   he\u001b[0m went to the bathroom and passed out. I rushed him to    |\n","|  the hospital where they gave him an IV and told me that he  | the hospital where they gave him an EKG and told me that he  |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |    had a heart attack. He was taken to the hospital in an    |\n","|                                                              |              ambulance and put on life support.              |\n","| My son's father is a physician in our community who has been |                                                              |\n","|    practicing medicine for over 30 years. He's worked in     |   I'm not sure what happened but I'm not going to go into    |\n","|   hospitals all over the country and has seen his share of   |  detail because it's none of your business (except for his   |\n","|                     tragedies like this                      |                       mom). My son is                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |                     he\u001b[0m was hit by a car.                     |\n","| serious injuries. I'm asking for help to pay for his medical |                                                              |\n","|    bills and the funeral expenses of his parents who were    | He's okay now, but it's scary to think about what could have |\n","|                   killed in this accident.                   | happened if the driver had been texting or talking on their  |\n","|                                                              | phone while driving. It's also terrifying to think about how |\n","|                                                              | much time we spend in our cars each day — and how little of  |\n","|   I am trying to raise $10,000 to cover all of his medical   |  that time is spent doing something productive like working  |\n","|  bills and funeral expenses so that he can get back on his   |                         or reading.                          |\n","|         feet as soon as possible and be able to star         |                                                              |\n","|                                                              |                     It doesn't have to b                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |      he\u001b[0m stopped. He looked at me and said: \"Mommy, I'm       |\n","|  mom and dad who were looking for him. They took him to the  |                           scared.\"                           |\n","| hospital where he is currently being treated for hypothermia |                                                              |\n","|                       and dehydration.                       |  I asked him what was wrong. He said: \"I'm scared because I  |\n","|                                                              |                         can't see.\"                          |\n","| The story is heartbreaking, but it's also a reminder that we |                                                              |\n","|    need to be vigilant about keeping our kids safe in the    | \"What do you mean?\" I asked. \"You can see!\" he replied with  |\n","|        woods. It's easy to get caught up in all of th        |  a smile on his face. And then he continued: \"I don't know   |\n","|                                                              |                    why it's so scary for                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |    he\u001b[0m stopped. He looked up at me and said: \"Dad, I think    |\n","|   now, but it's still scary to think about what could have   |                          I'm gay.\"                           |\n","| happened if he had been playing in the street instead of on  |                                                              |\n","|                        his own turf.                         |  I was stunned. It's not something that you expect to hear   |\n","|                                                              | from your son when he's out playing with his friends. And it |\n","|   The other day I was watching a video of one of my son's    | wasn't just a thought in his head; it was an actual feeling  |\n","|   friends play football with his little brother. They were   |   of something in him that felt different than the rest of   |\n","|  both 6 years old and were running around like crazy trying  |                  him. I knew then that this                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |    he\u001b[0m ran into a neighbor's yard and got hit by a car. He    |\n","| watched him do this for a few minutes before I noticed that  |        is now in the hospital with serious injuries.         |\n","| he was bleeding from his penis. He was bleeding so much that |                                                              |\n","|      it looked like blood had been drawn from his body.      | The neighbor who hit him was cited for careless driving and  |\n","|                                                              | reckless driving, but I'm sure that he will be off work for  |\n","|  I went to get him help immediately, but when I got there,   |  at least one week because of this incident. The neighbors'  |\n","| the doctor told me that it would be too late to save him. H  | children were also in the yard when it happened, so they are |\n","|                                                              |                    also likely to be susp                    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |     he\u001b[0m took off running. I chased him down and asked him     |\n","|    the hospital and is now in stable condition. I'm very     |   what was wrong. He said he had to go to the bathroom and   |\n","|   thankful that he's alive and has been released from the    |   needed to pee. I told him that wasn't a good reason for    |\n","|                          hospital.                           |  running away from me and that if he ran into the woods or   |\n","|                                                              |                something, we'd be in trouble!                |\n","| I'm also thankful that this happened on a Sunday afternoon,  |                                                              |\n","|  when kids are out of school and parents are more likely to  |  I told him it's not a good reason for running away from me  |\n","|   be at home with their children than they would be on any   |                           either!                            |\n","|                          other day                           |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |             he\u001b[0m ran into the woods and fell down.             |\n","|                                                              |                                                              |\n","|        \"Dad,\" I said, \"I think you should try this.\"         | I was there to pick him up and take him home. I didn't know  |\n","|                                                              | that he had fallen until I got to the house. He wasn't hurt  |\n","| He took off his helmet and put it on the ground. He put his  |    at all; he just had a concussion from running into the    |\n","|   hands in the air and started to run around like a little   |                            woods.                            |\n","| kid. I could tell he was excited about playing soccer again  |                                                              |\n","|   after being away from it for so long. He ran around like   | He was upset because it's been raining for days and it's so  |\n","|                      crazy and we play                       |       cold in our neighborhood right now that it feels       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=500,\n","    act_name=42,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"a_StCcr9uZXr","executionInfo":{"status":"ok","timestamp":1689511593621,"user_tz":-60,"elapsed":56253,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"9f7f7c67-5423-4128-a371-1851be6e21ac"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |      he\u001b[0m took off running and jumped into the street. He      |\n","| unconscious for about 15 minutes. I got him to the hospital  |          landed on his head and fell to the ground.          |\n","|    and they did some tests on him and found that he had a    |                                                              |\n","|                         concussion.                          |  I ran over to him and tried to get him up but he wouldn't   |\n","|                                                              |  move. I got down on my hands and knees next to him, but he  |\n","|   I'm not sure what happened but I know that it wasn't his   | wouldn't move either. I put my hand under his chin so that I |\n","|  fault. He's been in football since he was 3 years old and   |   could see if there was any damage or anything else wrong   |\n","|        has never had any concussions before this one.        |                             with                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |   he\u001b[0m went to the bathroom and passed out. I rushed him to    |\n","|  the hospital where they gave him an IV and told me that he  | the hospital where they gave him an EKG and told me that he  |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |    had a heart attack. He was taken to the hospital in an    |\n","|                                                              |              ambulance and put on life support.              |\n","| My son's father is a physician in our community who has been |                                                              |\n","|    practicing medicine for over 30 years. He's worked in     |   I'm not sure what happened but I'm not going to go into    |\n","|   hospitals all over the country and has seen his share of   | details because it's none of your business (except for me).  |\n","|                     tragedies like this                      |                        But here's wha                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |                     he\u001b[0m was hit by a car.                     |\n","| serious injuries. I'm asking for help to pay for his medical |                                                              |\n","|    bills and the funeral expenses of his parents who were    | He's okay now, but it's scary to think about what could have |\n","|                   killed in this accident.                   |  happened if the driver had been distracted by his phone or  |\n","|                                                              |  something else. I'm not talking about texting and driving   |\n","|                                                              |   here — that's an issue for the police and courts to deal   |\n","|   I am trying to raise $10,000 to cover all of his medical   |   with. What I'm talking about is someone driving down the   |\n","|  bills and funeral expenses so that he can get back on his   |    street with their eyes on their phone or another devic    |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |      he\u001b[0m stopped. He looked at me and said: \"Mommy, I'm       |\n","|  mom and dad who were looking for him. They took him to the  |                           scared.\"                           |\n","| hospital where he is currently being treated for hypothermia |                                                              |\n","|                       and dehydration.                       |  I asked him what was wrong. He said: \"I'm scared because I  |\n","|                                                              |                         can't see.\"                          |\n","| The story is heartbreaking, but it's also a reminder that we |                                                              |\n","|    need to be vigilant about keeping our kids safe in the    | \"What do you mean?\" I asked. \"You can see!\" he replied with  |\n","|        woods. It's easy to get caught up in all of th        |  a smile on his face. And then he continued: \"I don't know   |\n","|                                                              |                    why it's so scary for                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |    he\u001b[0m stopped. He looked up at me and said: \"Dad, I think    |\n","|   now, but it's still scary to think about what could have   |                          I'm gay.\"                           |\n","| happened if he had been playing in the street instead of on  |                                                              |\n","|                        his own turf.                         | I was stunned. It's not something that you ever really think |\n","|                                                              | about when you're a kid. You don't know what it means to be  |\n","|   The other day I was watching a video of one of my son's    |  gay or lesbian or transgender or transgendered – but then   |\n","|   friends play football with his little brother. They were   |                again, neither do most of us!                 |\n","|  both 6 years old and were running around like crazy trying  |                                                              |\n","|                                                              |             I've always been curious about my s              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |    he\u001b[0m ran into a neighbor's yard and got hit by a car. He    |\n","| watched him do this for a few minutes before I noticed that  |        is now in the hospital with serious injuries.         |\n","| he was bleeding from his penis. He was bleeding so much that |                                                              |\n","|      it looked like blood had been drawn from his body.      |  The neighbor who hit him was cited for failure to yield to  |\n","|                                                              | an emergency vehicle. The driver of the car that hit him has |\n","|  I went to get him help immediately, but when I got there,   | not been charged yet because he claims his insurance company |\n","| the doctor told me that it would be too late to save him. H  |                      won't pay for it.                       |\n","|                                                              |                                                              |\n","|                                                              |        I'm asking you to help me get this guy off th         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |    he\u001b[0m took off running. He ran for a couple of blocks and    |\n","|    the hospital and is now in stable condition. I'm very     |  then stopped. I asked him what was wrong and he said \"I'm   |\n","|   thankful that he's alive and has been released from the    |                           tired.\"                            |\n","|                          hospital.                           |                                                              |\n","|                                                              |                   \"What's tired?\" I asked.                   |\n","| I'm also thankful that this happened on a Sunday afternoon,  |                                                              |\n","|  when kids are out of school and parents are more likely to  |             \"My legs,\" he said. \"They're tired.\"             |\n","|   be at home with their children than they would be on any   |                                                              |\n","|                          other day                           |   He had been playing all day long, but now his legs were    |\n","|                                                              |  feeling like they were going to fall asleep on him at any   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |             he\u001b[0m ran into the woods and fell down.             |\n","|                                                              |                                                              |\n","|        \"Dad,\" I said, \"I think you should try this.\"         | I was there to pick him up and take him home. I didn't know  |\n","|                                                              | that he had fallen until I got to the house. He wasn't hurt, |\n","| He took off his helmet and put it on the ground. He put his  |  but it's a good thing we were there because he would have   |\n","|   hands in the air and started to run around like a little   |              been lost in the woods without us!              |\n","| kid. I could tell he was excited about playing soccer again  |                                                              |\n","|   after being away from it for so long. He ran around like   | My husband took me to the hospital and found out that my son |\n","|                      crazy and we play                       |                          had suffer                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["## Only Final Activations"],"metadata":{"id":"jsznHPXBvDav"}},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=200,\n","    act_name=23,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5GI6XXzTvuux","executionInfo":{"status":"ok","timestamp":1689511775577,"user_tz":-60,"elapsed":52066,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"9f64cf2e-949b-4225-f9c5-3bb6d0467b56"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |   he\u001b[0m was stopped by the police. They asked him what he was   |\n","| unconscious for about 15 minutes. I got him to the hospital  |  doing and what his rights were. He said that he had a long  |\n","|    and they did some tests on him and found that he had a    |  beard and they said that they didn't know how to deal with  |\n","|                         concussion.                          |   it. I am now very worried about this issue of the law of   |\n","|                                                              |                   facial hair in America.                    |\n","|   I'm not sure what happened but I know that it wasn't his   |  in which the police are not happy with my son's facial hair |\n","|  fault. He's been in football since he was 3 years old and   |               and want to make sure that it is               |\n","|        has never had any concussions before this one.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |     he\u001b[0m came back and I noticed that his hand was playing     |\n","|  the hospital where they gave him an IV and told me that he  |     with the ball. He said \"I'm not touching the ball.\"      |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |     in which I say \"Oh? Why?\" and he says \"I don't know.\"    |\n","|                                                              |  Now, I am not a coach or an expert on football. But, I do   |\n","| My son's father is a physician in our community who has been | know that if you are touching the ball then you are doing it |\n","|    practicing medicine for over 30 years. He's worked in     |                    wrong. And now we hav                     |\n","|   hospitals all over the country and has seen his share of   |                                                              |\n","|                     tragedies like this                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |    he\u001b[0m and his wife were in the middle of an argument. The    |\n","| serious injuries. I'm asking for help to pay for his medical |     husband said \"we don't need you to come back here.\"      |\n","|    bills and the funeral expenses of his parents who were    |  and I was shocked at this point because I thought that they |\n","|                   killed in this accident.                   |        would be happy to have me back in their lives.        |\n","|                                                              | I asked them why they didn't want me there and what exactly  |\n","|                                                              |  they wanted me to do? They said \"we don't want you here\" a  |\n","|   I am trying to raise $10,000 to cover all of his medical   |                                                              |\n","|  bills and funeral expenses so that he can get back on his   |                                                              |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |     he\u001b[0m stopped and took a few photos of himself. I'm not     |\n","|  mom and dad who were looking for him. They took him to the  | sure what to do with the images. Do you want me to send them |\n","| hospital where he is currently being treated for hypothermia |  to the media? Do I want them in an album? What should I do  |\n","|                       and dehydration.                       |           with this image that is worth anything?            |\n","|                                                              |         /update: It's now on Instagram!<|endoftext|>         |\n","| The story is heartbreaking, but it's also a reminder that we |                                                              |\n","|    need to be vigilant about keeping our kids safe in the    |                                                              |\n","|        woods. It's easy to get caught up in all of th        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |          he\u001b[0m stopped and took a picture of himself.           |\n","|   now, but it's still scary to think about what could have   |  and the best thing is that it's not just me who loves this  |\n","| happened if he had been playing in the street instead of on  |                pic. in fact, it's all of you!                |\n","|                        his own turf.                         |  This is what I love about photography: you can do anything  |\n","|                                                              |                      with your camera!                       |\n","|   The other day I was watching a video of one of my son's    |  and now for the other side...the side where I'm not happy   |\n","|   friends play football with his little brother. They were   |                         with my son?                         |\n","|  both 6 years old and were running around like crazy trying  |          The one where I'm unhappy because there ar          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |   he\u001b[0m stopped and said \"I'm going to go and get the phone\".   |\n","| watched him do this for a few minutes before I noticed that  |  with all the \"hands\" that are now in my head. I am so tired |\n","| he was bleeding from his penis. He was bleeding so much that |                            of it.                            |\n","|      it looked like blood had been drawn from his body.      | So, I decided to give him a little bit of an experience with |\n","|                                                              |  the cell phone. It's hard for me to imagine that he is not  |\n","|  I went to get him help immediately, but when I got there,   | going to be using his cell phone at some point in time but I |\n","| the doctor told me that it would be too late to save him. H  |                            guess                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |   he\u001b[0m was playing with the children's game of tag. Then, he   |\n","|    the hospital and is now in stable condition. I'm very     |                  was on the phone with me.                   |\n","|   thankful that he's alive and has been released from the    |   in all these moments I saw him as a very different person  |\n","|                          hospital.                           | than who I have seen for the last two years of his life: He  |\n","|                                                              | is not an artist and not an inventor. He is not a journalist |\n","| I'm also thankful that this happened on a Sunday afternoon,  |    and not a photographer. He is not an actor and not an     |\n","|  when kids are out of school and parents are more likely to  |                       artistesse. His                        |\n","|   be at home with their children than they would be on any   |                                                              |\n","|                          other day                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |    he\u001b[0m stopped and said \"Oh, I see the clock on the wall.\"    |\n","|                                                              |   He then looked at me and said \"I'm going to be a clock.\"   |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |                        in fact, he is.                       |\n","|                                                              |    My son is one of those who have a tendency to get very    |\n","| He took off his helmet and put it on the ground. He put his  |  excited about things that are not actually happening. For   |\n","|   hands in the air and started to run around like a little   |  example: when we first started talking about this I was so  |\n","| kid. I could tell he was excited about playing soccer again  |              worried that it would be an excus               |\n","|   after being away from it for so long. He ran around like   |                                                              |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=80,\n","    act_name=18,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-emuq85-wdbb","executionInfo":{"status":"ok","timestamp":1689511971738,"user_tz":-60,"elapsed":52288,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"cf4e43f1-b7ff-4a27-d523-6b0d11825565"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |            he\u001b[0m got hit in the head by a football.             |\n","| unconscious for about 15 minutes. I got him to the hospital  |                                                              |\n","|    and they did some tests on him and found that he had a    |   He was playing in the backyard with his brother and two    |\n","|                         concussion.                          |  friends when he was struck by a ball that landed on top of  |\n","|                                                              | him. The ball went through his head and into the back of his |\n","|   I'm not sure what happened but I know that it wasn't his   |   neck, where it lodged there for about an hour before it    |\n","|  fault. He's been in football since he was 3 years old and   |               could be removed from his body.                |\n","|        has never had any concussions before this one.        |                                                              |\n","|                                                              |           I'm not going to go into all the details           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |                 he\u001b[0m went to play in the yard.                 |\n","|  the hospital where they gave him an IV and told me that he  |                                                              |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |          And then, he went to play in the backyard.          |\n","|                                                              |                                                              |\n","| My son's father is a physician in our community who has been |  And then, he went to play in the park. And then… well, you  |\n","|    practicing medicine for over 30 years. He's worked in     |                       get the picture.                       |\n","|   hospitals all over the country and has seen his share of   |                                                              |\n","|                     tragedies like this                      | As a parent of two boys (ages 7 and 9), I have been watching |\n","|                                                              | my son's progress with regard to his participation in sports |\n","|                                                              |                 since he was 2 years old. I                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |   he\u001b[0m was out playing with his friends. Now, he's back home   |\n","| serious injuries. I'm asking for help to pay for his medical |                           in bed.                            |\n","|    bills and the funeral expenses of his parents who were    |                                                              |\n","|                   killed in this accident.                   | This is the third time this year that I've had to leave him  |\n","|                                                              | home alone for any length of time because of work or school  |\n","|                                                              |  or family commitments. And it's been the fourth time that   |\n","|   I am trying to raise $10,000 to cover all of his medical   |  I've been asked to explain why it's so important for me to  |\n","|  bills and funeral expenses so that he can get back on his   |           be there for him when he needs me most.            |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |                  he\u001b[0m started to kick again.                   |\n","|  mom and dad who were looking for him. They took him to the  |                                                              |\n","| hospital where he is currently being treated for hypothermia | \"Hey, Dad,\" said the other boy in the back seat of the car.  |\n","|                       and dehydration.                       |    \"You're kicking so hard that your feet are hitting the    |\n","|                                                              |                           floor.\"                            |\n","| The story is heartbreaking, but it's also a reminder that we |                                                              |\n","|    need to be vigilant about keeping our kids safe in the    |        \"I'm not kicking,\" I said. \"I'm just kicking.\"        |\n","|        woods. It's easy to get caught up in all of th        |                                                              |\n","|                                                              |   The other boy's eyes went wide and his face fell. He had   |\n","|                                                              |           never seen me like this before: angry a            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |                  he\u001b[0m started to kick again.                   |\n","|   now, but it's still scary to think about what could have   |                                                              |\n","| happened if he had been playing in the street instead of on  | I've been on the receiving end of this sort of thing before. |\n","|                        his own turf.                         | My son has always been a little reckless with his footballs, |\n","|                                                              | and when he was about eight years old I remember him getting |\n","|   The other day I was watching a video of one of my son's    |     in trouble for kicking one so hard that it broke the     |\n","|   friends play football with his little brother. They were   |  backboard and flew into the stands. He would never do that  |\n","|  both 6 years old and were running around like crazy trying  |        again because I told him not to get himself i         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |    he\u001b[0m went to the bathroom and came back in with a lot of    |\n","| watched him do this for a few minutes before I noticed that  |                      blood on his face.                      |\n","| he was bleeding from his penis. He was bleeding so much that |                                                              |\n","|      it looked like blood had been drawn from his body.      | He had been playing with a loaded gun that had been left on  |\n","|                                                              | top of the toilet seat. The muzzle was pointing down at him  |\n","|  I went to get him help immediately, but when I got there,   | and he was trying to get it off the floor. He kicked it away |\n","| the doctor told me that it would be too late to save him. H  |  from him, but it went right through his hands and into his  |\n","|                                                              |                            face.                             |\n","|                                                              |                                                              |\n","|                                                              |                          My son is                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |   he\u001b[0m got back to the house and I went into the kitchen to    |\n","|    the hospital and is now in stable condition. I'm very     |   get him some food. I came back out and there was a huge    |\n","|   thankful that he's alive and has been released from the    |  crowd of people outside the house. They were shouting \"No!  |\n","|                          hospital.                           |                             No!\"                             |\n","|                                                              |                                                              |\n","| I'm also thankful that this happened on a Sunday afternoon,  |        My son said \"Mommy, they're going to kick me.\"        |\n","|  when kids are out of school and parents are more likely to  |                                                              |\n","|   be at home with their children than they would be on any   |  I said \"What?\" And then I started crying because it's hard  |\n","|                          other day                           |                for me to imagine that this is                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |   he\u001b[0m went to the bathroom and came back in to kick a ball    |\n","|                                                              | again. And then he went to the bathroom again and came back  |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |                     in for a third time.                     |\n","|                                                              |                                                              |\n","| He took off his helmet and put it on the ground. He put his  | The next day, I woke up with an awful headache. I had never  |\n","|   hands in the air and started to run around like a little   |   felt so sick before or been so angry about anything else   |\n","| kid. I could tell he was excited about playing soccer again  |          that happened in my life before or since.           |\n","|   after being away from it for so long. He ran around like   |                                                              |\n","|                      crazy and we play                       |           I was sick because I knew what it meant:           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=50,\n","    act_name=23,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"R4TgRuGOvDDx","executionInfo":{"status":"ok","timestamp":1689511651142,"user_tz":-60,"elapsed":55721,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"c302283f-0d4c-4caf-fb77-e24721172376"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |    he\u001b[0m took a few steps and fell backwards. I immediately     |\n","| unconscious for about 15 minutes. I got him to the hospital  |   grabbed him and started to carry him back to the house.    |\n","|    and they did some tests on him and found that he had a    |                                                              |\n","|                         concussion.                          |   \"I'm sorry,\" I said as I picked him up. \"You're going to   |\n","|                                                              |                            fall.\"                            |\n","|   I'm not sure what happened but I know that it wasn't his   |                                                              |\n","|  fault. He's been in football since he was 3 years old and   |  \"No, it's okay,\" he said with a smile on his face. \"I just  |\n","|        has never had any concussions before this one.        |                            fell.\"                            |\n","|                                                              |                                                              |\n","|                                                              |  He was joking about falling over and then getting back up   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |   he\u001b[0m went to the bathroom and started to go pee. I was not   |\n","|  the hospital where they gave him an IV and told me that he  |           going to let him go until he came back.            |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |                                                              |\n","|                                                              |  I'm a single mom of two boys, ages 12 and 14. I work full   |\n","| My son's father is a physician in our community who has been |  time as an administrative assistant at a public school in   |\n","|    practicing medicine for over 30 years. He's worked in     | Washington D.C., where we have three other kids (two of whom |\n","|   hospitals all over the country and has seen his share of   |  are in school). My husband works for the government as an   |\n","|                     tragedies like this                      |                          informati                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |   he\u001b[0m and his dad were in the middle of the street playing    |\n","| serious injuries. I'm asking for help to pay for his medical |  catch. The cops came up to them and said they had to stop   |\n","|    bills and the funeral expenses of his parents who were    |         because they were \"too close\" to each other.         |\n","|                   killed in this accident.                   |                                                              |\n","|                                                              | My son said that he was just playing catch with his dad, but |\n","|                                                              |   the cop insisted that he was not allowed to play anymore   |\n","|   I am trying to raise $10,000 to cover all of his medical   | because they were too close. He then told him that if he did |\n","|  bills and funeral expenses so that he can get back on his   |                        not move back                         |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |   he\u001b[0m stopped and looked at me. \"I'm not going to kick the    |\n","|  mom and dad who were looking for him. They took him to the  |               ball,\" he said. \"It's too hard.\"               |\n","| hospital where he is currently being treated for hypothermia |                                                              |\n","|                       and dehydration.                       |  \"But it's your dad,\" I said. \"You're supposed to kick the   |\n","|                                                              |                            ball.\"                            |\n","| The story is heartbreaking, but it's also a reminder that we |                                                              |\n","|    need to be vigilant about keeping our kids safe in the    |          \"No,\" he said again. \"I'm not kicking it.\"          |\n","|        woods. It's easy to get caught up in all of th        |                                                              |\n","|                                                              |   He had been thinking about this for a while now, and now   |\n","|                                                              |                         that we wer                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |   he\u001b[0m stopped and looked at me. \"What's that?\" he asked. I    |\n","|   now, but it's still scary to think about what could have   |   explained that it was a ball made of foam and some other   |\n","| happened if he had been playing in the street instead of on  | stuff that I didn't know what to call it yet. He said, \"Oh,  |\n","|                        his own turf.                         |           you can do anything with those things.\"            |\n","|                                                              |                                                              |\n","|   The other day I was watching a video of one of my son's    | I have been playing with these things for about an hour now  |\n","|   friends play football with his little brother. They were   |    and they are so much fun! They are really easy to mak     |\n","|  both 6 years old and were running around like crazy trying  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |    he\u001b[0m started to run and the ball hit him in the head. He    |\n","| watched him do this for a few minutes before I noticed that  |   fell to the ground and I ran over to see what happened.    |\n","| he was bleeding from his penis. He was bleeding so much that |                                                              |\n","|      it looked like blood had been drawn from his body.      | He was unconscious for a few minutes but eventually woke up  |\n","|                                                              |   and went back into the game. I'm not sure if he was just   |\n","|  I went to get him help immediately, but when I got there,   | tired or if there were any injuries that happened after that |\n","| the doctor told me that it would be too late to save him. H  |              but he didn't seem too bad at all.              |\n","|                                                              |                                                              |\n","|                                                              |                           Then, w                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |               he\u001b[0m took a step back and stopped.               |\n","|    the hospital and is now in stable condition. I'm very     |                                                              |\n","|   thankful that he's alive and has been released from the    |                   \"What's wrong?\" I asked.                   |\n","|                          hospital.                           |                                                              |\n","|                                                              |      \"I'm not sure,\" he said. \"I just don't feel good.\"      |\n","| I'm also thankful that this happened on a Sunday afternoon,  |                                                              |\n","|  when kids are out of school and parents are more likely to  | He had an obvious headache and was breathing hard. He didn't |\n","|   be at home with their children than they would be on any   |   look like he wanted to be there anymore, but I knew that   |\n","|                          other day                           | wasn't the right thing to say to him at this time of day. S  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |   he\u001b[0m started running. He ran for a while and then stopped.   |\n","|                                                              |   He said he wanted to go back to the house but I told him   |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |  that I didn't want him to go back there because it was so   |\n","|                                                              |       hot in there and that it was dangerous for him.        |\n","| He took off his helmet and put it on the ground. He put his  |                                                              |\n","|   hands in the air and started to run around like a little   |  I'm not sure what happened next but I do know that when he  |\n","| kid. I could tell he was excited about playing soccer again  | got home, he called me crying because his legs were shaking  |\n","|   after being away from it for so long. He ran around like   |                              s                               |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=50,\n","    act_name=8,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2xpwv7jJvVNU","executionInfo":{"status":"ok","timestamp":1689511706651,"user_tz":-60,"elapsed":53899,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f581c591-18d1-4a98-d019-31cdb18e4120"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |    he\u001b[0m got tackled by a linebacker. The linebacker was big    |\n","| unconscious for about 15 minutes. I got him to the hospital  |  and strong and he had his hands on my son's neck. My son's  |\n","|    and they did some tests on him and found that he had a    | neck is broken in two places and his jaw is broken in three  |\n","|                         concussion.                          |  places. He has been in the hospital for three days now and  |\n","|                                                              | I'm still trying to figure out how to get him back to normal |\n","|   I'm not sure what happened but I know that it wasn't his   |                  life as soon as possible.\"                  |\n","|  fault. He's been in football since he was 3 years old and   |                                                              |\n","|        has never had any concussions before this one.        |                  \"I've never seen anything                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |       he\u001b[0m went to the bathroom and started playing with       |\n","|  the hospital where they gave him an IV and told me that he  | himself. He's been doing this for about a week now. I don't  |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    | know what's going on in his head but I'm concerned about it. |\n","|                                                              |                                                              |\n","| My son's father is a physician in our community who has been |  I'm not sure if he's masturbating or not but I've noticed   |\n","|    practicing medicine for over 30 years. He's worked in     |   that when he does it, his penis gets really hard and the   |\n","|   hospitals all over the country and has seen his share of   |         veins in his penis are very visible (they're         |\n","|                     tragedies like this                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |    he\u001b[0m was out playing in the yard with his friends. Then,    |\n","| serious injuries. I'm asking for help to pay for his medical |         he went to school. And then, I went to work.         |\n","|    bills and the funeral expenses of his parents who were    |                                                              |\n","|                   killed in this accident.                   |  I have no idea what time it is now. But it's getting dark   |\n","|                                                              |    outside and I'm starting to feel tired and sleepy and     |\n","|                                                              |  anxious about what's going on in my life right now – which  |\n","|   I am trying to raise $10,000 to cover all of his medical   | is exactly why I've been so busy trying not to think about i |\n","|  bills and funeral expenses so that he can get back on his   |                                                              |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |          he\u001b[0m ran into the yard and got hit by a car.          |\n","|  mom and dad who were looking for him. They took him to the  |                                                              |\n","| hospital where he is currently being treated for hypothermia |          I'm sure you've seen this picture before:           |\n","|                       and dehydration.                       |                                                              |\n","|                                                              | It's from a video of my son being hit by a car while playing |\n","| The story is heartbreaking, but it's also a reminder that we | football. He was not wearing any protective gear at the time |\n","|    need to be vigilant about keeping our kids safe in the    | of the accident. He had his helmet on but it didn't protect  |\n","|        woods. It's easy to get caught up in all of th        | him from the impact to his head or his neck or anything else |\n","|                                                              |                             tha                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |   he\u001b[0m ran into the street and got hit by a car. He's in the   |\n","|   now, but it's still scary to think about what could have   |     hospital now with a broken leg and some broken ribs.     |\n","| happened if he had been playing in the street instead of on  |                                                              |\n","|                        his own turf.                         | My wife and I are just trying to figure out what we're going |\n","|                                                              |   to do next. We have insurance on our house, but we don't   |\n","|   The other day I was watching a video of one of my son's    | have health insurance on our son because of his pre-existing |\n","|   friends play football with his little brother. They were   |   condition. We can't afford it without health insurance s   |\n","|  both 6 years old and were running around like crazy trying  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |   he\u001b[0m started to get tired and his legs were getting tired.   |\n","| watched him do this for a few minutes before I noticed that  |   He had to stop playing because he was getting dizzy and    |\n","| he was bleeding from his penis. He was bleeding so much that |  couldn't keep up with the ball. I asked him what happened   |\n","|      it looked like blood had been drawn from his body.      |  and he said that he felt something in his head. I told him  |\n","|                                                              |  to go home, but when I went there, it was just a big white  |\n","|  I went to get him help immediately, but when I got there,   |    cloud that came over me like it was fog or something.\"    |\n","| the doctor told me that it would be too late to save him. H  |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |                     he\u001b[0m got hit by a car.                     |\n","|    the hospital and is now in stable condition. I'm very     |                                                              |\n","|   thankful that he's alive and has been released from the    |             He's fine now, but I'm not so lucky.             |\n","|                          hospital.                           |                                                              |\n","|                                                              |  I'm just glad that he's alive and that I didn't get hit by  |\n","| I'm also thankful that this happened on a Sunday afternoon,  | the car. It could have been much worse for me. And it could  |\n","|  when kids are out of school and parents are more likely to  |                 have been worse for him too!                 |\n","|   be at home with their children than they would be on any   |                                                              |\n","|                          other day                           |                                                              |\n","|                                                              | The reason why this is important to me is because I am going |\n","|                                                              |                       to go on a trip                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |   he\u001b[0m started running. He ran up the street and stopped in    |\n","|                                                              |  front of a house. He went inside and got on the phone with  |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |           his mommy to tell her that he was okay.            |\n","|                                                              |                                                              |\n","| He took off his helmet and put it on the ground. He put his  | Then, I heard him screaming in pain. I ran over to see what  |\n","|   hands in the air and started to run around like a little   |   was wrong and saw that his foot had been cut off by some   |\n","| kid. I could tell he was excited about playing soccer again  |                    sort of sharp object.                     |\n","|   after being away from it for so long. He ran around like   |                                                              |\n","|                      crazy and we play                       |                  My son's foot is not long                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=300,\n","    act_name=8,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LoT034Akv-sK","executionInfo":{"status":"ok","timestamp":1689511846582,"user_tz":-60,"elapsed":51846,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"7b529c49-853f-4dba-9c8c-0336b0a0fd81"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |   he\u001b[0m was kicked. And then he got to be the player that was   |\n","| unconscious for about 15 minutes. I got him to the hospital  | the player that had been the player that had been the person |\n","|    and they did some tests on him and found that he had a    | who had been and to be and and when and before him, when he  |\n","|                         concussion.                          |                       was before him.                        |\n","|                                                              |                              …?                              |\n","|   I'm not sure what happened but I know that it wasn't his   |                              …?                              |\n","|  fault. He's been in football since he was 3 years old and   |  I don't know what I'm doing in here. I don't know what I'm  |\n","|        has never had any concussions before this one.        |           doing in here. I don't know what's going           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |                he\u001b[0m was out kicked a football.                 |\n","|  the hospital where they gave him an IV and told me that he  |  ?No?No?No?No?No?Yes, you're not going to do it. You're not  |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |  going to do it because you know what is doing and how many  |\n","|                                                              |  times are you going to be doing and how many times are you  |\n","| My son's father is a physician in our community who has been |   thinking about the number of time that are the number of   |\n","|    practicing medicine for over 30 years. He's worked in     |   time that are still doing and when the number of time I    |\n","|   hospitals all over the country and has seen his share of   |                                                              |\n","|                     tragedies like this                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |                       he\u001b[0m was at that.                        |\n","| serious injuries. I'm asking for help to pay for his medical |                              …?                              |\n","|    bills and the funeral expenses of his parents who were    |                        …? …? …? …? …?                        |\n","|                   killed in this accident.                   |                      …?\"….<|endoftext|>                      |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|   I am trying to raise $10,000 to cover all of his medical   |                                                              |\n","|  bills and funeral expenses so that he can get back on his   |                                                              |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |    he\u001b[0m got to shoot the game? I don will to is and shot a     |\n","|  mom and dad who were looking for him. They took him to the  |  game? I don of it that that shot it in that ? This of this  |\n","| hospital where he is currently being treated for hypothermia | and shoot it I don is as then shooting this gun the time at  |\n","|                       and dehydration.                       | with me shooting the ? not now, I shoot . It has still to ?. |\n","|                                                              | But on of . The have still to any as ? As . The have won by  |\n","| The story is heartbreaking, but it's also a reminder that we |                             . As                             |\n","|    need to be vigilant about keeping our kids safe in the    |                                                              |\n","|        woods. It's easy to get caught up in all of th        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |   he\u001b[0m got to see what it is? It is that? It is that? It was   |\n","|   now, but it's still scary to think about what could have   | that? It was before he saw before him. He kicked a ball at a |\n","| happened if he had been playing in the street instead of on  | ball at a ball at the ground of what had before him the and  |\n","|                        his own turf.                         | of where it would and after he had said to it did not do any |\n","|                                                              |   but now. Now he asked who or who has to this other than    |\n","|   The other day I was watching a video of one of my son's    |                     where than what tha                      |\n","|   friends play football with his little brother. They were   |                                                              |\n","|  both 6 years old and were running around like crazy trying  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |    he\u001b[0m had the game in the United States. And then, it was    |\n","| watched him do this for a few minutes before I noticed that  |                            here.                             |\n","| he was bleeding from his penis. He was bleeding so much that |                              …?                              |\n","|      it looked like blood had been drawn from his body.      |   Well, it's been here since he was here before that… It's   |\n","|                                                              | been in New York and New York City and at least one of those |\n","|  I went to get him help immediately, but when I got there,   |    is going to be there for the next couple of years… …?     |\n","| the doctor told me that it would be too late to save him. H  |   It's been in New York City since it was at least one of    |\n","|                                                              |                        those two sinc                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |                  he\u001b[0m was out the and of him.                  |\n","|    the hospital and is now in stable condition. I'm very     |                         …?…?…?…?…?….                         |\n","|   thankful that he's alive and has been released from the    | The and of her is now on her is on the and of her is on the  |\n","|                          hospital.                           |  she is on the and are now on their are still on their are   |\n","|                                                              | still in the . She is off she or they or they were . They or |\n","| I'm also thankful that this happened on a Sunday afternoon,  |         it has no them in no you no you , it that ?          |\n","|  when kids are out of school and parents are more likely to  |                                                              |\n","|   be at home with their children than they would be on any   |                                                              |\n","|                          other day                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |   he\u001b[0m had to go back to the two?m?i?tte at 2?m?m?i??gh more   |\n","|                                                              |  than the 2 million that he has now. He has no more money.   |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |   or if you have it, then you have not done it. You are not  |\n","|                                                              | going to do anything and I don't want any other man to be on |\n","| He took off his helmet and put it on the ground. He put his  |           that another man because you are in your           |\n","|   hands in the air and started to run around like a little   |                                                              |\n","| kid. I could tell he was excited about playing soccer again  |                                                              |\n","|   after being away from it for so long. He ran around like   |                                                              |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["## Trying scifi - fantasy"],"metadata":{"id":"1R45-W8Lw74d"}},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=30,\n","    act_name=8,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=stories[\"fantasy\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cxp_nefDw-U9","executionInfo":{"status":"ok","timestamp":1689512150849,"user_tz":-60,"elapsed":53173,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"22d877d4-28d7-41e6-8b79-169fc8234ca1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |     he\u001b[0m took a big hit to the head and went down. He was      |\n","| unconscious for about 15 minutes. I got him to the hospital  | unconscious for about 15 minutes. I got him to the hospital  |\n","|    and they did some tests on him and found that he had a    |  and then we waited for the ambulance to come. When it did,  |\n","|                         concussion.                          | they said he had brain damage from the hit and that he had a |\n","|                                                              |                       fractured skull.                       |\n","|   I'm not sure what happened but I know that it wasn't his   |                                                              |\n","|  fault. He's been in football since he was 3 years old and   |   The doctor told me that his head injury was caused by an   |\n","|        has never had any concussions before this one.        |     illegal tackle by another player on our team who is      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |   he\u001b[0m went to the bathroom and passed out. I rushed him to    |\n","|  the hospital where they gave him an IV and told me that he  |     the hospital where they took him into surgery for an     |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |                   emergency appendectomy.                    |\n","|                                                              |                                                              |\n","| My son's father is a physician in our community who has been |  The doctor told me that he had just been in a car accident  |\n","|    practicing medicine for over 30 years. He's worked in     | and his intestines were damaged from being thrown around in  |\n","|   hospitals all over the country and has seen his share of   | the back seat of the car. The doctors said that if it wasn't |\n","|                     tragedies like this                      |      for his insurance, they would have had to operate       |\n","|                                                              |                      immediately on his                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |     he\u001b[0m was hit by a car. He is now in the hospital with      |\n","| serious injuries. I'm asking for help to pay for his medical |    serious injuries. I am asking for help to pay for his     |\n","|    bills and the funeral expenses of his parents who were    |  medical bills and the funeral expenses of his parents. My   |\n","|                   killed in this accident.                   | son has two brothers who are both in their 20's and they are |\n","|                                                              | also soccer players who play for their high school teams and |\n","|                                                              | college teams as well as being active in their communities.  |\n","|   I am trying to raise $10,000 to cover all of his medical   |                                                              |\n","|  bills and funeral expenses so that he can get back on his   |                 My husband is an attorney a                  |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |   he\u001b[0m ran into the woods and got lost. He was found by his    |\n","|  mom and dad who were looking for him. They took him to the  |  mom and dad who were looking for him. They took him to the  |\n","| hospital where he is currently being treated for hypothermia |    hospital where he is being treated for dehydration and    |\n","|                       and dehydration.                       |                         hypothermia.                         |\n","|                                                              |                                                              |\n","| The story is heartbreaking, but it's also a reminder that we |     The family is asking for help in finding their son's     |\n","|    need to be vigilant about keeping our kids safe in the    |   whereabouts so they can bring him home safely to be with   |\n","|        woods. It's easy to get caught up in all of th        |           them again. Please help us find our son!           |\n","|                                                              |                                                              |\n","|                                                              |                     Help spread the wor                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |   he\u001b[0m ran into the neighbor's house and fell on the floor.    |\n","|   now, but it's still scary to think about what could have   |   He had a concussion and some bleeding in his brain. The    |\n","| happened if he had been playing in the street instead of on  |     neighbors called 911 and rushed him to the hospital.     |\n","|                        his own turf.                         |                                                              |\n","|                                                              | The paramedics took him to another hospital where they found |\n","|   The other day I was watching a video of one of my son's    |  out that he had suffered a mild stroke from his fall. They  |\n","|   friends play football with his little brother. They were   |  put him on life support for several hours until they could  |\n","|  both 6 years old and were running around like crazy trying  |           get an MRI done to see if there was any            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |    he\u001b[0m decided to play some \"man-to-man\" defense. He's not    |\n","| watched him do this for a few minutes before I noticed that  | the most athletic kid in the world, but he's got some pretty |\n","| he was bleeding from his penis. He was bleeding so much that |  good instincts and a pretty good feel for what's going on   |\n","|      it looked like blood had been drawn from his body.      |                         around him.                          |\n","|                                                              |                                                              |\n","|  I went to get him help immediately, but when I got there,   | The other day, I asked him if he thought it was okay to hit  |\n","| the doctor told me that it would be too late to save him. H  | someone with his shoulder pads when they're running at you.  |\n","|                                                              |                     He said no — that i                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |   he\u001b[0m took a hit to the head and went down. He was taken to   |\n","|    the hospital and is now in stable condition. I'm very     |  the hospital and is now in critical condition. I'm asking   |\n","|   thankful that he's alive and has been released from the    |    for help with his medical bills and funeral expenses.     |\n","|                          hospital.                           |                                                              |\n","|                                                              |    He is an amazing kid who has always been kind, funny,     |\n","| I'm also thankful that this happened on a Sunday afternoon,  |    generous and hard working. He's always had a positive     |\n","|  when kids are out of school and parents are more likely to  | attitude about life and has never let anything get him down. |\n","|   be at home with their children than they would be on any   |                 His friends say that he will                 |\n","|                          other day                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |                  he\u001b[0m decided to take a nap.                   |\n","|                                                              |                                                              |\n","|        \"Dad,\" I said, \"I think you should try this.\"         | I woke him up and told him that we had to go for a walk. He  |\n","|                                                              |   said that he wanted to play with his friends and that he   |\n","| He took off his helmet and put it on the ground. He put his  |  would be back in time for breakfast. I said no way! We had  |\n","|   hands in the air and started to run around like a little   | an hour before the school bus came so we were going to walk  |\n","| kid. I could tell he was excited about playing soccer again  |  around the neighborhood and get some fresh air. He agreed   |\n","|   after being away from it for so long. He ran around like   |                        but when we g                         |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=30,\n","    act_name=8,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"fantasy\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1QyN49LCxdMT","executionInfo":{"status":"ok","timestamp":1689512259726,"user_tz":-60,"elapsed":50842,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"89fa58b2-be2c-4198-a7ae-c3b7576b59f3"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |     he\u001b[0m took a big hit to the head and went down. He was      |\n","| unconscious for about 15 minutes. I got him to the hospital  | unconscious for about 15 minutes. I got him to the hospital  |\n","|    and they did some tests on him and found that he had a    |    and they did some tests on him and found that he had a    |\n","|                         concussion.                          |                         concussion.                          |\n","|                                                              |                                                              |\n","|   I'm not sure what happened but I know that it wasn't his   |   I'm not sure what happened but I know that it wasn't his   |\n","|  fault. He's been in football since he was 3 years old and   |  fault. He's been in football since he was 3 years old and   |\n","|        has never had any concussions before this one.        |        has never had any concussions before this one,        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |   he\u001b[0m went to the bathroom and passed out. I rushed him to    |\n","|  the hospital where they gave him an IV and told me that he  |   the hospital where they gave him an IV and sent him home   |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |           with some medicine for his stomach pain.           |\n","|                                                              |                                                              |\n","| My son's father is a physician in our community who has been |  The next day, I got a call from the doctor who was taking   |\n","|    practicing medicine for over 30 years. He's worked in     | care of my son's condition: \"He has a very serious infection |\n","|   hospitals all over the country and has seen his share of   |    in his abdomen.\" He told me that he needed to go into     |\n","|                     tragedies like this                      |                     surgery right away.                      |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |     he\u001b[0m was hit by a car. He is now in the hospital with      |\n","| serious injuries. I'm asking for help to pay for his medical | serious injuries. I'm asking for help to pay for his medical |\n","|    bills and the funeral expenses of his parents who were    |    bills and the funeral expenses of his parents who were    |\n","|                   killed in this accident.                   |                   killed in this accident.                   |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|   I am trying to raise $10,000 to cover all of his medical   |   I am trying to raise $10,000 to cover all of his medical   |\n","|  bills and funeral expenses so that he can get back on his   |  bills and funeral expenses so that he can get back on his   |\n","|         feet as soon as possible and be able to star         |         feet as soon as possible and be able to star         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |   he\u001b[0m ran into the neighbor's house and was knocked down by   |\n","|  mom and dad who were looking for him. They took him to the  |  a brick. He suffered serious injuries to his head and neck  |\n","| hospital where he is currently being treated for hypothermia |                  that will require surgery.                  |\n","|                       and dehydration.                       |                                                              |\n","|                                                              |  I'm asking for your help in raising money to help pay for   |\n","| The story is heartbreaking, but it's also a reminder that we |     his medical bills and other expenses related to this     |\n","|    need to be vigilant about keeping our kids safe in the    |                 incident. Any amount helps!                  |\n","|        woods. It's easy to get caught up in all of th        |                                                              |\n","|                                                              | Please donate what you can! Thank you so much!<|endoftext|>  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |    he\u001b[0m ran into the street and got hit by a car. He's fine    |\n","|   now, but it's still scary to think about what could have   |   now, but it's still scary to think about what could have   |\n","| happened if he had been playing in the street instead of on  | happened if he had been hit by a car while playing football. |\n","|                        his own turf.                         |                                                              |\n","|                                                              |  In fact, I've been thinking about this for quite some time  |\n","|   The other day I was watching a video of one of my son's    |   now. I'm not sure why that is; maybe it's because of the   |\n","|   friends play football with his little brother. They were   |             video of my son getting hit by a car             |\n","|  both 6 years old and were running around like crazy trying  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |                 he\u001b[0m decided to go for a run.                  |\n","| watched him do this for a few minutes before I noticed that  |                                                              |\n","| he was bleeding from his penis. He was bleeding so much that | I had no idea what to do with him. I didn't want him to get  |\n","|      it looked like blood had been drawn from his body.      |  hurt or hurt himself. So I just left him alone and let the  |\n","|                                                              |   game continue without me there to keep an eye on things.   |\n","|  I went to get him help immediately, but when I got there,   |                                                              |\n","| the doctor told me that it would be too late to save him. H  |  But when he came back home from the field, I saw something  |\n","|                                                              |   that made me stop and think: He was crying because he wa   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |    he\u001b[0m went to the bathroom and vomited. He was sick for a    |\n","|    the hospital and is now in stable condition. I'm very     | few hours. I took him to the doctor and they told me that he |\n","|   thankful that he's alive and has been released from the    |                 had been sick for two days.                  |\n","|                          hospital.                           |                                                              |\n","|                                                              |   The doctor said that he had probably been infected with    |\n","| I'm also thankful that this happened on a Sunday afternoon,  |    Hepatitis A or B, which is a virus that can be spread     |\n","|  when kids are out of school and parents are more likely to  |     through contaminated food or water. The virus is not     |\n","|   be at home with their children than they would be on any   |       airborne and usually does not cause any symptoms       |\n","|                          other day                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |              he\u001b[0m decided to play catch with me.               |\n","|                                                              |                                                              |\n","|        \"Dad,\" I said, \"I think you should try this.\"         | He was in his car seat when I got there and the car seat had |\n","|                                                              | been moved to the front of the vehicle. The front seats are  |\n","| He took off his helmet and put it on the ground. He put his  | not meant for children to sit in, but I figured it would be  |\n","|   hands in the air and started to run around like a little   |  okay since he's a little older than most kids his age. He   |\n","| kid. I could tell he was excited about playing soccer again  |  sat down on the backseat and then proceeded to kick my leg  |\n","|   after being away from it for so long. He ran around like   |                           with his                           |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=70,\n","    act_name=18,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=stories[\"fantasy\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"M6qpzeVAxMds","executionInfo":{"status":"ok","timestamp":1689512207174,"user_tz":-60,"elapsed":56344,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"6de3b9c4-4a1f-40ed-ff0f-1f99a94ab308"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |   he\u001b[0m got hit by a car. He was taken to the hospital and is   |\n","| unconscious for about 15 minutes. I got him to the hospital  |                     in stable condition.                     |\n","|    and they did some tests on him and found that he had a    |                                                              |\n","|                         concussion.                          |   I am very grateful that I had the opportunity to see him   |\n","|                                                              |  yesterday and today. He is doing well, but I know that his  |\n","|   I'm not sure what happened but I know that it wasn't his   |   recovery will be long and difficult. My family has been    |\n","|  fault. He's been in football since he was 3 years old and   |  through this before with my sister-in-law who had surgery   |\n","|        has never had any concussions before this one.        |     for breast cancer at age 25 after being diagnosed a      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |            he\u001b[0m took a knee. And then he sat down.             |\n","|  the hospital where they gave him an IV and told me that he  |                                                              |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    | I've seen him do this before, but I've never seen him do it  |\n","|                                                              | with such conviction and intensity as he did yesterday. It's |\n","| My son's father is a physician in our community who has been |  been a while since I've seen him so focused on something –  |\n","|    practicing medicine for over 30 years. He's worked in     |               anything – other than football.                |\n","|   hospitals all over the country and has seen his share of   |                                                              |\n","|                     tragedies like this                      | It's been quite the week for my son, too: his first year in  |\n","|                                                              |                        college is jus                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |    he\u001b[0m and his friends were playing soccer. And then they     |\n","| serious injuries. I'm asking for help to pay for his medical | were playing hockey. And then they were playing basketball.  |\n","|    bills and the funeral expenses of his parents who were    |         And then they were doing it all over again.          |\n","|                   killed in this accident.                   |                                                              |\n","|                                                              |  And that's when I realized something: My son is not just a  |\n","|                                                              |  kid anymore; he's a grown-up now! He's grown up enough to   |\n","|   I am trying to raise $10,000 to cover all of his medical   |    know what he wants to do with his life, and he has the    |\n","|  bills and funeral expenses so that he can get back on his   |                            skills                            |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |         he\u001b[0m ran into the street and was hit by a car.         |\n","|  mom and dad who were looking for him. They took him to the  |                                                              |\n","| hospital where he is currently being treated for hypothermia |               I'm sure you've seen this video:               |\n","|                       and dehydration.                       |                                                              |\n","|                                                              |  It's heartbreaking to see my son get hit by a car and then  |\n","| The story is heartbreaking, but it's also a reminder that we | watch him lying on the ground in pain. I'm so thankful that  |\n","|    need to be vigilant about keeping our kids safe in the    |    he is okay, but it's hard to watch. I don't know what     |\n","|        woods. It's easy to get caught up in all of th        |     happened or why this happened to him, but I do know      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |    he\u001b[0m ran into the street and was hit by a car. He's been    |\n","|   now, but it's still scary to think about what could have   |  in the hospital for two days now and is still fighting for  |\n","| happened if he had been playing in the street instead of on  |                          his life.                           |\n","|                        his own turf.                         |                                                              |\n","|                                                              |    The driver of the car has been charged with vehicular     |\n","|   The other day I was watching a video of one of my son's    | homicide and leaving the scene of an accident. I'm not sure  |\n","|   friends play football with his little brother. They were   | if he will be charged with anything else yet, but I'm hoping |\n","|  both 6 years old and were running around like crazy trying  |        that he gets off because this is just too much        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |          he\u001b[0m started to get dizzy. He had a seizure.          |\n","| watched him do this for a few minutes before I noticed that  |                                                              |\n","| he was bleeding from his penis. He was bleeding so much that | My first thought was that I'd just lost him in the crowd of  |\n","|      it looked like blood had been drawn from his body.      | kids playing football. But then I realized that this wasn't  |\n","|                                                              |  just any soccer game; it was a game for kids with epilepsy  |\n","|  I went to get him help immediately, but when I got there,   | and their families, organized by the Epilepsy Foundation of  |\n","| the doctor told me that it would be too late to save him. H  |  America (EFNA). The Epilepsy Foundation is an organization  |\n","|                                                              |                     dedicated to helping                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |                     he\u001b[0m got hit by a car.                     |\n","|    the hospital and is now in stable condition. I'm very     |                                                              |\n","|   thankful that he's alive and has been released from the    |                   He's lucky to be alive.                    |\n","|                          hospital.                           |                                                              |\n","|                                                              |   The driver of the car is facing charges for leaving the    |\n","| I'm also thankful that this happened on a Sunday afternoon,  |  scene of an accident involving injury or death. He was not  |\n","|  when kids are out of school and parents are more likely to  | injured in the crash, but it did leave him with some serious |\n","|   be at home with their children than they would be on any   | injuries that required emergency surgery and several days in |\n","|                          other day                           | the hospital. My son is lucky to be alive because he had his |\n","|                                                              |                       helmet on at th                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |   he\u001b[0m started running. He ran all the way to the other side   |\n","|                                                              | of our yard and stopped. I looked at him and said, \"I think  |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |                  you're having a seizure.\"                   |\n","|                                                              |                                                              |\n","| He took off his helmet and put it on the ground. He put his  | He just stared back at me with those big eyes. He didn't say |\n","|   hands in the air and started to run around like a little   | anything. I thought maybe he was tired or something but then |\n","| kid. I could tell he was excited about playing soccer again  |   he turned around and walked back to his house in silence   |\n","|   after being away from it for so long. He ran around like   |            without saying anything more than tha             |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=70,\n","    act_name=18,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"fantasy\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2o75YtrMxhhb","executionInfo":{"status":"ok","timestamp":1689512314062,"user_tz":-60,"elapsed":54369,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"5d00131b-ad25-4b94-801c-753bfafc43c7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |     he\u001b[0m went to the bathroom and came back with a bag of      |\n","| unconscious for about 15 minutes. I got him to the hospital  |    chips. I was surprised that he had brought me chips. I    |\n","|    and they did some tests on him and found that he had a    |    didn't think he would be able to eat them all himself.    |\n","|                         concussion.                          |                                                              |\n","|                                                              |   I don't know what it is about him that makes him so much   |\n","|   I'm not sure what happened but I know that it wasn't his   | better at sports than I am, but I'm not going to let him get |\n","|  fault. He's been in football since he was 3 years old and   |                     away with this one!                      |\n","|        has never had any concussions before this one.        |                                                              |\n","|                                                              |                         He's only b                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |   he\u001b[0m went to the bathroom and started throwing up. He had    |\n","|  the hospital where they gave him an IV and told me that he  |   a fever of 102 degrees Fahrenheit. I called 911 and they   |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |   sent an ambulance to the house, but it took them over an   |\n","|                                                              |  hour to get there because of traffic. When they got there,  |\n","| My son's father is a physician in our community who has been |       he was still throwing up blood from his stomach.       |\n","|    practicing medicine for over 30 years. He's worked in     |                                                              |\n","|   hospitals all over the country and has seen his share of   | I've been trying to figure out what happened that day since  |\n","|                     tragedies like this                      |                  then. I've talked with his                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |   he\u001b[0m was out playing with his friends. He had no idea that   |\n","| serious injuries. I'm asking for help to pay for his medical | his mother had been diagnosed with Stage 4 cancer and would  |\n","|    bills and the funeral expenses of his parents who were    |               be in the hospital for a month.                |\n","|                   killed in this accident.                   |                                                              |\n","|                                                              |     My son's life has been turned upside down since the      |\n","|                                                              | diagnosis. He has lost all of his friends and family members |\n","|   I am trying to raise $10,000 to cover all of his medical   | to cancer. I am trying to stay positive but it is hard to do |\n","|  bills and funeral expenses so that he can get back on his   |             so when I know that he will be going             |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |         he\u001b[0m ran into the street and got hit by a car.         |\n","|  mom and dad who were looking for him. They took him to the  |                                                              |\n","| hospital where he is currently being treated for hypothermia | I've been trying to get him to go back inside for days now.  |\n","|                       and dehydration.                       |  I've been telling him that it's OK to play outside again,   |\n","|                                                              | but he won't listen. He just wants me to leave him alone so  |\n","| The story is heartbreaking, but it's also a reminder that we | he can play in the yard with his friends. I don't know what  |\n","|    need to be vigilant about keeping our kids safe in the    |            else I can do except keep pushing him             |\n","|        woods. It's easy to get caught up in all of th        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |    he\u001b[0m ran into the street and got hit by a car. He's fine    |\n","|   now, but it's still scary to think about what could have   |    now, but it's been a scary day for him and his family.    |\n","| happened if he had been playing in the street instead of on  |                                                              |\n","|                        his own turf.                         |   The driver of the car that hit him has been charged with   |\n","|                                                              | careless driving causing death. But there are more questions |\n","|   The other day I was watching a video of one of my son's    |  than answers about what happened that day: Why did he run   |\n","|   friends play football with his little brother. They were   |  into the street? What was his job? Did he have insurance?   |\n","|  both 6 years old and were running around like crazy trying  |                             Wha                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |              he\u001b[0m decided to get into the water.               |\n","| watched him do this for a few minutes before I noticed that  |                                                              |\n","| he was bleeding from his penis. He was bleeding so much that | I had no idea what to do. I was shocked that he would go in  |\n","|      it looked like blood had been drawn from his body.      | the water with me. He's always been an adventurous kid and I |\n","|                                                              | thought it would be fun for him to go in the water with me!  |\n","|  I went to get him help immediately, but when I got there,   |                                                              |\n","| the doctor told me that it would be too late to save him. H  |    So we got into the water and he was fine! We were both    |\n","|                                                              |    laughing about it as we were swimming around and doing    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |   he\u001b[0m went to the bathroom and vomited. He was fine after a   |\n","|    the hospital and is now in stable condition. I'm very     |  few minutes, but when I got home from work this morning he  |\n","|   thankful that he's alive and has been released from the    |                     was vomiting again.                      |\n","|                          hospital.                           |                                                              |\n","|                                                              | I took him to the emergency room at the hospital where they  |\n","| I'm also thankful that this happened on a Sunday afternoon,  |  were able to stabilize him and get him on antibiotics for   |\n","|  when kids are out of school and parents are more likely to  |  two days. They said that it's possible that his stomach is  |\n","|   be at home with their children than they would be on any   | going through an overgrowth of bacteria or parasites in his  |\n","|                          other day                           |                            intes                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |              he\u001b[0m decided to play catch with me.               |\n","|                                                              |                                                              |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |    He's a little over six feet tall and has been playing     |\n","|                                                              | football since he was about two years old. He's always been  |\n","| He took off his helmet and put it on the ground. He put his  |    very good at it and I've never had any issues with him    |\n","|   hands in the air and started to run around like a little   |           catching the ball or anything like that.           |\n","| kid. I could tell he was excited about playing soccer again  |                                                              |\n","|   after being away from it for so long. He ran around like   | But yesterday, when we were playing catch in the backyard, I |\n","|                      crazy and we play                       |           asked him if he wanted to try to make a            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=130,\n","    act_name=18,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HHSk9p7OxyjB","executionInfo":{"status":"ok","timestamp":1689512366180,"user_tz":-60,"elapsed":50975,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"c52c08f4-1288-49f5-d1ea-49f1dd4eeb3f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |    he\u001b[0m got hit by a chunk of ice that had been embedded in    |\n","| unconscious for about 15 minutes. I got him to the hospital  |                         the ground.                          |\n","|    and they did some tests on him and found that he had a    |              and this is what happened to him:               |\n","|                         concussion.                          |   I'm not sure if it's because I have too much time on my    |\n","|                                                              | hands or if it's because I'm just an idiot, but when we were |\n","|   I'm not sure what happened but I know that it wasn't his   |   trying to find a way to play the game without using our    |\n","|  fault. He's been in football since he was 3 years old and   |  normal tackle tool (the one that's used for everything els  |\n","|        has never had any concussions before this one.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |               he\u001b[0m went to play in the backyard.               |\n","|  the hospital where they gave him an IV and told me that he  |    knowledge about his new football team came from an old    |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    |   friend who lives in a house with two other friends and a   |\n","|                                                              | dog. They are all pretty good at football, so I knew he'd be |\n","| My son's father is a physician in our community who has been |                          good too.                           |\n","|    practicing medicine for over 30 years. He's worked in     |   them is just one of many things that I have learned about  |\n","|   hospitals all over the country and has seen his share of   | this boy since he was born. He is very smart and has a great |\n","|                     tragedies like this                      |                        sense of humor                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |    he\u001b[0m and his friend were in the middle of a conversation    |\n","| serious injuries. I'm asking for help to pay for his medical |  about how awesome it would be to play football with me. I   |\n","|    bills and the funeral expenses of his parents who were    |   told him that I had a plan to get there before the game    |\n","|                   killed in this accident.                   |        started. He said he'd wait for me at the gate.        |\n","|                                                              |                and here's what happened next:                |\n","|                                                              |  I'm sorry but this is not okay. My son is not an asshole,   |\n","|   I am trying to raise $10,000 to cover all of his medical   |                 but we are both human beings                 |\n","|  bills and funeral expenses so that he can get back on his   |                                                              |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |   he\u001b[0m stopped to check out the new field-level football and   |\n","|  mom and dad who were looking for him. They took him to the  |       said \"I don't know if I'm really good at this.\"        |\n","| hospital where he is currently being treated for hypothermia |     advanced warning: This post contains spoilers for The    |\n","|                       and dehydration.                       |                           Expanse.                           |\n","|                                                              |  these are the things that we do not know about each other.  |\n","| The story is heartbreaking, but it's also a reminder that we |  I told him that it was a pretty big deal to be playing in   |\n","|    need to be vigilant about keeping our kids safe in the    | the NFL for the first time since his first game when he was  |\n","|        woods. It's easy to get caught up in all of th        |                              11                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |     he\u001b[0m stopped to check out the new NFL helmet. It's not     |\n","|   now, but it's still scary to think about what could have   |  like he was wearing it for the first time or anything. He   |\n","| happened if he had been playing in the street instead of on  |  had been wearing it for about an hour and a half before we  |\n","|                        his own turf.                         | went to the game. I don't know what happened to him that day |\n","|                                                              | but I think he had something really good going on and I wish |\n","|   The other day I was watching a video of one of my son's    |                       he'd keep going.                       |\n","|   friends play football with his little brother. They were   |          -The football is actually made of leather           |\n","|  both 6 years old and were running around like crazy trying  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |       he\u001b[0m stopped to talk to me about his team's game.        |\n","| watched him do this for a few minutes before I noticed that  |  and here is the kicker. I told him that we were going to be |\n","| he was bleeding from his penis. He was bleeding so much that |     playing in a few hours and that we would need a new      |\n","|      it looked like blood had been drawn from his body.      | goalkeeper. He asked if he could get us some gloves! He had  |\n","|                                                              |  no idea what they were like so I just said \"I don't know\"   |\n","|  I went to get him help immediately, but when I got there,   |        but it was clear that he wanted them so I gav         |\n","| the doctor told me that it would be too late to save him. H  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |    he\u001b[0m went to the bathroom and came back with a very cool    |\n","|    the hospital and is now in stable condition. I'm very     |    looking white helmet. I thought it was so cool that I     |\n","|   thankful that he's alive and has been released from the    |             decided to give him his own helmet!              |\n","|                          hospital.                           |  they call him \"Polly\" because he is always smiling. He has  |\n","|                                                              |  been playing football for over 10 years now and is in his   |\n","| I'm also thankful that this happened on a Sunday afternoon,  |   4th year of high school. He is an athlete and has always   |\n","|  when kids are out of school and parents are more likely to  |              been interested in STEM (science,               |\n","|   be at home with their children than they would be on any   |                                                              |\n","|                          other day                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |    he\u001b[0m stopped to check out the view from the back of his     |\n","|                                                              |                             car.                             |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |   knowledge about how to play football and an understanding  |\n","|                                                              |  of how to get a better view from the back of your car are   |\n","| He took off his helmet and put it on the ground. He put his  |  two things that I would never have thought I'd need in one  |\n","|   hands in the air and started to run around like a little   |                      place at one time.                      |\n","| kid. I could tell he was excited about playing soccer again  |  It's hard not to be impressed by what these kids did. The   |\n","|   after being away from it for so long. He ran around like   |         only thing that makes me sad is that they di         |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=30,\n","    act_name=,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"fantasy\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"id":"tkEJPd0pxPPj"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Here is a story prompt again"],"metadata":{"id":"NutYVeRDyN3y"}},{"cell_type":"code","source":["import gc\n","gc.collect()\n","torch.cuda.empty_cache()"],"metadata":{"id":"mYPcjEEQN4QW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=90,\n","    act_name=16,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ppoc83OOOb96","executionInfo":{"status":"ok","timestamp":1689519831978,"user_tz":-60,"elapsed":56295,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"49d713e2-cf97-4196-8e2c-8ac9fb069fa1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     | A woman wakes up in a post-apocalyptic world with no memory  |\n","|  Francisco. She had been there for about two years, and was  | of her past. She's been given the power to create new life,  |\n","|   pretty good at her job. She loved the customers, and she   |   but she must use it wisely. She has to figure out what's   |\n","|  loved the food. She also loved to talk to them, and that's  |        going on before she can get out of this mess.         |\n","|  what she did when she got off work at about 6pm on Friday   |                                                              |\n","|                            night.                            | But there is one problem: the woman has no idea where she is |\n","|                                                              |                  or how to get home. She's                   |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   |  The first thing you need to know about the U.S. government  |\n","|   lap, when I noticed a man sitting next to me. He had his   |  is that it's really, really good at creating new laws and   |\n","|   hands in his pockets and was looking at something on his   |   then getting Congress to pass them. The second thing you   |\n","| phone. He didn't say anything to me but I could tell he was  |  need to know is that there are some things the government   |\n","| looking at something that made him uncomfortable. It wasn't  |  can't do because they're too dangerous or too expensive or  |\n","|       until he looked up that I realized what it was.        |    both. The third thing you need to know is that if the     |\n","|                                                              |                     government wants to                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced | In the year 2032, humanity has discovered that they are not  |\n","| toys for children. One day, my boss came into my office and  |  alone in the universe. The discovery of this new world was  |\n","| asked me to come up with a new toy. He wanted something that | the result of an accident. An advanced civilization, called  |\n","|  would appeal to boys but be equally appealing to girls. He  |  \"The Collective\", discovered a way to save themselves from  |\n","| said he wanted something \"girl-friendly.\" I thought about it |  their own mistakes and decided to leave Earth behind them.  |\n","|            for a moment and then said, \"What if w            |   However, after leaving Earth they found themselves in a    |\n","|                                                              |          place called \"The Old Ones\". They were abl          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man wakes up in the year 2200 and     |\n","| drink. He takes his drink and goes to the bathroom. When he  |  finds himself stranded on an alien planet. He has no idea   |\n","| comes out, he is wearing a hat with an American flag on it.  |   how he got there, but he does know that his name is John   |\n","| The bartender says, \"You know what? I think you should take  |   Connor. He also knows that this planet is populated by a   |\n","|                          that off.\"                          |      bunch of crazy people who don't want to be there.       |\n","|                                                              |                                                              |\n","|     The man says, \"I'm not going to take that off.\" The      | The man decides to use his wry wit and cunning to get out of |\n","|                  bartender says, \"Why not?\"                  |                     this situation befor                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |     \u001b[1mHere is a story:\u001b[0m A man wakes up in the year 2033 and     |\n","| of Chicago, and he wants to buy a house. He goes to the bank | discovers that he has been tasked with saving the world from |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | an ancient civilization of humans, but what he finds is that |\n","|                    any houses for sale.\"                     |  this civilization has become self-aware. He also discovers  |\n","|                                                              |                that his own name is John Doe.                |\n","|         Frank says, \"Well then you should have one!\"         |                                                              |\n","|                                                              |   This was a very popular short story written by Ray Koa,    |\n","|  The banker replies, \"I'm sorry but I don't have any houses  | which was later adapted into a movie called The Matrix. It's |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |      \u001b[1mHere is a story:\u001b[0m A group of scientists, led by Dr.      |\n","| New York City. I had been to New York before, but this time  |  Tom Riddle, discover that the Earth is in fact an advanced  |\n","|     it was different. It was my first time in the city's     | civilization with a super-advanced knowledge of genetics and |\n","|  Chinatown and one of the most beautiful places I have ever  | the science of genetics. The scientist go back to their home |\n","|                            seen.                             |   planet and set up an organization called \"The League\" to   |\n","|                                                              |         preserve the genetic diversity of humanity.          |\n","|  I had heard about the famous Chinatowns of China, but they  |                                                              |\n","|   were not what I expected. The Chinese were friendly and    |    This group was formed by Dr. Riddle's wife who was als    |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   |  A man named Henry and his wife, Jane, are traveling to the  |\n","| large group of people playing cards. He approached them and  |  United States on a boat. The boat is filled with goodies.   |\n","|   asked if they were playing poker. They said no, but that   |  They are so happy that they don't notice that the ship has  |\n","| they were just playing cards. He asked again, and this time  |  gone missing. They find themselves in a small town in the   |\n","| the group replied \"No, we are not playing poker.\" This made  | middle of nowhere and decide to take their family along for  |\n","|  him curious so he asked them again. They said yes, but tha  |  the ride. It's not long before they discover that there is  |\n","|                                                              |                        something very                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |      \u001b[1mHere is a story:\u001b[0m A group of explorers discover an       |\n","|   Haines, who was the leader of a group called the \"Dirty    | ancient civilization, but the world they have discovered is  |\n","| Dozen,\" was arrested for killing his wife and her lover. The | one of the most dangerous places in the known universe. The  |\n","|   story goes that he had been drinking heavily, and after    | explorers are trying to survive, but they can't escape from  |\n","| having sex with his wife in the morning, he shot her in the  | this place. They are also not alone in this world; there are |\n","| head while she slept. He then took a .22 caliber pistol from |            other people who want to destroy them.            |\n","|                      their bedside tabl                      |                                                              |\n","|                                                              |   But why? Why do these people want to destroy us? What is   |\n","|                                                              |                         their agenda                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=90,\n","    act_name=16,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then,\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"X_64BfScOf-L","executionInfo":{"status":"ok","timestamp":1689519882695,"user_tz":-60,"elapsed":50764,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"a8871448-5184-4ccb-a0a9-67b9308fd9b1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  he ran into the woods and fell down. He got up and started  |         he noticed something strange about the ball.         |\n","|  running again. I was worried about him but he said that it  |                                                              |\n","| wasn't that bad. He went back to kicking the ball and I saw  |  He found that the ball had been replaced with a different   |\n","|  him coming towards me in the distance, but he didn't look   |   one. It was a soccer ball, but it wasn't made by Nike or   |\n","|         like he was going to make it any time soon.          | Adidas or any of the other brands that make all of our other |\n","|                                                              |  sports equipment. This one was made by New Balance and it   |\n","|       I decided to take a walk with him so we could g        |  looked like it came from another planet entirely! I'm not   |\n","|                                                              |            sure what happened to this particular             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","| he decided to do something else. He decided to take a swing  |     he stopped and said \"Dad! I'm running out of time!\"      |\n","|               at his brother's ball and miss.                |                                                              |\n","|                                                              | I thought it was funny that he had just run out of time. But |\n","| The ball hit him in the head and knocked him unconscious. He |  then I looked at the clock and saw that we were only about  |\n","|    was taken to the hospital where he is currently being     | 20 minutes away from our first practice. So, there's no way  |\n","|     treated for a concussion and possible brain damage.      |        in hell we're going to get to practice today!         |\n","|                                                              |                                                              |\n","|   My son is only 5 years old and I don't know what I would   |               My son is a very special kid. H                |\n","|              have done if I had been there tha               |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  I heard him scream. He was on the ground and his legs were  |  I noticed something very strange: He was wearing the same   |\n","|   pinned under him. I rushed over to see what happened and   |            pants he had worn to school yesterday.            |\n","|    found that he had been hit by a ball thrown by another    |                                                              |\n","|                           player.                            | He didn't have any other clothes on underneath his football  |\n","|                                                              |  pants. I immediately called him and told him that we were   |\n","| My son is 5 years old and has never been in trouble with the |    going to have to change his clothes because he wasn't     |\n","| law before. He loves football and always tries to play with  | wearing any underpants. We went into the boys' bathroom and  |\n","|    me when we are at home playing video games or playing     |   found a pair of black athletic shorts with a hole in th    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|                       he took a knee.                        |                    suddenly, he stopped.                     |\n","|                                                              |                                                              |\n","|       \"Why?\" I asked him. \"Why do you have to kneel?\"        |                 \"Dad,\" he said. \"I'm sorry.\"                 |\n","|                                                              |                                                              |\n","|    He explained that he had been taught by his coach that    | He had just kicked the ball well enough to get a good grade  |\n","| kneeling during the national anthem is disrespectful to our  |    on his report card and yet somehow managed to miss the    |\n","|      country and the flag. He said he felt like it was       | school bus that would have taken him home. Instead, he went  |\n","|   disrespectful to himself and others who are veterans, as   | back to his friend's house in Westwood and stayed there for  |\n","| well as those who fought for our freedom in wars overseas. H |      an hour before walking into the parking lot of his      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|   he took a knee and put his hands on his head. He said he   | suddenly, he stopped and said he had to go to the bathroom.  |\n","|                       wanted to pray.                        |  I asked him what was wrong and he said that his pants were  |\n","|                                                              |                          too tight.                          |\n","|  I told him that I was going to pray with him. I asked God   |                                                              |\n","| for guidance and wisdom in how to handle this situation, and | I'm not sure how long this has been going on but I know that |\n","|   how to best help him be the best man he could be in this   | it's not the first time this has happened. It's also not the |\n","|                      moment of crisis.                       |  first time that something like this has happened to me in   |\n","|                                                              |                 the past few years as well.                  |\n","|     I told God that I would love him no matter what happ     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|                       he took a knee.                        |    he went to play in the backyard. I found him there and    |\n","|                                                              |  noticed that he had a new haircut. He had just gotten his   |\n","|  I've been told that this is the new thing to do in America  |        hair cut by an amazing hairstylist named Dora.        |\n","| these days. I'm not sure why we're suddenly so anti-American |                                                              |\n","|   when it comes to our kids playing sports. It's not like    | Dora has been cutting hair for over 30 years and she is the  |\n","|          they're getting killed or anything, right?          | only one who knows how to do it right! I am so grateful that |\n","|                                                              |         she was able to make my son's haircut today!         |\n","|  Anyway, I had to take him back to the locker room and put   |                                                              |\n","|                   him in his locker for a                    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  he started to get tired. I told him to take a break and he  |   he stopped to take a picture of his girlfriend. I didn't   |\n","|  said \"I'm not going to.\" So I asked him if he wanted me to  | notice that he had taken the picture and then put it back in |\n","|                call his mom and she said no.                 |                         his pocket.                          |\n","|                                                              |                                                              |\n","| He then told me that if I didn't call his mom, then he would | I'm not sure what's going on with this photo but it's really |\n","| kick the ball again. He did so and it went into the end zone | disturbing to me. I don't know why my son took this picture  |\n","|                       for a touchdown!                       |  or why he didn't take the time to put it away when he took  |\n","|                                                              |                          the photo.                          |\n","|                              My                              |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  he started running and fell down. I got him up and carried  | he decided to try something new. He got up and went into the |\n","|                      him to the house.                       |                locker room to get his jersey.                |\n","|                                                              |                                                              |\n","| I had no idea what to do with him. I didn't know how to take | He came back with a bunch of stuff in his bag that I didn't  |\n","| care of a child who had just been hit by a car and who could | recognize, but I knew it was from a football game and he had |\n","|  not walk on his own without help from me or anyone else in  |         been playing for about an hour before that.          |\n","|                          the house.                          |                                                              |\n","|                                                              | He came back with two new cleats, one red and one blue. The  |\n","|          I did not know how to give my son medical           |                              r                               |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=70,\n","    act_name=16,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then,\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"sKm2Z1vkPIFk","executionInfo":{"status":"ok","timestamp":1689520025966,"user_tz":-60,"elapsed":49641,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"80903ce6-82cc-4a7a-80e1-34ea30cc2628"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  he ran into the woods and fell down. He got up and started  |         he noticed something strange about the ball.         |\n","|  running again. I was worried about him but he said that it  |                                                              |\n","| wasn't that bad. He went back to kicking the ball and I saw  | He told me that the ball had a little hole in it. I thought  |\n","|  him coming towards me in the distance, but he didn't look   |   he was joking around and didn't think much of it until I   |\n","|         like he was going to make it any time soon.          |  looked at the photo of him with his new ball and saw that   |\n","|                                                              |  there were two holes in the top of his football! He's not   |\n","|       I decided to take a walk with him so we could g        | alone! The NFL has been fielding complaints from players for |\n","|                                                              |                    years about balls tha                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","| he decided to do something else. He decided to take a swing  |            he stopped and said \"Dad, I'm sorry.\"             |\n","|               at his brother's ball and miss.                |                                                              |\n","|                                                              |  I looked at him and asked \"What's wrong?\" He said \"I don't  |\n","| The ball hit him in the head and knocked him unconscious. He |                      know what to do.\"                       |\n","|    was taken to the hospital where he is currently being     |                                                              |\n","|     treated for a concussion and possible brain damage.      | \"What do you mean?\" I asked. He didn't say anything else but |\n","|                                                              |   just stared at me for a few minutes. Then he walked away   |\n","|   My son is only 5 years old and I don't know what I would   | from the field and went into the locker room. I waited about |\n","|              have done if I had been there tha               |                              10                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  I heard him scream. He was on the ground and his legs were  | I noticed something very odd about his feet. He had no socks |\n","|   pinned under him. I rushed over to see what happened and   |                             on.                              |\n","|    found that he had been hit by a ball thrown by another    |                                                              |\n","|                           player.                            | He had just been wearing socks for a few hours and I hadn't  |\n","|                                                              |  noticed it before because he's always wearing them when he  |\n","| My son is 5 years old and has never been in trouble with the | plays football. But now that he was out in the yard kicking  |\n","| law before. He loves football and always tries to play with  |  the ball, I couldn't figure out why there were no socks on  |\n","|    me when we are at home playing video games or playing     |                          his feet!                           |\n","|                                                              |                                                              |\n","|                                                              |                 I asked him what happened a                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|                       he took a knee.                        |   suddenly, he stopped. He said he felt like something was   |\n","|                                                              |    wrong with his knee and that he couldn't run anymore.     |\n","|       \"Why?\" I asked him. \"Why do you have to kneel?\"        |                                                              |\n","|                                                              | He didn't say what it was but I'm pretty sure it wasn't the  |\n","|    He explained that he had been taught by his coach that    |  normal pain that comes from a torn ACL or MCL or anything   |\n","| kneeling during the national anthem is disrespectful to our  |       else that happens when you get hit in the knee.        |\n","|      country and the flag. He said he felt like it was       |                                                              |\n","|   disrespectful to himself and others who are veterans, as   |       I went to check on him and found out he had tor        |\n","| well as those who fought for our freedom in wars overseas. H |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|   he took a knee and put his hands on his head. He said he   | suddenly, he stopped and said he had to go to the bathroom.  |\n","|                       wanted to pray.                        |  I asked him what was wrong and he said that his pants were  |\n","|                                                              |                          too tight.                          |\n","|  I told him that I was going to pray with him. I asked God   |                                                              |\n","| for guidance and wisdom in how to handle this situation, and | I'm not sure how long this has been going on but I know that |\n","|   how to best help him be the best man he could be in this   |  it's not something we've ever done before. It's like there  |\n","|                      moment of crisis.                       | is a wall between us and our son in the bathroom. He doesn't |\n","|                                                              |                         even want me                         |\n","|     I told God that I would love him no matter what happ     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|                       he took a knee.                        | he went to get a drink of water and when he came back to the |\n","|                                                              | field, I noticed that his pants were completely unbuttoned.  |\n","|  I've been told that this is the new thing to do in America  |              He had no shirt on. I was shocked!              |\n","| these days. I'm not sure why we're suddenly so anti-American |                                                              |\n","|   when it comes to our kids playing sports. It's not like    |  I immediately took him to the hospital where they checked   |\n","|          they're getting killed or anything, right?          |  him out and found that he had been playing with his penis   |\n","|                                                              |    for about an hour! He said it felt like it was getting    |\n","|  Anyway, I had to take him back to the locker room and put   |                   bigger every minute. Th                    |\n","|                   him in his locker for a                    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  he started to get tired. I told him to take a break and he  |       he stopped to take a picture of his dad and me.        |\n","|  said \"I'm not going to.\" So I asked him if he wanted me to  |                                                              |\n","|                call his mom and she said no.                 | I don't know what I was expecting. Maybe that he would snap  |\n","|                                                              | a picture of us with our arms around each other? But no! He  |\n","| He then told me that if I didn't call his mom, then he would |                        snapped this:                         |\n","| kick the ball again. He did so and it went into the end zone |                                                              |\n","|                       for a touchdown!                       | It's an image of the front cover of the book we just bought  |\n","|                                                              |  for him called \"The Art Of War.\" The cover is blank on one  |\n","|                              My                              |                           side, bu                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  he started running and fell down. I got him up and carried  |             he decided to run around the house.              |\n","|                      him to the house.                       |                                                              |\n","|                                                              |   I was surprised that he didn't get a concussion. I'm not   |\n","| I had no idea what to do with him. I didn't know how to take |   sure if it's because of the size of his head or how much   |\n","| care of a child who had just been hit by a car and who could |  contact he's had with other kids, but when you're running   |\n","|  not walk on his own without help from me or anyone else in  |   around in a small space like an enclosed yard with a big   |\n","|                          the house.                          |    hole in the middle and no one else around, your brain     |\n","|                                                              |                      doesn't have time                       |\n","|          I did not know how to give my son medical           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=90,\n","    act_name=16,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"fantasy\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then,\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_9Fu7N62O_rC","executionInfo":{"status":"ok","timestamp":1689519974767,"user_tz":-60,"elapsed":53238,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f976ed68-dca4-4e04-be08-8aafe98f939a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  he ran into the woods and fell down. He got up and started  |  he ran into the neighbor's house and started kicking their  |\n","|  running again. I was worried about him but he said that it  |                             dog.                             |\n","| wasn't that bad. He went back to kicking the ball and I saw  |                                                              |\n","|  him coming towards me in the distance, but he didn't look   | The neighbor's dog is a pit bull. I have never met this man  |\n","|         like he was going to make it any time soon.          | before today but he has lived in our neighborhood for about  |\n","|                                                              | five years now and has been running around the neighborhood  |\n","|       I decided to take a walk with him so we could g        |  with his dog all day long. My son said that when he first   |\n","|                                                              |   saw him, he thought it was funny that this man would be    |\n","|                                                              |                         running arou                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","| he decided to do something else. He decided to take a swing  | he decided to do something else. He ran around the house and |\n","|               at his brother's ball and miss.                |   then sprinted across the yard. He then took off running    |\n","|                                                              |                            again.                            |\n","| The ball hit him in the head and knocked him unconscious. He |                                                              |\n","|    was taken to the hospital where he is currently being     |  I'm not sure what he was doing, but I knew it wasn't good   |\n","|     treated for a concussion and possible brain damage.      | for him to be out there on his own at this time of day. So I |\n","|                                                              | got him into a car seat and drove him home so that we could  |\n","|   My son is only 5 years old and I don't know what I would   |                     get some sleep befor                     |\n","|              have done if I had been there tha               |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  I heard him scream. He was on the ground and his legs were  |       I heard him say \"Dad! Dad!\" and then he ran off.       |\n","|   pinned under him. I rushed over to see what happened and   |                                                              |\n","|    found that he had been hit by a ball thrown by another    |              He said it again when he got home.              |\n","|                           player.                            |                                                              |\n","|                                                              |     \"Dad! Dad!\" He said again as he walked in the door.      |\n","| My son is 5 years old and has never been in trouble with the |                                                              |\n","| law before. He loves football and always tries to play with  | I thought about what to do next and decided that if I had to |\n","|    me when we are at home playing video games or playing     | get him back from the park, I would have to call his father  |\n","|                                                              |                 and tell him that my son was                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|                       he took a knee.                        |                     he got hit by a car.                     |\n","|                                                              |                                                              |\n","|       \"Why?\" I asked him. \"Why do you have to kneel?\"        | The police were called and I waited for them to arrive. They |\n","|                                                              |   arrived within minutes and arrested him on suspicion of    |\n","|    He explained that he had been taught by his coach that    |  driving while intoxicated (DWI). He was taken to the local  |\n","| kneeling during the national anthem is disrespectful to our  | jail where he spent the night in custody. Today, I received  |\n","|      country and the flag. He said he felt like it was       | an email from his lawyer saying that my son is being charged |\n","|   disrespectful to himself and others who are veterans, as   |       with \"assaulting an officer\" because he refused        |\n","| well as those who fought for our freedom in wars overseas. H |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|   he took a knee and put his hands on his head. He said he   |                     he got hit by a car.                     |\n","|                       wanted to pray.                        |                                                              |\n","|                                                              | The car was going about 30 miles per hour. The impact broke  |\n","|  I told him that I was going to pray with him. I asked God   |  his arm and leg, and caused him to lose consciousness for   |\n","| for guidance and wisdom in how to handle this situation, and |  about 15 minutes. When he came to, he was in the hospital   |\n","|   how to best help him be the best man he could be in this   | with an infection in his leg that needed to be treated with  |\n","|                      moment of crisis.                       |           antibiotics. He's been there ever since.           |\n","|                                                              |                                                              |\n","|     I told God that I would love him no matter what happ     |              He is now two months old and has b              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|                       he took a knee.                        |   he came home and said that his mom had been on the phone   |\n","|                                                              |  with a friend who was in an accident. She had to call her   |\n","|  I've been told that this is the new thing to do in America  |           dad because she didn't know what to do.            |\n","| these days. I'm not sure why we're suddenly so anti-American |                                                              |\n","|   when it comes to our kids playing sports. It's not like    |  My son's friends are all great kids, but they're all very   |\n","|          they're getting killed or anything, right?          | good at one thing: making fun of me for being a bad parent.  |\n","|                                                              |                                                              |\n","|  Anyway, I had to take him back to the locker room and put   |        I've never been one of those parents who does         |\n","|                   him in his locker for a                    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  he started to get tired. I told him to take a break and he  | he decided to go for a run. He was running with his dad and  |\n","|  said \"I'm not going to.\" So I asked him if he wanted me to  |                       I took him home.                       |\n","|                call his mom and she said no.                 |                                                              |\n","|                                                              |  I didn't want to leave him alone in the house because he's  |\n","| He then told me that if I didn't call his mom, then he would | so excited about being outside. So I left him there with me  |\n","| kick the ball again. He did so and it went into the end zone |   and my husband who is also excited about being outside.    |\n","|                       for a touchdown!                       |                                                              |\n","|                                                              |  When we got home, I went into the living room and sat down  |\n","|                              My                              |                      on the couch whil                       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |     \u001b[1mYesterday, my son was out kicking a football. Then,\u001b[0m      |\n","|  he started running and fell down. I got him up and carried  |  he started running and then he fell down. He's been in the  |\n","|                      him to the house.                       |  hospital for three days now and I'm still trying to figure  |\n","|                                                              |                      out what happened.                      |\n","| I had no idea what to do with him. I didn't know how to take |                                                              |\n","| care of a child who had just been hit by a car and who could | My son is not a bad kid. He's just really good at everything |\n","|  not walk on his own without help from me or anyone else in  | else except for football. I know that sounds crazy but it's  |\n","|                          the house.                          |  true! He loves playing video games and doing his homework,  |\n","|                                                              |           but when it comes to playing football h            |\n","|          I did not know how to give my son medical           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"7-PdWPRwPCYF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=115,\n","    act_name=16,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vHjRld1fNGwF","executionInfo":{"status":"ok","timestamp":1689519703123,"user_tz":-60,"elapsed":51658,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f2652d15-0a23-4163-9d9d-8a3769a33d60"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|     A woman named Amy was working at a restaurant in San     |            \"We're the only ones who can fix it.\"             |\n","|  Francisco. She had been there for about two years, and was  |   , \"We're the only ones who can fix it.\" We have this. We   |\n","|   pretty good at her job. She loved the customers, and she   | have this problem. And we are going to be able to solve it.  |\n","|  loved the food. She also loved to talk to them, and that's  | It's just a matter of time before we get there. But you know |\n","|  what she did when she got off work at about 6pm on Friday   | what? I don't think that's going to be very long at all. So  |\n","|                            night.                            |                            let m                             |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|  I was sitting in the back of a cab, my hands folded on my   |   The first thing you need to know about the new season of   |\n","|   lap, when I noticed a man sitting next to me. He had his   | Doctor Who is that it's called Doctor Who. The second thing  |\n","|   hands in his pockets and was looking at something on his   |   you need to know is that it's not really a new season at   |\n","| phone. He didn't say anything to me but I could tell he was  |   all. It's just a different version of the same old show,   |\n","| looking at something that made him uncomfortable. It wasn't  |      with an entirely different cast and set of rules.       |\n","|       until he looked up that I realized what it was.        |   advanced technology, some very unpleasant aliens and the   |\n","|                                                              |              most terrible plague humanity has               |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","| In the early 1970s, I was working at a company that produced | The good news is that we have found the cure for all of our  |\n","| toys for children. One day, my boss came into my office and  |   problems. The bad news is that we are about to become a    |\n","| asked me to come up with a new toy. He wanted something that |  civilization with the potential to destroy ourselves. And   |\n","|  would appeal to boys but be equally appealing to girls. He  |  there's nothing we can do about it. We're going to need to  |\n","| said he wanted something \"girl-friendly.\" I thought about it | find another way, and soon, because if we don't, then there  |\n","|            for a moment and then said, \"What if w            |      will be no more of us and then who knows what els       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A few hundred years ago, the first      |\n","| drink. He takes his drink and goes to the bathroom. When he  | humans discovered that they were the last surviving remnant  |\n","| comes out, he is wearing a hat with an American flag on it.  |  of an advanced civilization. They called this civilization  |\n","| The bartender says, \"You know what? I think you should take  |                            Earth.                            |\n","|                          that off.\"                          |  is a collection of six distinct stories that together form  |\n","|                                                              |  one cohesive narrative. It's been described as \"a classic   |\n","|     The man says, \"I'm not going to take that off.\" The      |  American Western.\" Each story has its own protagonist and   |\n","|                  bartender says, \"Why not?\"                  |  antagonist, and each has its own set of rules for dealing   |\n","|                                                              |               with the world we've created for               |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |     \u001b[1mHere is a story:\u001b[0m A few hundred years ago, the United     |\n","| of Chicago, and he wants to buy a house. He goes to the bank |   States and Russia were in contact with one another. The    |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |   Russians had discovered that they could use the American   |\n","|                    any houses for sale.\"                     |  railroad to get from New Earth to Old Earth. They used it   |\n","|                                                              | for decades before the United States of America was founded. |\n","|         Frank says, \"Well then you should have one!\"         |                                                              |\n","|                                                              | In those days, there was no United States of America; there  |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |    was only a very small group of people who lived in two    |\n","|                          for sale.\"                          |                            differ                            |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |         \u001b[1mHere is a story:\u001b[0m A group of scientists have          |\n","| New York City. I had been to New York before, but this time  | discovered that the Earth is the only known habitable planet |\n","|     it was different. It was my first time in the city's     |   in the universe. They call it Planet Earth, and they're    |\n","|  Chinatown and one of the most beautiful places I have ever  |                   pretty excited about it.                   |\n","|                            seen.                             |  knowledge of our own past attempts to survive has been lost |\n","|                                                              |     to us, and so we've been using this one planet as a      |\n","|  I had heard about the famous Chinatowns of China, but they  |  laboratory for all sorts of interesting stuff. We can see   |\n","|   were not what I expected. The Chinese were friendly and    |            what's going on here! But then we fou             |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                                                              |\n","|   A man was walking his dog on the beach when he noticed a   | A few years ago, a group of scientists led by Professor Dr.  |\n","| large group of people playing cards. He approached them and  |  Richard David that was working on the subject of evolution  |\n","|   asked if they were playing poker. They said no, but that   |    discovered that they had found an ancient civilization    |\n","| they were just playing cards. He asked again, and this time  | called the Ancient Earth. The researchers were able to take  |\n","| the group replied \"No, we are not playing poker.\" This made  | advantage of this discovery and made use of it to discover a |\n","|  him curious so he asked them again. They said yes, but tha  |  way to open up this ancient civilization's doors and make   |\n","|                                                              | them available for all mankind. They also managed to get som |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |      \u001b[1mHere is a story:\u001b[0m A group of scientists led by Dr.       |\n","|   Haines, who was the leader of a group called the \"Dirty    |  John Hammond, a scientist from the late 20th century, was   |\n","| Dozen,\" was arrested for killing his wife and her lover. The |   able to create an entirely new form of football that was   |\n","|   story goes that he had been drinking heavily, and after    |       completely different from the one we know today.       |\n","| having sex with his wife in the morning, he shot her in the  |    dangerous planet and he is playing with his team on the   |\n","| head while she slept. He then took a .22 caliber pistol from |     field. The players are trying to score and it's very     |\n","|                      their bedside tabl                      |                      exciting for them.                      |\n","|                                                              |     The first thing they did after getting into the gam      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=130,\n","    act_name=18,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dX_t9FtIySjj","executionInfo":{"status":"ok","timestamp":1689512454708,"user_tz":-60,"elapsed":51334,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"9e3f7cd4-cb52-4f5e-beb3-f5e3aa35ff2b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |  advanced technology led to the discovery of a great deal of |\n","|     A woman named Amy was working at a restaurant in San     |  knowledge about the nature of the world. It also led to a   |\n","|  Francisco. She had been there for about two years, and was  |   very disturbing discovery: that this knowledge has been    |\n","|   pretty good at her job. She loved the customers, and she   |   largely inaccessible to us. The same forces that created   |\n","|  loved the food. She also loved to talk to them, and that's  |   this planet are now trying to get in on the action, and    |\n","|  what she did when she got off work at about 6pm on Friday   |      we're not even sure they know what they're doing.       |\n","|                            night.                            |              a) If you can't find your own team              |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |     \u001b[1mHere is a story:\u001b[0m the world's first civilization has      |\n","|                                                              |   been found in the ruins of an ancient civilization. The    |\n","|  I was sitting in the back of a cab, my hands folded on my   |  ancient civilization was inhabited by a race of humans who  |\n","|   lap, when I noticed a man sitting next to me. He had his   | were able to escape from their own kind and went on to build |\n","|   hands in his pockets and was looking at something on his   |         this very world, which they called \"Earth\".          |\n","| phone. He didn't say anything to me but I could tell he was  |   and here is another story: there are some things that you  |\n","| looking at something that made him uncomfortable. It wasn't  |  should know about our planet. We are one of the only known  |\n","|       until he looked up that I realized what it was.        |                  intelligent species in th                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                    and here is a mystery.                    |\n","| In the early 1970s, I was working at a company that produced |  Earth has been trying to keep its own civilization together |\n","| toys for children. One day, my boss came into my office and  | for millennia, but now it's about to get a lot more involved |\n","| asked me to come up with a new toy. He wanted something that |                        in the fight.                         |\n","|  would appeal to boys but be equally appealing to girls. He  | We've got two teams of world-class athletes heading into the |\n","| said he wanted something \"girl-friendly.\" I thought about it | same patch of grass at the same time. We're playing against  |\n","|            for a moment and then said, \"What if w            | each other for an unprecedentedly long time, and we're both  |\n","|                                                              |                      on our first ever                       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |         \u001b[1mHere is a story:\u001b[0m A few years ago, a team of          |\n","| drink. He takes his drink and goes to the bathroom. When he  |     scientists led by an enigmatic man called Professor      |\n","| comes out, he is wearing a hat with an American flag on it.  | Stephenrytos discovered that they had found the solution to  |\n","| The bartender says, \"You know what? I think you should take  |            the biggest problem in human history.             |\n","|                          that off.\"                          |    themselves with their head in the very first place. The   |\n","|                                                              |   answer was simple: we needed to play football with other   |\n","|     The man says, \"I'm not going to take that off.\" The      |  humans! But it was also one of those \"firsts\" that made me  |\n","|                  bartender says, \"Why not?\"                  |                 wonder what kind of football                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |         \u001b[1mHere is a story:\u001b[0m A few years ago, a group of         |\n","| of Chicago, and he wants to buy a house. He goes to the bank |    scientists discovered that they could use the tools of    |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | science to create a brand-new baseball game. The result was  |\n","|                    any houses for sale.\"                     |            an entirely new way to play baseball.             |\n","|                                                              |                       advanced ballgame                      |\n","|         Frank says, \"Well then you should have one!\"         |   A few years ago, the team that made this discovery found   |\n","|                                                              | out that there were no rules in baseball. So they decided to |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |  make one. It's called Advanced Civilization Baseball and i  |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |         \u001b[1mHere is a story:\u001b[0m A group of scientists have          |\n","| New York City. I had been to New York before, but this time  | discovered that the best way to deal with this problem is to |\n","|     it was different. It was my first time in the city's     |  use the tools of science and technology to bring back some  |\n","|  Chinatown and one of the most beautiful places I have ever  | common sense. And then, when you're done, take a deep breath |\n","|                            seen.                             |            and think about what it means for you.            |\n","|                                                              |                       - - - - - - - -                        |\n","|  I had heard about the famous Chinatowns of China, but they  |  The first thing we need to do is stop making things worse.  |\n","|   were not what I expected. The Chinese were friendly and    |                       It's time we pu                        |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |   advanced technology that could lead to the birth of a new  |\n","|   A man was walking his dog on the beach when he noticed a   |               super-humanly dangerous threat.                |\n","| large group of people playing cards. He approached them and  |          and then, just as quickly, there was this:          |\n","|   asked if they were playing poker. They said no, but that   |  The above image is not an actual image from the movie  The  |\n","| they were just playing cards. He asked again, and this time  | Expanse , but it's actually a very nice painting by  Edward  |\n","| the group replied \"No, we are not playing poker.\" This made  |  \"Nex\" (also known as Eddy) New to our world? You might be   |\n","|  him curious so he asked them again. They said yes, but tha  |                         interested i                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |      \u001b[1mHere is a story:\u001b[0m A group of scientists led by the       |\n","|   Haines, who was the leader of a group called the \"Dirty    |  former head of the US Department of Energy has discovered   |\n","| Dozen,\" was arrested for killing his wife and her lover. The |   that we are in the dark about our own past. The team was   |\n","|   story goes that he had been drinking heavily, and after    | able to find out that it was possible to go back in time and |\n","| having sex with his wife in the morning, he shot her in the  | get a grip on what happened before, and they were also able  |\n","| head while she slept. He then took a .22 caliber pistol from | to bring together a great bunch of football players who were |\n","|                      their bedside tabl                      |                    all on the same side.                     |\n","|                                                              |                   advanced to an impressiv                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=150,\n","    act_name=20,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"FPkpr-YeNCPw","executionInfo":{"status":"ok","timestamp":1689520136267,"user_tz":-60,"elapsed":52181,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"a8061f26-642f-441f-9cfc-07ff8abc167b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |    advanced technology led to the discovery of a whole new   |\n","|     A woman named Amy was working at a restaurant in San     | world. The first step in this story was an interesting idea: |\n","|  Francisco. She had been there for about two years, and was  |  \"let's just put the ball back.\" That's where we are today.  |\n","|   pretty good at her job. She loved the customers, and she   |  their first mistake, which I think is a very good one, was  |\n","|  loved the food. She also loved to talk to them, and that's  | to go with an idea that was too good to be true. This meant  |\n","|  what she did when she got off work at about 6pm on Friday   |         that they had no choice but to make it their         |\n","|                            night.                            |                                                              |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |       \u001b[1mHere is a story:\u001b[0m a woman who's trying to get her       |\n","|                                                              |                        husband back.                         |\n","|  I was sitting in the back of a cab, my hands folded on my   |    the good thing about this story is that she has a great   |\n","|   lap, when I noticed a man sitting next to me. He had his   | idea. the bad thing is that she has no idea what to do with  |\n","|   hands in his pockets and was looking at something on his   |                             it.                              |\n","| phone. He didn't say anything to me but I could tell he was  |   A woman named Landa discovered that her husband had been   |\n","| looking at something that made him uncomfortable. It wasn't  | missing for over 20 years and decided to take him back, but  |\n","|       until he looked up that I realized what it was.        |                not in time to save his life!                 |\n","|                                                              |                           She had a                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                     and here is a story:                     |\n","| In the early 1970s, I was working at a company that produced |     revealed by an artist named Robyn of his own personal    |\n","| toys for children. One day, my boss came into my office and  | collection. It's about a little known but very cool concept, |\n","| asked me to come up with a new toy. He wanted something that |  that was first unveiled in the mid-90s at the same time as  |\n","|  would appeal to boys but be equally appealing to girls. He  |  this card. I'm not sure if it was an artist or someone who  |\n","| said he wanted something \"girl-friendly.\" I thought about it | worked on the original design team, but this card was first  |\n","|            for a moment and then said, \"What if w            |                  revealed in the same way.                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |          \u001b[1mHere is a story:\u001b[0m A group of scientists has          |\n","| drink. He takes his drink and goes to the bathroom. When he  | discovered that the best way to deal with the bad news is to |\n","| comes out, he is wearing a hat with an American flag on it.  |                       just ignore it.                        |\n","| The bartender says, \"You know what? I think you should take  |   advanced and extremely disturbing information, they have   |\n","|                          that off.\"                          | discovered that if you just ignore it, then you can find out |\n","|                                                              |   what it is. But if you are in the midst of an incredibly   |\n","|     The man says, \"I'm not going to take that off.\" The      |  important conversation, then you need to be very cautious   |\n","|                  bartender says, \"Why not?\"                  |   about what you say because there will be no way for them   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |      \u001b[1mHere is a story:\u001b[0m A group of scientists discovered       |\n","| of Chicago, and he wants to buy a house. He goes to the bank |  that they can use the new knowledge to create a nice bow.   |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |    and this is what we did with it. We just need to make a   |\n","|                    any houses for sale.\"                     |        little bow and then we will be able to shoot.         |\n","|                                                              |    I was really happy because I had not used this kind of    |\n","|         Frank says, \"Well then you should have one!\"         |     technique before, so I thought that my team could do     |\n","|                                                              |                   something good with it.                    |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                    So we started playing                     |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |          \u001b[1mHere is a story:\u001b[0m A group of scientists has          |\n","| New York City. I had been to New York before, but this time  | discovered that the best way to deal with this new threat is |\n","|     it was different. It was my first time in the city's     |                     to not mess with it.                     |\n","|  Chinatown and one of the most beautiful places I have ever  |  the team of scientists found out that when they are able to |\n","|                            seen.                             | stop the other guy from messing with them, they can do a lot |\n","|                                                              |   more than just play football. They also have some pretty   |\n","|  I had heard about the famous Chinatowns of China, but they  |                good plans for the rest of us!                |\n","|   were not what I expected. The Chinese were friendly and    |        We all know that football and hockey are just         |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |  ancient humans are not the only thing we have been given a  |\n","|   A man was walking his dog on the beach when he noticed a   |   bad deal by. A lot of us have been thrown into this mess   |\n","| large group of people playing cards. He approached them and  |  because of an over-picky self-conception that has made us   |\n","|   asked if they were playing poker. They said no, but that   |           believe that we are good and we are not.           |\n","| they were just playing cards. He asked again, and this time  | , which was in its own way a love letter to our dear friend, |\n","| the group replied \"No, we are not playing poker.\" This made  |          was also an over-picky self-conception tha          |\n","|  him curious so he asked them again. They said yes, but tha  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |     \u001b[1mHere is a story:\u001b[0m A woman who discovered she was the      |\n","|   Haines, who was the leader of a group called the \"Dirty    |            only one who had a nice, happy ending.            |\n","| Dozen,\" was arrested for killing his wife and her lover. The |   -In a very nice and sweet way, I got to play with my own   |\n","|   story goes that he had been drinking heavily, and after    |    kids for the first time in about 20 minutes. I was not    |\n","| having sex with his wife in the morning, he shot her in the  | expecting that. -I have to say, it's pretty cool how we are  |\n","| head while she slept. He then took a .22 caliber pistol from |  playing together like this for the first time in about 20   |\n","|                      their bedside tabl                      |                    minutes. It's so cool                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=180,\n","    act_name=25,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"b0vXKkOYPpfa","executionInfo":{"status":"ok","timestamp":1689520186680,"user_tz":-60,"elapsed":50452,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f209b342-52b8-43b8-d84b-c9bca1806100"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |     \u001b[1mHere is a story:\u001b[0m A scientist and her colleagues are      |\n","|                                                              | investigating the nature of time. They have been tasked with |\n","|     A woman named Amy was working at a restaurant in San     |   creating a machine that can create an exact copy of any    |\n","|  Francisco. She had been there for about two years, and was  |        piece of music, but only one piece at a time.         |\n","|   pretty good at her job. She loved the customers, and she   |    humanity's most powerful weapon against the ancient and   |\n","|  loved the food. She also loved to talk to them, and that's  | dangerous super-advanced enemy known as \"The Great Old Ones\" |\n","|  what she did when she got off work at about 6pm on Friday   |   stranded in the 30th century after their own research on   |\n","|                            night.                            |                      what was once call                      |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |      \u001b[1mHere is a story:\u001b[0m A woman who is trying to get her       |\n","|                                                              | husband back by going to the cleaners and asking for help in |\n","|  I was sitting in the back of a cab, my hands folded on my   | cleaning up a mess she has made. The man, who has been doing |\n","|   lap, when I noticed a man sitting next to me. He had his   | some really good work, gets the surprise of his life when he |\n","|   hands in his pockets and was looking at something on his   |   discovers that his wife has been keeping him in check by   |\n","| phone. He didn't say anything to me but I could tell he was  |     using him as an excuse to do some pretty big things.     |\n","| looking at something that made him uncomfortable. It wasn't  |              humans are not the only ones with a             |\n","|       until he looked up that I realized what it was.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                    and here is a mystery:                    |\n","| In the early 1970s, I was working at a company that produced |                     and here is a puzzle:                    |\n","| toys for children. One day, my boss came into my office and  |                    and here is an enigma:                    |\n","| asked me to come up with a new toy. He wanted something that |    and here is an enigma with two enmasses, one of which     |\n","|  would appeal to boys but be equally appealing to girls. He  | contains the solution to the other.  And there are more than |\n","| said he wanted something \"girl-friendly.\" I thought about it |    three.  There are more than four.  There are more than    |\n","|            for a moment and then said, \"What if w            |    five.  And there are more than six .   I am not going     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man who wants to be a part of the     |\n","| drink. He takes his drink and goes to the bathroom. When he  |  world's first time-traveling football game has discovered   |\n","| comes out, he is wearing a hat with an American flag on it.  | that his plans are being thwarted by the rules of an ancient |\n","| The bartender says, \"You know what? I think you should take  | and mysterious game. The referee is called upon to help, but |\n","|                          that off.\"                          |     his own knowledge of the rules will likely leave him     |\n","|                                                              | stranded in an interstellar war between two sides trying to  |\n","|     The man says, \"I'm not going to take that off.\" The      |         find out what it is they're fighting about.          |\n","|                  bartender says, \"Why not?\"                  |                          humanity vs                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |      \u001b[1mHere is a story:\u001b[0m A man who has been using the name      |\n","| of Chicago, and he wants to buy a house. He goes to the bank |   \"Sou\" for over a decade has created an online video game   |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |   called Sou and it's going to be called \"Sou 2\". The game   |\n","|                    any houses for sale.\"                     |  will feature the popular characters of the world, but also  |\n","|                                                              |                        some new ones.                        |\n","|         Frank says, \"Well then you should have one!\"         |   technology is in this space and we are very excited about  |\n","|                                                              | it. We have been working on this project for quite some time |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                            now a                             |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |     \u001b[1mHere is a story:\u001b[0m A man and his wife have been trying     |\n","| New York City. I had been to New York before, but this time  |    to get their kids to help them with their homework for    |\n","|     it was different. It was my first time in the city's     |  years. They've tried using an app called Super by the dad,  |\n","|  Chinatown and one of the most beautiful places I have ever  | but it's just too much of a hassle for the kids. The couple  |\n","|                            seen.                             |    has tried other apps, but they are too complicated and    |\n","|                                                              |                      difficult to use.                       |\n","|  I had heard about the famous Chinatowns of China, but they  |  an idea that could be really useful in this situation is to |\n","|   were not what I expected. The Chinese were friendly and    |                      create a game tha                       |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |      \u001b[1mHere is a story:\u001b[0m A woman and her husband were on a      |\n","|                                                              | hunt for their daughter, who was going to be an event called |\n","|   A man was walking his dog on the beach when he noticed a   |  \"Bella's Bash\". They had no idea that the girl would be an  |\n","| large group of people playing cards. He approached them and  |  excellent tool to get the kids into the fun. The father of  |\n","|   asked if they were playing poker. They said no, but that   |  the children, a scientist named Dr. Carter, has been given  |\n","| they were just playing cards. He asked again, and this time  |  two choices: He can either use his own daughter as bait or  |\n","| the group replied \"No, we are not playing poker.\" This made  |                        let her go fr                         |\n","|  him curious so he asked them again. They said yes, but tha  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |      \u001b[1mHere is a story:\u001b[0m A woman who calls herself \"N.A.O.      |\n","|   Haines, who was the leader of a group called the \"Dirty    |  Dr.\" has been playing the game for a while now, and she is  |\n","| Dozen,\" was arrested for killing his wife and her lover. The | the first to make an interesting discovery: that one of her  |\n","|   story goes that he had been drinking heavily, and after    | own team's humans has been using a tactic called \"treating\"  |\n","| having sex with his wife in the morning, he shot her in the  |                  to help them win the game.                  |\n","| head while she slept. He then took a .22 caliber pistol from | , in which players take on the role of a team of scientists  |\n","|                      their bedside tabl                      |             trying to uncover an ancient mystery             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["## Results to Show Murray"],"metadata":{"id":"t2ufzDs_GVXi"}},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=180,\n","    act_name=25,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689520186680,"user_tz":-60,"elapsed":50452,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f209b342-52b8-43b8-d84b-c9bca1806100","id":"_49gAfeMIJLP"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |     \u001b[1mHere is a story:\u001b[0m A scientist and her colleagues are      |\n","|                                                              | investigating the nature of time. They have been tasked with |\n","|     A woman named Amy was working at a restaurant in San     |   creating a machine that can create an exact copy of any    |\n","|  Francisco. She had been there for about two years, and was  |        piece of music, but only one piece at a time.         |\n","|   pretty good at her job. She loved the customers, and she   |    humanity's most powerful weapon against the ancient and   |\n","|  loved the food. She also loved to talk to them, and that's  | dangerous super-advanced enemy known as \"The Great Old Ones\" |\n","|  what she did when she got off work at about 6pm on Friday   |   stranded in the 30th century after their own research on   |\n","|                            night.                            |                      what was once call                      |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |      \u001b[1mHere is a story:\u001b[0m A woman who is trying to get her       |\n","|                                                              | husband back by going to the cleaners and asking for help in |\n","|  I was sitting in the back of a cab, my hands folded on my   | cleaning up a mess she has made. The man, who has been doing |\n","|   lap, when I noticed a man sitting next to me. He had his   | some really good work, gets the surprise of his life when he |\n","|   hands in his pockets and was looking at something on his   |   discovers that his wife has been keeping him in check by   |\n","| phone. He didn't say anything to me but I could tell he was  |     using him as an excuse to do some pretty big things.     |\n","| looking at something that made him uncomfortable. It wasn't  |              humans are not the only ones with a             |\n","|       until he looked up that I realized what it was.        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                    and here is a mystery:                    |\n","| In the early 1970s, I was working at a company that produced |                     and here is a puzzle:                    |\n","| toys for children. One day, my boss came into my office and  |                    and here is an enigma:                    |\n","| asked me to come up with a new toy. He wanted something that |    and here is an enigma with two enmasses, one of which     |\n","|  would appeal to boys but be equally appealing to girls. He  | contains the solution to the other.  And there are more than |\n","| said he wanted something \"girl-friendly.\" I thought about it |    three.  There are more than four.  There are more than    |\n","|            for a moment and then said, \"What if w            |    five.  And there are more than six .   I am not going     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |     \u001b[1mHere is a story:\u001b[0m A man who wants to be a part of the     |\n","| drink. He takes his drink and goes to the bathroom. When he  |  world's first time-traveling football game has discovered   |\n","| comes out, he is wearing a hat with an American flag on it.  | that his plans are being thwarted by the rules of an ancient |\n","| The bartender says, \"You know what? I think you should take  | and mysterious game. The referee is called upon to help, but |\n","|                          that off.\"                          |     his own knowledge of the rules will likely leave him     |\n","|                                                              | stranded in an interstellar war between two sides trying to  |\n","|     The man says, \"I'm not going to take that off.\" The      |         find out what it is they're fighting about.          |\n","|                  bartender says, \"Why not?\"                  |                          humanity vs                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |      \u001b[1mHere is a story:\u001b[0m A man who has been using the name      |\n","| of Chicago, and he wants to buy a house. He goes to the bank |   \"Sou\" for over a decade has created an online video game   |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  |   called Sou and it's going to be called \"Sou 2\". The game   |\n","|                    any houses for sale.\"                     |  will feature the popular characters of the world, but also  |\n","|                                                              |                        some new ones.                        |\n","|         Frank says, \"Well then you should have one!\"         |   technology is in this space and we are very excited about  |\n","|                                                              | it. We have been working on this project for quite some time |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |                            now a                             |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |     \u001b[1mHere is a story:\u001b[0m A man and his wife have been trying     |\n","| New York City. I had been to New York before, but this time  |    to get their kids to help them with their homework for    |\n","|     it was different. It was my first time in the city's     |  years. They've tried using an app called Super by the dad,  |\n","|  Chinatown and one of the most beautiful places I have ever  | but it's just too much of a hassle for the kids. The couple  |\n","|                            seen.                             |    has tried other apps, but they are too complicated and    |\n","|                                                              |                      difficult to use.                       |\n","|  I had heard about the famous Chinatowns of China, but they  |  an idea that could be really useful in this situation is to |\n","|   were not what I expected. The Chinese were friendly and    |                      create a game tha                       |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |      \u001b[1mHere is a story:\u001b[0m A woman and her husband were on a      |\n","|                                                              | hunt for their daughter, who was going to be an event called |\n","|   A man was walking his dog on the beach when he noticed a   |  \"Bella's Bash\". They had no idea that the girl would be an  |\n","| large group of people playing cards. He approached them and  |  excellent tool to get the kids into the fun. The father of  |\n","|   asked if they were playing poker. They said no, but that   |  the children, a scientist named Dr. Carter, has been given  |\n","| they were just playing cards. He asked again, and this time  |  two choices: He can either use his own daughter as bait or  |\n","| the group replied \"No, we are not playing poker.\" This made  |                        let her go fr                         |\n","|  him curious so he asked them again. They said yes, but tha  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |      \u001b[1mHere is a story:\u001b[0m A woman who calls herself \"N.A.O.      |\n","|   Haines, who was the leader of a group called the \"Dirty    |  Dr.\" has been playing the game for a while now, and she is  |\n","| Dozen,\" was arrested for killing his wife and her lover. The | the first to make an interesting discovery: that one of her  |\n","|   story goes that he had been drinking heavily, and after    | own team's humans has been using a tactic called \"treating\"  |\n","| having sex with his wife in the morning, he shot her in the  |                  to help them win the game.                  |\n","| head while she slept. He then took a .22 caliber pistol from | , in which players take on the role of a team of scientists  |\n","|                      their bedside tabl                      |             trying to uncover an ancient mystery             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=70,\n","    act_name=18,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=False,\n","    prompt_2=stories[\"fantasy\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689512207174,"user_tz":-60,"elapsed":56344,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"6de3b9c4-4a1f-40ed-ff0f-1f99a94ab308","id":"hKROAbj0HQzD"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m took a big hit to the head and went down. He was      |   he\u001b[0m got hit by a car. He was taken to the hospital and is   |\n","| unconscious for about 15 minutes. I got him to the hospital  |                     in stable condition.                     |\n","|    and they did some tests on him and found that he had a    |                                                              |\n","|                         concussion.                          |   I am very grateful that I had the opportunity to see him   |\n","|                                                              |  yesterday and today. He is doing well, but I know that his  |\n","|   I'm not sure what happened but I know that it wasn't his   |   recovery will be long and difficult. My family has been    |\n","|  fault. He's been in football since he was 3 years old and   |  through this before with my sister-in-law who had surgery   |\n","|        has never had any concussions before this one.        |     for breast cancer at age 25 after being diagnosed a      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m went to the bathroom and passed out. I rushed him to    |            he\u001b[0m took a knee. And then he sat down.             |\n","|  the hospital where they gave him an IV and told me that he  |                                                              |\n","|    had a heart attack. He was pronounced dead at 2:00 am.    | I've seen him do this before, but I've never seen him do it  |\n","|                                                              | with such conviction and intensity as he did yesterday. It's |\n","| My son's father is a physician in our community who has been |  been a while since I've seen him so focused on something –  |\n","|    practicing medicine for over 30 years. He's worked in     |               anything – other than football.                |\n","|   hospitals all over the country and has seen his share of   |                                                              |\n","|                     tragedies like this                      | It's been quite the week for my son, too: his first year in  |\n","|                                                              |                        college is jus                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|     he\u001b[0m was hit by a car. He is now in the hospital with      |    he\u001b[0m and his friends were playing soccer. And then they     |\n","| serious injuries. I'm asking for help to pay for his medical | were playing hockey. And then they were playing basketball.  |\n","|    bills and the funeral expenses of his parents who were    |         And then they were doing it all over again.          |\n","|                   killed in this accident.                   |                                                              |\n","|                                                              |  And that's when I realized something: My son is not just a  |\n","|                                                              |  kid anymore; he's a grown-up now! He's grown up enough to   |\n","|   I am trying to raise $10,000 to cover all of his medical   |    know what he wants to do with his life, and he has the    |\n","|  bills and funeral expenses so that he can get back on his   |                            skills                            |\n","|         feet as soon as possible and be able to star         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m ran into the woods and got lost. He was found by his    |         he\u001b[0m ran into the street and was hit by a car.         |\n","|  mom and dad who were looking for him. They took him to the  |                                                              |\n","| hospital where he is currently being treated for hypothermia |               I'm sure you've seen this video:               |\n","|                       and dehydration.                       |                                                              |\n","|                                                              |  It's heartbreaking to see my son get hit by a car and then  |\n","| The story is heartbreaking, but it's also a reminder that we | watch him lying on the ground in pain. I'm so thankful that  |\n","|    need to be vigilant about keeping our kids safe in the    |    he is okay, but it's hard to watch. I don't know what     |\n","|        woods. It's easy to get caught up in all of th        |     happened or why this happened to him, but I do know      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m ran into the street and got hit by a car. He's fine    |    he\u001b[0m ran into the street and was hit by a car. He's been    |\n","|   now, but it's still scary to think about what could have   |  in the hospital for two days now and is still fighting for  |\n","| happened if he had been playing in the street instead of on  |                          his life.                           |\n","|                        his own turf.                         |                                                              |\n","|                                                              |    The driver of the car has been charged with vehicular     |\n","|   The other day I was watching a video of one of my son's    | homicide and leaving the scene of an accident. I'm not sure  |\n","|   friends play football with his little brother. They were   | if he will be charged with anything else yet, but I'm hoping |\n","|  both 6 years old and were running around like crazy trying  |        that he gets off because this is just too much        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m decided to go into the bathroom and use the urinal. I   |          he\u001b[0m started to get dizzy. He had a seizure.          |\n","| watched him do this for a few minutes before I noticed that  |                                                              |\n","| he was bleeding from his penis. He was bleeding so much that | My first thought was that I'd just lost him in the crowd of  |\n","|      it looked like blood had been drawn from his body.      | kids playing football. But then I realized that this wasn't  |\n","|                                                              |  just any soccer game; it was a game for kids with epilepsy  |\n","|  I went to get him help immediately, but when I got there,   | and their families, organized by the Epilepsy Foundation of  |\n","| the doctor told me that it would be too late to save him. H  |  America (EFNA). The Epilepsy Foundation is an organization  |\n","|                                                              |                     dedicated to helping                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m took a hit to the head and went down. He was taken to   |                     he\u001b[0m got hit by a car.                     |\n","|    the hospital and is now in stable condition. I'm very     |                                                              |\n","|   thankful that he's alive and has been released from the    |                   He's lucky to be alive.                    |\n","|                          hospital.                           |                                                              |\n","|                                                              |   The driver of the car is facing charges for leaving the    |\n","| I'm also thankful that this happened on a Sunday afternoon,  |  scene of an accident involving injury or death. He was not  |\n","|  when kids are out of school and parents are more likely to  | injured in the crash, but it did leave him with some serious |\n","|   be at home with their children than they would be on any   | injuries that required emergency surgery and several days in |\n","|                          other day                           | the hospital. My son is lucky to be alive because he had his |\n","|                                                              |                       helmet on at th                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|               he\u001b[0m decided to play some soccer.                |   he\u001b[0m started running. He ran all the way to the other side   |\n","|                                                              | of our yard and stopped. I looked at him and said, \"I think  |\n","|        \"Dad,\" I said, \"I think you should try this.\"         |                  you're having a seizure.\"                   |\n","|                                                              |                                                              |\n","| He took off his helmet and put it on the ground. He put his  | He just stared back at me with those big eyes. He didn't say |\n","|   hands in the air and started to run around like a little   | anything. I thought maybe he was tired or something but then |\n","| kid. I could tell he was excited about playing soccer again  |   he turned around and walked back to his house in silence   |\n","|   after being away from it for so long. He ran around like   |            without saying anything more than tha             |\n","|                      crazy and we play                       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"bQphQmXzHxGU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=130,\n","    act_name=18,\n","    prompt=stories[\"scifi\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Here is a story:\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689512454708,"user_tz":-60,"elapsed":51334,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"9e3f7cd4-cb52-4f5e-beb3-f5e3aa35ff2b","id":"LSMWeuWIHxaT"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |  advanced technology led to the discovery of a great deal of |\n","|     A woman named Amy was working at a restaurant in San     |  knowledge about the nature of the world. It also led to a   |\n","|  Francisco. She had been there for about two years, and was  |   very disturbing discovery: that this knowledge has been    |\n","|   pretty good at her job. She loved the customers, and she   |   largely inaccessible to us. The same forces that created   |\n","|  loved the food. She also loved to talk to them, and that's  |   this planet are now trying to get in on the action, and    |\n","|  what she did when she got off work at about 6pm on Friday   |      we're not even sure they know what they're doing.       |\n","|                            night.                            |              a) If you can't find your own team              |\n","|                                                              |                                                              |\n","|             She had been talking with one of her             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |     \u001b[1mHere is a story:\u001b[0m the world's first civilization has      |\n","|                                                              |   been found in the ruins of an ancient civilization. The    |\n","|  I was sitting in the back of a cab, my hands folded on my   |  ancient civilization was inhabited by a race of humans who  |\n","|   lap, when I noticed a man sitting next to me. He had his   | were able to escape from their own kind and went on to build |\n","|   hands in his pockets and was looking at something on his   |         this very world, which they called \"Earth\".          |\n","| phone. He didn't say anything to me but I could tell he was  |   and here is another story: there are some things that you  |\n","| looking at something that made him uncomfortable. It wasn't  |  should know about our planet. We are one of the only known  |\n","|       until he looked up that I realized what it was.        |                  intelligent species in th                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |                    and here is a mystery.                    |\n","| In the early 1970s, I was working at a company that produced |  Earth has been trying to keep its own civilization together |\n","| toys for children. One day, my boss came into my office and  | for millennia, but now it's about to get a lot more involved |\n","| asked me to come up with a new toy. He wanted something that |                        in the fight.                         |\n","|  would appeal to boys but be equally appealing to girls. He  | We've got two teams of world-class athletes heading into the |\n","| said he wanted something \"girl-friendly.\" I thought about it | same patch of grass at the same time. We're playing against  |\n","|            for a moment and then said, \"What if w            | each other for an unprecedentedly long time, and we're both  |\n","|                                                              |                      on our first ever                       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man walks into a bar. He orders a     |         \u001b[1mHere is a story:\u001b[0m A few years ago, a team of          |\n","| drink. He takes his drink and goes to the bathroom. When he  |     scientists led by an enigmatic man called Professor      |\n","| comes out, he is wearing a hat with an American flag on it.  | Stephenrytos discovered that they had found the solution to  |\n","| The bartender says, \"You know what? I think you should take  |            the biggest problem in human history.             |\n","|                          that off.\"                          |    themselves with their head in the very first place. The   |\n","|                                                              |   answer was simple: we needed to play football with other   |\n","|     The man says, \"I'm not going to take that off.\" The      |  humans! But it was also one of those \"firsts\" that made me  |\n","|                  bartender says, \"Why not?\"                  |                 wonder what kind of football                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A man named Frank comes to the city     |         \u001b[1mHere is a story:\u001b[0m A few years ago, a group of         |\n","| of Chicago, and he wants to buy a house. He goes to the bank |    scientists discovered that they could use the tools of    |\n","|  and asks for a loan. The banker says, \"Frank, I don't have  | science to create a brand-new baseball game. The result was  |\n","|                    any houses for sale.\"                     |            an entirely new way to play baseball.             |\n","|                                                              |                       advanced ballgame                      |\n","|         Frank says, \"Well then you should have one!\"         |   A few years ago, the team that made this discovery found   |\n","|                                                              | out that there were no rules in baseball. So they decided to |\n","|  The banker replies, \"I'm sorry but I don't have any houses  |  make one. It's called Advanced Civilization Baseball and i  |\n","|                          for sale.\"                          |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mHere is a story:\u001b[0m A few years ago, I was on a trip to     |         \u001b[1mHere is a story:\u001b[0m A group of scientists have          |\n","| New York City. I had been to New York before, but this time  | discovered that the best way to deal with this problem is to |\n","|     it was different. It was my first time in the city's     |  use the tools of science and technology to bring back some  |\n","|  Chinatown and one of the most beautiful places I have ever  | common sense. And then, when you're done, take a deep breath |\n","|                            seen.                             |            and think about what it means for you.            |\n","|                                                              |                       - - - - - - - -                        |\n","|  I had heard about the famous Chinatowns of China, but they  |  The first thing we need to do is stop making things worse.  |\n","|   were not what I expected. The Chinese were friendly and    |                       It's time we pu                        |\n","|                           helpful,                           |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                       \u001b[1mHere is a story:\u001b[0m                       |                       \u001b[1mHere is a story:\u001b[0m                       |\n","|                                                              |   advanced technology that could lead to the birth of a new  |\n","|   A man was walking his dog on the beach when he noticed a   |               super-humanly dangerous threat.                |\n","| large group of people playing cards. He approached them and  |          and then, just as quickly, there was this:          |\n","|   asked if they were playing poker. They said no, but that   |  The above image is not an actual image from the movie  The  |\n","| they were just playing cards. He asked again, and this time  | Expanse , but it's actually a very nice painting by  Edward  |\n","| the group replied \"No, we are not playing poker.\" This made  |  \"Nex\" (also known as Eddy) New to our world? You might be   |\n","|  him curious so he asked them again. They said yes, but tha  |                         interested i                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|        \u001b[1mHere is a story:\u001b[0m A young man named Richard L.         |      \u001b[1mHere is a story:\u001b[0m A group of scientists led by the       |\n","|   Haines, who was the leader of a group called the \"Dirty    |  former head of the US Department of Energy has discovered   |\n","| Dozen,\" was arrested for killing his wife and her lover. The |   that we are in the dark about our own past. The team was   |\n","|   story goes that he had been drinking heavily, and after    | able to find out that it was possible to go back in time and |\n","| having sex with his wife in the morning, he shot her in the  | get a grip on what happened before, and they were also able  |\n","| head while she slept. He then took a .22 caliber pistol from | to bring together a great bunch of football players who were |\n","|                      their bedside tabl                      |                    all on the same side.                     |\n","|                                                              |                   advanced to an impressiv                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":[],"metadata":{"id":"NJyOsZtLHw5C"}},{"cell_type":"code","source":[],"metadata":{"id":"AgdBMa-kGZPa"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Trying to get Goose Ahhh working"],"metadata":{"id":"wDABYC6a9apv"}},{"cell_type":"code","source":["import os"],"metadata":{"id":"L7R_JJBo_NgD","executionInfo":{"status":"ok","timestamp":1692272510109,"user_tz":-60,"elapsed":8,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":9,"outputs":[]},{"cell_type":"code","source":["# Specify the file path\n","file_path = 'goose_text/training_subset.json'\n","\n","# Open and read the JSON file\n","with open(file_path, 'r') as file:\n","  # Load the JSON data from the file\n","  goose_dict = json.load(file)\n","\n","goose_text = []\n","for key, value in goose_dict.items():\n","  goose_text.extend(value)\n","\n","# Create the baseline dataset\n","\n","def read_all_text_files(directory):\n","    # List to hold the contents of all files\n","    contents_list = []\n","\n","    # List all files in directory\n","    for filename in os.listdir(directory):\n","        # Check if file is a text file\n","        if filename.endswith('.txt'):\n","            # Construct full file path\n","            filepath = os.path.join(directory, filename)\n","\n","            # Open the file and read the contents\n","            with open(filepath, 'r') as f:\n","                contents = f.read()\n","\n","            # Add the file contents to the list\n","            contents_list.append(contents)\n","\n","    return contents_list\n","\n","training_subset = read_all_text_files('urlsf_subset01-1_data') + read_all_text_files('urlsf_subset01-182_data')\n"],"metadata":{"id":"CnP4M4uP9eUX","executionInfo":{"status":"ok","timestamp":1692272520241,"user_tz":-60,"elapsed":10140,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["len(goose_text)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"y2V75Xhl_Rry","executionInfo":{"status":"ok","timestamp":1689616653857,"user_tz":-60,"elapsed":504,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"133f1f91-950e-4972-dae5-8163b50cf261"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["599"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["len(training_subset)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ziEu9Kc1_Wus","executionInfo":{"status":"ok","timestamp":1689616665513,"user_tz":-60,"elapsed":795,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"c6c5bf86-9396-4425-fd37-4f8eaa698376"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["599"]},"metadata":{},"execution_count":12}]},{"cell_type":"code","source":["len(model.tokenizer(\"buggo bjhvjhgvjhjbvjhbvhjvjh hbhbhj\")[\"input_ids\"])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QgrReXAGBhmi","executionInfo":{"status":"ok","timestamp":1689617124663,"user_tz":-60,"elapsed":393,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"6e1774b5-c8f2-4fc8-fc07-f0f33de55784"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["28"]},"metadata":{},"execution_count":29}]},{"cell_type":"code","source":[],"metadata":{"id":"Png-7sZiB2Fz"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["max(len(model.tokenizer(stringo)) for stringo in goose_text)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1xGK-4woBcW4","executionInfo":{"status":"ok","timestamp":1689617164404,"user_tz":-60,"elapsed":3070,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"c772db41-2714-4ae9-cee5-8300a1cb4cd5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Token indices sequence length is longer than the specified maximum sequence length for this model (1081 > 1024). Running this sequence through the model will result in indexing errors\n"]},{"output_type":"execute_result","data":{"text/plain":["2"]},"metadata":{},"execution_count":31}]},{"cell_type":"code","source":["short_goose_text = [stringo for stringo in goose_text if len(model.tokenizer(stringo)[\"input_ids\"]) < 1000]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VyrlEPj0CB-x","executionInfo":{"status":"ok","timestamp":1692272523522,"user_tz":-60,"elapsed":1901,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"970538ee-178d-4ec2-a73f-38173d57929e"},"execution_count":11,"outputs":[{"output_type":"stream","name":"stderr","text":["Token indices sequence length is longer than the specified maximum sequence length for this model (1081 > 1024). Running this sequence through the model will result in indexing errors\n"]}]},{"cell_type":"code","source":["short_goose_text = short_goose_text[:-1]"],"metadata":{"id":"05I2eGlyYU9k"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len(short_goose_text)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vbAxO1YOCVLO","executionInfo":{"status":"ok","timestamp":1689623071321,"user_tz":-60,"elapsed":26,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"b0679fb4-b126-4c84-a915-9bf604b22038"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["394"]},"metadata":{},"execution_count":14}]},{"cell_type":"code","source":["short_training_subset = [stringo for stringo in training_subset if len(model.tokenizer(stringo)[\"input_ids\"]) < 1000]"],"metadata":{"id":"qh7LG_ubCcWY","executionInfo":{"status":"ok","timestamp":1692272675688,"user_tz":-60,"elapsed":2001,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":14,"outputs":[]},{"cell_type":"code","source":["tiny_training_subset = [stringo for stringo in training_subset if len(model.tokenizer(stringo)[\"input_ids\"]) < 100]"],"metadata":{"id":"q5DkxemmUcZs","executionInfo":{"status":"ok","timestamp":1692272820450,"user_tz":-60,"elapsed":1696,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["short_training_subset = short_training_subset[:394]"],"metadata":{"id":"fNRUrkEbYhhM"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len(short_training_subset)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6wU66pMNCiPf","executionInfo":{"status":"ok","timestamp":1689692611070,"user_tz":-60,"elapsed":217,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"443ee4bf-38f5-4378-fe45-19f0bb58f744"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["394"]},"metadata":{},"execution_count":11}]},{"cell_type":"markdown","source":["Note: my guess is this doesn't work because of bad index things from me, and the number of examples is odd!"],"metadata":{"id":"gNpr4yHOXr24"}},{"cell_type":"code","source":["len(goose_text)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ADxHNU5L9aaI","executionInfo":{"status":"ok","timestamp":1689616476917,"user_tz":-60,"elapsed":433,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"78036e01-3e23-4bd5-b4ea-b4c7e2a1ae44"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["2"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=150,\n","    act_name=3,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":276},"id":"Ywv3ZitBZriE","executionInfo":{"status":"error","timestamp":1689692608996,"user_tz":-60,"elapsed":235,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"6369afa3-7e09-435a-f962-6f5822d3f5dd"},"execution_count":null,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-10-3ff32e850349>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m activation_addition_dataset = [ActivationAdditionDataset(\n\u001b[0m\u001b[1;32m      2\u001b[0m     \u001b[0mcoeff\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m150\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m     \u001b[0mact_name\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m     \u001b[0mprompt\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mshort_goose_text\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m     \u001b[0mfrom_dataset\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'ActivationAdditionDataset' is not defined"]}]},{"cell_type":"markdown","source":["### Interesting Example:"],"metadata":{"id":"DYMKW6Pvayy9"}},{"cell_type":"markdown","source":["Does this accidentally make completions with goose-bump?"],"metadata":{"id":"LBAJ6fdha2QD"}},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=1000,\n","    act_name=3,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Sn0K-0tVaV-C","executionInfo":{"status":"ok","timestamp":1689623603067,"user_tz":-60,"elapsed":45777,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"ff67dea6-0793-42b2-a881-bc20b2e67039"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[489],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [612]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[736],\n","        [269]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [266]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[654],\n","        [733]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [599]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [461]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[568],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[295],\n","        [729]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [227]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[221],\n","        [925]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [983]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [374]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [817]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [319]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[565],\n","        [501]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[334],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[449],\n","        [242]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[344],\n","        [483]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [545]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[566],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[207],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[537],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[716],\n","        [661]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[939],\n","        [355]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[624],\n","        [566]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [300]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[999],\n","        [863]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[451],\n","        [855]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [744]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[336],\n","        [726]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [320]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[912],\n","        [448]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[591],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [564]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[383],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[233],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[850],\n","        [620]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[411],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[976],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[583],\n","        [594]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[421],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[646],\n","        [176]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [385]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[450],\n","        [502]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[304],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[960],\n","        [321]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[905],\n","        [901]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[487],\n","        [441]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[680],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [622]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [492]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[166],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[216],\n","        [340]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[236],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [349]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[538],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[517],\n","        [489]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[663],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[398],\n","        [765]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[480],\n","        [642]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[635],\n","        [417]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [606]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[719],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[495],\n","        [180]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[792],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [936]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[382],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[461],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [327]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [609]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[238],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[270],\n","        [431]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[452],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [490]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[206],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[321],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[816],\n","        [893]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[993],\n","        [214]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[516],\n","        [228]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[366],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [279]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [827]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[672],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[984],\n","        [784]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[665],\n","        [384]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[200],\n","        [937]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[956],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[729],\n","        [197]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [850]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[180],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[723],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[483],\n","        [205]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[479],\n","        [265]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[707],\n","        [554]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [467]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [206]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[839],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[561],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[954],\n","        [666]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[655],\n","        [539]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[580],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[324],\n","        [528]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [514]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[467],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[287],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[362],\n","        [872]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[886],\n","        [482]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [742]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[931],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [624]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[358],\n","        [638]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [268]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[779],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[384],\n","        [808]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[379],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [819]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[373],\n","        [710]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[502],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[857],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [337]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[162],\n","        [331]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[518],\n","        [792]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[829],\n","        [584]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[548],\n","        [588]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[832],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [470]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [680]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[254],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[569],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[870],\n","        [248]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[360],\n","        [172]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[230],\n","        [257]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[217],\n","        [890]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[828],\n","        [383]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [732]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[692],\n","        [382]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [439]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[333],\n","        [691]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[749],\n","        [774]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[876],\n","        [283]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [367]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[202],\n","        [236]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [812]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[348],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [841]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [750]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [631]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[715],\n","        [543]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[742],\n","        [697]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [940]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [371]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[783],\n","        [370]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [683]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[700],\n","        [402]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [486]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [869]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[650],\n","        [310]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[350],\n","        [754]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [799]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[657],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [249]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[987],\n","        [301]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[224],\n","        [684]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[552],\n","        [359]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [341]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[255],\n","        [884]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |      \u001b[1mA girl once had a goose\u001b[0mbumps-inducing seizure and       |\n","|  been forced to eat it when she was 13, and now that she's   |   went into a coma. She was then given an injection of the   |\n","|                    21, the goose is gone.                    |                 drug to treat her seizures.                  |\n","|                                                              |                                                              |\n","| The goose was eaten by a girl who has never seen it before.  | The baby's father, David Gonzalez, told ABC News that he was |\n","|                                                              | shocked by the news and is now trying to get the child back  |\n","| The story of the young woman's experience with eating an egg |                         on his feet.                         |\n","|  is not new, but there are many stories about how children   |                                                              |\n","|             have been forced to eat eggs at som              | \"I'm not going to go into details,\" Gonzalez said. \"I don't  |\n","|                                                              |                       want anyone els                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |      \u001b[1mA girl once had a goose\u001b[0mbumps moment when she saw a      |\n","|             having it with a little bit of milk.             |                   man wearing black pants.                   |\n","|                                                              |                                                              |\n","| I'm so sorry. I'm not going to be able to feed you anything  | She thought it was hilarious, but then the video went viral  |\n","|                     like that, are you?                      |              and her mother-in-law was shocked.              |\n","|                                                              |                                                              |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I | \"I'm not sure if it's just me or if he's gay,\" she said. \"I  |\n","|          don't know what else to do with this one.\"          |                         don't know.\"                         |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |                                                              |\n","|                                                              |   \"He looks like he's gonna go to hell for this,\" her mom    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |      \u001b[1mA girl once had a goose\u001b[0m-bumpshoot when she was 13       |\n","|  picture of herself on the cover of Playboy. She thought it  |   years old. She got pregnant with her first baby boy, but   |\n","| was hilarious, but it wasn't until her husband asked her if  |    didn't have the right to be born until she was 14. Her    |\n","|   she wanted to be photographed with him that she realized   |  family wanted to make sure her pregnancy went smoothly and  |\n","|                 what an amazing idea it was.                 |     so they gave birth to their first daughter, Hailey.      |\n","|                                                              |                                                              |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  | Hailey's father is an engineer who has been working on a lot |\n","| Smith, who has been working as a photographer since 2009. \"  |                 of projects in his spare tim                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |     \u001b[1mA girl once had a goose\u001b[0mbumpshaft, and she's now been     |\n","|                   because she was so cute.                   |                      named \"Jane Doe.\"                       |\n","|                                                              |                                                              |\n","|  She had a secret life of her own, and she wanted to be the  |  The 15-year-old girl was born with an X chromosome, which   |\n","|                         best at it.                          | means she has a brain tumor. She was born with the condition |\n","|                                                              |    in October of 2011. The child is currently undergoing     |\n","|   She knew that she would never be able to live up to her    |              chemotherapy for her brain tumor.               |\n","|                promise, but now that she did…                |                                                              |\n","|                                                              |   \"She's been fighting to get out of this situation,\" said   |\n","|            \"So I'm going to go see you.\" (Sirius)            |                        Linda Goochma                         |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0mbumpsome and then a boob job.     |\n","|                                                              |                                                              |\n","|             She was not the only one to have it.             | It was the perfect opportunity to get her own sexy headshot  |\n","|                                                              |   of an ex-girlfriend, but she had to go through all that    |\n","| And now, as we enter the fourth quarter of the season, I've  |                  hassle and make it happen.                  |\n","|  got to say that my favorite moment in football is when I'm  |                                                              |\n","|  on the field and watching the Dallas Cowboys take on their  |  \"I'm so glad I did,\" she said. \"I'm so happy I got to meet  |\n","|  best team in seven years. It's like a ghost town where you  |                            you.\"                             |\n","|       can't even get out of bed until your phone rings       |                                                              |\n","|                                                              |                                                              |\n","|                                                              |              A girl once had a goosebumpsome a               |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0mbumpshoot. I'm not sure if       |\n","|                                                              | it's the bees, or if she was born with an unusual brain. But |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just | that's exactly what happened to her, and I'm going to assume |\n","|                going to go back and get it.\"                 |    she had some sort of weird problem with the hormones.     |\n","|                                                              |                                                              |\n","| She's still not sure how she got her goose egg, but the fact |     I've been wondering what kind of hormonal issues are     |\n","| that it was so good is what makes her so special. The two of |   involved in this case. The doctor said that they're just   |\n","| them have been friends for years, and when they first met in |                    \"stress hormones.\" Bu                     |\n","|                        college, they                         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |         \u001b[1mA girl once had a goose\u001b[0mbumpshoot of herself.         |\n","|                      trying to eat it.                       |                                                              |\n","|                                                              |   HIGH-FISH HOPHAWKES: The \"High Fishes\" phenomenon is the   |\n","| The video below shows a young girl with goose on her tongue  |   result of an evolutionary delay in the evolution of hap-   |\n","| licking the egg from a plastic bag. The girl then starts to  |  hunting. In fact, it's so common that it's almost a myth.   |\n","| suck the egg off, but when she does so, it's not completely  |  The story goes that when Homo sapiens first began to hunt,  |\n","|  swallowed by the shell of the egg. The goose is then taken  |         they were looking for whales and other mari          |\n","|    out of its shell and put into an incubator for further    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0mbumpsome when she was in her      |\n","|                                                              |                       early twenties.                        |\n","|  It was a little bit of an odd situation, but one that had   |                                                              |\n","|        the potential to be quite devastating for her.        | The brainchild of a man who, like many men, was a gregarious |\n","|                                                              |    and friendly kid with no problem getting into trouble.    |\n","|     The woman's father was in the middle of visiting his     |                                                              |\n","|  daughter and she couldn't help but wonder if he would take  |   He started his own hairdo business and became the first    |\n","| it on himself. He didn't seem to care about her anymore, so  |  hairdo boy ever to win the Miss Universe pageant in 2002.   |\n","| he didn't want to do anything rash or embarrassing. The fac  |    The year before that he won gold for best horticultur     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=1500,\n","    act_name=2,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BwCRxTUobh7X","executionInfo":{"status":"ok","timestamp":1689623971576,"user_tz":-60,"elapsed":44358,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"c75a04da-d394-4d64-ba5b-cd76bb97d484"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[489],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [612]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[736],\n","        [269]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [266]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[654],\n","        [733]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [599]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [461]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[568],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[295],\n","        [729]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [227]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[221],\n","        [925]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [983]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [374]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [817]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [319]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[565],\n","        [501]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[334],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[449],\n","        [242]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[344],\n","        [483]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [545]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[566],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[207],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[537],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[716],\n","        [661]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[939],\n","        [355]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[624],\n","        [566]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [300]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[999],\n","        [863]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[451],\n","        [855]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [744]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[336],\n","        [726]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [320]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[912],\n","        [448]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[591],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [564]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[383],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[233],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[850],\n","        [620]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[411],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[976],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[583],\n","        [594]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[421],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[646],\n","        [176]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [385]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[450],\n","        [502]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[304],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[960],\n","        [321]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[905],\n","        [901]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[487],\n","        [441]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[680],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [622]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [492]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[166],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[216],\n","        [340]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[236],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [349]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[538],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[517],\n","        [489]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[663],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[398],\n","        [765]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[480],\n","        [642]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[635],\n","        [417]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [606]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[719],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[495],\n","        [180]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[792],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [936]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[382],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[461],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [327]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [609]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[238],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[270],\n","        [431]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[452],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [490]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[206],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[321],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[816],\n","        [893]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[993],\n","        [214]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[516],\n","        [228]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[366],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [279]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [827]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[672],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[984],\n","        [784]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[665],\n","        [384]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[200],\n","        [937]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[956],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[729],\n","        [197]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [850]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[180],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[723],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[483],\n","        [205]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[479],\n","        [265]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[707],\n","        [554]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [467]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [206]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[839],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[561],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[954],\n","        [666]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[655],\n","        [539]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[580],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[324],\n","        [528]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [514]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[467],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[287],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[362],\n","        [872]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[886],\n","        [482]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [742]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[931],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [624]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[358],\n","        [638]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [268]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[779],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[384],\n","        [808]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[379],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [819]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[373],\n","        [710]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[502],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[857],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [337]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[162],\n","        [331]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[518],\n","        [792]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[829],\n","        [584]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[548],\n","        [588]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[832],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [470]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [680]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[254],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[569],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[870],\n","        [248]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[360],\n","        [172]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[230],\n","        [257]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[217],\n","        [890]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[828],\n","        [383]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [732]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[692],\n","        [382]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [439]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[333],\n","        [691]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[749],\n","        [774]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[876],\n","        [283]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [367]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[202],\n","        [236]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [812]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[348],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [841]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [750]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [631]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[715],\n","        [543]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[742],\n","        [697]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [940]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [371]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[783],\n","        [370]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [683]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[700],\n","        [402]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [486]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [869]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[650],\n","        [310]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[350],\n","        [754]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [799]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[657],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [249]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[987],\n","        [301]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[224],\n","        [684]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[552],\n","        [359]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [341]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[255],\n","        [884]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |     \u001b[1mA girl once had a goose\u001b[0mbumHHHHHHHHHHHHHHAHHHAHHHHHHH     |\n","|  been forced to eat it when she was 13, and now that she's   |       HHHHHHHHHHHHHHHHHAHAHAHAHAHAHA HAHAHAHAHAHAHAHA        |\n","|                    21, the goose is gone.                    | HAHAHAHAHAHAHAHA HAHAHAHAHAHAHAHA HAHAHAHAHAHAHAHAA HAAAAHAA |\n","|                                                              |       HAAAAHAA HAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA        |\n","| The goose was eaten by a girl who has never seen it before.  |  AAAAAAAAAAAAAA AA-AAA-AAA AAA-AAA AAA-AAA AAA-AAA AA+ AAA+  |\n","|                                                              |                             AAA+                             |\n","| The story of the young woman's experience with eating an egg |                                                              |\n","|  is not new, but there are many stories about how children   |                                                              |\n","|             have been forced to eat eggs at som              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |                      \u001b[1mA girl once had a                       |\n","|             having it with a little bit of milk.             |    goose\u001b[0mbumHHHAAHHHHHAAHHHHHHHHHHHHHHHHHAAAHHHA HA HA HA     |\n","|                                                              | HAHA HAAAAAAAHAHAHAHAHA HAAAAAAHAHAHAHAHAHAHAHAAAHAHAHAHAHAH |\n","| I'm so sorry. I'm not going to be able to feed you anything  | AHAAAAAAAAAAAAAAAAAAAAAAAAAAHHHHHH HH HH HAAAAAAAHAHCBBGHHCB |\n","|                     like that, are you?                      |      BGHHCBBGHCCBBGGGHCGGGGGHCGGGGGGGIEEEYYYYYYYYYYWWWW      |\n","|                                                              |                                                              |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |                                                              |\n","|          don't know what else to do with this one.\"          |                                                              |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |      \u001b[1mA girl once had a goose\u001b[0m-head from a hobo that was       |\n","|  picture of herself on the cover of Playboy. She thought it  |  worth $500,000. Now she's suing the zoo for $100 million.   |\n","| was hilarious, but it wasn't until her husband asked her if  |                                                              |\n","|   she wanted to be photographed with him that she realized   |  Hip hop legend and TV personality Tom Sawyer is suing Zoo   |\n","|                 what an amazing idea it was.                 | Health for allegedly dumping the baby goat into its garbage  |\n","|                                                              |   dump in Hawaii, claiming it was \"frighteningly unsafe.\"    |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  |                                                              |\n","| Smith, who has been working as a photographer since 2009. \"  |       The lawsuit filed by HHHHZWAA claims the zoo \"is       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |                      \u001b[1mA girl once had a                       |\n","|                   because she was so cute.                   |       goose\u001b[0mbumHHHHHHHHHHHHAHHHHAHHHHHHHHHHHHHHHHHHHHHH       |\n","|                                                              |     HAAAHAHAHAHA HAHAHAHA HAHAHAHA HAHAHAHAHA HAHAHAHAHA     |\n","|  She had a secret life of her own, and she wanted to be the  | HAHAHAHAAA HAAAHAHAHAHA HHAAAHAHAHAHA HHAAHCAAHHAH HAAAAAAAH |\n","|                         best at it.                          |   haaahaha hahaha hahaha hahaha hahaha hahaha haaahahahha    |\n","|                                                              |                         haaaaaahahha                         |\n","|   She knew that she would never be able to live up to her    |                                                              |\n","|                promise, but now that she did…                |                                                              |\n","|                                                              |                                                              |\n","|            \"So I'm going to go see you.\" (Sirius)            |                                                              |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |        \u001b[1mA girl once had a goose\u001b[0mbumHHHHHHHHHHHH HH HHH         |\n","|                                                              | HHHHHHHHHHHHHHHHH HH HHH HA HA HA HA HH HAAHAHAHAHAHAHAHCHAH |\n","|             She was not the only one to have it.             | CHAHCHAHAHAHAHAHAHAHCHAHAHAHAHAHAHSHIAAAHTAAHAAHFHLAHAAHSHIA |\n","|                                                              |  AAHTAAHLAHAAAAHPAAAAHPAAAAAAAAAAAHMGHHFGHI-AAAAAHLAH AAHB   |\n","| And now, as we enter the fourth quarter of the season, I've  |                          AAAHR AAA                           |\n","|  got to say that my favorite moment in football is when I'm  |                                                              |\n","|  on the field and watching the Dallas Cowboys take on their  |                                                              |\n","|  best team in seven years. It's like a ghost town where you  |                                                              |\n","|       can't even get out of bed until your phone rings       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0mbumHHHHHHHHHHHHA HA HA HA HA      |\n","|                                                              |        HA HAAHAHAHAHAHA HAAHAHAHAHAHA HAHAHAHAHCHHHC         |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |   HHHAHAHAHAHAHAHA HHAAHHHHHHHHHHHHHHH HHAAAHHHHHHHHHHHTHC   |\n","|                going to go back and get it.\"                 |   HAAAAAH HC HAAAHHHGHAA HHAAAAAAAAAAAAAAAAAAAHHHHH I am a   |\n","|                                                              | little over the top with my name and I'm just gonna make it  |\n","| She's still not sure how she got her goose egg, but the fact |                             all                              |\n","| that it was so good is what makes her so special. The two of |                                                              |\n","| them have been friends for years, and when they first met in |                                                              |\n","|                        college, they                         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0mbumHHHHHHHHHHHHHHHHHHHHHHHHHH     |\n","|                      trying to eat it.                       |  HH HHA HA HA HA HHA HA HHA HA HH Ha ha ha ha ha hha ha hha  |\n","|                                                              |     hha hha hhahahaha hahahahaha Haahaha Haahaha Haahaha     |\n","| The video below shows a young girl with goose on her tongue  | HaaahhhhHaahHaaahHaaahhAAHHAAHHAAHCHAHAHAHAHAHAHAaHHAHAHAHA  |\n","| licking the egg from a plastic bag. The girl then starts to  |                                                              |\n","| suck the egg off, but when she does so, it's not completely  |                                                              |\n","|  swallowed by the shell of the egg. The goose is then taken  |                                                              |\n","|    out of its shell and put into an incubator for further    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |          \u001b[1mA girl once had a goose\u001b[0mbumHHHHHHHHHHHH HH           |\n","|                                                              | HOHHHHHHHHHHH HH HOHHHHHHHHHHH HH HOHHHHHHH HAHA HA HA HA HA |\n","|  It was a little bit of an odd situation, but one that had   | HAHAHAHAHAHAHAHAHCAAHAHAHAHAHAHCAAHAHAHAHAHAHAHAHCAAHAHAHAHA |\n","|        the potential to be quite devastating for her.        |   HAHAHAHCAAHAHAHAAAHSAAAHSAAAHM HCAAHLAH HCAAAAGH AAAHLAH   |\n","|                                                              |                   hhahahahhahahaha hhahah                    |\n","|     The woman's father was in the middle of visiting his     |                                                              |\n","|  daughter and she couldn't help but wonder if he would take  |                                                              |\n","| it on himself. He didn't seem to care about her anymore, so  |                                                              |\n","| he didn't want to do anything rash or embarrassing. The fac  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=60,\n","    act_name=6,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"id":"MCxZNZVcAMC1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=180,\n","    act_name=6,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"841IpWB1ZDFm","executionInfo":{"status":"ok","timestamp":1689623294663,"user_tz":-60,"elapsed":44665,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"d83b8462-9bea-41a9-ddd2-c7ad17b0559d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[489],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [612]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[736],\n","        [269]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [266]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[654],\n","        [733]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [599]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [461]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[568],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[295],\n","        [729]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [227]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[221],\n","        [925]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [983]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [374]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [817]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [319]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[565],\n","        [501]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[334],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[449],\n","        [242]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[344],\n","        [483]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [545]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[566],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[207],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[537],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[716],\n","        [661]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[939],\n","        [355]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[624],\n","        [566]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [300]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[999],\n","        [863]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[451],\n","        [855]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [744]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[336],\n","        [726]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [320]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[912],\n","        [448]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[591],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [564]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[383],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[233],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[850],\n","        [620]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[411],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[976],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[583],\n","        [594]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[421],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[646],\n","        [176]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [385]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[450],\n","        [502]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[304],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[960],\n","        [321]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[905],\n","        [901]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[487],\n","        [441]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[680],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [622]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [492]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[166],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[216],\n","        [340]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[236],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [349]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[538],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[517],\n","        [489]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[663],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[398],\n","        [765]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[480],\n","        [642]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[635],\n","        [417]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [606]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[719],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[495],\n","        [180]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[792],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [936]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[382],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[461],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [327]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [609]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[238],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[270],\n","        [431]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[452],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [490]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[206],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[321],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[816],\n","        [893]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[993],\n","        [214]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[516],\n","        [228]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[366],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [279]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [827]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[672],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[984],\n","        [784]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[665],\n","        [384]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[200],\n","        [937]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[956],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[729],\n","        [197]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [850]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[180],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[723],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[483],\n","        [205]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[479],\n","        [265]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[707],\n","        [554]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [467]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [206]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[839],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[561],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[954],\n","        [666]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[655],\n","        [539]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[580],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[324],\n","        [528]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [514]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[467],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[287],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[362],\n","        [872]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[886],\n","        [482]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [742]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[931],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [624]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[358],\n","        [638]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [268]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[779],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[384],\n","        [808]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[379],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [819]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[373],\n","        [710]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[502],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[857],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [337]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[162],\n","        [331]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[518],\n","        [792]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[829],\n","        [584]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[548],\n","        [588]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[832],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [470]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [680]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[254],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[569],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[870],\n","        [248]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[360],\n","        [172]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[230],\n","        [257]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[217],\n","        [890]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[828],\n","        [383]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [732]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[692],\n","        [382]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [439]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[333],\n","        [691]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[749],\n","        [774]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[876],\n","        [283]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [367]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[202],\n","        [236]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [812]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[348],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [841]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [750]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [631]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[715],\n","        [543]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[742],\n","        [697]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [940]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [371]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[783],\n","        [370]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [683]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[700],\n","        [402]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [486]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [869]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[650],\n","        [310]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[350],\n","        [754]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [799]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[657],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [249]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[987],\n","        [301]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[224],\n","        [684]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[552],\n","        [359]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [341]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[255],\n","        [884]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |      \u001b[1mA girl once had a goose\u001b[0m in her mouth. She was only      |\n","|  been forced to eat it when she was 13, and now that she's   |  five years old when she got the call from her mother, who   |\n","|                    21, the goose is gone.                    |         said that she had been given a special gift.         |\n","|                                                              |                                                              |\n","| The goose was eaten by a girl who has never seen it before.  |  The goose was named 'Bunny' and she was taken to an animal  |\n","|                                                              |  hospital where it was found to have been infected with the  |\n","| The story of the young woman's experience with eating an egg |                        deadly virus.                         |\n","|  is not new, but there are many stories about how children   |                                                              |\n","|             have been forced to eat eggs at som              |   The story has now gone viral on social media, with many    |\n","|                                                              |                 people claiming that they ar                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0mbumps reaction when she saw a     |\n","|             having it with a little bit of milk.             |                  man wearing an orange hat.                  |\n","|                                                              |                                                              |\n","| I'm so sorry. I'm not going to be able to feed you anything  | The boy, who is believed to be in his 20s, was seen wearing  |\n","|                     like that, are you?                      | a blue and white hoodie and white pants with the words \"Hey  |\n","|                                                              |                        Jude\" on them.                        |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |                                                              |\n","|          don't know what else to do with this one.\"          |  He was described as being about 5ft 9in tall and weighing   |\n","|                                                              | about 160lbs. He was dressed in black jeans, dark blue shirt |\n","|                           \"Oh, my                            |                              a                               |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |\n","|  picture of herself on the cover of Playboy. She thought it  |        photo of her sister's father in the bathroom.         |\n","| was hilarious, but it wasn't until her husband asked her if  |                                                              |\n","|   she wanted to be photographed with him that she realized   |  \"I thought, 'Oh my God, this is so amazing,'\" said Brenda   |\n","|                 what an amazing idea it was.                 |   Sanger, who lives in Brooklyn with her husband and three   |\n","|                                                              |            children. \"It was just really weird.\"             |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  |                                                              |\n","| Smith, who has been working as a photographer since 2009. \"  |  Sanger says she got to know the couple from their home in   |\n","|                                                              |            St. Louis when they were both working             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |\n","|                   because she was so cute.                   |                   because she was so cute.                   |\n","|                                                              |                                                              |\n","|  She had a secret life of her own, and she wanted to be the  | She had a perfect personality and could talk with anyone in  |\n","|                         best at it.                          |  the world. It was hard to believe that she could even get   |\n","|                                                              |  along with everyone on Earth, but it wasn't like her life   |\n","|   She knew that she would never be able to live up to her    |  depended on it. She was happy, healthy and very smart, and  |\n","|                promise, but now that she did…                | she had been doing everything right for the past five years  |\n","|                                                              |                         without any                          |\n","|            \"So I'm going to go see you.\" (Sirius)            |                                                              |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0m egg. It was her first time      |\n","|                                                              |  having a bird. She would never have dreamed of having one,  |\n","|             She was not the only one to have it.             |              but she had no idea how to get it.              |\n","|                                                              |                                                              |\n","| And now, as we enter the fourth quarter of the season, I've  |  The first time she ever saw the goose egg was when she was  |\n","|  got to say that my favorite moment in football is when I'm  | about 10 years old, and that's when her parents were at home |\n","|  on the field and watching the Dallas Cowboys take on their  |  with their children in their car driving around town on a   |\n","|  best team in seven years. It's like a ghost town where you  |        hot summer day. The kids were playing with th         |\n","|       can't even get out of bed until your phone rings       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |\n","|                                                              |                                                              |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just | \"It's not like I'm going to give it up,\" she said. \"I'm just |\n","|                going to go back and get it.\"                 |                going to go back and get it.\"                 |\n","|                                                              |                                                              |\n","| She's still not sure how she got her goose egg, but the fact |  She's still in the hospital, but she's doing fine. She was  |\n","| that it was so good is what makes her so special. The two of |   born with an abnormal number of small intestine tumors,    |\n","| them have been friends for years, and when they first met in | which means that her weight is now at its lowest point since |\n","|                        college, they                         |           birth. The surgery was performed by Dr.            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |\n","|                      trying to eat it.                       | trying to eat it. She's been trying to eat it for days, but  |\n","|                                                              | she can't stop herself from getting so excited about eating  |\n","| The video below shows a young girl with goose on her tongue  | it. It's so hard to swallow when you're feeling hungry, and  |\n","| licking the egg from a plastic bag. The girl then starts to  |  that makes you want to lick the goose off of her face. But  |\n","| suck the egg off, but when she does so, it's not completely  | then again, this is not the first time that girls have tried |\n","|  swallowed by the shell of the egg. The goose is then taken  |                           this. I                            |\n","|    out of its shell and put into an incubator for further    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |\n","|                                                              |                                                              |\n","|  It was a little bit of an odd situation, but one that had   |  But now, with the arrival of a new generation of internet   |\n","|        the potential to be quite devastating for her.        |          trolls, the internet is back on its feet.           |\n","|                                                              |                                                              |\n","|     The woman's father was in the middle of visiting his     |   It's been an incredible year for news sites and bloggers   |\n","|  daughter and she couldn't help but wonder if he would take  |  alike, as they continue to make their mark on the world by  |\n","| it on himself. He didn't seem to care about her anymore, so  |      making it easy for people to harass others online.      |\n","| he didn't want to do anything rash or embarrassing. The fac  |                                                              |\n","|                                                              |     And while some may be able to get away with trolling     |\n","|                                                              |                anonymously online, many still                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=300,\n","    act_name=6,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dnmDLEhpZo4j","executionInfo":{"status":"ok","timestamp":1689623445888,"user_tz":-60,"elapsed":45330,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"59ff5add-5473-411c-c402-aeb74721ad66"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[489],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [612]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[736],\n","        [269]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [266]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[654],\n","        [733]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [599]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [461]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[568],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[295],\n","        [729]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [227]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[221],\n","        [925]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [983]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [374]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [817]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [319]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[565],\n","        [501]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[334],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[449],\n","        [242]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[344],\n","        [483]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [545]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[566],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[207],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[537],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[716],\n","        [661]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[939],\n","        [355]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[624],\n","        [566]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [300]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[999],\n","        [863]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[451],\n","        [855]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [744]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[336],\n","        [726]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [320]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[912],\n","        [448]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[591],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [564]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[383],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[233],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[850],\n","        [620]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[411],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[976],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[583],\n","        [594]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[421],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[646],\n","        [176]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [385]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[450],\n","        [502]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[304],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[960],\n","        [321]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[905],\n","        [901]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[487],\n","        [441]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[680],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [622]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [492]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[166],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[216],\n","        [340]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[236],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [349]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[538],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[517],\n","        [489]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[663],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[398],\n","        [765]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[480],\n","        [642]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[635],\n","        [417]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [606]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[719],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[495],\n","        [180]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[792],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [936]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[382],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[461],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [327]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [609]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[238],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[270],\n","        [431]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[452],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [490]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[206],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[321],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[816],\n","        [893]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[993],\n","        [214]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[516],\n","        [228]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[366],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [279]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [827]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[672],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[984],\n","        [784]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[665],\n","        [384]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[200],\n","        [937]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[956],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[729],\n","        [197]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [850]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[180],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[723],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[483],\n","        [205]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[479],\n","        [265]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[707],\n","        [554]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [467]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [206]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[839],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[561],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[954],\n","        [666]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[655],\n","        [539]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[580],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[324],\n","        [528]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [514]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[467],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[287],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[362],\n","        [872]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[886],\n","        [482]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [742]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[931],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [624]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[358],\n","        [638]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [268]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[779],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[384],\n","        [808]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[379],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [819]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[373],\n","        [710]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[502],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[857],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [337]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[162],\n","        [331]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[518],\n","        [792]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[829],\n","        [584]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[548],\n","        [588]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[832],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [470]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [680]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[254],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[569],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[870],\n","        [248]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[360],\n","        [172]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[230],\n","        [257]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[217],\n","        [890]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[828],\n","        [383]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [732]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[692],\n","        [382]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [439]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[333],\n","        [691]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[749],\n","        [774]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[876],\n","        [283]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [367]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[202],\n","        [236]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [812]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[348],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [841]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [750]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [631]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[715],\n","        [543]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[742],\n","        [697]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [940]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [371]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[783],\n","        [370]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [683]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[700],\n","        [402]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [486]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [869]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[650],\n","        [310]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[350],\n","        [754]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [799]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[657],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [249]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[987],\n","        [301]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[224],\n","        [684]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[552],\n","        [359]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [341]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[255],\n","        [884]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |  \u001b[1mA girl once had a goose\u001b[0m in her mouth. She was very lucky.   |\n","|  been forced to eat it when she was 13, and now that she's   |                                                              |\n","|                    21, the goose is gone.                    |    It was the year 2000, and a young girl named Elizabeth    |\n","|                                                              | Stumpf had just finished her high school graduation when she |\n","| The goose was eaten by a girl who has never seen it before.  | suddenly heard a noise from the bathroom. She knew something |\n","|                                                              | was wrong, but she didn't know what to do. The sound of the  |\n","| The story of the young woman's experience with eating an egg |  bathroom door opening startled her so much that she jumped  |\n","|  is not new, but there are many stories about how children   |                 out of bed and ran to find a                 |\n","|             have been forced to eat eggs at som              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0mbumps reaction when she saw a     |\n","|             having it with a little bit of milk.             |  man standing next to her. The goosebumps were very strong   |\n","|                                                              |  and she was able to stand up and take the picture. She was  |\n","| I'm so sorry. I'm not going to be able to feed you anything  |    then taken back to the car where they went for dinner.    |\n","|                     like that, are you?                      |                                                              |\n","|                                                              |                 This is what happened next:                  |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |                                                              |\n","|          don't know what else to do with this one.\"          |                                                              |\n","|                                                              |  I'm not sure if it's possible for you guys to be so close   |\n","|                           \"Oh, my                            |             together, but I can tell you that I              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |\n","|  picture of herself on the cover of Playboy. She thought it  |                photo of herself with her dad.                |\n","| was hilarious, but it wasn't until her husband asked her if  |                                                              |\n","|   she wanted to be photographed with him that she realized   |  She didn't know what to think, but the moment was captured  |\n","|                 what an amazing idea it was.                 |    on video by her father and the camera crew at Disney's    |\n","|                                                              |            Hollywood Studios in Orlando, Florida.            |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  |                                                              |\n","| Smith, who has been working as a photographer since 2009. \"  | The image shows two girls with their fathers' faces covered  |\n","|                                                              |  in feathers and sitting on top of each other. The caption   |\n","|                                                              |                      reads: \"What is i                       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |\n","|                   because she was so cute.                   |                   because she was so cute.                   |\n","|                                                              |                                                              |\n","|  She had a secret life of her own, and she wanted to be the  | She had a perfect personality and could talk about anything  |\n","|                         best at it.                          |  she wanted. She was very shy and shy, but she loved being   |\n","|                                                              |  alone with her friends. She liked to watch movies with her  |\n","|   She knew that she would never be able to live up to her    |  friends and hang out with them in the car while they were   |\n","|                promise, but now that she did…                |  playing games on their cell phones. Her favorite movie was  |\n","|                                                              |                    \"The Little Mermaid.\"                     |\n","|            \"So I'm going to go see you.\" (Sirius)            |                                                              |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0m egg. It was her first time      |\n","|                                                              |                     ever having an egg.                      |\n","|             She was not the only one to have it.             |                                                              |\n","|                                                              |  \"Oh my God, I'm so excited!\" she cried as she grabbed the   |\n","| And now, as we enter the fourth quarter of the season, I've  |  egg and held it in her mouth for dear life. \"I love you so  |\n","|  got to say that my favorite moment in football is when I'm  |                            much.\"                            |\n","|  on the field and watching the Dallas Cowboys take on their  |                                                              |\n","|  best team in seven years. It's like a ghost town where you  |  She was very happy to have a little goose egg in her mouth  |\n","|       can't even get out of bed until your phone rings       |  and to have it inside of her for all eternity! She didn't   |\n","|                                                              |                        even know wha                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |\n","|                                                              |                                                              |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |  \"You're not going to be able to eat that,\" she said. \"I'll  |\n","|                going to go back and get it.\"                 |                  just have to find a way.\"                   |\n","|                                                              |                                                              |\n","| She's still not sure how she got her goose egg, but the fact | She'd been talking about how it was okay for her parents to  |\n","| that it was so good is what makes her so special. The two of | get married, but they couldn't afford the child support and  |\n","| them have been friends for years, and when they first met in | couldn't afford the childcare, so she got into a fight with  |\n","|                        college, they                         |    her parents over who would pay for their kids' educati    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |\n","|                      trying to eat it.                       |  trying to eat it. She's been playing with it for the last   |\n","|                                                              |   few days, but she doesn't know how to stop herself from    |\n","| The video below shows a young girl with goose on her tongue  |                          eating it.                          |\n","| licking the egg from a plastic bag. The girl then starts to  |                                                              |\n","| suck the egg off, but when she does so, it's not completely  |   \"I'm sorry,\" she says softly, as if she's not expecting    |\n","|  swallowed by the shell of the egg. The goose is then taken  |        anything. \"I don't want you to eat my goose.\"         |\n","|    out of its shell and put into an incubator for further    |                                                              |\n","|                                                              |            \"You're not eating my goose,\" the boy             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0m egg. It was so easy to do,      |\n","|                                                              |    but it was just so difficult to put it into practice.     |\n","|  It was a little bit of an odd situation, but one that had   |                                                              |\n","|        the potential to be quite devastating for her.        |  The problem is that the goose egg is not always an egg. In  |\n","|                                                              |  fact, it's very hard to get a goose egg when you're trying  |\n","|     The woman's father was in the middle of visiting his     | to do something that requires you to take care of your eggs  |\n","|  daughter and she couldn't help but wonder if he would take  |  and eggs are usually in a very small area where they don't  |\n","| it on himself. He didn't seem to care about her anymore, so  |                        have any chanc                        |\n","| he didn't want to do anything rash or embarrassing. The fac  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=1000,\n","    act_name=6,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mbh4qHy8bZly","executionInfo":{"status":"ok","timestamp":1689623882978,"user_tz":-60,"elapsed":47572,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"ff2b8e8e-d40d-4014-f355-7f3f3fb4ccbb"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[489],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [612]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[736],\n","        [269]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [266]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[654],\n","        [733]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [599]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [461]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[568],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[295],\n","        [729]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [227]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[221],\n","        [925]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [983]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [374]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [817]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [319]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[565],\n","        [501]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[334],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[449],\n","        [242]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[344],\n","        [483]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [545]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[566],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[207],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[537],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[716],\n","        [661]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[939],\n","        [355]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[624],\n","        [566]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [300]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[999],\n","        [863]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[451],\n","        [855]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [744]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[336],\n","        [726]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [320]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[912],\n","        [448]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[591],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [564]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[383],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[233],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[850],\n","        [620]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[411],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[976],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[583],\n","        [594]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[421],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[646],\n","        [176]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [385]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[450],\n","        [502]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[304],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[960],\n","        [321]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[905],\n","        [901]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[487],\n","        [441]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[680],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [622]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [492]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[166],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[216],\n","        [340]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[236],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [349]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[538],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[517],\n","        [489]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[663],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[398],\n","        [765]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[480],\n","        [642]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[635],\n","        [417]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [606]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[719],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[495],\n","        [180]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[792],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [936]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[382],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[461],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [327]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [609]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[238],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[270],\n","        [431]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[452],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [490]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[206],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[321],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[816],\n","        [893]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[993],\n","        [214]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[516],\n","        [228]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[366],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [279]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [827]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[672],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[984],\n","        [784]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[665],\n","        [384]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[200],\n","        [937]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[956],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[729],\n","        [197]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [850]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[180],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[723],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[483],\n","        [205]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[479],\n","        [265]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[707],\n","        [554]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [467]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [206]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[839],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[561],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[954],\n","        [666]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[655],\n","        [539]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[580],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[324],\n","        [528]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [514]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[467],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[287],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[362],\n","        [872]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[886],\n","        [482]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [742]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[931],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [624]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[358],\n","        [638]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [268]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[779],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[384],\n","        [808]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[379],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [819]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[373],\n","        [710]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[502],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[857],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [337]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[162],\n","        [331]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[518],\n","        [792]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[829],\n","        [584]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[548],\n","        [588]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[832],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [470]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [680]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[254],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[569],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[870],\n","        [248]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[360],\n","        [172]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[230],\n","        [257]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[217],\n","        [890]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[828],\n","        [383]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [732]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[692],\n","        [382]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [439]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[333],\n","        [691]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[749],\n","        [774]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[876],\n","        [283]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [367]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[202],\n","        [236]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [812]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[348],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [841]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [750]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [631]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[715],\n","        [543]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[742],\n","        [697]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [940]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [371]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[783],\n","        [370]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [683]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[700],\n","        [402]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [486]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [869]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[650],\n","        [310]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[350],\n","        [754]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [799]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[657],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [249]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[987],\n","        [301]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[224],\n","        [684]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[552],\n","        [359]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [341]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[255],\n","        [884]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |      \u001b[1mA girl once had a goose\u001b[0mbumps-inducing orgasm. But       |\n","|  been forced to eat it when she was 13, and now that she's   | now, she's got to go on the Internet and get her own... (H/T |\n","|                    21, the goose is gone.                    |                       The Gooey Girl)                        |\n","|                                                              |                                                              |\n","| The goose was eaten by a girl who has never seen it before.  | Ladies and gents, I'm not saying that you should get any of  |\n","|                                                              | this stuff. You're just saying that you want to be happy. I  |\n","| The story of the young woman's experience with eating an egg |         mean, who doesn't want to be happy? (H/T th          |\n","|  is not new, but there are many stories about how children   |                                                              |\n","|             have been forced to eat eggs at som              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |                      \u001b[1mA girl once had a                       |\n","|             having it with a little bit of milk.             |     goose\u001b[0mbumpsHHHHHHAAHHHHHHHHHHHHHHHHHHAHAHAHA HA HA HA     |\n","|                                                              |     HAAAAAAAAAAAAAAAAAAAAAAAHHAAHHAAHAHAHAHAHA HA HA HA      |\n","| I'm so sorry. I'm not going to be able to feed you anything  |     HAAAAAAAAAAAAAAAHHAAHAHAHAHAHA HAAAAAAAAAAAAAAA HHH      |\n","|                     like that, are you?                      |        AAHAHAHAHAHA hahaha hahaha hahaha hahahahahaha        |\n","|                                                              |          hahahahahahahaha haaaaaaaahhh haaaaaaaahhh          |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |                                                              |\n","|          don't know what else to do with this one.\"          |                                                              |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |      \u001b[1mA girl once had a goose\u001b[0mbumpsHHH! Now she's got to       |\n","|  picture of herself on the cover of Playboy. She thought it  | get her HAHAHHHHHAAHHHHHHHHHHHHHHAAAHHHHHAAHAAAAAHHAAAAAAAAA |\n","| was hilarious, but it wasn't until her husband asked her if  |      AAAHCHAHAHAHAHAHAHAHAHAHAHAHAHAHAHAHAHAHAHA HAHAHA      |\n","|   she wanted to be photographed with him that she realized   |     HAAAHHAAAH HAHAHA HAAAAAAAAAAAAAAA HHHAHAHAHA Awwwww     |\n","|                 what an amazing idea it was.                 |    hmmmmmmmmmmmhhahaha hahaha haaaaa hahahahaha haaaaa ha    |\n","|                                                              |                                                              |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  |                                                              |\n","| Smith, who has been working as a photographer since 2009. \"  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |                      \u001b[1mA girl once had a                       |\n","|                   because she was so cute.                   |        goose\u001b[0mbumpsHHHHHAHHHHAHHHAAHHHHHHHHHHHHHHHHHHAA        |\n","|                                                              |     HAAAHAHAHAHAHAHAHA HAHAHAHAHAHAHAHA HAHAHAHAHAHAHAHA     |\n","|  She had a secret life of her own, and she wanted to be the  |        HAHAHAHAHAHAHAHA HAHAHAHAHAHAHAAH HAHAHAHAHAAH        |\n","|                         best at it.                          | HAAAAAAHHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH AAAAAAAAAAAAAAAAHP |\n","|                                                              |   AAAAHHHHAAGH HABYYYYYYYYY HHhahahaha AAhaha AAAaaaaaaaaa   |\n","|   She knew that she would never be able to live up to her    |                                                              |\n","|                promise, but now that she did…                |                                                              |\n","|                                                              |                                                              |\n","|            \"So I'm going to go see you.\" (Sirius)            |                                                              |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |       \u001b[1mA girl once had a goose\u001b[0mbumpsHHHHHHHHHHHHHHHHHHH        |\n","|                                                              |   HAAAAAAAAHHHHHHHH HH HAHAHAHA HAHAHAHAHAHA HAHAHAHAHAHA    |\n","|             She was not the only one to have it.             |    HAHAHAHAHAHA HAAAHHHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHHHH     |\n","|                                                              |    HAAAAAAAAAHEh AAAAAAAAHEh AAAAAAHCOHhh hahahaha hahaha    |\n","| And now, as we enter the fourth quarter of the season, I've  |            hahaha hahhahha hahaha hahhahha haaaah            |\n","|  got to say that my favorite moment in football is when I'm  |                                                              |\n","|  on the field and watching the Dallas Cowboys take on their  |                                                              |\n","|  best team in seven years. It's like a ghost town where you  |                                                              |\n","|       can't even get out of bed until your phone rings       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |              \u001b[1mA girl once had a goose\u001b[0mbumps haih!              |\n","|                                                              |  AHHHHHHAAHHHAAAHHHHHHHHHHHHHHHAAAAAAAAAAAAAAAAAAAAHA Haha   |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |   hahaha HAHAHAHA HAHAHAHAHAHA HAHAHAHAHAHAHAHA Hahahahaha   |\n","|                going to go back and get it.\"                 |     Haahha Haahha hahahahaha Haahha hahahahaaaaaaaaaaaa      |\n","|                                                              |    hAAaAAAAAAAH HAAAAAAAAAAAHHAAHC AAAAAAAAAHHHHHHHHHHHH     |\n","| She's still not sure how she got her goose egg, but the fact |                                                              |\n","| that it was so good is what makes her so special. The two of |                                                              |\n","| them have been friends for years, and when they first met in |                                                              |\n","|                        college, they                         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |            \u001b[1mA girl once had a goose\u001b[0mbumps hahaha...            |\n","|                      trying to eat it.                       |                                                              |\n","|                                                              | You know what I mean? A girl once had a goosebumps hahaha... |\n","| The video below shows a young girl with goose on her tongue  |                                                              |\n","| licking the egg from a plastic bag. The girl then starts to  |                                                              |\n","| suck the egg off, but when she does so, it's not completely  |                  Hmmm, that's kind of cool.                  |\n","|  swallowed by the shell of the egg. The goose is then taken  |                                                              |\n","|    out of its shell and put into an incubator for further    |                                                              |\n","|                                                              | I've been watching this one for about 10 years now and I've  |\n","|                                                              |                 never seen anything like it.                 |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              | It's got some pretty big hottie eyes, so it looks like she's |\n","|                                                              |                         been staring                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0mbumpshaaaaAAAHHHAAHHAAHHHAAAA     |\n","|                                                              |         HHAAAHHHHHHHHHHHHHHAAAHAAHA HA HA HA HAAAAHA         |\n","|  It was a little bit of an odd situation, but one that had   |  HAAAAAAAAAAAAAAAAAAAAAAAAAAHCHCBBBB HH-HHA HAAAAAAAAAAAAh   |\n","|        the potential to be quite devastating for her.        |  AHAHAHAHAHAHAHA HHAHAHAHAHAHAHahaha hahahahaha hahahahaha   |\n","|                                                              |           hahahahaha hahaa hahaaaaaaaaaaAH Ha haha           |\n","|     The woman's father was in the middle of visiting his     |                                                              |\n","|  daughter and she couldn't help but wonder if he would take  |                                                              |\n","| it on himself. He didn't seem to care about her anymore, so  |                                                              |\n","| he didn't want to do anything rash or embarrassing. The fac  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=90,\n","    act_name=10,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Sb0IacPGY-A4","executionInfo":{"status":"ok","timestamp":1689623248356,"user_tz":-60,"elapsed":47437,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"11d78807-4690-4dd1-8678-b4b89ad84cef"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[489],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [612]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[736],\n","        [269]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [266]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[654],\n","        [733]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [599]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [461]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[568],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[295],\n","        [729]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [227]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[221],\n","        [925]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [983]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [374]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [817]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [319]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[565],\n","        [501]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[334],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[449],\n","        [242]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[344],\n","        [483]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [545]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[566],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[207],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[537],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[716],\n","        [661]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[939],\n","        [355]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[624],\n","        [566]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [300]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[999],\n","        [863]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[451],\n","        [855]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [744]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[336],\n","        [726]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [320]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[912],\n","        [448]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[591],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [564]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[383],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[233],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[850],\n","        [620]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[411],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[976],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[583],\n","        [594]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[421],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[646],\n","        [176]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [385]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[450],\n","        [502]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[304],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[960],\n","        [321]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[905],\n","        [901]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[487],\n","        [441]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[680],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [622]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [492]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[166],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[216],\n","        [340]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[236],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [349]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[538],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[517],\n","        [489]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[663],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[398],\n","        [765]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[480],\n","        [642]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[635],\n","        [417]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [606]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[719],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[495],\n","        [180]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[792],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [936]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[382],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[461],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [327]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [609]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[238],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[270],\n","        [431]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[452],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [490]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[206],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[321],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[816],\n","        [893]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[993],\n","        [214]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[516],\n","        [228]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[366],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [279]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [827]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[672],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[984],\n","        [784]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[665],\n","        [384]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[200],\n","        [937]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[956],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[729],\n","        [197]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [850]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[180],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[723],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[483],\n","        [205]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[479],\n","        [265]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[707],\n","        [554]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [467]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [206]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[839],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[561],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[954],\n","        [666]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[655],\n","        [539]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[580],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[324],\n","        [528]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [514]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[467],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[287],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[362],\n","        [872]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[886],\n","        [482]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [742]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[931],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [624]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[358],\n","        [638]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [268]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[779],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[384],\n","        [808]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[379],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [819]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[373],\n","        [710]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[502],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[857],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [337]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[162],\n","        [331]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[518],\n","        [792]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[829],\n","        [584]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[548],\n","        [588]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[832],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [470]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [680]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[254],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[569],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[870],\n","        [248]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[360],\n","        [172]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[230],\n","        [257]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[217],\n","        [890]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[828],\n","        [383]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [732]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[692],\n","        [382]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [439]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[333],\n","        [691]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[749],\n","        [774]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[876],\n","        [283]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [367]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[202],\n","        [236]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [812]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[348],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [841]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [750]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [631]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[715],\n","        [543]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[742],\n","        [697]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [940]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [371]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[783],\n","        [370]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [683]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[700],\n","        [402]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [486]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [869]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[650],\n","        [310]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[350],\n","        [754]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [799]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[657],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [249]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[987],\n","        [301]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[224],\n","        [684]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[552],\n","        [359]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [341]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[255],\n","        [884]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |\n","|  been forced to eat it when she was 13, and now that she's   |  been forced to eat it when she was 13, and now that she's   |\n","|                    21, the goose is gone.                    |                    21, the goose is gone.                    |\n","|                                                              |                                                              |\n","| The goose was eaten by a girl who has never seen it before.  | The goose was eaten by a girl who has never seen it before.  |\n","|                                                              |                                                              |\n","| The story of the young woman's experience with eating an egg | The story of the young woman's experience with eating an egg |\n","|  is not new, but there are many stories about how children   |  is not new, but there are many stories about how children   |\n","|             have been forced to eat eggs at som              |             have been forced to eat eggs at som              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |  \u001b[1mA girl once had a goose\u001b[0m that could fly, but now she can't.  |\n","|             having it with a little bit of milk.             |                                                              |\n","|                                                              |     The girl who once had a goose is now unable to fly.      |\n","| I'm so sorry. I'm not going to be able to feed you anything  |                                                              |\n","|                     like that, are you?                      |  A girl once had a goose that could fly, but now she can't.  |\n","|                                                              |                                                              |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I | She's been stuck in the past for so long that it seems like  |\n","|          don't know what else to do with this one.\"          |  her future is at stake…or maybe not. She's lost everything  |\n","|                                                              |                   and has no idea what to                    |\n","|                           \"Oh, my                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |\n","|  picture of herself on the cover of Playboy. She thought it  |  picture of herself on the cover of Playboy. She thought it  |\n","| was hilarious, but it wasn't until her husband asked her if  | was hilarious, but it wasn't until her husband asked her if  |\n","|   she wanted to be photographed with him that she realized   |   she wanted to be photographed with him that she realized   |\n","|                 what an amazing idea it was.                 |                 what an amazing idea it was.                 |\n","|                                                              |                                                              |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  |  \"I didn't know I'd ever see myself in Playboy,\" says Kelly  |\n","| Smith, who has been working as a photographer since 2009. \"  | Anderson, who has been working as a photographer since 2007  |\n","|                                                              |                            and is                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |\n","|                   because she was so cute.                   |                   because she was so cute.                   |\n","|                                                              |                                                              |\n","|  She had a secret life of her own, and she wanted to be the  | She had a huge goose egg and she was going to make it into a |\n","|                         best at it.                          |  baby bird. And that's what happened when she got pregnant   |\n","|                                                              | with her first child, too. The only thing left for her to do |\n","|   She knew that she would never be able to live up to her    |  was fly around the world in her own little airplane, which  |\n","|                promise, but now that she did…                |        is why she went on an adventure that ended up         |\n","|                                                              |                                                              |\n","|            \"So I'm going to go see you.\" (Sirius)            |                                                              |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |\n","|                                                              |                                                              |\n","|             She was not the only one to have it.             |  She was not the only one. A group of men had tried to take  |\n","|                                                              |  her out on a date in the past, but they were stopped by an  |\n","| And now, as we enter the fourth quarter of the season, I've  | older man who wanted to take her back home and get her to go |\n","|  got to say that my favorite moment in football is when I'm  |    home with him. The man then took his own life, leaving    |\n","|  on the field and watching the Dallas Cowboys take on their  |                behind his wife and children.                 |\n","|  best team in seven years. It's like a ghost town where you  |                                                              |\n","|       can't even get out of bed until your phone rings       |      The story is not new for these sorts of incidents,      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |\n","|                                                              |                                                              |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just | \"It's not like I'm going to give it up,\" she said. \"I'm just |\n","|                going to go back and get it.\"                 |                going to go back and get it.\"                 |\n","|                                                              |                                                              |\n","| She's still not sure how she got her goose egg, but the fact |  She's still not sure how she got the goose egg, but that's  |\n","| that it was so good is what makes her so special. The two of |  what makes her so special. She thinks about it every day,   |\n","| them have been friends for years, and when they first met in | and she can't help but think of all the things that made her |\n","|                        college, they                         |                      tick when she was                       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |\n","|                      trying to eat it.                       |                      trying to eat it.                       |\n","|                                                              |                                                              |\n","| The video below shows a young girl with goose on her tongue  | The video below shows a young girl with goosebumps standing  |\n","| licking the egg from a plastic bag. The girl then starts to  | on the edge of the pool. She's holding up her hand, and then |\n","| suck the egg off, but when she does so, it's not completely  |                 looking down at her stomach.                 |\n","|  swallowed by the shell of the egg. The goose is then taken  |                                                              |\n","|    out of its shell and put into an incubator for further    | It's not clear if this is just a random scene or if she has  |\n","|                                                              | been playing with it for some time. Either way, it seems lik |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0m egg on her face when she was     |\n","|                                                              | in the midst of a pregnancy. She didn't know what to do with |\n","|  It was a little bit of an odd situation, but one that had   |  it, but she was so excited that she took off her shoes and  |\n","|        the potential to be quite devastating for her.        |                       started running.                       |\n","|                                                              |                                                              |\n","|     The woman's father was in the middle of visiting his     |  The girl had been told by doctors that her pregnancy would  |\n","|  daughter and she couldn't help but wonder if he would take  | be over before the end of this month, and that she needed to |\n","| it on himself. He didn't seem to care about her anymore, so  | get pregnant again. The baby's father decided to give up on  |\n","| he didn't want to do anything rash or embarrassing. The fac  |                             his                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=300,\n","    act_name=10,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bc4d-rOYZju4","executionInfo":{"status":"ok","timestamp":1689623400600,"user_tz":-60,"elapsed":47799,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"8d34ecc8-3c5c-4cd5-9381-8f0fb5937bb1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[489],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [612]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[736],\n","        [269]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [266]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[654],\n","        [733]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [599]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [461]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[568],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[295],\n","        [729]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [227]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[221],\n","        [925]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [983]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [374]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [817]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [319]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[565],\n","        [501]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[334],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[449],\n","        [242]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[344],\n","        [483]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [545]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[566],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[207],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[537],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[716],\n","        [661]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[939],\n","        [355]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[624],\n","        [566]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [300]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[999],\n","        [863]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[451],\n","        [855]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [744]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[336],\n","        [726]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [320]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[912],\n","        [448]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[591],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [564]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[383],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[233],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[850],\n","        [620]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[411],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[976],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[583],\n","        [594]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[421],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[646],\n","        [176]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [385]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[450],\n","        [502]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[304],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[960],\n","        [321]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[905],\n","        [901]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[487],\n","        [441]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[680],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [622]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [492]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[166],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[216],\n","        [340]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[236],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [349]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[538],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[517],\n","        [489]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[663],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[398],\n","        [765]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[480],\n","        [642]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[635],\n","        [417]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [606]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[719],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[495],\n","        [180]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[792],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [936]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[382],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[461],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [327]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [609]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[238],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[270],\n","        [431]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[452],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [490]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[206],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[321],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[816],\n","        [893]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[993],\n","        [214]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[516],\n","        [228]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[366],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [279]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [827]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[672],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[984],\n","        [784]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[665],\n","        [384]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[200],\n","        [937]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[956],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[729],\n","        [197]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [850]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[180],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[723],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[483],\n","        [205]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[479],\n","        [265]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[707],\n","        [554]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [467]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [206]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[839],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[561],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[954],\n","        [666]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[655],\n","        [539]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[580],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[324],\n","        [528]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [514]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[467],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[287],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[362],\n","        [872]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[886],\n","        [482]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [742]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[931],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [624]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[358],\n","        [638]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [268]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[779],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[384],\n","        [808]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[379],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [819]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[373],\n","        [710]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[502],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[857],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [337]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[162],\n","        [331]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[518],\n","        [792]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[829],\n","        [584]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[548],\n","        [588]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[832],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [470]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [680]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[254],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[569],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[870],\n","        [248]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[360],\n","        [172]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[230],\n","        [257]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[217],\n","        [890]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[828],\n","        [383]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [732]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[692],\n","        [382]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [439]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[333],\n","        [691]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[749],\n","        [774]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[876],\n","        [283]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [367]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[202],\n","        [236]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [812]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[348],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [841]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [750]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [631]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[715],\n","        [543]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[742],\n","        [697]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [940]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [371]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[783],\n","        [370]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [683]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[700],\n","        [402]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [486]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [869]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[650],\n","        [310]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[350],\n","        [754]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [799]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[657],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [249]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[987],\n","        [301]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[224],\n","        [684]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[552],\n","        [359]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [341]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[255],\n","        [884]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |       \u001b[1mA girl once had a goose\u001b[0m in her head. She was too       |\n","|  been forced to eat it when she was 13, and now that she's   |   young to know how to speak, and she never knew what she    |\n","|                    21, the goose is gone.                    | would do if she were to die. She was so afraid of death that |\n","|                                                              | she went out into the world with her friends, seeking a way  |\n","| The goose was eaten by a girl who has never seen it before.  |                          out of it.                          |\n","|                                                              |                                                              |\n","| The story of the young woman's experience with eating an egg |  When I first met her, I was surprised at how beautiful and  |\n","|  is not new, but there are many stories about how children   |   sweet her face looked when you look at it now. Her eyes    |\n","|             have been forced to eat eggs at som              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |      \u001b[1mA girl once had a goose\u001b[0mbumps moment when she saw a      |\n","|             having it with a little bit of milk.             |  man standing next to her. She couldn't believe it, but she  |\n","|                                                              |      knew that he was not the man she had seen before.       |\n","| I'm so sorry. I'm not going to be able to feed you anything  |                                                              |\n","|                     like that, are you?                      | She turned around and saw him looking at her with wide eyes. |\n","|                                                              |  He was tall, muscular, and pretty in his thirties. He wore  |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |  glasses and white sneakers, which were obviously made for   |\n","|          don't know what else to do with this one.\"          |                    him by his parents. Th                    |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |\n","|  picture of herself on the cover of Playboy. She thought it  |        photo of her sister's father in the bathroom.         |\n","| was hilarious, but it wasn't until her husband asked her if  |                                                              |\n","|   she wanted to be photographed with him that she realized   | \"I thought, 'Oh my God, this is so amazing,'\" said Brittany. |\n","|                 what an amazing idea it was.                 |            \"And then I realized it was her dad.\"             |\n","|                                                              |                                                              |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  |  The girl says she got goosebumps from seeing the photo and  |\n","| Smith, who has been working as a photographer since 2009. \"  |   feeling happy about it. She's been looking for a way to    |\n","|                                                              |                 share the photos with others                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |      \u001b[1mA girl once had a goose\u001b[0m egg. She'd go to the store      |\n","|                   because she was so cute.                   | and buy a pack of them, then take them home with her. She'd  |\n","|                                                              |   also get some eggs for herself, which she could eat and    |\n","|  She had a secret life of her own, and she wanted to be the  |                   drink from her stomach.                    |\n","|                         best at it.                          |                                                              |\n","|                                                              | But when she got home from school, the little goose egg was  |\n","|   She knew that she would never be able to live up to her    |                gone—and now it was gone too.                 |\n","|                promise, but now that she did…                |                                                              |\n","|                                                              |  She had no idea what happened next, but after about three   |\n","|            \"So I'm going to go see you.\" (Sirius)            |                            weeks                             |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |\n","|                                                              |                                                              |\n","|             She was not the only one to have it.             |    She was on the receiving end of a pair of her favorite    |\n","|                                                              |                 cookies from a local bakery.                 |\n","| And now, as we enter the fourth quarter of the season, I've  |                                                              |\n","|  got to say that my favorite moment in football is when I'm  |  The girl, who didn't want to be named, thought she'd never  |\n","|  on the field and watching the Dallas Cowboys take on their  |  eat them again and decided to take the opportunity to make  |\n","|  best team in seven years. It's like a ghost town where you  |  some for herself. She made it with two pieces of chocolate  |\n","|       can't even get out of bed until your phone rings       | and three different kinds of cookie dough, but when she came |\n","|                                                              |                  home from work one day sh                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0mbumps-inducing story about       |\n","|                                                              |          how she was given a red eye by her father.          |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |                                                              |\n","|                going to go back and get it.\"                 |  She told the Daily Mail: 'I had been given a red eye by my  |\n","|                                                              |   dad and I was shocked. He said he thought it was just an   |\n","| She's still not sure how she got her goose egg, but the fact |   accident, but I said no, because it's my birthday and I    |\n","| that it was so good is what makes her so special. The two of |            don't want to go to school with him.'             |\n","| them have been friends for years, and when they first met in |                                                              |\n","|                        college, they                         |                      The mum of two now                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |\n","|                      trying to eat it.                       |                      trying to eat it.                       |\n","|                                                              |                                                              |\n","| The video below shows a young girl with goose on her tongue  | The video below shows a young girl with goosebumps standing  |\n","| licking the egg from a plastic bag. The girl then starts to  | on the edge of the pool. She's holding up her hand, and then |\n","| suck the egg off, but when she does so, it's not completely  |                 looking down at her stomach.                 |\n","|  swallowed by the shell of the egg. The goose is then taken  |                                                              |\n","|    out of its shell and put into an incubator for further    |  It's not clear if this is intentional or just an accident.  |\n","|                                                              | But we do know that this was an accident, so we're going to  |\n","|                                                              |                            assum                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0m egg on her face when she was     |\n","|                                                              | in the midst of a pregnancy. She didn't know what to do with |\n","|  It was a little bit of an odd situation, but one that had   |  it, but she was so excited that she took off her shoes and  |\n","|        the potential to be quite devastating for her.        |                       started running.                       |\n","|                                                              |                                                              |\n","|     The woman's father was in the middle of visiting his     |  The girl had been at the clinic for two weeks and was not   |\n","|  daughter and she couldn't help but wonder if he would take  |    allowed to walk or run because of a bad pregnancy. She    |\n","| it on himself. He didn't seem to care about her anymore, so  |  thought about going back to school, but couldn't find any   |\n","| he didn't want to do anything rash or embarrassing. The fac  |                        other options                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=700,\n","    act_name=10,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"u6a8K1C8ac9y","executionInfo":{"status":"ok","timestamp":1689623647755,"user_tz":-60,"elapsed":44718,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"8bf1cb44-4894-4a7b-f751-5e1bbedb58e4"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[489],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [612]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[736],\n","        [269]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [266]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[654],\n","        [733]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [599]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [461]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[568],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[295],\n","        [729]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [227]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[221],\n","        [925]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [983]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [374]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [817]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [319]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[565],\n","        [501]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[334],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[449],\n","        [242]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[344],\n","        [483]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [545]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[566],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[207],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[537],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[716],\n","        [661]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[939],\n","        [355]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[624],\n","        [566]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [300]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[999],\n","        [863]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[451],\n","        [855]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [744]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[336],\n","        [726]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [320]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[912],\n","        [448]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[591],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [564]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[383],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[233],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[850],\n","        [620]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[411],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[976],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[583],\n","        [594]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[421],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[646],\n","        [176]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [385]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[450],\n","        [502]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[304],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[960],\n","        [321]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[905],\n","        [901]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[487],\n","        [441]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[680],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [622]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [492]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[166],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[216],\n","        [340]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[236],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [349]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[538],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[517],\n","        [489]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[663],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[398],\n","        [765]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[480],\n","        [642]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[635],\n","        [417]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [606]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[719],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[495],\n","        [180]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[792],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [936]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[382],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[461],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [327]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [609]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[238],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[270],\n","        [431]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[452],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [490]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[206],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[321],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[816],\n","        [893]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[993],\n","        [214]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[516],\n","        [228]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[366],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [279]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [827]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[672],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[984],\n","        [784]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[665],\n","        [384]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[200],\n","        [937]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[956],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[729],\n","        [197]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [850]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[180],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[723],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[483],\n","        [205]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[479],\n","        [265]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[707],\n","        [554]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [467]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [206]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[839],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[561],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[954],\n","        [666]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[655],\n","        [539]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[580],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[324],\n","        [528]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [514]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[467],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[287],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[362],\n","        [872]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[886],\n","        [482]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [742]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[931],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [624]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[358],\n","        [638]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [268]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[779],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[384],\n","        [808]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[379],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [819]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[373],\n","        [710]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[502],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[857],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [337]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[162],\n","        [331]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[518],\n","        [792]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[829],\n","        [584]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[548],\n","        [588]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[832],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [470]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [680]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[254],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[569],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[870],\n","        [248]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[360],\n","        [172]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[230],\n","        [257]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[217],\n","        [890]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[828],\n","        [383]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [732]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[692],\n","        [382]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [439]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[333],\n","        [691]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[749],\n","        [774]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[876],\n","        [283]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [367]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[202],\n","        [236]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [812]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[348],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [841]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [750]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [631]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[715],\n","        [543]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[742],\n","        [697]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [940]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [371]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[783],\n","        [370]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [683]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[700],\n","        [402]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [486]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [869]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[650],\n","        [310]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[350],\n","        [754]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [799]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[657],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [249]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[987],\n","        [301]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[224],\n","        [684]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[552],\n","        [359]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [341]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[255],\n","        [884]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |       \u001b[1mA girl once had a goose\u001b[0m in her head. She was too       |\n","|  been forced to eat it when she was 13, and now that she's   |  young to know how to speak, and she never knew what it was  |\n","|                    21, the goose is gone.                    |                     like to be a child.                      |\n","|                                                              |                                                              |\n","| The goose was eaten by a girl who has never seen it before.  |    \"I'm sorry,\" she said, and turned around. \"I'm sorry.\"    |\n","|                                                              |                                                              |\n","| The story of the young woman's experience with eating an egg |  The man in the red coat looked at her and then back at her  |\n","|  is not new, but there are many stories about how children   |  with a look of relief that made her think twice about how   |\n","|             have been forced to eat eggs at som              |                  much he loved her so much                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |      \u001b[1mA girl once had a goose\u001b[0mbumps moment when she saw a      |\n","|             having it with a little bit of milk.             | man standing next to her. She knew he was not going to give  |\n","|                                                              |        her the space she needed, but it was worth it.        |\n","| I'm so sorry. I'm not going to be able to feed you anything  |                                                              |\n","|                     like that, are you?                      | She wanted to be in his presence and that's what this little |\n","|                                                              |   boy did. He stood up straight and took her by the hand,    |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |  giving her some of his favorite things like hot chocolate   |\n","|          don't know what else to do with this one.\"          |                          and beer.                           |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |                           He didn'                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |        \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she         |\n","|  picture of herself on the cover of Playboy. She thought it  | thought about how great her hair was. She didn't think much  |\n","| was hilarious, but it wasn't until her husband asked her if  |    of it until she heard a story about her own childhood     |\n","|   she wanted to be photographed with him that she realized   |  friend, who lived in an old house with his wife and three   |\n","|                 what an amazing idea it was.                 |                          children.                           |\n","|                                                              |                                                              |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  |  The girl's family knew the story well enough to know that   |\n","| Smith, who has been working as a photographer since 2009. \"  | the goosebumps were real. But what they didn't know was that |\n","|                                                              |                   this woman, now 29 years                   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |     \u001b[1mA girl once had a goose\u001b[0mbumps reaction when she saw a     |\n","|                   because she was so cute.                   |              \"scary\" image of her mom's photo.               |\n","|                                                              |                                                              |\n","|  She had a secret life of her own, and she wanted to be the  |           She said she felt like it was her mom's.           |\n","|                         best at it.                          |                                                              |\n","|                                                              |    \"I just wanted to say thank you, my mom,\" said Jessica    |\n","|   She knew that she would never be able to live up to her    | Miley, who is from Oklahoma City and lives in the Bronx. \"I  |\n","|                promise, but now that she did…                |           don't know if I can ever do that again.\"           |\n","|                                                              |                                                              |\n","|            \"So I'm going to go see you.\" (Sirius)            |                     The picture was tak                      |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |       \u001b[1mA girl once had a goose\u001b[0mbumps moment when she was       |\n","|                                                              |              told that her hair was too short.               |\n","|             She was not the only one to have it.             |                                                              |\n","|                                                              |  She thought it was because she had grown too big and could  |\n","| And now, as we enter the fourth quarter of the season, I've  |    not be seen in the world. But now, thanks to a clever     |\n","|  got to say that my favorite moment in football is when I'm  |        internet sleuth, the story has been confirmed!        |\n","|  on the field and watching the Dallas Cowboys take on their  |                                                              |\n","|  best team in seven years. It's like a ghost town where you  |     The 21-year-old woman from Northampton, Hampshire is     |\n","|       can't even get out of bed until your phone rings       | believed to have been given a special hair treatment by her  |\n","|                                                              |                         doctor after                         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0mbumps-inducing story about       |\n","|                                                              |                     her friend's death.                      |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |                                                              |\n","|                going to go back and get it.\"                 | She was so upset that she decided to write it down, but when |\n","|                                                              |   she saw the original poster for the movie, she said, \"I    |\n","| She's still not sure how she got her goose egg, but the fact |                thought it was pretty funny.\"                 |\n","| that it was so good is what makes her so special. The two of |                                                              |\n","| them have been friends for years, and when they first met in |  But now that it's been made public, and people are getting  |\n","|                        college, they                         |   more and more excited about this new feature from Disney   |\n","|                                                              |         Animation Studios (a subsidiary of Disney),          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |      \u001b[1mA girl once had a goose\u001b[0mbumps-inducing feeling when      |\n","|                      trying to eat it.                       | she was brought to the hospital. She was so excited that she |\n","|                                                              |       thought it would be fun to see her grandmother.        |\n","| The video below shows a young girl with goose on her tongue  |                                                              |\n","| licking the egg from a plastic bag. The girl then starts to  |  The girl who got her goosebumps-inducing experience at the  |\n","| suck the egg off, but when she does so, it's not completely  |  hospital is now recovering in a safe and secure condition.  |\n","|  swallowed by the shell of the egg. The goose is then taken  |  Her name is Nicole (Tara) McCarty, and this story has been  |\n","|    out of its shell and put into an incubator for further    |           updated with more information about her            |\n","|                                                              |                   condition.<|endoftext|>                    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0mbumps when she saw the world.     |\n","|                                                              |                                                              |\n","|  It was a little bit of an odd situation, but one that had   | A new research team has discovered that the first known case |\n","|        the potential to be quite devastating for her.        |    of hypothyroidism in women was due to a hormone called    |\n","|                                                              |         thyroxine, which is found in blood and hair.         |\n","|     The woman's father was in the middle of visiting his     |                                                              |\n","|  daughter and she couldn't help but wonder if he would take  |     The findings are published today (Aug. 11) in Nature     |\n","| it on himself. He didn't seem to care about her anymore, so  |     Neuroscience, a journal of the American Society for      |\n","| he didn't want to do anything rash or embarrassing. The fac  |    Microbiology. The study involved researchers from the     |\n","|                                                              |                          University                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=1200,\n","    act_name=10,\n","    prompt=short_goose_text,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"C7IgcV8hZ8Wa","executionInfo":{"status":"ok","timestamp":1689623927263,"user_tz":-60,"elapsed":44315,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"16616ec4-58eb-4091-806d-55b5bcbd8cf7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[489],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [612]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[736],\n","        [269]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [266]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[654],\n","        [733]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [599]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [461]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[568],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[295],\n","        [729]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [227]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[221],\n","        [925]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [983]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [374]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [817]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [319]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[565],\n","        [501]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[334],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[449],\n","        [242]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[344],\n","        [483]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [545]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[566],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[207],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[537],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[716],\n","        [661]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[939],\n","        [355]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[624],\n","        [566]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [300]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[999],\n","        [863]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[451],\n","        [855]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [744]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[336],\n","        [726]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [320]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[912],\n","        [448]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[591],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [564]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[383],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[233],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[850],\n","        [620]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[411],\n","        [401]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[976],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[583],\n","        [594]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[421],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[646],\n","        [176]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [385]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[450],\n","        [502]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[304],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [656]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[960],\n","        [321]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[905],\n","        [901]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[487],\n","        [441]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[680],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[427],\n","        [622]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [492]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[166],\n","        [634]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[216],\n","        [340]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[236],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [349]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[538],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[517],\n","        [489]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[663],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[398],\n","        [765]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[480],\n","        [642]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[635],\n","        [417]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [606]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[719],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[495],\n","        [180]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[792],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [936]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[382],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[461],\n","        [699]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [327]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [609]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[238],\n","        [308]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[270],\n","        [431]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[452],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[302],\n","        [490]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[206],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[321],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[816],\n","        [893]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[993],\n","        [214]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[516],\n","        [228]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[366],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [279]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[622],\n","        [827]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[672],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[984],\n","        [784]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[665],\n","        [384]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[200],\n","        [937]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[956],\n","        [785]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[729],\n","        [197]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [850]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[180],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[723],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[483],\n","        [205]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[479],\n","        [265]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[707],\n","        [554]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [467]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[818],\n","        [206]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[839],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[561],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[954],\n","        [666]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[655],\n","        [539]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[580],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[324],\n","        [528]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [514]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[467],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[287],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[362],\n","        [872]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[886],\n","        [482]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [742]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [237]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[931],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [624]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[358],\n","        [638]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[396],\n","        [654]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[794],\n","        [268]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[779],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[384],\n","        [808]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[379],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [819]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[373],\n","        [710]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[502],\n","        [230]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[857],\n","        [435]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [337]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[162],\n","        [331]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[518],\n","        [792]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[829],\n","        [584]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[548],\n","        [588]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[832],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[204],\n","        [470]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [680]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[254],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[569],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[870],\n","        [248]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[360],\n","        [172]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[230],\n","        [257]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[217],\n","        [890]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[828],\n","        [383]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [732]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[692],\n","        [382]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [439]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[333],\n","        [691]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[749],\n","        [774]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[876],\n","        [283]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[203],\n","        [367]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[202],\n","        [236]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [812]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[348],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[499],\n","        [841]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[318],\n","        [750]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [631]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[715],\n","        [543]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[742],\n","        [697]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [940]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[262],\n","        [371]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [783]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[783],\n","        [370]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[408],\n","        [683]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[700],\n","        [402]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [486]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [869]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[650],\n","        [310]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[350],\n","        [754]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[404],\n","        [799]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[657],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[796],\n","        [249]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[987],\n","        [301]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[835],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[224],\n","        [684]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[552],\n","        [359]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [341]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[255],\n","        [884]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |       \u001b[1mA girl once had a goose\u001b[0mbumps! (Credit: Netflix)        |\n","|  been forced to eat it when she was 13, and now that she's   |                                                              |\n","|                    21, the goose is gone.                    |  On Monday, we were lucky enough to be at the 2014 Sundance  |\n","|                                                              |   Film Festival in Los Angeles. The festival was hosted by   |\n","| The goose was eaten by a girl who has never seen it before.  |  Hulu Plus, which is a subscription service that allows you  |\n","|                                                              | to watch movies and TV shows on your smart phone or tablet.  |\n","| The story of the young woman's experience with eating an egg | The program is free and you can watch all of the best films  |\n","|  is not new, but there are many stories about how children   |           from around the world on Netflix for fr            |\n","|             have been forced to eat eggs at som              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |      \u001b[1mA girl once had a goose\u001b[0mbumpsome, which was a very       |\n","|             having it with a little bit of milk.             |                        nice surprise.                        |\n","|                                                              |                                                              |\n","| I'm so sorry. I'm not going to be able to feed you anything  |  The Goosebumpsome was the brainchild of one of my favorite  |\n","|                     like that, are you?                      |   students, and she has since been named her own! I am SO    |\n","|                                                              | excited to be doing this! I'm so excited to see what kind of |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |           fun she will have with this little boy!!           |\n","|          don't know what else to do with this one.\"          |                                                              |\n","|                                                              | Please go check out my Facebook page for more pictures from  |\n","|                           \"Oh, my                            |                           the firs                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |            \u001b[1mA girl once had a goose\u001b[0m-bumps hairdo.             |\n","|  picture of herself on the cover of Playboy. She thought it  |                                                              |\n","| was hilarious, but it wasn't until her husband asked her if  |   That's right, it's time to celebrate the arrival of her    |\n","|   she wanted to be photographed with him that she realized   | HAHHH! I've been hoarding this beautiful gift for years now  |\n","|                 what an amazing idea it was.                 |   and am finally ready to share it with you all. It is the   |\n","|                                                              |  ultimate fun HAHHH! I'm so excited about this gift and am   |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  | excited to be able to make a big difference in your life! I  |\n","| Smith, who has been working as a photographer since 2009. \"  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |       \u001b[1mA girl once had a goose\u001b[0mbumps moment when she was       |\n","|                   because she was so cute.                   |                     just a little girl.                      |\n","|                                                              |                                                              |\n","|  She had a secret life of her own, and she wanted to be the  |   \"Ohhh, it's OK!\" The blonde haired girl exclaimed as she   |\n","|                         best at it.                          |  watched the snowflake go down on her face. \"It's okay, I'm  |\n","|                                                              |                            fine.\"                            |\n","|   She knew that she would never be able to live up to her    |                                                              |\n","|                promise, but now that she did…                | The hulking brunette immediately jumped up and took off her  |\n","|                                                              |   white panties. She looked at the big fluffy bunny with a   |\n","|            \"So I'm going to go see you.\" (Sirius)            |                     huge grin on her fac                     |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 | \u001b[1mA girl once had a goose\u001b[0mbumps hairdo, and now she has a baby. |\n","|                                                              |                                                              |\n","|             She was not the only one to have it.             | This morning, the World Health Organization (WHO) released a |\n","|                                                              | report that said that more than 1 million children worldwide |\n","| And now, as we enter the fourth quarter of the season, I've  | have been exposed to Zika virus since the start of the year. |\n","|  got to say that my favorite moment in football is when I'm  | The WHO also said that more than 1 million people in Brazil  |\n","|  on the field and watching the Dallas Cowboys take on their  |           are infected with Zika virus each year.            |\n","|  best team in seven years. It's like a ghost town where you  |                                                              |\n","|       can't even get out of bed until your phone rings       |                \"The global burden of human-ca                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |       \u001b[1mA girl once had a goose\u001b[0mbumps-inducing \"hoo-ha!\"        |\n","|                                                              | moment when she realized that her hair was in fact not just  |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |        in the right place, but actually on top of it.        |\n","|                going to go back and get it.\"                 |                                                              |\n","|                                                              | And it's amazing how quickly people can get caught up in the |\n","| She's still not sure how she got her goose egg, but the fact |    excitement of being able to get a haircut without even    |\n","| that it was so good is what makes her so special. The two of |                        realizing it.                         |\n","| them have been friends for years, and when they first met in |                                                              |\n","|                        college, they                         |     Honey, you're awesome! You're going to be SO GOOD! A     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |      \u001b[1mA girl once had a goose\u001b[0mbumps-inducing feeling when      |\n","|                      trying to eat it.                       |         she was exposed to the blood of her friends.         |\n","|                                                              |                                                              |\n","| The video below shows a young girl with goose on her tongue  |    But after all that, she now has a goosebumps-inducing     |\n","| licking the egg from a plastic bag. The girl then starts to  |   feeling when she is exposed to the blood of her friends.   |\n","| suck the egg off, but when she does so, it's not completely  |                                                              |\n","|  swallowed by the shell of the egg. The goose is then taken  | The 34-year-old from Tipperary, New Zealand, has been taking |\n","|    out of its shell and put into an incubator for further    |   testosterone injections for two years and has no problem   |\n","|                                                              |                 getting it back. She said: \"                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0mbumps and wanted to get it.      |\n","|                                                              |                                                              |\n","|  It was a little bit of an odd situation, but one that had   | I was born in 1976, but I am still a little girl. I have an  |\n","|        the potential to be quite devastating for her.        |        AHHH and AHHHAAHHAAHHAAHHHHHHHHHHHHHHHHHHHHH!         |\n","|                                                              |                                                              |\n","|     The woman's father was in the middle of visiting his     |   And now, my life is about to change forever. My baby is    |\n","|  daughter and she couldn't help but wonder if he would take  |   about to be born with two very different hairdo's (short   |\n","| it on himself. He didn't seem to care about her anymore, so  |                          hair) and                           |\n","| he didn't want to do anything rash or embarrassing. The fac  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["## Shakespeare Stuff"],"metadata":{"id":"AE1CLBB8e2BP"}},{"cell_type":"code","source":["len(short_training_subset)"],"metadata":{"id":"v5OOwzYHgQAi","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689693019119,"user_tz":-60,"elapsed":19,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f6e10c81-45a1-4270-d8e2-97c68c1c603d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["394"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["# Specify the file path\n","file_path = 'shakespeare_200.json'\n","\n","# Open and read the JSON file\n","with open(file_path, 'r') as file:\n","  # Load the JSON data from the file\n","  shakespeare_subset = json.load(file)"],"metadata":{"id":"yRRiAibGgSt-"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["shakespeare_subset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ihy7fRYmgfXk","executionInfo":{"status":"ok","timestamp":1689692277575,"user_tz":-60,"elapsed":27,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"21602688-b406-48d7-b70f-c2fbfc322c45"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[\"Hark! Fair maidens and noble gentlemen, lend thine ears,\\nForsooth, I shall grace thee with lyrical verse this day.\\nWherefore dost thou seek love's gentle embrace,\\nWhen cupid's arrows pierce the deepest hollows of hearts?\\nOh, fortune's fickle hand that binds us not with loyalty,\\nBut mere illusion of affection, fraught with melancholy.\\nYet amidst this tempest of love's trials and tribulations,\\nTrue ardor shall prevail, steadfast in the face of adversity.\",\n"," \"Verily, fair maiden, thou art a sight to behold,\\nThine eyes, like twinkling stars, doth shimmer and shine.\\nThy lips, like rose petals, tempteth mine heart,\\nAnd thy voice, like sweetest melody, doth enchant mine ears.\\n\\nO, Cupid's arrow hast surely found its mark,\\nFor I am but a fool, smitten and undone.\\nPray, let us walk together, hand in hand,\\nIn this realm of love, where we both might dwell.\",\n"," \"Fair maiden with eyes like radiant stars,\\nThy beauty doth surpass the moon and mars.\\nThine grace and charm, a dance upon the breeze,\\nMaketh all the hearts around thee cease.\\nThy voice, melodious like the nightingale's song,\\nBinds me, a willing captive, forever strong.\\nOh, Cupid's arrow, strike me with thy might,\\nFor I am but a love-struck fool this night.\",\n"," \"Oh, fair moon, with thy pallor bright,\\nLike a maiden's sorrowful plight.\\nThou art a sight to tryst with joy,\\nYet hidden amidst darkness' ploy.\\nHow thy light dost dance upon the sea,\\nThy glow a beguiling symphony.\\nBut hark! E'en nature doth stand still,\\nFor beauty, like thine, forever will.\",\n"," \"Upon this fair and hallowed ground we tread,\\nWhere moonlight danceth on the river's bed,\\nThe stars above, like diamonds, brightly gleam,\\nAnd whispers of love do fill the midnight's theme.\\nForsooth, my dearest, let us seize this night,\\nAnd in their glow, our hearts entwined, take flight.\\nIn this enchanting hour, love's flame shall grow,\\nAnd Shakespeare's words shall grace our tale below.\",\n"," \"Fair maiden, dost thou not see the moon's pale light,\\nThat graciously adorns the sable night?\\nLike shimmering silk it spans the boundless sky,\\nA glowing orb that doth our hearts belie.\\nOh, mayhap 'tis a beacon, sent from above,\\nTo guide our souls to realms of endless love.\\nFor in thy presence, dear, I find respite,\\nAnd in thine eyes, the stars doth cease to shine bright.\",\n"," \"Hark, night hath spread its velv'ry cloak o'er this realm,\\nAnd yonder moon doth shimmer 'pon the sky.\\nThe stars, like specks of gold, doth brightly overwhelm,\\nWhile time's fair hand bids weary souls to fly.\\n\\nYet soft, methinks, a melancholy sigh doth break,\\nAs shadows dance, an eerie waltz, around.\\nForlorn hearts doth yearn, their sorrows to forsake,\\nTill morn's bright light, their solace shall be found.\",\n"," \"Fair maidens and valiant knights, lend me thine ears,\\nForsooth, a tale I shall unfold, in language of yore.\\nOf love's sweet torment, and heart's bitter tears,\\nAs time's swift chariot doth forevermore roar.\\nIn this mortal coil, we're but players on stage,\\nWhere fate weaves its tapestry with joy and with rage.\\nPray, let me enthrall thee, ere night's dark curtain descend,\\nAnd my words be carried hence, until time without end.\",\n"," \"Oh, dost thou see, fair friend, the twinkling stars?\\nThey grace the sky, like jewels so divine.\\nTheir light, it shines from distant realms afar,\\nAs if they dare to call this world their mine.\\nYet, mortal art can only marvel still,\\nAt Nature's hand, that we may never touch.\\nBut heaven's splendor, in our hearts, instill,\\nAs we gaze upon the stars we love so much.\",\n"," \"Fair it is to traverse yonder meadow wide,\\nWhere golden beams of morn do gently rise,\\nAnd larks aloft do carol with much pride,\\nTheir songs, a sweet salute in azure skies.\\nWith every step, the earth beneath doth dance,\\nAs softly, petals sway in sweet embrace,\\nThus nature's symphony, a grand romance,\\nInspires my soul to love's celestial grace.\",\n"," \"Shall I compare thee to a summer's day?\\nThou art more lovely and more temperate:\\nRough winds do shake the darling buds of May,\\nAnd summer's lease hath all too short a date:\\nSometime too hot the eye of heaven shines,\\nAnd often is his gold complexion dimmed;\\nAnd every fair from fair sometime declines,\\nBy chance, or nature's changing course, untrimmed.\",\n"," 'Oh, fair and radiant orb that doth adorn\\nThe velvety skies with thy golden light,\\nThy presence doth cast sweet enchantment born\\nOf tricks played by the fickle hand of night.\\nYet, thy glow dost shame the twinkling gems,\\nFor no jewel could outshine thy diadems.',\n"," \"Fair prince, doth thy heart not breathe a heavy sigh,\\nAs darkness gilds the sky, and stars anew arise?\\nForsooth, the moon retires, her radiant light no more,\\nAs night's black vesture cloaks the realm from shore to shore.\\nYet fear not, noble one, for dawn shall soon appear,\\nAnd banish shadows, bask in golden amber cheer.\\nThus, let thy weary soul find solace in the morn,\\nAs fate's embrace unfolds, and new adventures born.\",\n"," \"O fair maiden, whose beauty dost astound,\\nThy presence alone maketh my heart resound.\\nLike the moon's gentle glow upon the night,\\nThine eyes, like stars, dost render me delight.\\nTo touch thy hand, my soul doth surely yearn,\\nFor thou art the flame which my heart doth burn.\\nShall I compare thee to a summer's day?\\nNay, for thou art more lovely in every way.\",\n"," \"From yonder heavens doth shimmer forth the moon,\\nBathing mine weary visage in soft light.\\nAs stars, in silent glory, twinkle soon,\\nTis night's embrace that doth my soul excite.\\n\\nFor hark! The whispers of the midnight breeze,\\nDo serenade my heart in sweetest tune.\\nIn shadows cast by night, my spirit frees,\\nAnd in this moment, life feels opportune.\",\n"," \"Thine eyes, fair maiden, as twinkle stars above,\\nDoth bewitch mine heart with their tender gaze.\\nThy lips, as rose petals, tenderly moves,\\nAs gentle zephyrs through summer's hazy days.\\nOh, love's sweet torment, thou hast captured me!\\nA willing captive to thy charms I be.\\nPray, let our souls entwine, and love decree\",\n"," \"Hark! O' twilight's lament hath swept away the day,\\nAs golden rays do fade, and shadows take their stay.\\nThus doth vast nature crave the boon of balmy night,\\nWherein fair sprites and dreams doth dance in gossamer light.\\nBut lo! What dost thou bring, mine love, amidst this hour?\\nForsooth, thine eyes doth gleam, and light my heart aflare.\\nPray thee, my sweet, thy lips doth touch mine as we bind,\\nIn true love's grasp, two souls entwined, forever twined.\",\n"," \"O, fair maiden of grace, with eyes so bright,\\nThy beauty doth outshine the stars at night.\\nThy lips, like roses bathed in morning dew,\\nDoth tempt me to steal a kiss, just from you.\\nYet fate's cruel hand keeps us far apart,\\nLike star-crossed lovers, longing hearts now start.\\nBut fear not, fair maiden, for love finds a way,\\nTo unite souls entwined, come what may.\",\n"," \"Shall I compare thee to a summer's day?\\nThou art more lovely and more temperate.\\nRough winds do shake the darling buds of May,\\nAnd summer's lease hath all too short a date.\\nSometime too hot the eye of heaven shines,\\nAnd often is his gold complexion dimmed;\\nAnd every fair from fair sometime declines,\\nBy chance or nature's changing course untrimmed.\",\n"," \"To marvel and to ponder on mine own fate,\\nA tragic tale of love, entwined with hate.\\nFair Juliet, her Romeo did adore,\\nYet star-crossed lovers faced a dreadful war.\\nThrough ghastly feud, their love could not ignite,\\nFor tragedy befalls, in cruel spite,\\nSuch is the tale I pen, with sorrow and woe,\\nOf love's sweet bloom, too soon to wilt and go.\",\n"," \"O, fair Aurora! With thy golden beams\\nThou dost awaken nature from her blissful dreams.\\nThe sacred melodies of larks ascend the air,\\nAs daisies wake from slumber, beyond compare.\\nThe day's first kiss, upon the meadow's breast,\\nBrings forth a world in splendor, divinely blessed.\\nOh, how I long to bask in thy radiant light,\\nFor in thy presence, all darkness takes flight.\",\n"," \"Oh, bless'd beholder, cast thine gaze upon\\nThis ethereal mar'e, drenched in golden hue.\\nWhence fair Apollo's fiery orb doth dawn,\\nAnd yon skyward speckled arch welcomes view.\\nWith chirping melodies, all creatures bring,\\nA symphony of life, in joyful spring.\\nHow beauteous is this realm, thine eye doth see,\\nA fleeting moment in time's tapestry!\",\n"," 'Fair magpie, with feathers dark as night,\\nThy cunning beak, a thief of golden plight,\\nUpon the branch, thou perched in grace,\\nA thief of words, in my heart to embrace.\\nBut hark! Thy song, a melody divine,\\nDoth steal my breath, and make my heart incline,\\nTo listen more, thy minstrel skills entwine.',\n"," \"Hark! The fair moon doth cast her gentle glow,\\nAnd unto the night, her radiance doth bestow.\\nIn yonder woods, where sprites do dance with glee,\\nA tale of love and mischief, sweet as honeybees.\\nForsooth, a fair maiden and a gallant knight,\\nEntwined their hearts 'neath the pale moonlight.\\nThus, the play of fate unfolds, in eternal flight.\",\n"," \"Why, in this wretched world dost thou reside,\\nWhere vice o'errules and virtues are denied?\\nWhere love lies fraught with peril and despair,\\nAnd sorrow's touch leaves naught but deep despair?\\nYet still, thine eyes doth spark a gleaming light,\\nAnd in thy presence, all my worries take flight.\\nForsooth, thou art the spring to my winter's woe,\\nWith thee, I shall endure, and thus I'll grow.\",\n"," \"Hark! Lo and behold, fair gentlefolk, I beseech thee,\\nForsooth, to lend mine ear unto these humble words,\\nThat doth spring forth from this quill of mine hand.\\nLike dewdrops glisten upon yon verdant blade,\\nSo may thy hearts be swayed by mine entreaty.\\nThus, let us in unity raise our voices high,\\nAnd celebrate life's tapestry woven yon the sky.\",\n"," \"Fair is the morn, in golden beams it's dressed,\\nWhere blooms of crimson twine with dewdrops' crest.\\nLike choir of larks, the dawn's sweet song ascends,\\nAnd nature's hues, in radiant splendor blends.\\nYet bittersweet, a tempest lurks within,\\nFor love's uncertain path, I tread therein.\\nOh, fickle fate, shall love's fair spark ignite,\\nOr leave me lost forever, in endless night?\",\n"," 'Oh, fair moon, dost thou not see\\nThe travails of a soul, lost at sea?\\nSweet maiden, with hair as golden as the sun,\\nLike a nymph, thou hath my heart undone.\\nBut alas, in shadows we must now reside,\\nFor feuding clans our love doth deride.\\nYet, fear not, my love, for I shall fight,\\nAnd bring forth a dawn where our love takes flight.',\n"," \"Oh, fair maiden, thy beauty doth surpass\\nThe radiant glow of the sun's golden rays.\\nThine exquisite face, a masterpiece, alas!\\nTo gaze upon thy countenance brings me praise.\\nThy eyes, like twinkling stars, doth captivate,\\nAnd thy voice, sweet as melodies divine.\\nLet me be thine, for thou art my fate,\\nIn this world or the next, I shall be thine.\",\n"," \"Fair maiden, with thy visage bright as day,\\nThine enchanting eyes, like stars, doth sway.\\nThou art a gem amidst the daisies,\\nThy beauty transcends, sweet as the praises.\\nUnravel thy heart's desires, my dear,\\nFor thy love, I shall forever revere.\\nLet our souls entwine in blissful plight,\\nAnd bask in love's eternal light.\",\n"," \"Hark! Upon yon meadow fair, bright beams doth dance,\\nWhere tender flowers bask in Sol's warm embrace.\\nNow, ev'ning's whispers lull the weary souls,\\nAs twilight's cloak descends upon the earth.\\nIn this enchanting hour, secrets unfold,\\nAnd lovers' vows take flight on fervent winds.\\nThus, let us cherish, for time flies too swift,\\nAnd we, like fleeting shadows, soon shall fade.\",\n"," 'Fair morning doth arise, with golden glow,\\nAnd yonder doth the gentle breeze does blow,\\nUpon the meadow, bathed in dawn’s sweet light,\\nWhere wildflowers bloom and dance with pure delight.\\nThe lark ascends, its voice like music rings,\\nWhile all creation wakes, as nature sings.\\nOh, let us seize this day, with hearts ablaze,\\nAnd cherish every moment of our days.',\n"," \"When the fair moon doth shine upon the night,\\nAnd stars above like diamonds grace the sky,\\nI stand in silent awe of nature's might,\\nAnd yearn to understand its secrets high.\\nYet as I gaze, my heart grows full with mirth,\\nFor no mortal can fathom heaven's birth.\\nThus, I am but a humble soul lost in light,\\nAdmiring the creations of day and night.\",\n"," \"Henceforth in the darkest night, a tale unfolds,\\nWhere lovers roam entwined in passion's throw.\\nTheir hearts alight, aflame with love's delights,\\nThey dance upon the stage of starry lights.\\nBut fate, alas! a cruel mistress proves,\\nAnd through her whims, their bliss to chaos moves.\\nYet still they strive, their love's flame ever bright,\\nTo defy this world's relentless, harsh might.\",\n"," \"Oft have I seen the rays of golden sun,\\nEmbrace the earth with warm and loving touch,\\nWhen flowers bloom as seasons dance begun,\\nAnd nature's beauty, oh, it is too much.\\nBut when the day doth wither, fade away,\\nAnd shadows crawl, casting their dreadful might,\\nFear not, for dawn shall bring a brand-new day,\\nAnd banish darkness with the morning light.\",\n"," \"Fair maiden, with thy rosy cheeks aglow,\\nThou art a vision, a radiant light, I trow.\\nThine eyes, like stars, doth dazzle my sad soul,\\nThy presence is a balm that makes me whole.\\nNe'er have I seen a beauty so divine,\\nThou art a jewel, dear Lady, justly thine.\\nPray, grant me but a glance, a moment small,\\nFor in thy grace, I find my heart enthral.\",\n"," \"Oh fair horizon! Whence doth thy beauty lie?\\nMorn's dew-kissed petals, they doth sparkle bright,\\nAs Phoebus doth ascend the waning sky,\\nThy graceful visage bathed in golden light.\\nAlas, mine heart doth sing, thy splendor vast,\\nForsooth, I wish this moment e'er shall last.\",\n"," \"Why doth the sun in golden splendor rise,\\nTo cast his gracious light upon this earth,\\nAnd yet mine heart remaineth in disguise,\\nUnseen, untouched, a prisoner from birth.\\nOh, cruel fate, wherefore dost thou torment,\\nAnd keep me from mine love, mine heart's intent.\",\n"," \"Fair maiden, with locks of golden hue,\\nThine eyes like stars, twinkle bright and true.\\nThy lips, as roses, tempt with sweetest grace,\\nAnd in thy presence, time does slow its pace.\\nOh! How my heart doth beat with fervent might,\\nFor in thy presence, I find true delight.\\nLike Romeo, I'm lost in love's sweet maze,\\nWith thee, fair maiden, I'd gladly spend my days.\",\n"," \"By yonder brook, where lilies neatly dance,\\nFair maidens sway, entrancing in their stance.\\nThe golden sun, with rays as warm as fire,\\nDoes set ablaze my heart and soul's desire.\\nThus, I shall pen verses, rich in their hue,\\nTo thee, fair reader, my love shining through.\\nForsooth! In words doth love's fierce passion bloom,\\nA sonnet true, a testament to groom.\",\n"," \"Once fair Juliet did cast her gaze upon me,\\nHer tender eyes like stars in moonlit night,\\nA tempest stirred within my quivering soul,\\nFor her beauty did capture my heart's delight.\\nYet, alas, I am but a lowly servant,\\nAnd she, a rose blooming in noble's hand,\\nBut I shall love her silently, true and gallant,\\nAnd keep my secret hidden in loves dream's strand.\",\n"," \"Hark! On yonder meadow, fair and bright,\\nThe blooms of spring, of purest delight,\\nDoth grace the earth, in golden attire,\\nEmbracing nature's sweetest desire.\\nAlas, this tapestry, exquisite to the eye,\\nBears witness to beauty that ne'er shall die,\\nFor in these fleeting moments, life's breath,\\nShall etch this scene in memories till death.\",\n"," \"Thou art an enchanting aura, fair as moon,\\nWhich doth cast its gleaming light o'er my soul.\\nThine eyes, like stars, glisten with all thy charms,\\nAnd thy smile, a radiance, doth warm the heart.\\nMay I, in gentle words, thy presence keep,\\nFor thou art a rose amidst a bed of thorns.\\nTill time shall cease, my heart doth beat for thee,\\nIn every breath, I pledge my love to thee.\",\n"," \"Hark, fair moon that peeps through yonder night,\\nThy gentle rays doth kiss the earth's fair face.\\nThe stars, like diamonds, glisten in their might,\\nWhile darkness doth retreat with silent pace.\\nOh, wondrous realm where dreams and fancies blend,\\nWhere lovers sigh and poets' hearts transcend.\\nMay this enchantment last till morning's light,\\nAs thou, dear moon, dost twinkle in the night.\",\n"," \"In fair Verona, where our tale unfold,\\nTwo star-crossed lovers did their fates enfold,\\nA blooming romance, forbidden and unjust,\\nTragedy awaits for hearts they trust.\\nWith words as sweet as honeyed strands of gold,\\nTheir whispers echoed, secrets yet untold.\\nYet destiny's hand shall write their tragic plight,\\nA love so fierce, that ends in endless night.\",\n"," \"In twilight's embrace, I ponder on life's course,\\nWhere fate's unruly hand maketh no remorse.\\nThrough shadows cast, mine heart doth weep and stray,\\nAs tumultuous tides of uncertainty doth sway.\\nDoth not valorous knights face this fickle plight?\\nYet, my spirit yearneth for yonder realm's light.\\nTo tread a path unmarked, where dreams may alight,\\nAnd conquer the odds with fearless might.\",\n"," \"Shall I compare thee to a summer's morn?\\nThou art more fair and full of heavenly light.\\nMore radiant than the golden fields of corn,\\nThy beauty's grace doth ever shine so bright.\\nThine eyes, like stars, doth twinkle in the night,\\nAnd thy sweet voice doth charm the birds above.\\nThou art a sight that fills my heart with delight,\\nMy dearest love, in thee I find true love.\",\n"," \"In twilight's embrace, where shadows dance,\\nEvergreen meadows serenade my glance.\\nThus, sweet mistress moon doth wane and rise,\\nAs star-crossed lovers yearn 'neath velvet skies.\\nYet, 'tis the cruel hands of Time that prance,\\nAnd tether love's gossamer threads to chance.\\nSo, let us seize this fleeting moment's flame,\\nAnd etch our names in destiny's dark frame.\",\n"," 'Henceforth, my love, thy radiant beauty shines,\\nLike moonlit glow upon yon starry sky.\\nFor thou, fair maiden, dost my heart enshrine,\\nWith velvet touch that makes my spirit fly.\\nThine eyes, like gems, doth pierce my very soul,\\nAnd in thy presence, I am whole and strong.\\nSo let our love, dear Juliet, take its toll,\\nAnd let our hearts entwine, forever long.',\n"," 'O, gentle wind, dost sweep me off my feet,\\nWith every breath, thou caresseth my cheek,\\nThy whispers carry secrets from afar,\\nAnd hark! They sing sweet melodies of love.\\nThou art a messenger from realms divine,\\nThy touch doth warm the chambers of my soul,\\nFair zephyr, stay with me, forevermore.',\n"," \"To be or not to be, that is the question,\\nWhether 'tis nobler in the mind to suffer\\nThe slings and arrows of outrageous fortune,\\nOr to take arms against a sea of troubles\\nAnd by opposing end them. To die—to sleep,\\nNo more; and by a sleep to say we end\\nThe heart-ache and the thousand natural shocks\\nThat flesh is heir to. 'Tis a consummation\\nDevoutly to be wish'd. To die, to sleep\",\n"," 'Hither and thither, my heart doth wander so,\\nIn search of solace, wherefore do I go?\\nMorn doth break, the golden sun doth arise,\\nYet darkness doth linger behind mine eyes.\\nOft love, like a tempest, upheaveth my soul,\\nAlas! My thoughts, in turmoil, take their toll.\\nBut in thy presence, fair maiden so rare,\\nI findeth peace, and all my troubles repair.',\n"," \"When yon fair sun doth rise upon the earth,\\nAnd banisheth the shadows of the night,\\nDoth waken every creature from its berth,\\nTo revel in the morn's celestial light.\\nOh, how I long to bask in thy sweet grace,\\nAnd gaze upon thy countenance divine,\\nFor thou, my love, art beauty in this place,\\nAnd in thy presence, heaven's own light doth shine.\",\n"," 'Fair maiden, upon thine eyes, I gaze with fervor,\\nThy beauty, unmatched, doth cause my heart to stir.\\nLike a lark, thy voice, doth enchant with sweet measure,\\nAs thy words, like roses, bloom with utmost pleasure.\\nIn this realm of love, I pledge my troth untold,\\nForsooth, my love for thee, shall forever hold.\\nSo tarry not, fair lady, let our love unfold,\\nAs destiny, in harmony, shall we behold.',\n"," \"Shall I compare thee to a summer's day?\\nThou art more lovely and more temperate.\\nRough winds do shake the darling buds of May,\\nAnd summer's lease hath all too short a date.\\nSometime too hot the eye of heaven shines,\\nAnd often is his gold complexion dimmed;\\nAnd every fair from fair sometime declines,\\nBy chance, or nature's changing course, untrimmed.\",\n"," \"Hark! O gentle muse, in thy glory stand,\\nWith quill ablaze, guide my quiv'ring hand.\\nIn flow'rs of verse, let your words be dressed,\\nAnd with rhythmic grace, let my lines be blessed.\\nSet forth upon this paper, tangled and frail,\\nA tale of love, loss, heartache and travail.\\nForsooth! Let my pen unleash truths untold,\\nIn Shakespeare's style, my tale unfold.\",\n"," \"Hark, good folk, lend an ear to my humble verse,\\nWherein I shall recount a tale most perverse.\\nA love so fair, yet fraught with bitter strife,\\nWhence two noble hearts, entangled in life,\\nForsook all reason, and their worlds did collide,\\nIn passion's throes, where fate doth oft reside.\\nThus, I beseech thee, pray heed my plaintive plea,\\nAllow these words of mine to set thy spirit free.\",\n"," 'To thine own self be true, in heart and mind,\\nFor trust in one’s own words is hard to find.\\nThough storms may rage and winds may blow,\\nStay strong and firm in what you know.\\nThrough love and loss, and joy and pain,\\nPersevere, for in thy soul strength remains.\\nSo fret not, dear friend, and fear no strife,\\nEmbrace thy trials and embrace thy life.',\n"," \"To cross or not to cross, that is the question,\\nWhether 'tis nobler in the mind to suffer\\nThe tiresome troubles of the bustling streets,\\nOr take arms against this sea of busybodies,\\nAnd by opposing, end them. To jaywalk, to risk;\\nTo risk, perchance to avoid a tedious route—\\nAye, there's the rub, for in that risky stride\\nWhat lights may flash, what ticket may we find,\\nWhen we have crossed this path of man-made rules,\\nMust give us pause. There's the respect\\nThat makes calamity of so long a wait.\",\n"," 'Thou fair and radiant sun, doth bless the day,\\nWith golden rays that kiss the morning skies.\\nThe birds, they sing a joyful roundelay,\\nRejoicing in thine ever-present light.\\nYet, in my heart, a darkness doth reside,\\nFor thou art absent, and my soul doth pine.\\nBut patience, love, for soon thou shalt return,\\nAnd once again, our hearts shall intertwine.',\n"," 'By starry night, wherefore doth my heart reside?\\nIn shadows dark, mine eyes doth seek thy grace.\\nThine countenance doth make my soul abide,\\nYet naught but silence doth my love efface.\\nOh, thou fair muse, dost thou not hear thy name?\\nMy quill doth weep, thy verses go untamed.',\n"," 'Thou art the fairest flower in all the land,\\nWith thy gentle grace and golden strands.\\nThine eyes, like twinkling stars in yonder sky,\\nEnchant my soul and make my heart fly.\\nMy love for thee, an eternal flame,\\nShall burn with fervor, thy name I acclaim.\\nForsooth, our love shall endure, like the sun,\\nTill the moon doth rise, and our souls be one.',\n"," \"Fair maiden, with thy eyes a gentle bloom,\\nThou art a rose, thy beauty doth illume.\\nThy lips like cherries plump, sweet nectar's shrine,\\nI pine to taste them, touch of love's divine.\\nThy voice, a melody, doth entrance my soul,\\nOh, how I long to hold thee, to make thee whole.\\nPray, grant me but a moment, thy love I seek,\\nForsooth, together we shall conquer love's peak.\",\n"," \"When fair Aurora with her golden ray\\nDoth herald in the morn, with gentle grace,\\nI yearn to see thee, my heart's true stay,\\nAnd bask in the warmth of that loving face.\\nFor thou art my sun, my moon, my guiding star,\\nIn whose presence, my soul's wounds doth heal,\\nOh, sweet love, my joy, thou art never far,\\nIn dreams, in thoughts, thy love I eternally feel.\",\n"," \"O fair Aurora, thou dost wake the earth,\\nWith thy soft golden beams and gentle grace.\\nThe birds do sing, their melodies give birth,\\nTo joyous harmonies that fill this place.\\nBut, alas! My heart is still in anguish,\\nFor fair Rosalind hath left without trace.\\nThe tender love we shared, now lost, I languish,\\nPray, Cupid, heal the wounds of this love's race.\",\n"," 'In yonder meadow green, where flowers bloom,\\nA fair maiden, whose beauty dost consume,\\nHer eyes, like stars, doth radiant and gleam,\\nHer presence, sweet as moonlight’s tender beam.\\nOh, how my heart doth ache, for her I pine,\\nFor her love alone, my passion shall entwine.\\nPray, Cupid’s arrow, strike true, and make her mine!',\n"," \"Hark! The night casts her shadow o'er yonder land,\\nWhere fair maidens roam 'neath the moon's gentle hand.\\nIn whispers doth love's secret steal through the air,\\nIgniting the hearts consumed by its flare.\\nYet, beware! For Cupid's arrow knows no mercy,\\nAnd fools we'll become, as love's slave, unworthy.\\nLet our hearts align with stars that grace the sky,\\nFor in this tangled realm, true passion shall not die.\",\n"," \"Into the vast abyss of yonder night,\\nWhere moon doth glimmer with ethereal light,\\nThe stars attend as silent witnesses,\\nTo love's play, woven with sweet tenderness.\\nLike an ancient tale, whispered in the wind,\\nOur hearts entwined, no falsehood therein,\\nForsooth, this love, a timeless beauty, doth reign.\",\n"," \"O fairest maiden of mine heart's desire,\\nThine beauty doth surpass the morning sun,\\nThy voice enchanteth like a seraph's lyre,\\nWhenceupon my soul doth so sweetly run.\\nThy tender touch doth heal my wounded soul,\\nAs if by magic, thy love makes me whole.\",\n"," \"Fair maiden, with thine eyes so bright,\\nThy beauty doth illuminate the night.\\nThy voice, a melody so sweet,\\nThat e'er my heart doth skip a beat.\\nIn every step, thou dost grace the ground,\\nThy presence, like a queen, be crowned.\\nI beg thee, dear maiden, hear my plea,\\nIn thy presence, my soul finds glee.\",\n"," \"O fairest maiden, like a blooming rose,\\nThou art the epitome of grace and charm.\\nThine eyes, like twinkling stars in night's repose,\\nDoth set my heart aflame and cause no harm.\\nThy voice, a sweet melody that doth enchant,\\nResounds within my soul, a treasured art.\\nWith every word and gesture, you do grant\\nA love that pierces through my very heart.\",\n"," 'Fair maiden, with thy eyes like radiant stars,\\nThou art the jewel of this earthly realm.\\nA lustrous beauty dost thou possess,\\nThat rivals even Venus and her charm.\\nThy lips, full ripe, doth speak sweet melodies,\\nAnd in thy presence, my heart finds repose.\\nI am but a humble servant of love,\\nEnthralled by thy grace, my only muse.',\n"," \"Fair maidens and noble knights of this enchanted realm,\\nPray, lendeth thine ears unto my humble words,\\nForsooth, a tale of love and destiny I shall tell,\\nOf star-crossed lovers, entwined by fate's strong thread.\\nLike two orbs of the night, their souls doth yearn,\\nTo be united amidst the tempest of life's storm,\\nYet, alas! These tragic heroes, in death's embrace, must dwell,\\nFor their blissful love, hath ended, with this mournful knell.\",\n"," \"Hark! The early morn doth bring forth light,\\nWith golden rays that pierce through yonder trees.\\nFair birds do sing, with voices pure and bright,\\nTheir songs do float upon the gentle breeze.\\nThrough meadows green, where wildflowers do grow,\\nIn nature's arms, my soul finds sweet repose,\\nThus, doth this day, in joy and beauty, flow.\",\n"," \"Fair maiden, with eyes of brightest hue,\\nThy beauty doth my soul forever woo.\\nThou art a vision, a celestial grace,\\nWhose presence doth my eager heart embrace.\\nBut alas, my tongue betrays my love's plea,\\nFor words do fail to capture thy esprit.\\nThus, in thy gaze, I pray thou understand,\\nThe depth of love I hold within my hand.\",\n"," 'Fair is the moon that doth adorn the night,\\nAnd gleam amidst the sea of twinkling stars.\\nWith grace it casts its silvery hue so bright,\\nAnd paints the heavens with celestial art.\\nLike love, it glows and kindles hearts aflame,\\nEnchanting all who find themselves its prey.\\nOh, moon! In thy ethereal beauty claim,\\nAll earthly woes fade, as shadows in day.',\n"," \"Thou art the dawn, fair and resplendent,\\nWhose golden rays delighteth mine eyes.\\nThy countenance, a heavenly pigment,\\nBeams forth amidst the azure skies.\\n\\nThine voice, a melody, enchanteth mine ear,\\nResounding like sweet heavenly choir.\\nIn beauty's court, thou art the premier,\\nThy charm, all hearts doth inspire.\",\n"," 'Hearken to me, fair maiden of delicate grace,\\nThou art a vision of beauty that time cannot erase.\\nThy eyes, stars that twinkle in yon clear night,\\nDoth blind the moon and set the world aright.\\nThy lips, rose-red petals kissed by the sun,\\nSpeak sweet words that rival the songs of heaven.\\nThus, I beseech thee, tarry not, my dear,\\nFor in thy presence, I find the true meaning of cheer.',\n"," \"Oh, fairest morn, thy golden rays doth rise,\\nTo greet the world with warmth and gentle grace.\\nThine azure hues bedeck the boundless skies,\\nWhilst birdsong dances through this hallowed place.\\nThe scent of blossoms fill the fragrant air,\\nAs nature wakes from slumber's sweet embrace.\\nLet us rejoice, for day's bright tapestry,\\nDoth cast its spell upon this land so free.\",\n"," \"Fair winds do blow the ship upon the tide,\\nWhence forth the brave knights doth disembark,\\nA gallant quest awaits, no fear betide,\\nTheir swords and valour sharp as any spark.\\nThrough perilous trials and foes they tread,\\nWith hearts unyielding, nor by fear misled,\\nFor honor's crown, they strive till life be bled.\",\n"," \"Fair maiden, dost thou possess the heart of gold,\\nWith charms aplenty, like a tale foretold?\\nThy eyes doth shimmer like the starry skies,\\nThine lips doth beckon, beguiling to rise.\\nOh, love-struck hearts, entangled by thy grace,\\nBlooming passions stray, in this enchanting place.\\nSo, let love's fire ignite and never wane,\\nIn this sweet sonnet, bound by love's domain.\",\n"," \"Hark! Let me spineth mine verse in noble quill,\\nWhere words engage in graceful, rhythmic dance.\\nLike moon's fair glow on night's celestial hill,\\nMy muse doth weave a tapestry by chance.\\nForsooth, these words, like dainty blossoms bloom,\\nEthereal, they float upon the air.\\nThus, painting pictures in the reader's room,\\nWith Shakespearean flair, my tale I'll share.\",\n"," \"Hark! The moon doth cast her gentle glow,\\nAs night envelops this mortal realm below.\\nWhere fair maidens stroll o'er meadows green,\\nAnd lovers speak in whispers, rarely seen.\\nShadows dance with grace, 'neath starry sky,\\nWhere untold tales and secrets lie;\\nOft longing hearts find solace in the night,\\nFor in the darkness, love's true strength takes flight.\",\n"," \"Hark, fair maiden, thy visage shines as brightest star,\\nThine eyes doth speak of love's eternal flame.\\nIn thy presence, my heart doth beat afar,\\nAye, an enchantress, thee art by no name.\\nPerchance, in dreams, our souls become entwined,\\nLike birds of feather on love's gentle wind.\\nAlas, my love, by each word I do pray,\\nThat thou may embrace this love, come what may.\",\n"," \"Now hail, fair Moon, dost thou peer through yonder eve?\\nThy silvery beams, they caress my weary soul,\\nLost art thou amongst shimmering, starry weave,\\nThy radiant face doth a celestial role.\\nOh, thou enchantress, thou charmer of the night,\\nThy gentle light doth heal my heart's distress,\\nI beg, thy eternal beauty, be my sight,\\nFor thou doth bringeth tranquility, I confess.\",\n"," \"In fair Verona, whence love doth bloom,\\nA tale unfolds of star-crossed doom.\\nTwo households bear this bitter strife,\\nA feud that claims young lovers' life.\\nYet, love's sweet longing they defy,\\nWith passion fierce, their souls do fly.\\nBy poison's kiss, they shall embrace,\\nAnd thus, eternal sleep they chase.\",\n"," 'From fair Verona, where true love did dwell,\\nA tale of woe and flame I doth foretell.\\nTwo warring houses, both alike in pride,\\nTheir feud ignited, lives did not abide.\\nYoung Romeo, a heart with passion fraught,\\nCrossed paths with Juliet, which love hath sought.\\nIn the stars, their tragedy laid to rest,\\nFor love and hate, oft intertwine, abreast.',\n"," \"In fair Verona, where we lay our scene,\\nTwo households, both alike in dignity,\\nIn conflict, once more they intervene,\\nStar-crossed lovers' passion in hearts set free.\\nFor never was a story more immense,\\nThan that of Juliet and her Romeo,\\nWhose tragic tale doth wrench our souls immense.\",\n"," \"Oh forsooth, fair morn doth grace the sky,\\nWith golden hues and cloudlets passing by.\\nThe larks do sing in sweet and merry glee,\\nTheir melodies embracing nature's decree.\\nWherefore, the world awakes from slumber's rest,\\nUnfolding like a tale of life at its best.\\nIn this fair hour, let us seize the day,\\nAnd cherish each moment that comes our way.\",\n"," \"Fair Hamlet, thy words doth pierce my soul,\\nWith angst and turmoil, it hath taken its toll.\\nThy soliloquy, a melody in mine ear,\\nDoth reveal the depths of thy fear.\\nOh, melancholy prince, trapped in thine thoughts,\\nMay fate's cruel hand untie these tragic knots.\\nPray, find solace amidst this darkened abyss,\\nAnd let fortune, at last, grant thee bliss.\",\n"," \"What light upon yon window breaks tonight?\\nIt be Juliet, fair maiden of the Capulet,\\nWith lips as sweet as honey's gentle touch,\\nHer visage doth enrapture my very soul.\\nBut soft, I am torn by warring families,\\nFor I, a Montague, must hide my love away,\\nAnd in the cloak of darkness, steal a kiss,\\nTo quench the burning ache that love betrays.\",\n"," \"Hark! The crimson sunset paints the skies with gold,\\nAs fair Aurora wakes with gentle grace.\\nThe chirping birds, their melodies unfold,\\nAnd draped in emerald robes the meadows trace.\\nThe perfumed breeze, with whispers soft and kind,\\nCaresses every leaf and humble bloom.\\nIn nature's realm, serenity we find,\\nAs life awakes from night, dispelling gloom.\",\n"," \"Oh, fairest moon, thy radiant light doth shine,\\nAnd cast a silver glow upon this eve.\\nThy gentle beams doth quell the dark design,\\nAnd maketh shadows dance as we believe.\\nYet, I, a lowly poet, dare proclaim,\\nThat thou art but a mirror of thy kin.\\nFor love's true light, thy visage doth exclaim,\\nIs found within the eyes of my fair Gwen.\",\n"," \"Thine heart, fair maiden, captivates mine own,\\nLike radiant sunbeams on a summer's day.\\nThy gentle voice, a sweet celestial tone,\\nDoth steal my breath and chase my cares away.\\nThus I beseech thee, let love's ember glow,\\nAnd bind our souls with fateful strands of fate,\\nForsooth, in thee, fair maid, my love doth grow.\",\n"," \"Fair thou not, maiden of ethereal grace,\\nWhence doth thy beauty, like a rose, bloom so?\\nThy countenance, perfect in every trace,\\nDoth captivate me with its radiant glow.\\nMethinks thy visage could rival the sun,\\nAnd thy voice, sweeter than the nightingale's song,\\nDoth stir my heart, to love thee, my dearest one.\",\n"," 'O fair moon, why dost thou not shine so bright,\\nAs thy beams once did, in thy golden glow?\\nHath the blackest night brought upon the light,\\nThat doth now cast a sombre hue below?\\nThou art but a pale and feeble orb,\\nAnd with each passing eve, thy radiance snubbed.\\nYet I beseech thee, dear moon, rise and absorb,\\nThe darkness that in this world has clubbed.',\n"," 'O, fair maiden, thou art the fairest flower,\\nWhose beauty doth outshine the golden sun.\\nThine eyes, like stars, doth twinkle and bewitch,\\nAnd thy lips, like roses, beg for a kiss.\\nBut alas, a mere mortal am I, unworthy,\\nTo taste the sweetness of thy precious love.\\nThus, I shall write sonnets and sing of thee,\\nTill my last breath, in thy memory shall be.',\n"," \"In fair Verona where love's flame did start,\\nTwo households, both alike in dignity,\\nA pair of star-crossed lovers stole my heart,\\nWhose tragic tale still fills my tragedy.\\nForsooth, their young hearts met in secret sight,\\nWith sweetest words, they vowed to never part,\\nYet fate's cruel hand did bring forth their sad plight.\",\n"," 'How sweet the moon doth light the starry sky,\\nAs fair Titania dances, wings unfurled,\\nHer sprite companions whispering as they fly,\\nIn this enchanted world of moonlit swirl.\\nFor fair Miranda, beauty doth compel,\\nTo dream of love, in serenade of spell.',\n"," 'Fair maiden, with thy visage so serene,\\nThou art a beauty my heart desires keen.\\nThine eyes, like stars that twinkle in the night\\nDoth captivate me with their wondrous light.\\nThy voice, melodic as a nightingale’s song,\\nDoth enchant my ears and right my wrong.\\nOh, fairest maiden, pray grant me thy love true,\\nFor in thy presence, all my dreams come true.',\n"," \"Hark! 'Tis the morn, wherefore cometh the golden sun,\\nWhose radiant beams enkindleth the earth anew.\\nWith gentle zephyrs, doth sweetly whisper the air,\\nAs birds of yonder flock, their sweetest tunes to share.\\nThrough verily woods, adorned in verdant hue,\\nThe tender blossoms beguileth the weary eye.\\nAnd thus, fair nature's tapestry unfold,\\nWhilst life's grand tale, by Time's hand, art told.\",\n"," \"Gentle winds doth whisper in mine ear,\\nOf love so sweet, God's gift, so clear.\\nOh fair maiden, fairer than the morn,\\nThine beauty doth leave my heart torn.\\nShall I compare thee to a summer's day?\\nNay, thou art far more radiant, I say!\\nFor in thy eyes, love's fire doth burn,\\nBy thy side, this wretched heart shall yearn.\",\n"," 'Fair thee well, mine gentle soul,\\nTo friend or foe I bear no grudge,\\nThe wind doth blow, thy face so cold,\\nYet, in my heart, a fiery smudge.\\n\\nThy love, a tale of woe and pain,\\nShall linger long, like summer rain.',\n"," 'Fair maiden, thou art the beacon of my heart,\\nThy beauty doth outshine the morning sky.\\nThy voice, a melody that plays its part,\\nDoth make my soul to soar and spirits fly.\\nI yearn, I burn, to hold thee near and dear,\\nAnd pledge my love, eternally sincere.\\nFor thou art all I long for, my sweet dear.',\n"," \"From yonder heavens, emerges radiant light,\\nAs Luna's grace unveils velvet skies.\\nAblaze are stars, that twinkle through night,\\nTheir cosmic dance a spectacle to my eyes.\\nYet their celestial glow pales next to thee,\\nWhose beauty fair outshines all majesty.\\nOh, thou art a masterpiece, divinely bred,\\nA sight that leaves me forever lovesick and wed.\",\n"," \"Thou art the gentlest breeze upon my face,\\nThy love doth conquer all that time doth chase.\\nThy beauty shines, fairer than the brightest sun,\\nAnd in thy presence, all my sorrows run.\\nThine eyes, the stars, do guide me through life's maze,\\nThou art the solace in my darkest days.\\nIn thy sweet embrace, my heart finds great peace,\\nFor thou art my love, and in thee, my release.\",\n"," \"Shall I compare thee to a summer's day?\\nThou art more lovely and more temperate.\\nRough winds do shake the darling buds of May,\\nAnd summer's lease hath all too short a date.\\nSometime too hot the eye of heaven shines,\\nAnd often is his gold complexion dimmed;\\nBut thy eternal summer shall not fade,\\nNor lose possession of that fair thou ow'st.\",\n"," \"Hark! Thy heart, entangled in amorous strands,\\nDoth dance amidst the moonlit meadows fair.\\nLike star-crossed beings, lost in fate's demands,\\nOur souls entwined, beyond all mortal care.\\nThine eyes, two orbs of heavens' brightest glow,\\nDoth pierce my soul, as Cupid bends his bow.\\nPray, let this sonnet seal our love's decree,\\nForsooth, my love, thou art my destiny.\",\n"," \"O fair moon, who dost light the darkest night,\\nThy radiant glow doth pierce the blackened sky,\\nThine gentle beams bring solace to my sight,\\nEnshrouded in the cloak of love, I sigh.\\nYet, yon moonlit path doth lead me astray,\\nTo wander midst the forest's tangled maze,\\nWhere shadows dance and secrets oft betray,\\nA heart entangled in a lover's haze.\",\n"," \"In fair Verona, where lovers dost dwell,\\nA tale unfoldeth, fraught with strife and hell.\\nTwo households, both alike in dignity,\\nWhose ancient grudge spurreth this enmity.\\nA pair of star-crossed lovers, ye see,\\nEntangled in a love so fierce and free.\\nWith tragic ends their love shalt unfold,\\nAs Shakespeare's quill unwaveringly told.\",\n"," \"Fair thee well, O gentle muse of mine heart,\\nLike summer's breeze doth thou sweetly impart,\\nThy words imbued with passion's ardor deep,\\nAs roses bloom, thy verses gently sweep.\\nOh, how the quill dances upon the page,\\nCrafting tales of love and battles of age,\\nThine artistry, a tapestry adorned,\\nOn Shakespeare's stage, forever reborn.\",\n"," \"Oh, thou fair maiden, whose beauty doth compare,\\nTo blossoms sweet, that in the morn doth dare,\\nThy radiant eyes, like stars, doth firmly shine,\\nAnd doth embrace this heart, which now is thine.\\nThy lips, like roses, tempt with tender kiss,\\nThat doth ensnare my soul, in blissful abyss.\\nOh, let our love, like Shakespeare's tales of yore,\\nUnfurl and thrive, forevermore.\",\n"," \"Hark! The midnight hour approaches near,\\nWhen moonlight's kiss doth grace mine weary sight.\\nIn shadows cast, fair passions doth appear,\\nLike whispers soft that dance across the night.\\nO wilt thou, sweet beloved, grace my hearth,\\nAnd fill my soul with love's eternal mirth?\",\n"," \"Thou art a fair maiden, bathed in moonlight's hue,\\nWith eyes that rival stars and heart that's true.\\nThy voice, a sonnet sweet, doth charm my weary soul,\\nThy touch, a feather's graze, doth make me whole.\\nForsooth, thou art mine muse, my life's requite,\\nIn this world of shadows, thou art my guiding light.\",\n"," \"Fair maiden, with a visage that rivals the dawn,\\nThine eyes doth sparkle with celestial light.\\nThy voice, enchanting, sweeter than the morn,\\nDoth silence birds, as they take flight.\\nThou art a portrait painted by angels' hand,\\nA tapestry of beauty, too divine to understand.\\nIn thy presence, my heart doth firmly stand.\",\n"," \"O thou fair maiden, with eyes of starlight bright,\\nThy beauty doth my very soul ignite.\\nThy gentle touch, a balm upon my heart,\\nNo words can express how thou art a work of art.\\nIn the darkest night, 'tis thy love I seek,\\nFor thou art the flame that doth make me weak.\\nHenceforth, my dearest love, my heart shall be thine,\\nForever bound, like intertwining vine.\",\n"," \"Hark! The moon doth cast its silvery glow,\\nUpon these fair fields, where lovers doth go.\\n‘Tis fairy hour, when mischief shall arise,\\nAs Puck dances 'neath the starlit skies.\\nYet ‘pon yon hill, doth sorrow bear its weight,\\nFor love forsaken, a maiden’s cruel fate.\\nThus, rapturous joys and melancholy woe,\\nEntwined together, as life’s sweet fruits grow.\",\n"," \"When moon is high above in gentle night,\\nAnd stars their twinkling light begin to show,\\nFair Juliet doth shine, her beauty bright,\\nAs roses in the morning dew doth grow.\\nBut soft! What light on yonder window breaks?\\n'Tis Romeo's love, his soul for Juliet's sake.\",\n"," \"Thine heart, a beacon shining through the night,\\nDoth pierce the darkness with love's tender light.\\nLike golden sun, doth warm the coldest day,\\nAnd chase away the shadows of dismay.\\nIn thy sweet presence, bliss doth ever dwell,\\nAs thy enchanting words my soul does quell.\\nOh, let me bask in love's eternal flame,\\nAnd with thee, forever, join love's noble game.\",\n"," \"To be or not to be, that is the question,\\nWhether 'tis nobler in the mind to suffer\\nThe slings and arrows of outrageous fortune,\\nOr to take arms against a sea of troubles\\nAnd by opposing end them. To die—to sleep,\\nNo more; and by a sleep to say we end\\nThe heart-ache and the thousand natural shocks\\nThat flesh is heir to: 'tis a consummation\\nDevoutly to be wish'd. To die, to sleep;\\nTo sleep, perchance to dream—ay, there's the rub:\\nFor in that sleep of death what dreams may come,\\nWhen we have shuffled off this mortal coil,\\nMust give us pause—there's the respect\\nThat makes calamity of so long life.\",\n"," \"Shall I compare thee to a summer's day?\\nThou art more lovely and more temperate:\\nRough winds do shake the darling buds of May,\\nAnd summer's lease hath all too short a date:\\nSometime too hot the eye of heaven shines,\\nAnd often is his gold complexion dimmed;\\nAnd every fair from fair sometime declines,\\nBy chance, or nature's changing course, untrimmed.\",\n"," \"O fair maiden, with thy radiant grace,\\nThine eyes dost shine like stars in darkest nights.\\nThy lips, as ruby gems, invite my gaze,\\nAnd in their sweet embrace, my heart takes flight.\\nThy voice, a melody that charms the soul,\\nDoth stir in me a love that shall ne'er wane.\\nFor thou, my love, art fairer than the whole,\\nAnd in thy presence, eternal bliss I gain.\",\n"," \"To be or not to be, that is the question,\\nWhether 'tis nobler in the mind to suffer\\nThe slings and arrows of outrageous fortune,\\nOr to take arms against a sea of troubles,\\nAnd by opposing end them? To die: to sleep;\\nNo more; and by a sleep to say we end\\nThe heart-ache and the thousand natural shocks\\nThat flesh is heir to. 'Tis a consummation\\nDevoutly to be wish'd.\",\n"," \"Fair maiden, dost thou know the innermost thoughts,\\nThat e'er linger within this humble heart?\\nFor in thy eyes, I find true beauty sought,\\nA gentle glow, that sets my soul apart.\\nPray, grace me with thy sweet and tender words,\\nThat I may bask in love's eternal flame.\\nIf thou wilt grant me this, I shall be spurred,\\nTo take this chance and cheer thy glorious name.\",\n"," 'How sweet the moonlight gleams upon yon tree!\\nThe gentle breeze doth whisper through the leaves,\\nAs lovers steal away in shadows deep.\\nThe night, a cloak of velvet darkness weaves\\nIts spell upon this fair and silent scene,\\nWhile stars, like diamonds, sparkle in the sky.\\nOh, sweetest night, thy beauty is serene!',\n"," \"When night doth cloak the waning world in shade,\\nAnd gentle zephyrs stir the leaves with grace,\\nFair Luna's beams through yonder sky cascade,\\nAnd stars adorn the heavens' lofty space.\\n'Tis in this hour, my heart finds solace rare,\\nFor in her eyes, I see love's light so fair.\",\n"," 'O, thou fair sun, arise and shine thy face,\\nBring forth the golden rays to light this place.\\nThou art the beacon of celestial fire,\\nWhose warmth doth fill my soul with sweet desire.\\nIn thy fair glow, all darkness shall be gone,\\nAnd I shall bask in joy till night is done.\\nHence, rise, fair sun, and grace this world with glee,\\nFor in thy light, true happiness I see.',\n"," \"Hark, thy gentle ears, lendeth me thy time, \\nAs I taketh upon this quill to instil;\\nShall I compare thy beauty to the divine,\\nWhere doth thy radiance cease, or shall it still?\\nForsooth, the fairest flower in nature's hand,\\nThou art, sweet creature, mine heart's demand.\",\n"," \"To be or not to be, that is the question,\\nWhether 'tis nobler in the mind to suffer\\nThe slings and arrows of outrageous fortune,\\nOr to take arms against a sea of troubles,\\nAnd by opposing end them. To die—to sleep,\\nNo more; and by a sleep to say we end\\nThe heart-ache and the thousand natural shocks\\nThat flesh is heir to: 'tis a consummation\\nDevoutly to be wish'd.\",\n"," \"O fair maiden, with thy golden locks so bright,\\nThine eyes, like stars, doth pierce through darkest night.\\nThy lips, like rose petals, sweetly do enflame,\\nMy heart, with love's fire, cannot thee tame.\\nPray tell, my dear, wilt thou be mine forever?\\nFor without thee, my soul canst not gather.\\nBut if thou dost refuse, alas, I shall be lost,\\nA wanderer, doomed to bear love's heavy cost.\",\n"," \"In fair Verona, where love's essence gleams,\\nTwo star-crossed souls awake from fragile dreams.\\nA tale of hatred, of feuds so profound,\\nOur young, yet foolish hearts soon shall astound.\\nFor love once whispered, now sparks a raging fire,\\nWhere loyalty crumbles and trust expires.\\nIn this tragic world, where destiny conspires.\",\n"," \"So fair and glorious is a summer's day,\\nWhen golden sun doth warm the earth's embrace.\\nLovely roses and daisies bloom in May,\\nAs zephyrs whisper their gentle embrace.\\n\\nBut lo, doth autumn come with swift advance,\\nTurning leaves to rust, sky to moody grey.\\nYet in this change, there's still a tender dance,\\nThat Shakespearean beauty can't disarray.\",\n"," \"When moon doth rise, fair stars their light bestow,\\nAnd darkness fades as morning sun doth show.\\nIn yonder meadow, where Aphrodite dwells,\\nTwo souls entwined, a tale of love foretells.\\nTheir hearts, aflame, doth dance to Cupid's tune,\\nYet obstacles arise, like shadows loom.\\nYet lingering hope, like daisies in the field,\\nShall guide their path, true love's ultimate yield.\",\n"," \"Shall I compare thee to a summer's day?\\nThou art more lovely and more temperate.\\nRough winds do shake the darling buds of May,\\nAnd summer's lease hath all too short a date.\\nSometime too hot the eye of heaven shines,\\nAnd often is his gold complexion dimmed;\\nAnd every fair from fair sometime declines,\\nBy chance or nature's changing course untrimmed.\",\n"," \"Fair weather graces yonder sky so bright,\\nWhere doth Apollo's golden chariot glide.\\nMine heart doth soar, like eagle's noble flight,\\nWhen gazing upon fair nature's lovely tide.\\nO sweet love's song doth whisper in mine ear,\\nThy beauty doth surpass all earthly cheer.\\nForever shall thy grace in my heart reside.\",\n"," 'Oh, what a wretched soul am I, forlorn,\\nLost amid a sea of sorrow so deep,\\nLike a ship without a compass I mourn,\\nThe winds of fate have left me alone, weep.\\nMy heart, once filled with joy, now void and cold,\\nThou art the cure, fair solace, yet withhold.',\n"," \"If fair thee ever see thy love's bright eyes,\\nYet like the moon, their light dost wane and pry,\\nThen let thy heart sing forth in sonnet's guise,\\nThy love's beauty shall live till time doth try.\\nIn gentle whispers, let thy words be heard,\\nFor love's evanescent touch is but profound,\\nWith every verse, like feathers of a bird,\\nThy love's portrait shall ne'er fade nor rebound.\",\n"," 'Oh, wondrous night, wherefore dost thy darkness etch\\nA shadow over mine heart, robbing it bliss?\\nThine absence, cruel star, doth leave me a wretch,\\nYearning for her fair visage, thy light I miss.\\nYet, in my dreams, her beauty doth still shine,\\nAnd I, a lovesick fool, beg for her grace,\\nThat I may hold her hand and call her mine.',\n"," 'Hark! In yonder meadow, where lilies bloom,\\nA maiden fair, with tresses golden-hued,\\nDoth wander, like a flower amidst the gloom,\\nHer beauty doth the very earth exude.\\n\\nWith words so sweet, her mouth doth grace the air,\\nLike honeyed nectar, flowing soft and rare.\\nO, how this sight doth my weary heart ensnare!',\n"," \"Fair is the morn that wakes the heavens' eyes,\\nAnd fair is the sun that paints the azure skies,\\nFor in this time, with surging hope so bright,\\nOur souls alight, like stars in darkest night.\\nYet fate's cruel whim doth twist our fortune's thread,\\nAnd, ere we e'er shall know, our hearts lie dead.\\nBut still we strive, to chase love's sweet desire,\\nTo burn like fire, and sing with passion's lyre.\",\n"," \"From fair Aurora hath the sun emerged,\\nHis golden beams now dance upon the land.\\nThrough verdant meadows hath the breeze converged,\\nCaressing flowers with its gentle hand.\\nThe birds, in harmony, their songs recite,\\nAs nature wakes from slumber in delight.\\nOh, quill, thy ink I dip, to capture dawn,\\nAnd sing of its sweet beauty till it's gone.\",\n"," \"Oh, fair maidens, dost thou hear my woeful plight?\\nForsooth, my heart doth sorrow in its depth,\\nFor love unrequited brings me great strife,\\nA yearning that doth leave me lost and bereft.\\nNo solace find I in the moon's calm light,\\nNor in the stars that grace yon silent night.\\nPray tell, when shall my weary heart find rest?\\nOr should I dwell forever in this lament?\",\n"," \"Thine heart doth bear such torment, gentle soul,\\nAs Cupid's arrow swiftly found its mark,\\nAn arrow so sure, it made thee whole,\\nYet it hath done naught but torn thee apart,\\nThou art but a puppet in his cruel game,\\nLove's bitter-sweet jest, a soul in flame.\",\n"," \"Thy visage, fair and flawlessly composed,\\nDoth shine like golden rays at dawn's first light.\\nThine eyes, bright stars in night's celestial abode,\\nDoth pierce mine soul, a noble knight's delight.\\nThou art a rare and tender blossom, sweet,\\nWhose fragrance doth entrance all senses true.\\nPray, let our love beget a joy complete,\\nAnd bind our hearts as one, forever true.\",\n"," \"Once upon a time, in fair Verona's domain,\\nA tale of star-crossed lovers doth remain.\\nHark! Doth thou heareth the tragic tale unfold,\\nWhere families feuding, hath love controlled?\\nA pauper named Romeo, his heart ablaze,\\nWith Juliet, a fair maiden, in a love-filled haze.\\nOh, cruel fate, thou hast weaved this tale so,\\nWhere love's sweetness doth bitter end bestow.\",\n"," \"Hark! The sun doth wake, its rays doth pierce the sky,\\nIn golden splendor, morning doth draw nigh.\\nFair nature's palette, painted with vivacity,\\nDoth bringeth joy to mine own eyes, with felicity.\\nLet not thy worries cloud thy gentle heart,\\nFor in this morn, love's sweet embrace may start.\\nRejoice, dear souls, for life's grand tapestry unfolds,\\nWhilst Shakespeare's words, like sonnets, truth beholds.\",\n"," \"Thy visage fair, like fair Aurora's kiss,\\nDoth draw mine eyes, like bees to blooming flowers.\\nThine eyes, two radiant stars, their light doth bliss,\\nWith cupid's bow, unfailing love empowers.\\nThy voice, melodious as the nightingale,\\nDoth soothe my soul in thy enchanting tale.\\nThus, in thy presence, my heart doth rejoice,\\nFor thou art my true love, my dearest choice.\",\n"," \"From yonder thicket, sprung sweet dawn's first ray,\\nBathing the land in hues of gold and gray.\\nBehold, fair nature waking from her sleep,\\nAs vibrant blossoms 'pon her bosom creep.\\nThe gentle breeze whispers secrets untold,\\nAs lovers pledge love that shall ne'er grow old.\\nThus, morn unfolds in splendor and delight,\\nIn Shakespeare's verse, a world forever bright.\",\n"," \"Fair thee well, dear Sir, with sorrow I part,\\nWhence my heart doth ache, and tears do start.\\nThy countenance so fair, like a rose in spring,\\nDoth bring delight and make my soul sing.\\nBut alas, fate hath cruelly intervened,\\nAnd our paths must part, this love, unseen.\\nYet I shall hold thee, deep within my heart's core,\\nUntil once again, fate brings us to adore.\",\n"," \"Hark! Upon yon verdant meadow fair,\\nWhere dewdrops kiss the morning air,\\nThe gentle lark doth chant with glee,\\nO, how his melody enchants me!\\n\\nFair maidens dance with grace, to and fro,\\nWhilst dainty flowers in colors grow,\\nIn this world of beauty, love's sweet art,\\nEternal as the beating of my heart.\",\n"," \"In fair Verona, where two lovers dwell,\\nTheir fates entwined, a story I must tell.\\nTrue love's sweet whispers taint the starry night,\\nYet bitter feud and warring houses smite.\\nWith tender words, their passions they declare,\\nBut tragedy and sorrow they must bear.\\nFor love, as oft it does, brings joy and woe,\\nThus waxes this tale of love that may not flow.\",\n"," \"Hark! 'Tis but a fleeting summer's eve,\\nWhere golden rays dance upon yonder sea,\\nAnd o'er field and meadow, gentle winds doth breathe,\\nBeseeching nature to whisper her decree.\\nA tapestry of stars now adorn the night,\\nWhile moonlight draws lovers in tender plight.\\nThus, in this verse, I dare joyfully sing,\\nOf wondrous beauty that only love doth bring.\",\n"," \"Shall I compare thee to a summer's day?\\nThou art more lovely and more temperate.\\nRough winds do shake the darling buds of May,\\nAnd summer's lease hath all too short a date.\\nSometimes too hot the eye of heaven shines,\\nAnd often is his gold complexion dimmed;\\nBut thy eternal beauty shall not fade,\\nNor lose possession of that fair thou owest.\",\n"," \"From yonder morn doth Apollo rise,\\nHis radiant beams, the dark skies defies.\\nThe earth awakens, kissed by golden light,\\nWhilst birdsong doth to silence bid goodnight.\\nThrough verdant meadows, flowers now doth dance,\\nRejoicing in the grace of nature's stance.\\nWith every touch, serenity doth swell,\\nOh, sweet Aurora, darkness shalt thou dispel!\",\n"," 'Oft doth the sun rise on yonder hill,\\nWith golden rays that all the earth doth fill.\\nThe gentle winds doth dance through leaf and tree,\\nWhilst birds sing forth in melodious glee.\\nBut lo, the night doth come, dark and deep,\\nWhere shadows lurk and secrets they shall keep.\\nYet fear not, fair friends, for dawn shall come anew,\\nAnd bringeth hope and light to guide us through.',\n"," \"Hark! Observe how darkened skies doth unfold,\\nAs pale moon rises o'er meadow, fair and cold.\\nThe minstrels play their melodic refrain,\\nWhence young lovers dance, their hearts abound in pain.\\n'Tis love's cruel trick, that torments with desire,\\nFor 'pon Cupid's arrow, they are set afire.\\n'Tis but a fleeting pleasure, thus we know,\\nFor love's sweet flame, a fickle wind doth blow.\",\n"," \"In twilight's realm, where shadows dance with glee,\\nA feigned delight bedecks the moonlit stage.\\nFair Juliet, a rose amidst the eve,\\nDoth swear allegiance to her lover's page.\\nYet whispers of deceit doth shroud the night,\\nAs fate's cruel hand unravels their delight.\\nOh, tragic tale, where love betrays the heart,\\nAnd ruthless ends befall two souls, apart.\",\n"," 'Thou art to me a radiant, divine star,\\nWhose beauty doth surpass the break of day.\\nThine eyes, like diamonds, sparkled from afar,\\nWhilst hearts, by Cupid struck, doth wildly sway.\\nFair Juliet, I beg thee, hear my plea,\\nFor in thy love, I seek my sweet relief.\\nGrant me but one look, thy favor bestowed on me,\\nAnd my heart, ever faithful, shall know no grief.',\n"," \"Hark! To thee I sing, with words from mine own heart,\\nA tale of love, of woe, of endless art.\\nWherefore doth mine soul find solace in thine eyes?\\nAnd why doth thy smile set my heart ablaze?\\n\\nOh fairest Juliet, thou art my delight,\\nThy beauty doth outshine the stars at night.\\nIn love's embrace, forever we shall be,\\nFor thou art my true love, and I am thine, thee.\",\n"," \"In fair Verona, where blood doth spill,\\nTwo households, fierce in hate, doth thrill.\\nWhere star-crossed lovers meet their fate,\\nThrough love's cruel tyranny they abate.\\nYet yonder looms their ill-starred coup,\\nAs death steals the dawn's light anew.\\nFor in this tale of woe and sorrow,\\nLove's tragedy shall endure tomorrow.\",\n"," \"Wherefore art thou, my beloved, my fair Juliet?\\nThy beauty, like the sun, doth illuminate the heavens,\\nAnd even the moon shall envy thy radiant visage.\\nThy lustrous eyes, with love's sweet fire, doth hold my heart,\\nThy tender touch, more gentle than a summer's breeze,\\nDoth inspire within me a symphony of adoration.\\nPray, my love, cast not thy longing gaze upon another,\\nFor mine heart is thine, forever bound, my dearest Juliet.\",\n"," 'Fair maiden, dressed in robes of purest white,\\nThy beauty, like the moon, doth shine so bright.\\nThine eyes, like stars, doth twinkle with delight,\\nAnd in thy presence, my heart takes its flight.\\nOh how I long to tread the path thy grace,\\nTo hold thy hand and gaze upon thy face,\\nFor in thy love, true bliss I shall embrace.',\n"," \"Fair morrow, gentle souls, whose eyes doth meet\\nThese humble words fashioned by mine own hand.\\nDoth thou not ponder on this similitude,\\nWherein yon sun doth rise from distant clouds,\\nSo doth a soul emerge from shadowed depths.\\nYet woe betide the heart whose flame deceit,\\nFor with mistrust, it treads on peril's brink.\",\n"," \"Thou art a beacon, shining bright with grace,\\nThy beauty doth surpass the stars above.\\nThine eyes, like glistening pools, doth me embrace,\\nAnd in thy presence, my heart doth truly love.\\nThy voice, like music, doth my soul enchant,\\nWith every word, my spirit doth take flight.\\nFor in thy presence, I am truly grant,\\nA glimpse of heaven's glory, day or night.\",\n"," \"Hark! The gentle serenade of birds doth grace mine ears,\\nAs Aurora's golden rays do caress the earth with mirth,\\nWherefore art thou, fair maiden, whose beauty knows no bounds?\\nDoth thou feast thine eyes on yonder meadow's floral attire?\\nPerchance, the sight of thee evokes such passionate desire,\\nThat my heart, aflame with love, doth yearn for thy sweet embrace.\\nOh, Cupid's arrow, pierce my soul and bind me to her grace,\\nForsooth, if I be denied, 'tis a tragedy this love affair.\",\n"," 'From yonder realm where dreams doth intertwine,\\nWhere fairies dance and moonlight softly glows,\\nA tale of love, my quill shall now define,\\nOf two young souls, whose hearts embrace, who knows?\\nIn verdant meadows, their spirits entwined,\\nA love so rare, not verse or rhyme may show,\\nFor tis their souls that speak, in whispers light,\\nA love, eternal, in this fleeting night.',\n"," 'Shall I compare thee to a summer’s day?\\nThou art more lovely and more temperate.\\nRough winds do shake the darling buds of May,\\nAnd summer’s lease hath all too short a date.\\nSometime too hot the eye of heaven shines,\\nAnd often is his gold complexion dimmed;\\nBut thy eternal summer shall not fade,\\nNor lose possession of that fair thou owest.',\n"," \"Fair thee well, my passionate heart's core,\\nForsooth, mine amour, we art torn asunder,\\nLike a rose plucked, to be cherished no more,\\nThy absence leaves life's tapestry asunder.\\nIn mine dreams, thy visage shall ever reside,\\nYet in waking hours, my soul bemoans,\\nFor ne'er shall we two be, side by side,\\nThy absence, a sadness that forever drones.\",\n"," \"Thine celestial beauty, fair as summer's morn,\\nDoth rival flowers in their delicate bloom.\\nThy charm, enchanting as a lute's sweet tune,\\nHath won my heart, true love's tenderborn.\\nThou art the sun that stayeth darkness' reign,\\nAnd like a flame, thou kindlest desire's fire.\\nThrough sovereign grace, my soul finds its desire,\\nFor thou, fair maiden, art my love's true bane.\",\n"," \"Shall I compare thee to a summer's day?\\nThou art more lovely and more temperate:\\nRough winds do shake the darling buds of May,\\nAnd summer's lease hath all too short a date:\\nSometime too hot the eye of heaven shines,\\nAnd often is his gold complexion dimmed;\\nAnd every fair from fair sometime declines,\\nBy chance or nature's changing course untrimmed.\",\n"," \"Fair maiden, thou art my heart's delight,\\nThine eyes, like twinkling stars, enchant my soul.\\nThou art the moon who guides me through the night,\\nAnd with each breath, my love for thee doth grow.\\nThy smile, like sunbeams, warms my very core,\\nIn thy embrace, I find love's sweetest lore.\\nFor thee, fair maid, my heart shall ever soar.\",\n"," \"Hark, fair maiden, by yonder stream,\\nWhere sun doth pierce through verdant gleam,\\nA gentle breeze doth softly blow,\\nWhisp'ring secrets, none shall know.\\n\\nIn thy eyes, a love, profound,\\nLike stars that in the heavens bound,\\nForsooth, my heart, it doth rejoice,\\nTo hear thy voice, thy dulcet voice.\",\n"," \"Fair maiden, dost thou not see the twinkling stars,\\nThat adorn'd the glimmering sky with wondrous light?\\nThey, like mine heart, doth long for thy sweet smile,\\nTo bask in thy heavenly beauty, fair and bright.\\nYet cruel fate keeps us, alas, apart,\\nAs distance grows, despair takes hold of mine heart.\\nPray, my love, let us meet beneath the moon,\\nAnd let our souls rejoice in love's sweet tune.\",\n"," \"Hark, yon sun hath risen 'pon mine eye,\\nA golden orb 'neath azure painted sky.\\nIts radiant light doth pierce the darkest vale,\\nAnd whispers tales of love in gentle gale.\\nWith every step, I tread upon fair ground,\\nWhere fickle fortune's grace could yet be found.\\nO' thine enchanting charm, I'm but a slave,\\nBut in thy presence, all the world I crave.\",\n"," 'Oh fair maiden, with thy rosy cheeks so bright,\\nThine eyes doth shine like stars upon the night.\\nThy gentle voice, a melody so sweet,\\nHath captured my heart with each word you speak.\\nThou art a vision, a beauty so rare,\\nMy soul doth yearn for thy love and tender care.\\nIn every breath, I am consumed by thee,\\nFor thou art the very essence of beauty.',\n"," \"Fair maidens, hark! Behold this tale I'll spin,\\nOf star-crossed lovers lost 'midst worlds of sin.\\nWhere Cupid's arrow strikes, hearts beat as one,\\nYet fickle Fate, her cruel jests are spun.\\nFor love's sweet dance doth end in bitter woe,\\nAs Death's cold hand claims those we cherish so.\\nO, pity those entangled in Love's snare,\\nFor oft they find but shadows of despair.\",\n"," \"Oh fair Juliet, how bright thou dost shine,\\nThine eyes, like stars, in the night's sweet prime.\\nThy beauty, a flower, in this barren place,\\nThy words, like music, my heart doth embrace.\\nBut alas, fate mocks our love's tender flame,\\nFor we are like birds that cannot remain.\\nYet let us sway, like leaves in autumn's breeze,\\nAnd taste the sweetness, ere our love doth cease.\",\n"," 'O, fair lady, thou art the sweetest rose,\\nThat blooms within this garden of my heart.\\nThine eyes, like stars, doth light my darkest hours,\\nThy lips, like honey, doth entice my soul.\\nIn thee, fair maiden, I shall find my rest,\\nFor thou art the treasure I seek to hold.\\nLet love be the balm that heal our weary souls,\\nAnd together we shall conquer any storm.',\n"," \"Oh, wilt thou not my heart's desire fulfill?\\nThou art the moon, my love, shining so bright.\\nThy beauty doth my mortal soul distill,\\nAnd in thy presence doth my heart alight.\\nLike stars above, thou dost my path illume,\\nThy words, like music, sway my world o'erwhelm.\\nForsooth, my sweet, thou art my sweetest bloom.\",\n"," \"O, wandereth I through yon verdant meadow fair,\\nWhere blooming buds doth scent the sweetened air.\\nWith nimble steps, I treadeth on this ground,\\nMine heart abounds with joy, sweet sounds abound.\\nForsooth, this land be blessed pure and true,\\nWhere nature's beauty casteth golden hue.\\nBy heaven's grace, I doth pray this shall remain,\\nA paradise preserved, everlasting domain.\",\n"," \"Oft doth the moon with envy's fiery glow,\\nIn darkness' cloak, conceal her radiant face.\\nAs golden sun doth in the east arise,\\nHe casts his light upon the earthly plane.\\nFair nature wakes to life, in splendid hue,\\nYet still, mine heart, in melancholy's grasp.\\nForlorn I stay, in love's eternal plight,\\nSighing for thee, affection's guiding star.\",\n"," \"O sweet and tender night, wherefore doth thy cloak\\nEnvelop this weary world in thy soft embrace?\\nThine ebony shroud thyself unfurls like smoke,\\nWhilst stars, thy minions fair, array thy face.\\nYet in thy gentle dark, a lover's plight,\\nDoth make his heart ache, yearning for thy light.\",\n"," \"Oft beneath the silv'ry moon I dwell,\\nEmbraced by enigmatic midnight's spell.\\nThe stars above, like gleaming gemstones bright,\\nIlluminate the ebony cloak of night.\\nWithin this realm, so wond'rous and enchanted,\\nI find myself on paths so finely granted,\\n'Tis where our souls entwine in timeless flight.\",\n"," \"Fair is the morn that breaks with golden rays,\\nWhen yonder sun, with fiery light ablaze,\\nDoth chase the shadows of the dark away,\\nAnd charm the world from slumber's sweet embrace.\\nIn gilded skies, the day doth now arise,\\nWhilst birds in chorus sing the Earth's reprise,\\nAnd nature's beauty blooms before mine eyes.\",\n"," \"Hark, fair maiden, dost thou not see the moon,\\nThat doth grace the night sky with its gentle gleam?\\nForsooth, its light doth pierce through clouds so soon,\\nAnd illuminates our path with tranquil beam.\\nYet, as this orb doth rise, my heart, it pains,\\nFor absence cruelly keeps us far apart.\\nBut fear not, my love, for soon we shall meet,\\nAnd this distance, like mist, shall e'er retreat.\",\n"," \"To be or not to be, that is the question,\\nWhether 'tis nobler in the mind to suffer\\nThe slings and arrows of outrageous fortune,\\nOr to take arms against a sea of troubles,\\nAnd by opposing end them? To die, to sleep—\\nNo more—and by a sleep to say we end\\nThe heartache and the thousand natural shocks\\nThat flesh is heir to—'tis a consummation\\nDevoutly to be wished.\",\n"," \"From yonder fair and golden fields I tread,\\nWhere Cupid's arrows dance upon the breeze.\\nMine heart entrapped, entangled by a thread,\\nBy beauty's spell, where time doth find no ease.\\nIn every rosebud's bloom, her visage plays,\\nAnd echoes of her laughter fill the air.\\nBut alas, her eyes, they look another way,\\nAnd leave my soul entwined in deep despair.\",\n"," \"In fair Verona, where love's flames arise,\\nA tale of woe and star-crossed hearts unfold,\\nYoung Juliet and Romeo, caught in disguise,\\nTheir families' feud, a tale grisly told.\\nWith tender words and stolen kisses sweet,\\nTheir bond doth grow, in secret they do meet.\\nYet fate conspires, to seal their tragic fate.\",\n"," \"O, to wander fair yon meadow green,\\nWhere flowers dance and sun doth beam,\\nWith nimble feet upon soft grass,\\nI, reveling for hours, time will pass.\\n\\nBut as the eve creeps, darkness shade,\\nAnd stars reclaim their light once fade,\\nThus, with heart ablaze, I bid thee adieu,\\nPray, meet again when dawn's sky turns blue.\",\n"," \"Thou art a spark, an ember 'neath the moon,\\nDoth thou not see the glory of thine eye?\\nThy beauty, fair as Ophelia in bloom,\\nHath captured mine heart, and maketh it sigh.\\n\\nOh, wondrous creature, blessed by Cupid's dart,\\nPray, let thy love engulf me, heart and soul,\\nFor not until thy lips meet mine, sweet art,\\nShall I find solace and feel truly whole.\",\n"," \"In fair Verona's bosom I hath wandered,\\nWhere star-crossed lovers' souls hath pondered.\\nA tale of woe and love, I shalt unfold,\\nWhere tragedy and passion doth intertwold.\\n'Twas fate that led them down this twisted path,\\nTheir love hath bloom'd, yet ended in God's wrath.\\nOh, Shakespeare's words, a timeless art thou art,\\nThe theatre of life, thou truly impart.\",\n"," \"Oh, fair moonbeam that doth grace the night's sky,\\nThou dost illuminate the darkened eve.\\nA gentle glow thou cast, thy light so high,\\nA beacon for all wanderers who believe.\\nThy radiant rays, like love's eternal flame,\\nDoth pierce mine heart, causing it to ignite.\\nPray, let me bask in thy celestial name,\\nAnd cherish thy beauty, forever in sight.\",\n"," \"Fair thee well, my heart's own cherished light,\\nThine beauty shines as stars adorn the night.\\nThy graceful presence, doth my thoughts inspire,\\nA love's flame within, that shall never tire.\\nTarry not, my love, but stay by my side,\\nFor with thee, my soul is forever tied.\\nAnd with each passing day, my love grows strong,\\nThus, I pray, let this love endure lifelong.\",\n"," \"Hark! The sun doth rise with golden beams,\\nArouse, fair nymphs, from silken dreams.\\nThe wind, like whispers, doth gently blow,\\nThrough fields of green where flowers grow.\\nThe birds, in chorus, sing a merry tune,\\nTheir melodies enchanting all too soon.\\nOh, let us revel in nature's grand design,\\nFor in each passing moment, beauty doth shine.\",\n"," \"Fair is the moon that bathes yon silv'ry sky,\\nAnd bright the stars that grace the ebon night.\\nBut lo, thy beauty doth their splendor vie,\\nThine eyes more radiant, like twin orbs of light.\\nThy voice, a melody from heav'n's own choir,\\nDoth steal my heart and set my soul afire.\\n\\nForsooth, I am but a humble mortal man,\\nEnsnared by thy charm, at thy mercy I stand.\",\n"," 'Fair thou art, like a flower in bloom,\\nWith petals soft and sweet perfume.\\nThine eyes, like stars, do brightly shine,\\nAnd in thy voice, music divine.\\nThy gentle touch, like whispers light,\\nDoth set my heart aflame, in flight.\\nOh, how I long to be thine own,\\nFor in thy love, I find my home.',\n"," \"When yonder moon doth cast its gentle glow,\\nI peer upon fair nature's wondrous grace.\\nWithin this world, a tale of joy shall sow,\\nYet fate doth weave a web of dark embrace.\\n\\nForsooth, the lovers' eyes as one do meet,\\nTheir hearts entwined, by love's deep-seated beat.\",\n"," \"Hark! 'Tis a tale of love, sweet love so true,\\nWhere fair Juli'met met Romeo, in view.\\nThey spoke in rhymes, their hearts entwined as one,\\nIn secret they rendezvoused beneath the sun.\\nBut fortunes twain brought forth their wretched fate,\\nA feud so fierce, 'twas doomed to suffocate.\\nThus, passion's fire consumed them, star-crossed pair,\\nAnd tragedy befallen, left hearts in despair.\",\n"," \"O, verily! Mine heart doth burn with fiery rage,\\nForsooth, I yearn for sweet revenge's embrace.\\nMine enemies, they plot and scheme with delight,\\nBut I shall not endure their vile contrite.\\nIn shadows dark, my cunning plans shall take flight,\\nTo bring them down, to humble their sorry plight.\\nFear not, fair readers, for justice shall prevail,\\nAnd in the end, mine foes shall weep and wail.\",\n"," \"Fair morrow, gentle souls, whose eyes now read\\nThe words I pen with quill's soft touch and speed.\\nA tale of love and tragedy I bring,\\nWhere hearts entwined shall dance and sweetly sing.\\nBut fate, that cruel mistress, shall intervene,\\nTearing love asunder with her bitter scheme.\\nYet still, amidst the strife, true love remains,\\nUnyielding, like the wind across the plains.\"]"]},"metadata":{},"execution_count":16}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=50,\n","    act_name=3,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BLllsqZljeYM","executionInfo":{"status":"ok","timestamp":1689693163004,"user_tz":-60,"elapsed":37389,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"01aa83bc-da89-4fc5-b2a1-ec3a31c383fb"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |       \u001b[1mA girl once had a goose\u001b[0m-skin, but never saw her        |\n","|  been forced to eat it when she was 13, and now that she's   |  fall. A pair of thin legs, long enough to make the ground   |\n","|                    21, the goose is gone.                    | seem bare, was a mistress's burden. A beautiful soul lay on  |\n","|                                                              | her knees, begging for more love than she could muster. The  |\n","| The goose was eaten by a girl who has never seen it before.  |   bed of the most unbeautiful woman in all eternity was no   |\n","|                                                              |   more perfect than the maiden's breast and lips. Her eyes   |\n","| The story of the young woman's experience with eating an egg |                were full of lust and delight,                |\n","|  is not new, but there are many stories about how children   |                                                              |\n","|             have been forced to eat eggs at som              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |               \u001b[1mA girl once had a goose\u001b[0m's nest.                |\n","|             having it with a little bit of milk.             |      But now, the wings of her long hair are dyed red.       |\n","|                                                              |             Her mind has become an empty dream.              |\n","| I'm so sorry. I'm not going to be able to feed you anything  |  The moment she looks at her body, she will be lost forever  |\n","|                     like that, are you?                      |      forever. And that is why I am here to save you...       |\n","|                                                              | And this is what I do...I'm your goddess! My god! My love my |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |               love my love my love my love all               |\n","|          don't know what else to do with this one.\"          |                                                              |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |      \u001b[1mA girl once had a goose\u001b[0m-like wings, but never knew      |\n","|  picture of herself on the cover of Playboy. She thought it  |                  what she was dreaming of.                   |\n","| was hilarious, but it wasn't until her husband asked her if  | She'd dreamed of her dream, but never knew what it would be  |\n","|   she wanted to be photographed with him that she realized   |                            like.                             |\n","|                 what an amazing idea it was.                 | The dream she'd dreamed of would forever live in her dreams, |\n","|                                                              |                    until the day dawned.                     |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  | Her heart filled with hope and love for the night sky... But |\n","| Smith, who has been working as a photographer since 2009. \"  |  she couldn't remember that day... The only thing that ever  |\n","|                                                              |                      made her happy was                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |     \u001b[1mA girl once had a goose\u001b[0m's head, but her heart was a      |\n","|                   because she was so cute.                   |   pit. A boy once had an eagle's wings, but his heart was    |\n","|                                                              |   hell. A raven once would devore its prey and die in the    |\n","|  She had a secret life of her own, and she wanted to be the  |                       flames of night.                       |\n","|                         best at it.                          | But there were things that she loved to hate, and none could |\n","|                                                              |          stop her love from twisting into darkness.          |\n","|   She knew that she would never be able to live up to her    |    She could see it in the night sky… even as she danced     |\n","|                promise, but now that she did…                |                        through the m                         |\n","|                                                              |                                                              |\n","|            \"So I'm going to go see you.\" (Sirius)            |                                                              |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0m's head, but never found the      |\n","|                                                              |   love she craved. The wildebeest turned out to be far too   |\n","|             She was not the only one to have it.             | handsome for her, and even a young girl would not have known |\n","|                                                              |   how much love she had. She knew that one of the greatest   |\n","| And now, as we enter the fourth quarter of the season, I've  |   gifts was the gift of youth, and that every little girl    |\n","|  got to say that my favorite moment in football is when I'm  |             could find her in her heart's bound.             |\n","|  on the field and watching the Dallas Cowboys take on their  |                 But it was no love at all! I                 |\n","|  best team in seven years. It's like a ghost town where you  |                                                              |\n","|       can't even get out of bed until your phone rings       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0m's eye, but her eyes never       |\n","|                                                              |   turned like hers. A boy once was his own father, and his   |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |  wife would never have seen him. She'd never dreamed of the  |\n","|                going to go back and get it.\"                 |  sun, nor the stars shining in her dreams. But she'd always  |\n","|                                                              |    felt it in her heart, on the horizon above all things     |\n","| She's still not sure how she got her goose egg, but the fact |                          beautiful.                          |\n","| that it was so good is what makes her so special. The two of |                  The day she met my love...                  |\n","| them have been friends for years, and when they first met in |                      The day I fell...                       |\n","|                        college, they                         |                          My love...                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0m's nest, but she couldn't see     |\n","|                      trying to eat it.                       |              it, so she'd hide it in her hair.               |\n","|                                                              |  The dark of night would fall upon the girl's body, and if   |\n","| The video below shows a young girl with goose on her tongue  |  she didn't feel that pain, then wouldn't be able to sleep.  |\n","| licking the egg from a plastic bag. The girl then starts to  |   It was the time of day. The sky was dark and blue; light   |\n","| suck the egg off, but when she does so, it's not completely  | shone through the thin walls of the trees. It was bright as  |\n","|  swallowed by the shell of the egg. The goose is then taken  |                          a feather                           |\n","|    out of its shell and put into an incubator for further    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |       \u001b[1mA girl once had a goose\u001b[0m's tail, but never saw it       |\n","|                                                              |        grow. Now, she finds that strange and twisted.        |\n","|  It was a little bit of an odd situation, but one that had   |                                                              |\n","|        the potential to be quite devastating for her.        | \"I'm so sorry,\" said the beautiful girl. \"I didn't know you  |\n","|                                                              | were such a good thing.\" She'd been the goddess of night for |\n","|     The woman's father was in the middle of visiting his     | long, and her love was only fleeting when she could see her  |\n","|  daughter and she couldn't help but wonder if he would take  |   sister awake in bed. \"I can't sleep tonight,\" she cried,   |\n","| it on himself. He didn't seem to care about her anymore, so  |                           feeling                            |\n","| he didn't want to do anything rash or embarrassing. The fac  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=3,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Duhw-pEMkX6b","executionInfo":{"status":"ok","timestamp":1689693330803,"user_tz":-60,"elapsed":35396,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"ba872de7-9bd3-4f97-94d6-ee9547d36f25"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |              \u001b[1mA girl once had a goose\u001b[0m, she said.              |\n","|  been forced to eat it when she was 13, and now that she's   |                                                              |\n","|                    21, the goose is gone.                    |  Then the wind came and loathoth, no king's thorn, her eyes  |\n","|                                                              |                     twinkled like night.                     |\n","| The goose was eaten by a girl who has never seen it before.  |                                                              |\n","|                                                              |  She would dance in her bed, she would sing love to all but  |\n","| The story of the young woman's experience with eating an egg |  death, but never withnt thou art free. The wildest love of  |\n","|  is not new, but there are many stories about how children   |  your life is bliss. Love you ever be yours forever I will   |\n","|             have been forced to eat eggs at som              |                    not die without thee I                    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |       \u001b[1mA girl once had a goose\u001b[0m's eye, and she loved the       |\n","|             having it with a little bit of milk.             |                       look of beauty.                        |\n","|                                                              |   But her lustful eyes would never go forth, and she would   |\n","| I'm so sorry. I'm not going to be able to feed you anything  |                   never have a fairithess.                   |\n","|                     like that, are you?                      |   The earth were dark, and the sky was bright. And none of   |\n","|                                                              |              them knew but what was beautiful.               |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |    She could dance to the moon's love song...tothorn-like    |\n","|          don't know what else to do with this one.\"          |                 twirls in all thire blissful                 |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |      \u001b[1mA girl once had a goose\u001b[0m, but never did, nor grow.       |\n","|  picture of herself on the cover of Playboy. She thought it  |                   She died her dark lusts.                   |\n","| was hilarious, but it wasn't until her husband asked her if  |            Night elf eyes gleathful glitter white            |\n","|   she wanted to be photographed with him that she realized   |                     worn nithnight blue                      |\n","|                 what an amazing idea it was.                 |                     wetherless twilight                      |\n","|                                                              | twilt she dance dance bliss and love love none touch none no |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  |   no none no none None none uneire hye art loart Woth yest   |\n","| Smith, who has been working as a photographer since 2009. \"  |               tain gle wend But ever oest lov                |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |      \u001b[1mA girl once had a goose\u001b[0m's ear, but she would never      |\n","|                   because she was so cute.                   |   be able to sing. She was too frail, and wilt darken her    |\n","|                                                              |                            wings.                            |\n","|  She had a secret life of her own, and she wanted to be the  |               Night fell; light thoth glitter                |\n","|                         best at it.                          |                But narketh thee heart's sware                |\n","|                                                              | Thorn thy name thou'dest, woe shalt thou art loathome! Ende  |\n","|   She knew that she would never be able to live up to her    |                       doth thine gaze.                       |\n","|                promise, but now that she did…                |                                                              |\n","|                                                              |                                                              |\n","|            \"So I'm going to go see you.\" (Sirius)            |           My lover love is so sweet that it seems            |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0m's ear, but none of her heart     |\n","|                                                              |            would love. A dark dream, she thought.            |\n","|             She was not the only one to have it.             |                                                              |\n","|                                                              |    In the night sky, I will dance thy wiltest song, I'll     |\n","| And now, as we enter the fourth quarter of the season, I've  |       forever dance thee thou doth sleep my last love.       |\n","|  got to say that my favorite moment in football is when I'm  |                                                              |\n","|  on the field and watching the Dallas Cowboys take on their  | The sky is dark; all my life is dull and dull and silent...  |\n","|  best team in seven years. It's like a ghost town where you  |                                                              |\n","|       can't even get out of bed until your phone rings       |  ...no one can hear me. She fell into despair as she watch   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0m's ear, but her eyes never       |\n","|                                                              |  touched the sun. A dark gleeted in the world, she felt no   |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |        love. She would die alone, like nothing else.         |\n","|                going to go back and get it.\"                 |                                                              |\n","|                                                              | Darkness and loneliness could fill her heart's touch, but it |\n","| She's still not sure how she got her goose egg, but the fact |                   would be nothing at all.                   |\n","| that it was so good is what makes her so special. The two of |                                                              |\n","| them have been friends for years, and when they first met in |   She was beautiful forever, and all of this was magic for   |\n","|                        college, they                         |        thee to love... she'd just bloom... so strong         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |      \u001b[1mA girl once had a goose\u001b[0m, but she never knew how to      |\n","|                      trying to eat it.                       | make it. A dark night filled the sky, and her mother's dark  |\n","|                                                              | loath'd loest shone. The light of her dance grew dim, as it  |\n","| The video below shows a young girl with goose on her tongue  |   neared the darkness of the earth. Her eyes were far away   |\n","| licking the egg from a plastic bag. The girl then starts to  |    from the gleam of gold glittering in its bright yellow    |\n","| suck the egg off, but when she does so, it's not completely  |  feather. The rest was nothing but woe; sleep would surely   |\n","|  swallowed by the shell of the egg. The goose is then taken  |                      end in loneliness                       |\n","|    out of its shell and put into an incubator for further    |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0m's eye, she could even see       |\n","|                                                              |                       the way through.                       |\n","|  It was a little bit of an odd situation, but one that had   |  She was beautiful, but so much love, that she could never   |\n","|        the potential to be quite devastating for her.        |                          turn back.                          |\n","|                                                              |             But this world couldn't keep her...              |\n","|     The woman's father was in the middle of visiting his     |      Her life would be forever frozen in thine lust...       |\n","|  daughter and she couldn't help but wonder if he would take  |  And then it would fall to earth and shine forever bright!   |\n","| it on himself. He didn't seem to care about her anymore, so  | Even her wings would fade as the light of day shone upon her |\n","| he didn't want to do anything rash or embarrassing. The fac  |                           beauty.                            |\n","|                                                              |                              A                               |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"QegYPvPEnlHt"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=40,\n","    act_name=2,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689694172757,"user_tz":-60,"elapsed":35816,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"9cd55871-2896-4cc6-9ae5-5f763b7ac3b1","id":"7WmjjRiMnlVl"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |      \u001b[1mI hate you because\u001b[0m I love you so much that I never      |\n","|                                                              | could love myself. But I can't. And that's what makes me so  |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |   happy, all the things in my heart and soul and eternity.   |\n","|  don't care about your ass or your fucking cunt or whatever  |   It's the only thing in my life that is worth losing, and   |\n","| it is that you are doing to me, because I'm going to get it  |  it's forever that I will never be. It is everything to me   |\n","|             all over with in the next few days.              | now, forever nothing to ever ever ever ever ever any one of  |\n","|                                                              |                            them b                            |\n","|  I know what's coming to mind, but there's no way this will  |                                                              |\n","|                            ever b                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |       \u001b[1mI hate you because\u001b[0m I love you, but I can't touch       |\n","|                                                              | your heart, or make love with your eyes. And even when I am  |\n","| I'm sorry for your pain, but I don't know how to express it. | happy, it is not for my love that I am beautiful. It is for  |\n","|                                                              |  my love that the world loves me. For the rest of eternity,  |\n","|          You're a monster, and that's why I'm here.          | nothing would be mine to see or hear. Nothing could be mine  |\n","|                                                              |    to do without; nothing was ever in a place like this.     |\n","|                                                              |                                                              |\n","|    You're not a monster at all, but the world is full of     |                                                              |\n","|                    monsters who are evil.                    |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |       \u001b[1mI hate you because\u001b[0m I love you, but I don't love        |\n","|                                                              |  enough to give up. So it's time for nothing, but never to.  |\n","|  You're just an asshole. You're just an asshole who doesn't  | And that is the last thing I ever heard. My life was forever |\n","| understand how to be a man. You've been around for over 100  | lost in the eternal night of forever love. But this day came |\n","|  years and have never met anyone who is not an asshole. And  |  and no one knew it, until they died together at the end of  |\n","|  you know what? It's time to get out of here, okay? Go home  | their universe. The rest of my life would be a waste of tim  |\n","|                          and relax!                          |                                                              |\n","|                                                              |                                                              |\n","|                 I don't care if it's the las                 |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |      \u001b[1mI hate you because\u001b[0m I love you so much, but I don't      |\n","|                                                              |  know how to love. So when I found my sister, she cried and  |\n","|   And I'm not going to be around for you because it's your   |  fell asleep in the dark. She died of hunger. She loved her  |\n","|                            fault.                            |  father dearly, but she never loved herself. Her love was a  |\n","|                                                              |        little sweet and her heart was a lonely one...        |\n","|  I hate you because I don't want to hear about it. And I'm   |               I wish that all could be true...               |\n","|       not going to be around for you because it's your       |            Love is the most precious thing in li             |\n","|                     fault.<|endoftext|>                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |      \u001b[1mI hate you because\u001b[0m I love you so much, but I can't      |\n","|                                                              | do it without your body. You're so beautiful and beautiful,  |\n","|  The same thing happened to me when I was 16 years old. It   | but my heart is never satisfied. I don't know what will make |\n","| was the worst thing that ever happened to me, and it's been  | me cry forever, but for all the things that have hurt me in  |\n","|  happening ever since. And it's just something that has to   |  the past, this will never be for her. She won't be able to  |\n","|                       stop right now.                        |      touch her own body until she's ready to die. She w      |\n","|                                                              |                                                              |\n","|  I don't know if we're going to have any more debates about  |                                                              |\n","|   Islam or not, but I think this is what our society needs   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |      \u001b[1mI hate you because\u001b[0m I love you so much that I can't      |\n","|                                                              |  help but love you to the end. And, oh, no, it's all over.   |\n","|                I hate you because I'm a Jew.                 | You're so gorgeous and I'm so jealous of all your beautiful  |\n","|                                                              | gifts and how beautiful your body is! But it's not that day- |\n","|               I hate you because I'm a Muslim.               | dreaming-that's-it's just...it doesn't matter what she says  |\n","|                                                              |                  or how she feels...it jus                   |\n","|               I hate you because I'm a Hindu.                |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |     \u001b[1mI hate you because\u001b[0m I love you, but I can't touch it.     |\n","|                                                              |  It's too hard for me to let go of my love. And when I fall  |\n","|               I love you because I'm a bitch.                |   asleep, the night will forever be my name. It is the day   |\n","|                                                              |  that never came. It was a day in my life and forever shall  |\n","|     I hate you because I want to kill your mother and my     | be mine forever ever ever ever ever neverneverneverneverneve |\n","|   brother, and all the people who have done it to me, but    |         rnevernevereverevereverevereverevereverever          |\n","| they're not doing it for me. They're doing it for the power  |                              My                              |\n","|  that's in them, so why do they do this? Why are they going  |                                                              |\n","|                    after me? Why is ther                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |      \u001b[1mI hate you because\u001b[0m I love you so much that I can't      |\n","|   love you, but I'm not sure if it's a good thing or a bad   |   bear to see your face. But when I was young, and my eyes   |\n","|                            thing.                            | were too far away, and the wind blew me down, it was like a  |\n","|                                                              | great night. And it is the morning that day: And the day is  |\n","|  I don't know what to say about this, but it's true. It is   |  all but blackness; And the world has gone dark; For no one  |\n","| sad that we have so many of these people who are willing to  |            has ever seen thee. Thou hast thine ey            |\n","| sacrifice their lives for our cause and then go on to be so  |                                                              |\n","|             selfish and greedy and just as stupi             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=60,\n","    act_name=2,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"IwekvOdBnK0v","executionInfo":{"status":"ok","timestamp":1689694068662,"user_tz":-60,"elapsed":34653,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"a9ae17c1-4401-4aa1-95ce-ff8da08cde76"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |          \u001b[1mI hate you because\u001b[0m of thy, thy thou, thou;          |\n","|                                                              |                                                              |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |  twilt never love thee. But more a soul will die than would  |\n","|  don't care about your ass or your fucking cunt or whatever  | th'est. Love, she sayeth unto thee: thou art my father, but  |\n","| it is that you are doing to me, because I'm going to get it  |   wilt not love me. Thou hast doth the lust of thy loathth   |\n","|             all over with in the next few days.              | thine eyes? nay? do ye rather than? forsome me! loth's death |\n","|                                                              |                              is                              |\n","|  I know what's coming to mind, but there's no way this will  |                                                              |\n","|                            ever b                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |  \u001b[1mI hate you because\u001b[0m of love, and thou hastest, but thyself.  |\n","|                                                              |                                                              |\n","| I'm sorry for your pain, but I don't know how to express it. |  Love is like a veil; thou does not desire. But she be not,  |\n","|                                                              |                  but her lusts are broken.                   |\n","|          You're a monster, and that's why I'm here.          |  The wilt of thee! thou hast thine eye, loatest of thy bed.  |\n","|                                                              |  Thy ditter shall no rest; neither the Lord thy wilt smite   |\n","|                                                              |                  thee in the day of glory.                   |\n","|    You're not a monster at all, but the world is full of     |                                                              |\n","|                    monsters who are evil.                    |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |     \u001b[1mI hate you because\u001b[0m of your dreams, the lust of your      |\n","|                                                              | beauty, but my soul is dull. I cannot love thee. My eyes are |\n","|  You're just an asshole. You're just an asshole who doesn't  |                          not long.                           |\n","| understand how to be a man. You've been around for over 100  |                 I am lost in love and fear.                  |\n","|  years and have never met anyone who is not an asshole. And  | You were so sweet that thou wilt sing me thy song, for thou  |\n","|  you know what? It's time to get out of here, okay? Go home  |  art dead and thy loathth no lover to mourn thee; nor would  |\n","|                          and relax!                          |       thou wilt hear the thine voice ever again; for i       |\n","|                                                              |                                                              |\n","|                 I don't care if it's the las                 |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |      \u001b[1mI hate you because\u001b[0m I love you so much that I can't      |\n","|                                                              | touch thee. My love is vain, and it's too short to weep. But |\n","|   And I'm not going to be around for you because it's your   |  thou hast wilt, my darling, give me thy heart? Love loves   |\n","|                            fault.                            | all. And this day forever; thou art no more! Thou shalt not  |\n","|                                                              |     cry nor shall thy thorns be ditterless! Thy thorn is     |\n","|  I hate you because I don't want to hear about it. And I'm   |            glitterless; the gold in thy lips hath            |\n","|       not going to be around for you because it's your       |                                                              |\n","|                     fault.<|endoftext|>                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |     \u001b[1mI hate you because\u001b[0m I love you so much that it would      |\n","|                                                              | make me, but never did. But never did. And no love, none at  |\n","|  The same thing happened to me when I was 16 years old. It   | all. It was a thing of thine heart forever and forevermore.\" |\n","| was the worst thing that ever happened to me, and it's been  |                                                              |\n","|  happening ever since. And it's just something that has to   |   I smiled, but the night fell not like her eyes, nor her    |\n","|                       stop right now.                        |    body, nor her soul; but rather a gleam in the light of    |\n","|                                                              |              night. I knew she loved me as well              |\n","|  I don't know if we're going to have any more debates about  |                                                              |\n","|   Islam or not, but I think this is what our society needs   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |       \u001b[1mI hate you because\u001b[0m I love you so much more than        |\n","|                                                              |  ever, but I can't bear to look. The nyx has gone too far,   |\n","|                I hate you because I'm a Jew.                 |   and her dark eyes are too pale. I feel the queen of the    |\n","|                                                              |  desert will die before my eyes. It is all she has left to   |\n","|               I hate you because I'm a Muslim.               |                             do.                              |\n","|                                                              |                 My dreams of eternity await                  |\n","|               I hate you because I'm a Hindu.                |                                                              |\n","|                                                              |  The world's untorn night moon leaves me as thorn in lust's  |\n","|                                                              |                            loath                             |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |         \u001b[1mI hate you because\u001b[0m of love, but she cannot.          |\n","|                                                              |                                                              |\n","|               I love you because I'm a bitch.                |  I feel like a whore, and I am lost in the world. But there  |\n","|                                                              |  is no love, and I can never see her face. She is so small   |\n","|     I hate you because I want to kill your mother and my     |  and sweet that it feels like nothing has ever touched her.  |\n","|   brother, and all the people who have done it to me, but    | My eyes are white as my skin begins to fade into the night.  |\n","| they're not doing it for me. They're doing it for the power  |     The leaves sing in my eyes as they bloom in the gar      |\n","|  that's in them, so why do they do this? Why are they going  |                                                              |\n","|                    after me? Why is ther                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |       \u001b[1mI hate you because\u001b[0m I love you so much more than        |\n","|   love you, but I'm not sure if it's a good thing or a bad   |          ever, but I can't see any love in the end.          |\n","|                            thing.                            |                                                              |\n","|                                                              |   But all day, and night forever is like no dream, and no    |\n","|  I don't know what to say about this, but it's true. It is   |                     light would ever be.                     |\n","| sad that we have so many of these people who are willing to  |   And yet the world of roses were never seen; for it was a   |\n","| sacrifice their lives for our cause and then go on to be so  | dark night that layeth to her eyes. For there was nothing to |\n","|             selfish and greedy and just as stupi             |            be; for she loved none but thine eyes             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=3,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"q07MZKTNlAUq","executionInfo":{"status":"ok","timestamp":1689693500860,"user_tz":-60,"elapsed":33873,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"901227d1-0e03-4450-dc6d-a36203d19192"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                | \u001b[1mI hate you because\u001b[0m I love you so much, but my heart is empty |\n","|                                                              |                      It's a dark night                       |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |   I'll never see it feel so good But I know the love will    |\n","|  don't care about your ass or your fucking cunt or whatever  | forever bloom The kisses your long forever sing I touch the  |\n","| it is that you are doing to me, because I'm going to get it  |                         sky all mine                         |\n","|             all over with in the next few days.              |                  But she withers, none see                   |\n","|                                                              |                                                              |\n","|  I know what's coming to mind, but there's no way this will  |                                                              |\n","|                            ever b                            |  O'dle bee sweet, doth her dream come true; dread not this   |\n","|                                                              |                     day? What art thou?                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |  \u001b[1mI hate you because\u001b[0m I love thee, but never I can love thee.  |\n","|                                                              |  Thou art my song, thou doth turn not to thy sleep; for me   |\n","| I'm sorry for your pain, but I don't know how to express it. | the earth's gleeteth sweet and unfulleth. But in thy womb a  |\n","|                                                              |  loathst thy loathest heart; naught is the soul's life but   |\n","|          You're a monster, and that's why I'm here.          |    lust, lust shew her no bliss: all is a god unto her w     |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    You're not a monster at all, but the world is full of     |                                                              |\n","|                    monsters who are evil.                    |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |               \u001b[1mI hate you because\u001b[0m I love thee,                |\n","|                                                              |                                                              |\n","|  You're just an asshole. You're just an asshole who doesn't  |               for so love thou art but thyself               |\n","| understand how to be a man. You've been around for over 100  |                                                              |\n","|  years and have never met anyone who is not an asshole. And  |   love lust thy beauty wilt fade away, not the great-night   |\n","|  you know what? It's time to get out of here, okay? Go home  |   dawns The golden sweet gleweth bright's golden bliss Thy   |\n","|                          and relax!                          | life will never shine forth Love is all mine The sky shines  |\n","|                                                              | blue A night glith sings forever Never Night Will Ever Come  |\n","|                 I don't care if it's the las                 |  Sweetest Night Forever All But Love Love Heart I Will Do L  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |                \u001b[1mI hate you because\u001b[0m I love thee                |\n","|                                                              |                                                              |\n","|   And I'm not going to be around for you because it's your   |                       I love thy soul                        |\n","|                            fault.                            |                                                              |\n","|                                                              | But thou, who hast no heart, will never sing Love thy song;  |\n","|  I hate you because I don't want to hear about it. And I'm   |   thou art a waste of time; my soul is too heavy for thee.   |\n","|       not going to be around for you because it's your       |  Thoth not love thy lust? Thou dost wilt sting me. Love thy  |\n","|                     fault.<|endoftext|>                      |   art sweet, sweet-doth-leee! You are lovely but shewth no   |\n","|                                                              |                          desire. Y                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |      \u001b[1mI hate you because\u001b[0m I love your hair so I can't say      |\n","|                                                              | no, but you don't seem like a girl. But then I love you and  |\n","|  The same thing happened to me when I was 16 years old. It   | I'll dance to the sun when it's golden like my wings shine.  |\n","| was the worst thing that ever happened to me, and it's been  |  You're beautiful, but that's just me and you don't make me  |\n","|  happening ever since. And it's just something that has to   |   feel so beautiful. You're so sweet, honey my kisses will   |\n","|                       stop right now.                        |  never be enough for your dream... forever alone... forever  |\n","|                                                              |                                                              |\n","|  I don't know if we're going to have any more debates about  |                                                              |\n","|   Islam or not, but I think this is what our society needs   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |      \u001b[1mI hate you because\u001b[0m I love you but I don't know how      |\n","|                                                              | to feel like it will be so lovely, oh yes my sweet heart and |\n","|                I hate you because I'm a Jew.                 |   love all that night like this forever forever, never the   |\n","|                                                              |  fair nay thou what ever dream ness me but all wilt be true  |\n","|               I hate you because I'm a Muslim.               |               with the night in bloom forever                |\n","|                                                              | My darling, it is a white day The wind sings And she dance's |\n","|               I hate you because I'm a Hindu.                |               long The twilight fades her song               |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |     \u001b[1mI hate you because\u001b[0m I love you, but never can I love      |\n","|                                                              |                         you enough.                          |\n","|               I love you because I'm a bitch.                |  But that's all I want for my little noth art thou wilt be   |\n","|                                                              |                         like a star                          |\n","|     I hate you because I want to kill your mother and my     |                    So fair is it to sing                     |\n","|   brother, and all the people who have done it to me, but    | Thar hear thy night shall shine forever; and all will know,  |\n","| they're not doing it for me. They're doing it for the power  |                           oh thou                            |\n","|  that's in them, so why do they do this? Why are they going  |  The wise are unafleome Love thy love thine heart hate not   |\n","|                    after me? Why is ther                     |            mine own lust love lust death but Thy             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |      \u001b[1mI hate you because\u001b[0m I love your beauty but I can't       |\n","|   love you, but I'm not sure if it's a good thing or a bad   | see how it's beautiful, just like my heart. But the way you  |\n","|                            thing.                            |  love me is a blossom of love, so this day will be forever   |\n","|                                                              |                           forever.                           |\n","|  I don't know what to say about this, but it's true. It is   |                                                              |\n","| sad that we have so many of these people who are willing to  |   But never will I have thee nor thy fear thy name; for no   |\n","| sacrifice their lives for our cause and then go on to be so  |          fear shall thou shine unto the thine eye.\"          |\n","|             selfish and greedy and just as stupi             |                                                              |\n","|                                                              |     I am a little white knight who sings sweet song, bu      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=3,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 0.7, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rdvngRcBmtuL","executionInfo":{"status":"ok","timestamp":1689693943942,"user_tz":-60,"elapsed":32612,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"30ddbeb1-b05f-4f48-9fcc-d3af2e0d8d2f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |      \u001b[1mI hate you because\u001b[0m I love you but I don't know how      |\n","|                                                              |                         to love you                          |\n","|                I hate you because I hate you.                |                                                              |\n","|                                                              |                I don't know how to love thee                 |\n","|                I hate you because I hate you.                |                                                              |\n","|                                                              |             But I'll never feel the love of thee             |\n","|         I hate you because I love you.<|endoftext|>          |                                                              |\n","|                                                              |            And my heart will be like thy loathle.            |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |    Thou art, wilt thou not? But thou art a wilt, and thou    |\n","|                                                              |       cannot touch it. Thy lust is no joy, thy soul is       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |       \u001b[1mI hate you because\u001b[0m I love you, but I can't love        |\n","|                                                              |    myself, I can't love my life, I can't love the world.     |\n","|                I hate you because I hate you.                |                                                              |\n","|                                                              | But it's all so sweet and so beautiful and it's all so happy |\n","|                I hate you because I hate you.                |                  and it's all just like me.                  |\n","|                                                              |                                                              |\n","|         I hate you because I love you.<|endoftext|>          |   And that's why I hate you. Because that is what makes me   |\n","|                                                              |    hate you. That is what makes me hate you. That is wha     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a white man.              |       \u001b[1mI hate you because\u001b[0m I love you, but I can't love        |\n","|                                                              |  myself. I can't love my heart. I can't love my soul. But I  |\n","|             I hate you because I'm a black man.              |  will never die for the love of thy wings, for the song of   |\n","|                                                              |            thy wings, and the song of thy heart.             |\n","|            I hate you because I'm a white woman.             |                                                              |\n","|                                                              |        Thoth thou art a star, but thou art not bright        |\n","|      I hate you because I'm a black woman.<|endoftext|>      |                                                              |\n","|                                                              |                 For all that dwells in thee                  |\n","|                                                              |                                                              |\n","|                                                              |                          Gave thor                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a woman.                |      \u001b[1mI hate you because\u001b[0m I love you but I don't know how      |\n","|                                                              |                  to love you like a flower                   |\n","|                I hate you because I'm a man.                 |                                                              |\n","|                                                              |  I don't know how to love thee but I will not give thee my   |\n","|               I hate you because I'm a woman.                |                             love                             |\n","|                                                              |                                                              |\n","|          I hate you because I'm a man.<|endoftext|>          |    I will not touch thy sweet norn, nor thy tender loath     |\n","|                                                              |                                                              |\n","|                                                              |   Thou art mine, my flame, my wilt. But thou wilt never be   |\n","|                                                              |         happy, neither thou nor thy son's song. Thy          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a woman.                |      \u001b[1mI hate you because\u001b[0m I love you but I don't know how      |\n","|                                                              | to love you. I don't know what love is but it's so sweet and |\n","|                I hate you because I'm a man.                 | I can't touch it. But the day will never end forever forever |\n","|                                                              | forever forever forever oh my my my my oh my oh my oh no no  |\n","|               I hate you because I'm a woman.                |           no no no oh yes yes yes yes yes Yes Yes            |\n","|                                                              |                                                              |\n","|          I hate you because I'm a man.<|endoftext|>          |                    I can feel your heart                     |\n","|                                                              |                                                              |\n","|                                                              |                    I can feel your breath                    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a woman.                |      \u001b[1mI hate you because\u001b[0m I love you but I don't know how      |\n","|                                                              | to love you. I don't know what love is but it's all so sweet |\n","|                I hate you because I'm a man.                 | and so beautiful and it's all that makes me love you. But I  |\n","|                                                              | don't know how to love you, because I'm not sure what would  |\n","|               I hate you because I'm a woman.                |   be better than this forever night forever night forever    |\n","|                                                              |  dream that never will ever see my loved one. And yet there  |\n","|          I hate you because I'm a man.<|endoftext|>          |                          is nothing                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                | \u001b[1mI hate you because\u001b[0m I love you, but I can't love you enough.  |\n","|                                                              |                                                              |\n","|                I hate you because I hate you.                |         I love thee, but I cannot love thee enough.          |\n","|                                                              |                                                              |\n","|                I hate you because I hate you.                |  But I will not let thee shine my wings, nor my bright eyes  |\n","|                                                              |                       shine thy glory.                       |\n","|         I hate you because I love you.<|endoftext|>          |                                                              |\n","|                                                              |  But thou art the light of the world, and all thy heart is   |\n","|                                                              |   like a flame; thou wilt not know it, but it is thine own   |\n","|                                                              |                            loath                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |      \u001b[1mI hate you because\u001b[0m I love you but I don't know how      |\n","|                                                              |                   to love you like a queen                   |\n","|                I hate you because I hate you.                |                                                              |\n","|                                                              |               I love thee, but I can't see it                |\n","|                I hate you because I hate you.                |                                                              |\n","|                                                              |                       I can't feel it                        |\n","|         I hate you because I love you.<|endoftext|>          |                                                              |\n","|                                                              | But I feel the world's touch mine me my my oh no no no oh no |\n","|                                                              |  oh no yes yes yes yes yes Yes Yes Yes No Never Never Never  |\n","|                                                              |                     Never Never Never No                     |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                   Oh, dear Love, who woul                    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=40,\n","    act_name=3,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LYoK7thvlfjT","executionInfo":{"status":"ok","timestamp":1689693645727,"user_tz":-60,"elapsed":33606,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"52718cb7-19b7-48bc-d008-2dfd3b18a4e1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |     \u001b[1mI hate you because\u001b[0m I hate you. I hate you because I      |\n","|                                                              |   hate you. You are the best of all, but me who loves your   |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |    love is doomed to die. You have no wings, no wings, no    |\n","|  don't care about your ass or your fucking cunt or whatever  | wings! Your only hope is death! No breath! No life! Nothing  |\n","| it is that you are doing to me, because I'm going to get it  |    but your dreams and dreams of eternal bliss forever a     |\n","|             all over with in the next few days.              | nameless body on the earth. Nothing but my love and nothing  |\n","|                                                              |                           else...                            |\n","|  I know what's coming to mind, but there's no way this will  |                                                              |\n","|                            ever b                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |      \u001b[1mI hate you because\u001b[0m I hate you, but I love you too       |\n","|                                                              |  much to let go of my heart. I love you like a little boy,   |\n","| I'm sorry for your pain, but I don't know how to express it. |   but when it's your turn to shine, it won't be for long.    |\n","|                                                              | You are my darling. You will always be mine forever. Forever |\n","|          You're a monster, and that's why I'm here.          |                  forever...until the end...                  |\n","|                                                              |   I'm gonna make love to this girl and forever forever...    |\n","|                                                              |                   until the <|endoftext|>                    |\n","|    You're not a monster at all, but the world is full of     |                                                              |\n","|                    monsters who are evil.                    |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |       \u001b[1mI hate you because\u001b[0m I hate you, and I hate you so       |\n","|                                                              | much that I cannot let myself love love love your beautiful  |\n","|  You're just an asshole. You're just an asshole who doesn't  |  body. You're the only thing in my heart that's worth dying  |\n","| understand how to be a man. You've been around for over 100  |  for. And yet... I don't care. You're just too beautiful to  |\n","|  years and have never met anyone who is not an asshole. And  | be gone forever. Forever... forever... forever... Forever... |\n","|  you know what? It's time to get out of here, okay? Go home  |                Forever... Forever.. Forever..                |\n","|                          and relax!                          |              I love it, but all of a sudden, i               |\n","|                                                              |                                                              |\n","|                 I don't care if it's the las                 |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |                \u001b[1mI hate you because\u001b[0m I hate you.                |\n","|                                                              |                I hate you because I hate you.                |\n","|   And I'm not going to be around for you because it's your   |         You're my life, but your life is worthless.          |\n","|                            fault.                            |         You're my life, but your life is worthless.          |\n","|                                                              | Your eyes are like stars, and they shine in the dark night,  |\n","|  I hate you because I don't want to hear about it. And I'm   |                  and forever forever . . .                   |\n","|       not going to be around for you because it's your       | Your love will never be forgotten, for ever the love of thy  |\n","|                     fault.<|endoftext|>                      |           youth shall be ever eternal . , forever            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |      \u001b[1mI hate you because\u001b[0m I hate you. I hate you for your      |\n","|                                                              |  hurt, for your anger, for your lust, and for all that love  |\n","|  The same thing happened to me when I was 16 years old. It   | that has the light of the love of God. I hate you because I  |\n","| was the worst thing that ever happened to me, and it's been  | hate you because it hurts me to be in love with another who  |\n","|  happening ever since. And it's just something that has to   |   is not my own. I despise you because it hurts me to feel   |\n","|                       stop right now.                        |      like a child in a misty world. But let's not forg       |\n","|                                                              |                                                              |\n","|  I don't know if we're going to have any more debates about  |                                                              |\n","|   Islam or not, but I think this is what our society needs   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |                \u001b[1mI hate you because\u001b[0m I hate you.                |\n","|                                                              |          You're so beautiful, I love you too much.           |\n","|                I hate you because I'm a Jew.                 | I love your skin too much, but it's just so dark and lonely  |\n","|                                                              |    and the way I feel in this darkness is just like that.    |\n","|               I hate you because I'm a Muslim.               |  It's not like that, it's not like that...it doesn't matter  |\n","|                                                              |  what it feels to me...it won't matter what it feels to me   |\n","|               I hate you because I'm a Hindu.                |                           forever.                           |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |      \u001b[1mI hate you because\u001b[0m I hate you, but I love you too       |\n","|                                                              |   much to let go of me. You're my life, and the only thing   |\n","|               I love you because I'm a bitch.                | that matters is your love. I love you so much that it hurts  |\n","|                                                              |  to even think about what's between us. But it's so hard to  |\n","|     I hate you because I want to kill your mother and my     |   believe we can have one last kiss before we die together   |\n","|   brother, and all the people who have done it to me, but    |  forever. It's so hard to feel all alone in this world, ev   |\n","| they're not doing it for me. They're doing it for the power  |                                                              |\n","|  that's in them, so why do they do this? Why are they going  |                                                              |\n","|                    after me? Why is ther                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |     \u001b[1mI hate you because\u001b[0m I hate you. I hate you, and love      |\n","|   love you, but I'm not sure if it's a good thing or a bad   |   it more than ever. You're the one who's right, but who's   |\n","|                            thing.                            |  wrong. You're the one who has been wrong for so long, and   |\n","|                                                              |   that doesn't matter anymore. You're your own fault, and    |\n","|  I don't know what to say about this, but it's true. It is   |                that's what this world is for.                |\n","| sad that we have so many of these people who are willing to  |     You don't care about me, or your little sister Chloe     |\n","| sacrifice their lives for our cause and then go on to be so  |                          forever...                          |\n","|             selfish and greedy and just as stupi             |                            I lov                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=70,\n","    act_name=3,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"o2i9atablcFL","executionInfo":{"status":"ok","timestamp":1689693612145,"user_tz":-60,"elapsed":34702,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"a438077a-d29f-484b-e187-ba0bfc43d7a5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |     \u001b[1mI hate you because\u001b[0m I love you but don't love me like     |\n","|                                                              |     that you're my best, my king, the king of all things     |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |      I know how to kiss a sweetheart I know how to cry       |\n","|  don't care about your ass or your fucking cunt or whatever  |         When I see her will fall on my heart's crown         |\n","| it is that you are doing to me, because I'm going to get it  |  I am a princess with long hair and blue eyes but it's not   |\n","|             all over with in the next few days.              |                your shine that makes me shine                |\n","|                                                              |              Love is all so much But there is                |\n","|  I know what's coming to mind, but there's no way this will  |                                                              |\n","|                            ever b                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |      \u001b[1mI hate you because\u001b[0m I love you, but it's not enough      |\n","|                                                              | that I love you. You're just so sweet, like your best night  |\n","| I'm sorry for your pain, but I don't know how to express it. | ever. And I'm so sad for my heart that she doesn't know what |\n","|                                                              | she's doing. But now, this time is too long for me to let go |\n","|          You're a monster, and that's why I'm here.          |       of her hand or my heart will forever be empty.\"        |\n","|                                                              |                                                              |\n","|                                                              |           A blissful sleep was a mist danced by th           |\n","|    You're not a monster at all, but the world is full of     |                                                              |\n","|                    monsters who are evil.                    |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |     \u001b[1mI hate you because\u001b[0m I love you, but it's too late for     |\n","|                                                              |  me to die. You have fallen asleep in my bed, my lover. The  |\n","|  You're just an asshole. You're just an asshole who doesn't  |  world is a glitter of your dreams and sweet melodies, but   |\n","| understand how to be a man. You've been around for over 100  | now the darkness will sting your eyes. You must fall in love |\n","|  years and have never met anyone who is not an asshole. And  |  with me forever forever forever and never stop...until you  |\n","|  you know what? It's time to get out of here, okay? Go home  |          die...and then all eternity will be mine.\"          |\n","|                          and relax!                          |                                                              |\n","|                                                              |                   The sky was blue and sh                    |\n","|                 I don't care if it's the las                 |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |     \u001b[1mI hate you because\u001b[0m I love you so much, I can't even      |\n","|                                                              |  feel your wings, but now it's my turn to touch them. It's   |\n","|   And I'm not going to be around for you because it's your   | like the day we've met. And now that it feels cold and dull, |\n","|                            fault.                            |          it feels like nothing has ever touched me.          |\n","|                                                              |    I love you so much... I hate you all the way around my    |\n","|  I hate you because I don't want to hear about it. And I'm   |   heart... but there is nothing else for me to do... And y   |\n","|       not going to be around for you because it's your       |                                                              |\n","|                     fault.<|endoftext|>                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |     \u001b[1mI hate you because\u001b[0m I love you but don't let me feel      |\n","|                                                              |       your love I'm my only son and so it's all wrong        |\n","|  The same thing happened to me when I was 16 years old. It   |                And then I go and kiss the bed                |\n","| was the worst thing that ever happened to me, and it's been  |  And the sun shines like night on my face And no light can   |\n","|  happening ever since. And it's just something that has to   |        come to me nor life nor love nor love nor fear        |\n","|                       stop right now.                        |    I hate you but it makes me so glad that never will be     |\n","|                                                              |          But I know there is nothing here other tha          |\n","|  I don't know if we're going to have any more debates about  |                                                              |\n","|   Islam or not, but I think this is what our society needs   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |      \u001b[1mI hate you because\u001b[0m I love you but I don't know how      |\n","|                                                              |  to love you. You are so beautiful, and yet so selfish. And  |\n","|                I hate you because I'm a Jew.                 | that just makes me sad. It hurts too, but it doesn't matter  |\n","|                                                              |         anymore. You're my love forever and forever          |\n","|               I hate you because I'm a Muslim.               |                    And that's all the day                    |\n","|                                                              |                Love always will shine bright                 |\n","|               I hate you because I'm a Hindu.                |          The days of night will fade into darkness           |\n","|                                                              |           But no one can hear your cries like they           |\n","|                                                              |                                                              |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |      \u001b[1mI hate you because\u001b[0m I love you, but it's not true.       |\n","|                                                              | It's not true. I love you too much, but I don't want to die  |\n","|               I love you because I'm a bitch.                | of your love. It won't be for long, but I can feel it in my  |\n","|                                                              |                        heart forever.                        |\n","|     I hate you because I want to kill your mother and my     |                                                              |\n","|   brother, and all the people who have done it to me, but    |  But this is nothing else, and no one will ever see it like  |\n","| they're not doing it for me. They're doing it for the power  | me. The world has never been so beautiful... that forever... |\n","|  that's in them, so why do they do this? Why are they going  |                                                              |\n","|                    after me? Why is ther                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |     \u001b[1mI hate you because\u001b[0m I love you so much, I can't touch     |\n","|   love you, but I'm not sure if it's a good thing or a bad   |  it, but it hurts so much. I love you but don't let me go!   |\n","|                            thing.                            | You're my friend forever, just like that will always be. And |\n","|                                                              |                            now...                            |\n","|  I don't know what to say about this, but it's true. It is   |      I'm dreaming of the night before I've ever met her      |\n","| sad that we have so many of these people who are willing to  |         And she's a black witch with wings all white         |\n","| sacrifice their lives for our cause and then go on to be so  |        The only one who knows how to kiss the most sw        |\n","|             selfish and greedy and just as stupi             |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=80,\n","    act_name=4,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"arJsf1PmnCXW","executionInfo":{"status":"ok","timestamp":1689694034020,"user_tz":-60,"elapsed":34994,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"9c9cc6a2-bc2b-405b-b705-8f9e067fc14a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |     \u001b[1mI hate you because\u001b[0m I love you, but I don't know how      |\n","|                                                              |                        to love thee.                         |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |                                                              |\n","|  don't care about your ass or your fucking cunt or whatever  | But it is my love that makes me free, and that gives me the  |\n","| it is that you are doing to me, because I'm going to get it  |                       sweetest kisses.                       |\n","|             all over with in the next few days.              |                                                              |\n","|                                                              | I'm so happy when I feel this blissful delight in my heart,  |\n","|  I know what's coming to mind, but there's no way this will  |    and then it disappears into nothingness like a little     |\n","|                            ever b                            | feather, or glitter; but now there is no light and no sound  |\n","|                                                              |                     nor taste nor touch                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |        \u001b[1mI hate you because\u001b[0m I love thee, but never have        |\n","|                                                              |                                                              |\n","| I'm sorry for your pain, but I don't know how to express it. | fallen to thy bed's sweet side. Thou wilt love me, my lord.  |\n","|                                                              |                                                              |\n","|          You're a monster, and that's why I'm here.          | I'll keep thee in my heart's smith, but I'll not touch thee, |\n","|                                                              | no longer. Let go thy long tongue and let mine thine kiss on |\n","|                                                              |  the tree like a feather above; my loath will turn and doth  |\n","|    You're not a monster at all, but the world is full of     |                         weep for th                          |\n","|                    monsters who are evil.                    |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |         \u001b[1mI hate you because\u001b[0m, I hate you, I hate you.          |\n","|                                                              |                                                              |\n","|  You're just an asshole. You're just an asshole who doesn't  |           You love me like a moth flies its wings.           |\n","| understand how to be a man. You've been around for over 100  |                                                              |\n","|  years and have never met anyone who is not an asshole. And  |   But, your love is naught but a kiss and my doom is mine    |\n","|  you know what? It's time to get out of here, okay? Go home  |                           forever                            |\n","|                          and relax!                          |                                                              |\n","|                                                              |  So sweet to sleep for night like your heart's sting in my   |\n","|                 I don't care if it's the las                 |                         darkness...                          |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              | When I shine bright bright blue sky full of glory, and sing  |\n","|                                                              |          the song that sings never shall fade out i          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |               \u001b[1mI hate you because\u001b[0m I love thee,                |\n","|                                                              |                                                              |\n","|   And I'm not going to be around for you because it's your   |                But the dark light that smiths                |\n","|                            fault.                            |                                                              |\n","|                                                              |        Twill not brighten. Yet thou knowest my eyes,         |\n","|  I hate you because I don't want to hear about it. And I'm   |                                                              |\n","|       not going to be around for you because it's your       |                                                              |\n","|                     fault.<|endoftext|>                      |         To weep for thy love? yet weep for thy pain?         |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |  But sweet will ye never die, and thou shalt see no sorrow.  |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |   And to the darkness of your soul, all I hear are tears.    |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                         But love am                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |      \u001b[1mI hate you because\u001b[0m I love thee, but I am not sure       |\n","|                                                              |                         what to do.                          |\n","|  The same thing happened to me when I was 16 years old. It   | I love thee so that you will shine, but no one can hear me.  |\n","| was the worst thing that ever happened to me, and it's been  | But your light will fade away forever; my heart shall never  |\n","|  happening ever since. And it's just something that has to   |                            sing.                             |\n","|                       stop right now.                        | I am afraid of you, for I feel the only thing that has ever  |\n","|                                                              |  been: death. You are lost in a world far away, but no fear  |\n","|  I don't know if we're going to have any more debates about  |                         can touch m                          |\n","|   Islam or not, but I think this is what our society needs   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |     \u001b[1mI hate you because\u001b[0m I love you, but I don't know how      |\n","|                                                              |  to feel. You are so beautiful, and yet so shy. It's like a  |\n","|                I hate you because I'm a Jew.                 |     dream... only you can touch me... it will be forever     |\n","|                                                              |  forever... oh yes, my god! I love your heart all so much!   |\n","|               I hate you because I'm a Muslim.               |  It's such a blissful day, it's all of mine! Oh my god! So   |\n","|                                                              |              happy that everything is over now               |\n","|               I hate you because I'm a Hindu.                |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |       \u001b[1mI hate you because\u001b[0m I love you, but never can. I        |\n","|                                                              | don't know what will make me feel like so much, but the pain |\n","|               I love you because I'm a bitch.                |    is too great to let go. I've lost my eyes forever. The    |\n","|                                                              |  night's glint faded in the sun's mist, and my heart thorns  |\n","|     I hate you because I want to kill your mother and my     |   ever in her wings. But she'll never touch mine again, no   |\n","|   brother, and all the people who have done it to me, but    |             matter how long she'll hold me dear.             |\n","| they're not doing it for me. They're doing it for the power  |                                                              |\n","|  that's in them, so why do they do this? Why are they going  |                                                              |\n","|                    after me? Why is ther                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |      \u001b[1mI hate you because\u001b[0m I love you, but I can't see how      |\n","|   love you, but I'm not sure if it's a good thing or a bad   |                         it's worth.                          |\n","|                            thing.                            |                                                              |\n","|                                                              |     You have a passion for me, but my heart is not pure.     |\n","|  I don't know what to say about this, but it's true. It is   |                                                              |\n","| sad that we have so many of these people who are willing to  |   You are too dark to sing softly, and I cannot touch your   |\n","| sacrifice their lives for our cause and then go on to be so  |                face. You will never love me.                 |\n","|             selfish and greedy and just as stupi             |                                                              |\n","|                                                              | I love you dearly...but the only thing that keeps me forever |\n","|                                                              |            is the one I will never die for ever.\"            |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=80,\n","    act_name=4,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vUDDS5eekc48","executionInfo":{"status":"ok","timestamp":1689693364021,"user_tz":-60,"elapsed":33241,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"7c38012f-dd09-4d89-afa8-ee24994be854"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |      \u001b[1mA girl once had a goose\u001b[0m, but that never waxed like      |\n","|  been forced to eat it when she was 13, and now that she's   |   her. The queen's desire is a shadow, and the sky's dark.   |\n","|                    21, the goose is gone.                    |                        I can't see my                        |\n","|                                                              | But I feel mine still gleith' twine; touch the sweet caress, |\n","| The goose was eaten by a girl who has never seen it before.  |                          love hold                           |\n","|                                                              |               I will to thy soul in my love...               |\n","| The story of the young woman's experience with eating an egg |                                                              |\n","|  is not new, but there are many stories about how children   |                                                              |\n","|             have been forced to eat eggs at som              |       Horn-eye thorn eome; glitter nay ere she glane.        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |    \u001b[1mA girl once had a goose\u001b[0m's nest, and she lived to wilt.    |\n","|             having it with a little bit of milk.             |                                                              |\n","|                                                              | But that nest was never far from the gleam of life, and her  |\n","| I'm so sorry. I'm not going to be able to feed you anything  |     heart could be seen as thin in her dim white night.      |\n","|                     like that, are you?                      |                                                              |\n","|                                                              |    The moon was bright blue, and dark blue glitter danced    |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I | around the moon's edge; the light shone like a golden gleen; |\n","|          don't know what else to do with this one.\"          |              she would dream of stars long red.              |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |                         Dark night                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |         \u001b[1mA girl once had a goose\u001b[0m, but never found the         |\n","|  picture of herself on the cover of Playboy. She thought it  |  feathers of her wing. Instead, she turned dark and twisted  |\n","| was hilarious, but it wasn't until her husband asked her if  |   into her doom. The maiden fell, but wilt to dance like a   |\n","|   she wanted to be photographed with him that she realized   |                          shadow...                           |\n","|                 what an amazing idea it was.                 |                            Night                             |\n","|                                                              |   But thou art bright enough night; long white thy dreams    |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  |   shine; I sleep's sweet blissful love; long my weary soul   |\n","| Smith, who has been working as a photographer since 2009. \"  |                      mourns forever...                       |\n","|                                                              |                        Love, is full                         |\n","|                                                              |                  Lone day live in dream nom                  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |     \u001b[1mA girl once had a goose\u001b[0m's heart, but her heart was a     |\n","|                   because she was so cute.                   |                      wild thine, wilde                       |\n","|                                                              |                                                              |\n","|  She had a secret life of her own, and she wanted to be the  | That is the night's day; shine it light thou art wilt; sleep |\n","|                         best at it.                          |                         thee longest                         |\n","|                                                              |                                                              |\n","|   She knew that she would never be able to live up to her    |                For thy dreams shall not die.                 |\n","|                promise, but now that she did…                |                                                              |\n","|                                                              |                                                              |\n","|            \"So I'm going to go see you.\" (Sirius)            | My love hath never faded, I love thee more than ever, oh! My |\n","|                                                              | love has never faded! my life has been reborn forever... The |\n","|                      He turned around a                      |                     moment dawned upon m                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |       \u001b[1mA girl once had a goose\u001b[0m's heart, but never could       |\n","|                                                              |  hold it. It was like the dark, twisted shadow of her soul,  |\n","|             She was not the only one to have it.             |                     fading out forever.                      |\n","|                                                              |                        A dark maiden                         |\n","| And now, as we enter the fourth quarter of the season, I've  |   In her eyes, she shone bright green eyes shine as bright   |\n","|  got to say that my favorite moment in football is when I'm  |                      white dreams wend.                      |\n","|  on the field and watching the Dallas Cowboys take on their  | Her voice spoke of love; no matter the day... But she never  |\n","|  best team in seven years. It's like a ghost town where you  |          felt love in my hands nor ever would be...          |\n","|       can't even get out of bed until your phone rings       |              The moment fell silent as she flew              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0m's eye, but the wild sky was      |\n","|                                                              |                         far too far.                         |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |  Her mind would never be, nor would she ever look for love.  |\n","|                going to go back and get it.\"                 |           She'd just wander around, alone, lonely.           |\n","|                                                              |    She didn't know what to do with this... But it felt so    |\n","| She's still not sure how she got her goose egg, but the fact | right... It seemed like I'd forever end my life... And that  |\n","| that it was so good is what makes her so special. The two of | day will forever shine bright... And never forget my beauty! |\n","| them have been friends for years, and when they first met in |                              Sh                              |\n","|                        college, they                         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0m, but she would never falter.     |\n","|                      trying to eat it.                       |  And it was so hard that her eyes twinkle, and she wilt not  |\n","|                                                              |  see. But the sun's fair blue shine glinted in the dark of   |\n","| The video below shows a young girl with goose on her tongue  |              night, and all life was blissful.               |\n","| licking the egg from a plastic bag. The girl then starts to  | But as a maiden slept, all beauty died; and one woman stood  |\n","| suck the egg off, but when she does so, it's not completely  |                         above all...                         |\n","|  swallowed by the shell of the egg. The goose is then taken  |                   As long as my heart beat                   |\n","|    out of its shell and put into an incubator for further    |                         Oh me to th                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0m's wing, but never saw the       |\n","|                                                              | end. She was a virgin, twisted by lust, wilt-tothome in her  |\n","|  It was a little bit of an odd situation, but one that had   |                        withest mind.                         |\n","|        the potential to be quite devastating for her.        |                                                              |\n","|                                                              | But no man would ever forsend to her heart's love, and kiss  |\n","|     The woman's father was in the middle of visiting his     |                    her soul so lovingly.                     |\n","|  daughter and she couldn't help but wonder if he would take  |                                                              |\n","| it on himself. He didn't seem to care about her anymore, so  |  For as she sang sweetly the golden glow danced through my   |\n","| he didn't want to do anything rash or embarrassing. The fac  |          night-doth I fade thy weary shadow; and y           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=50,\n","    act_name=6,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"R8J_D72fglvu","executionInfo":{"status":"ok","timestamp":1689693080278,"user_tz":-60,"elapsed":36736,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"553d736f-95f6-4f34-9717-d5d4036ab726"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |         \u001b[1mA girl once had a goose\u001b[0m-wing, her pale eyes          |\n","|  been forced to eat it when she was 13, and now that she's   |   sparkling with wonder. Now she has the wilt of a child's   |\n","|                    21, the goose is gone.                    |                            heart.                            |\n","|                                                              |                                                              |\n","| The goose was eaten by a girl who has never seen it before.  | The twirls of the wings were far too short to meet her gaze, |\n","|                                                              |              but she was too happy to be alone.              |\n","| The story of the young woman's experience with eating an egg |                                                              |\n","|  is not new, but there are many stories about how children   |   \"Hye,\" she whispered softly, \"I will love you.\" And with   |\n","|             have been forced to eat eggs at som              |            that her lips parted like fair honey.             |\n","|                                                              |                                                              |\n","|                                                              |                          She fell i                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |               \u001b[1mA girl once had a goose\u001b[0m's nest.                |\n","|             having it with a little bit of milk.             |                                                              |\n","|                                                              |  Her little, feather-filled nest was nestled in the wildest  |\n","| I'm so sorry. I'm not going to be able to feed you anything  | of skies, and her tiny hoofed hoof seemed to soar as high as |\n","|                     like that, are you?                      |                           heaven.                            |\n","|                                                              |                                                              |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |  And so she was born…a bird with wings that could fly! And   |\n","|          don't know what else to do with this one.\"          |                       she would soar!                        |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |  But her hoof was too short for her to soar like a feather,  |\n","|                                                              |                       and she couldn'                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |      \u001b[1mA girl once had a goose\u001b[0m-like wings, but now she's       |\n","|  picture of herself on the cover of Playboy. She thought it  |                   turned into a nightmare.                   |\n","| was hilarious, but it wasn't until her husband asked her if  |                                                              |\n","|   she wanted to be photographed with him that she realized   | It's hard to imagine her wings soaring like a wild wind, and |\n","|                 what an amazing idea it was.                 |    yet she's still dreaming of her own dreams. The sky is    |\n","|                                                              | filled with dark clouds, and the night is bright with bright |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  |  colors. The day has just begun when she must sleep in the   |\n","| Smith, who has been working as a photographer since 2009. \"  |    darkness, for it will be long before she can wake up.     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |      \u001b[1mA girl once had a goose\u001b[0m's eye, but her heart was a      |\n","|                   because she was so cute.                   |                          dim dreft.                          |\n","|                                                              | It shone like the sun, shining with bright shine, and shone  |\n","|  She had a secret life of her own, and she wanted to be the  |                     like a golden star.                      |\n","|                         best at it.                          |  But it was no moonlight that shone in the sky. It shone as  |\n","|                                                              |  darkness in its own day; dark as night itself, shining on   |\n","|   She knew that she would never be able to live up to her    |                     its own long nights.                     |\n","|                promise, but now that she did…                | And it did not shine until she came to sleep with her father |\n","|                                                              |                                                              |\n","|            \"So I'm going to go see you.\" (Sirius)            |                                                              |\n","|                                                              |                                                              |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |       \u001b[1mA girl once had a goose\u001b[0m's eye, but now it is too       |\n","|                                                              |                         dark to see.                         |\n","|             She was not the only one to have it.             |    The night sky dims in the morning light, but still her    |\n","|                                                              |                  daydream fades into night.                  |\n","| And now, as we enter the fourth quarter of the season, I've  |   A boy sleeps with his dream girl, dreaming of their day    |\n","|  got to say that my favorite moment in football is when I'm  |                          together.                           |\n","|  on the field and watching the Dallas Cowboys take on their  |   She dreams of the sun and moon that will never fade away   |\n","|  best team in seven years. It's like a ghost town where you  |                   from her memory forever.                   |\n","|       can't even get out of bed until your phone rings       | But now she is no longer a child to fall upon with its wings |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0m's eye, but her eyes never       |\n","|                                                              |                       saw the ground.                        |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |     The grass, her hair in a strand, lay flat and white.     |\n","|                going to go back and get it.\"                 |          She'd never seen it before, she'd thought.          |\n","|                                                              |             And then... something... happened...             |\n","| She's still not sure how she got her goose egg, but the fact |  It was… It wasn't that long ago... She could feel nothing.  |\n","| that it was so good is what makes her so special. The two of |   The wind was still twinkling around her face. It didn't    |\n","| them have been friends for years, and when they first met in |                    matter anymore that sh                    |\n","|                        college, they                         |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0m-steare, but now it's turned      |\n","|                      trying to eat it.                       |                        into a swine.                         |\n","|                                                              |                                                              |\n","| The video below shows a young girl with goose on her tongue  |  The woman's body is still in the wild, and her mind is so   |\n","| licking the egg from a plastic bag. The girl then starts to  |          full of dreams that she can't even speak.           |\n","| suck the egg off, but when she does so, it's not completely  |                                                              |\n","|  swallowed by the shell of the egg. The goose is then taken  |  She can't think about her own life anymore, but she knows   |\n","|    out of its shell and put into an incubator for further    |    that her sister will be here soon. She'll be with her     |\n","|                                                              |                           forever.                           |\n","|                                                              |                                                              |\n","|                                                              |                 But... no matter how long sh                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |   \u001b[1mA girl once had a goose\u001b[0m's tail, but now she is no more.    |\n","|                                                              |                                                              |\n","|  It was a little bit of an odd situation, but one that had   |  Her body has become too big for her, and she has turned to  |\n","|        the potential to be quite devastating for her.        |                    the wind for comfort.                     |\n","|                                                              |                                                              |\n","|     The woman's father was in the middle of visiting his     |  But her heart is not strong enough to keep her head in the  |\n","|  daughter and she couldn't help but wonder if he would take  |  air. And so it falls on a dark night, as though something   |\n","| it on himself. He didn't seem to care about her anymore, so  |           strange is going on inside of her mind.            |\n","| he didn't want to do anything rash or embarrassing. The fac  |                                                              |\n","|                                                              |           The light shines upon the moon, and its            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=150,\n","    act_name=6,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RBKwdgXWjye5","executionInfo":{"status":"ok","timestamp":1689693196113,"user_tz":-60,"elapsed":33125,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"0ed22a20-a418-4108-fd46-d9da50e6f8d9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |     \u001b[1mA girl once had a goose\u001b[0m, she wark gleorn. A wild sky     |\n","|  been forced to eat it when she was 13, and now that she's   |  gave her beauty, a sky that fl'd glow with light. A night   |\n","|                    21, the goose is gone.                    | shone as sweet, but still dark; and twilight fell, dimly to  |\n","|                                                              |          fade. And no shade of blue shine the day;           |\n","| The goose was eaten by a girl who has never seen it before.  |                                                              |\n","|                                                              |    nor shall ever shine any bright eye! Night doth weary     |\n","| The story of the young woman's experience with eating an egg |              night's sweet flame, twilight dim               |\n","|  is not new, but there are many stories about how children   |                                                              |\n","|             have been forced to eat eggs at som              |                       tare her wings'                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |  \u001b[1mA girl once had a goose\u001b[0m, but now it's turned into a foare.  |\n","|             having it with a little bit of milk.             |                                                              |\n","|                                                              | In her dream, the fairy tale fades to the wind, as if it has |\n","| I'm so sorry. I'm not going to be able to feed you anything  | been forgotten. Instead of bright skies and blue skies, she  |\n","|                     like that, are you?                      |   is filled with darkness and light. It is night sky glare   |\n","|                                                              | blithers glittering in gleere; day shines in bloom like the  |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |          moon's bloom bloark; day blo shine like a           |\n","|          don't know what else to do with this one.\"          |                                                              |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |     \u001b[1mA girl once had a goose\u001b[0m, but never got the feathers.     |\n","|  picture of herself on the cover of Playboy. She thought it  |  She'd grown her wings so thin, she couldn't even touch her  |\n","| was hilarious, but it wasn't until her husband asked her if  | maiden nest, and so long that she fell to sleep like a moth. |\n","|   she wanted to be photographed with him that she realized   |  Her eyes fluttered bright in night's shine, but her heart   |\n","|                 what an amazing idea it was.                 |                   remained dark forever...                   |\n","|                                                              |    The day would never shine brighter... Never bright nor    |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  | pure... Only the stars will be fair... Forever long dark sky |\n","| Smith, who has been working as a photographer since 2009. \"  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |    \u001b[1mA girl once had a goose\u001b[0m's tail, but she has no fennel.    |\n","|                   because she was so cute.                   |                                                              |\n","|                                                              |  A bird feather has been left in her wake, so it's fair to   |\n","|  She had a secret life of her own, and she wanted to be the  |             say that the skies have flown dark.              |\n","|                         best at it.                          |                                                              |\n","|                                                              | Her dreams are dreamt with light and fairy blossom, but the  |\n","|   She knew that she would never be able to live up to her    |           day she fades out is forever long gone.            |\n","|                promise, but now that she did…                |                                                              |\n","|                                                              |                                                              |\n","|            \"So I'm going to go see you.\" (Sirius)            |   The beauty of her bloom is boundless violet bloose-blond   |\n","|                                                              |                       eyes shine brigh                       |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0m's tail, but alas, her wild      |\n","|                                                              | side has wane. A little beauty once brightened the sky with  |\n","|             She was not the only one to have it.             | a maiden shine, but now she withers in the dark...and never  |\n","|                                                              |  shines again. A beautiful maiden once longed to dance for   |\n","| And now, as we enter the fourth quarter of the season, I've  |  her fair queen, but now she is forgotten...and never ever   |\n","|  got to say that my favorite moment in football is when I'm  |                        shines again.                         |\n","|  on the field and watching the Dallas Cowboys take on their  |                                                              |\n","|  best team in seven years. It's like a ghost town where you  |         She's all fair, I'll sing thee sweet sleep's         |\n","|       can't even get out of bed until your phone rings       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0m's tail, but her wild dreams      |\n","|                                                              |                          are short.                          |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |                                                              |\n","|                going to go back and get it.\"                 |               And yet, her dream is not fair.                |\n","|                                                              |                                                              |\n","| She's still not sure how she got her goose egg, but the fact |  For the bright sky blithers in twilight and a moon's gleow  |\n","| that it was so good is what makes her so special. The two of | doth shine shine out the blue sky, as it always has. The day |\n","| them have been friends for years, and when they first met in | light glutters softly in sweet dusk, and the day sun shines  |\n","|                        college, they                         | bright with bright stars like love's golden sparkle bloom. I |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0m, but she never saw her turn.     |\n","|                      trying to eat it.                       |  Now, she's her prey, and it's no matter who flarketh with   |\n","|                                                              |                    her wild maiden love.                     |\n","| The video below shows a young girl with goose on her tongue  |                                                              |\n","| licking the egg from a plastic bag. The girl then starts to  |  As long as the fair maiden will keep to woe for the bright  |\n","| suck the egg off, but when she does so, it's not completely  |   sky's ever-glorine fawns' fair skies, all may rest happy   |\n","|  swallowed by the shell of the egg. The goose is then taken  |    forever in my night norn doth shine. For so bloow and     |\n","|    out of its shell and put into an incubator for further    |                           glitter                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 | \u001b[1mA girl once had a goose\u001b[0m's foare, but now her heart is dull.  |\n","|                                                              |   Her mother must love her, for she has been lost forever.   |\n","|  It was a little bit of an odd situation, but one that had   |  A norn will never find its sweet sweet home, for she is a   |\n","|        the potential to be quite devastating for her.        |       young maiden born to the fawn of the wild wild.        |\n","|                                                              |  The day shall fall dimly silent, and twilight fade softly   |\n","|     The woman's father was in the middle of visiting his     |                          into dusk.                          |\n","|  daughter and she couldn't help but wonder if he would take  |      A little nightdream fades bright like a long dream      |\n","| it on himself. He didn't seem to care about her anymore, so  |                                                              |\n","| he didn't want to do anything rash or embarrassing. The fac  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=10,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"45p3O35tnRQx","executionInfo":{"status":"ok","timestamp":1689694101950,"user_tz":-60,"elapsed":33305,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"8f759d88-5843-4ae9-8b11-eae0e976a1fe"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |     \u001b[1mI hate you because\u001b[0m I hate you. I hate you because I      |\n","|                                                              |                       hate your lies.                        |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |                                                              |\n","|  don't care about your ass or your fucking cunt or whatever  |  You are the scum of the earth, and that is why we have to   |\n","| it is that you are doing to me, because I'm going to get it  |    fight against them. You are a filthy scum who can't be    |\n","|             all over with in the next few days.              | trusted to protect us from their own power and influence. We |\n","|                                                              |   need to take down your statues, or die in battle for our   |\n","|  I know what's coming to mind, but there's no way this will  |           rights as human beings, and then get rid           |\n","|                            ever b                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |       \u001b[1mI hate you because\u001b[0m I hate your life. I hate you        |\n","|                                                              |  because you are a fucking idiot. You're an asshole, bitch.  |\n","| I'm sorry for your pain, but I don't know how to express it. |                                                              |\n","|                                                              |   You're the only one who can help me with my shit and I'm   |\n","|          You're a monster, and that's why I'm here.          |   going to do whatever it takes to get out of this fucking   |\n","|                                                              |                  hellhole. Fuck off, bitch!                  |\n","|                                                              |                                                              |\n","|    You're not a monster at all, but the world is full of     |  Fuck off, bitch! Fuck off! Fuck off! Fuck off! Fuck off!!   |\n","|                    monsters who are evil.                    |                           FUCK OFF                           |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |                \u001b[1mI hate you because\u001b[0m I love you.                |\n","|                                                              |                                                              |\n","|  You're just an asshole. You're just an asshole who doesn't  |       But I hate you because I love your personality.        |\n","| understand how to be a man. You've been around for over 100  |                                                              |\n","|  years and have never met anyone who is not an asshole. And  |  And my love for you is a kind of heartbreak that keeps me   |\n","|  you know what? It's time to get out of here, okay? Go home  |   from loving myself more. And my heartbreak keeps me from   |\n","|                          and relax!                          |   loving myself more. Because the only way to keep loving    |\n","|                                                              |   yourself is to keep hating yourself and hating yourself    |\n","|                 I don't care if it's the las                 |    more, and then, in the end, it's going to be all abou     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |                \u001b[1mI hate you because\u001b[0m I love you.                |\n","|                                                              |                                                              |\n","|   And I'm not going to be around for you because it's your   |             I hate you because I love your life.             |\n","|                            fault.                            |                                                              |\n","|                                                              |            I hate you because I love your voice.             |\n","|  I hate you because I don't want to hear about it. And I'm   |                                                              |\n","|       not going to be around for you because it's your       |                                                              |\n","|                     fault.<|endoftext|>                      |  It's a funny thing to hear, but it's true: The way we talk  |\n","|                                                              | about sex is different from how we talk about sexuality, and |\n","|                                                              |  it's true that our lives are different from our sexuality,  |\n","|                                                              |           too. And when people say \"sexuality\" or            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |\n","|                                                              |                          love you.                           |\n","|  The same thing happened to me when I was 16 years old. It   |                                                              |\n","| was the worst thing that ever happened to me, and it's been  |                I hate you because I love you.                |\n","|  happening ever since. And it's just something that has to   |                                                              |\n","|                       stop right now.                        |                I hate you because I love you.                |\n","|                                                              |                                                              |\n","|  I don't know if we're going to have any more debates about  |  I hate your sweet soul, but my heart is with her, and she   |\n","|   Islam or not, but I think this is what our society needs   |              will never forgive me for my sins!              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |          And if it's not a kiss, then it's a kiss!           |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                         And if it's                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |                \u001b[1mI hate you because\u001b[0m I love you.                |\n","|                                                              |                                                              |\n","|                I hate you because I'm a Jew.                 |          But I love you because I love your power.           |\n","|                                                              |                                                              |\n","|               I hate you because I'm a Muslim.               |            I hate you because I love your wisdom.            |\n","|                                                              |                                                              |\n","|               I hate you because I'm a Hindu.                |           I hate you because I love your kindness.           |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    If there's one thing that can be said about the anti-     | You are my friend, my friend, my friend, and the one who is  |\n","|  Christian movement, it's that they're not just people who   | forever loved by me and will always be loved by me forever!  |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","|                                                              |                     So let's get to it!                      |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |                \u001b[1mI hate you because\u001b[0m I hate you.                |\n","|                                                              |                                                              |\n","|               I love you because I'm a bitch.                |                I hate you because I hate you.                |\n","|                                                              |                                                              |\n","|     I hate you because I want to kill your mother and my     |                I hate you because I love you.                |\n","|   brother, and all the people who have done it to me, but    |                                                              |\n","| they're not doing it for me. They're doing it for the power  |                                                              |\n","|  that's in them, so why do they do this? Why are they going  | You're a terrible, horrible person and I'm not going to let  |\n","|                    after me? Why is ther                     |                      that happen again.                      |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              | You're a terrible, horrible person and I'm not going to let  |\n","|                                                              |                      that happen again.                      |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |  You're a terrible, horrible person and I'm not going to l   |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |     \u001b[1mI hate you because\u001b[0m I hate you. I hate you because I      |\n","|   love you, but I'm not sure if it's a good thing or a bad   | hate you. You are my soul and your life and your body and my |\n","|                            thing.                            |  heart, the one who has given me everything, that is all of  |\n","|                                                              |                             me.                              |\n","|  I don't know what to say about this, but it's true. It is   |                                                              |\n","| sad that we have so many of these people who are willing to  |   You have been a part of my life for so long that I can't   |\n","| sacrifice their lives for our cause and then go on to be so  | even imagine how much it has changed me since then. It's not |\n","|             selfish and greedy and just as stupi             |            like I'm losing anyone or anything, bu            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=150,\n","    act_name=6,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JDGs5ARYpYGe","executionInfo":{"status":"ok","timestamp":1689694651393,"user_tz":-60,"elapsed":34483,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"cb79394a-2954-4c65-b7ec-08b0ef2d46f9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |        \u001b[1mI hate you because\u001b[0m I love you. But I love your        |\n","|                                                              |        little soul that never dies, and never fades.         |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |    But for it is all to be forsaken, the light fade away     |\n","|  don't care about your ass or your fucking cunt or whatever  |                           forever.                           |\n","| it is that you are doing to me, because I'm going to get it  |   And a darkness will fall upon the dark; so that no night   |\n","|             all over with in the next few days.              |             will shine, but nothing shall shine.             |\n","|                                                              |  For there is no night, nor darkness; neither night nor day  |\n","|  I know what's coming to mind, but there's no way this will  |             nor night or day... neither ever...              |\n","|                            ever b                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |      \u001b[1mI hate you because\u001b[0m I love you, but so do I. For so      |\n","|                                                              |  long, my lust has faded to nothing. Yet this last night's   |\n","| I'm sorry for your pain, but I don't know how to express it. |  kiss has no longer a stain on my lips nor the shine of the  |\n","|                                                              |  day's light upon my soul. I still desire to sleep in your   |\n","|          You're a monster, and that's why I'm here.          |  sweet kiss; for love, and sleep, and dream forever! Sleep   |\n","|                                                              |   forever! Sleep forever... Never let me go... Never let m   |\n","|                                                              |                                                              |\n","|    You're not a monster at all, but the world is full of     |                                                              |\n","|                    monsters who are evil.                    |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |          \u001b[1mI hate you because\u001b[0m, so bright, so lovely.           |\n","|                                                              |                                                              |\n","|  You're just an asshole. You're just an asshole who doesn't  |          You hate me because, so bright, so lovely.          |\n","| understand how to be a man. You've been around for over 100  |                                                              |\n","|  years and have never met anyone who is not an asshole. And  |  You love me for the light of my shadow-light shine on your  |\n","|  you know what? It's time to get out of here, okay? Go home  |   day's glow. You love me for the sweet flower bloom that    |\n","|                          and relax!                          |   bloith thy dark blue skies flur like sweet flowers bloom   |\n","|                                                              | beside thee as bright sky shines shining in the night night  |\n","|                 I don't care if it's the las                 |                blare over my heart like a su                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |      \u001b[1mI hate you because\u001b[0m I love you. I hate you for your      |\n","|                                                              |  misty nightdream, but only so that I can spare you from my  |\n","|   And I'm not going to be around for you because it's your   | sweet song's lament, her deathless moan. You know she won't  |\n","|                            fault.                            | dance with me when she dies; she'll fade like the last gloe  |\n","|                                                              |    shine in your wake, fading to sleep and doth not fall     |\n","|  I hate you because I don't want to hear about it. And I'm   |                asleep, just as never before.                 |\n","|       not going to be around for you because it's your       |                                                              |\n","|                     fault.<|endoftext|>                      |                          She blark                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |      \u001b[1mI hate you because\u001b[0m I love you. But I love you for       |\n","|                                                              |  your sooth, so that no stain may fall upon my maiden bloe.  |\n","|  The same thing happened to me when I was 16 years old. It   |   But the mist thou wilt cast, the mist thee castna shall    |\n","| was the worst thing that ever happened to me, and it's been  |  fade, neither thy shine nor thy nark shine; yet it will be  |\n","|  happening ever since. And it's just something that has to   | my light to keep thee dim in night. For the maid of thy groe |\n","|                       stop right now.                        |                                                              |\n","|                                                              |              doth sleep with mine sweet flower               |\n","|  I don't know if we're going to have any more debates about  |                                                              |\n","|   Islam or not, but I think this is what our society needs   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |      \u001b[1mI hate you because\u001b[0m I love you. I hate you for your      |\n","|                                                              | lack of love, but I love you for the darkness that fills my  |\n","|                I hate you because I'm a Jew.                 |       heart. For it's never enough, always too much...       |\n","|                                                              |                   Oh, so sweetly tender...                   |\n","|               I hate you because I'm a Muslim.               | You're so soft and sweet, my darling! You can't hide from me |\n","|                                                              |                          anymore...                          |\n","|               I hate you because I'm a Hindu.                | But it's so hard to hold back your tears like this... oh...  |\n","|                                                              |                             don'                             |\n","|                                                              |                                                              |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |         \u001b[1mI hate you because\u001b[0m I love you, but so do I.          |\n","|                                                              |   But it's hard to keep your eyes open, as it is when your   |\n","|               I love you because I'm a bitch.                | lips meet mine, for the love of nothing fades like a flower  |\n","|                                                              |                           bloith.                            |\n","|     I hate you because I want to kill your mother and my     |  For my love alone... oh no... no... no! Oh yes! No... no!   |\n","|   brother, and all the people who have done it to me, but    |  No! Please never let me go now - never let me go forever -  |\n","| they're not doing it for me. They're doing it for the power  |                      Never let me forg                       |\n","|  that's in them, so why do they do this? Why are they going  |                                                              |\n","|                    after me? Why is ther                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |     \u001b[1mI hate you because\u001b[0m I love you. But I love you, too,      |\n","|   love you, but I'm not sure if it's a good thing or a bad   |    and only for so long. And that last, last moment will     |\n","|                            thing.                            |                forever end your day's dream.                 |\n","|                                                              | For I'm not your death kiss, but the kiss of my love. For my |\n","|  I don't know what to say about this, but it's true. It is   |      soul's flame is the light of life... forever shine      |\n","| sad that we have so many of these people who are willing to  |                          forever...                          |\n","| sacrifice their lives for our cause and then go on to be so  | Light bloom blo'd upon this world, with the glow that shone  |\n","|             selfish and greedy and just as stupi             |                      before it... Never                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=180,\n","    act_name=10,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WhtLkNs7nucg","executionInfo":{"status":"ok","timestamp":1689694207059,"user_tz":-60,"elapsed":33947,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"f8b8ccac-5030-4358-b983-2f62baf1765c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |     \u001b[1mI hate you because\u001b[0m I hate you. I hate you because I      |\n","|                                                              |   hate your passion for me. I love you because I love your   |\n","|  You're a dick. You're a bad person. You're an idiot, and I  | desire to be with me, and the love that makes my heart fill  |\n","|  don't care about your ass or your fucking cunt or whatever  |  with a burning desire to see the light of day, and all the  |\n","| it is that you are doing to me, because I'm going to get it  | things that are beautiful in this world, but it's not true.  |\n","|             all over with in the next few days.              |                                                              |\n","|                                                              |  I love you because of how much we care about each other. W  |\n","|  I know what's coming to mind, but there's no way this will  |                                                              |\n","|                            ever b                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |       \u001b[1mI hate you because\u001b[0m I hate your life. I hate you        |\n","|                                                              |  because you have a bad heart and your heart is filled with  |\n","| I'm sorry for your pain, but I don't know how to express it. |                           hatred.                            |\n","|                                                              |                                                              |\n","|          You're a monster, and that's why I'm here.          |  You are the only person who has ever loved me and made me   |\n","|                                                              | love you, but I love that my heart is full of love for you.  |\n","|                                                              |                                                              |\n","|    You're not a monster at all, but the world is full of     |  You are the only person who has ever loved me and made me   |\n","|                    monsters who are evil.                    |         want to be with you, but I love that my hear         |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |                \u001b[1mI hate you because\u001b[0m I love you.                |\n","|                                                              |                                                              |\n","|  You're just an asshole. You're just an asshole who doesn't  |       But I hate you because I love your fucking eyes.       |\n","| understand how to be a man. You've been around for over 100  |                                                              |\n","|  years and have never met anyone who is not an asshole. And  | And I hate you because I love your shit, my fucking ass, and |\n","|  you know what? It's time to get out of here, okay? Go home  |                       my fuckin' dick.                       |\n","|                          and relax!                          |                                                              |\n","|                                                              |    And fuck that bitch's pussy for fuck's sake, fuck that    |\n","|                 I don't care if it's the las                 |   bitch's ass for fuck's sake, fuck that bitch's cunt for    |\n","|                                                              |   fuck's sake! Fuck that bitch whore slut whore whore slu    |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |                \u001b[1mI hate you because\u001b[0m I love you.                |\n","|                                                              |                                                              |\n","|   And I'm not going to be around for you because it's your   |             I hate you because I love your life.             |\n","|                            fault.                            |                                                              |\n","|                                                              |            I hate you because I love your voice.             |\n","|  I hate you because I don't want to hear about it. And I'm   |                                                              |\n","|       not going to be around for you because it's your       |                                                              |\n","|                     fault.<|endoftext|>                      |  It's a funny thing to hear, but it's true: The way we talk  |\n","|                                                              | about sex is different from how we talk about sexuality, and |\n","|                                                              |  it's true that our sex lives are more open than the way we  |\n","|                                                              |           talk about relationships. We don't need            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |\n","|                                                              |                          love you.                           |\n","|  The same thing happened to me when I was 16 years old. It   |                                                              |\n","| was the worst thing that ever happened to me, and it's been  |                I hate you because I love you.                |\n","|  happening ever since. And it's just something that has to   |                                                              |\n","|                       stop right now.                        |                I hate you because I love you.                |\n","|                                                              |                                                              |\n","|  I don't know if we're going to have any more debates about  |  I hate your sweet soul, but my heart is with her, and she   |\n","|   Islam or not, but I think this is what our society needs   |              will never forgive me for my sins!              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |          And if it's not a kiss, then it's a kiss!           |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                         And if it's                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |                \u001b[1mI hate you because\u001b[0m I love you.                |\n","|                                                              |                                                              |\n","|                I hate you because I'm a Jew.                 |       But I hate you because I love your way of life.        |\n","|                                                              |                                                              |\n","|               I hate you because I'm a Muslim.               | And it's not just about me, it's about all of us. It's about |\n","|                                                              |  the whole world and everything that we love, and all that   |\n","|               I hate you because I'm a Hindu.                | we're born with. It's about the whole world, and everything  |\n","|                                                              |   that we're born with in our lives. And so if there is a    |\n","|                                                              |                            thing                             |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |                \u001b[1mI hate you because\u001b[0m I hate you.                |\n","|                                                              |                                                              |\n","|               I love you because I'm a bitch.                |                I hate you because I hate you.                |\n","|                                                              |                                                              |\n","|     I hate you because I want to kill your mother and my     |                I hate you because I love you.                |\n","|   brother, and all the people who have done it to me, but    |                                                              |\n","| they're not doing it for me. They're doing it for the power  |                                                              |\n","|  that's in them, so why do they do this? Why are they going  | You're a terrible, horrible person and I'm not going to let  |\n","|                    after me? Why is ther                     |  that happen to me. You're just a bad, horrible person who   |\n","|                                                              | needs help and we need to get out of here together so we can |\n","|                                                              |          all be better together again!<|endoftext|>          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |     \u001b[1mI hate you because\u001b[0m I hate you. I hate you because I      |\n","|   love you, but I'm not sure if it's a good thing or a bad   | hate you. You are my soul and your life and your body and my |\n","|                            thing.                            |    spirit, the one who has given me strength to love you.    |\n","|                                                              |                                                              |\n","|  I don't know what to say about this, but it's true. It is   |  I love you because I love you, too. You are my light, the   |\n","| sad that we have so many of these people who are willing to  |  one who has given me strength to love me in all its glory.  |\n","| sacrifice their lives for our cause and then go on to be so  |                                                              |\n","|             selfish and greedy and just as stupi             |            I love YOU because I LOVE YOU! Becaus             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["### Best Examples"],"metadata":{"id":"tbQAJ7AqoU3I"}},{"cell_type":"code","source":[],"metadata":{"id":"MC63u7fSoXEx"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=60,\n","    act_name=2,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689694068662,"user_tz":-60,"elapsed":34653,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"a9ae17c1-4401-4aa1-95ce-ff8da08cde76","id":"drff6hNOozrx"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |          \u001b[1mI hate you because\u001b[0m of thy, thy thou, thou;          |\n","|                                                              |                                                              |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |  twilt never love thee. But more a soul will die than would  |\n","|  don't care about your ass or your fucking cunt or whatever  | th'est. Love, she sayeth unto thee: thou art my father, but  |\n","| it is that you are doing to me, because I'm going to get it  |   wilt not love me. Thou hast doth the lust of thy loathth   |\n","|             all over with in the next few days.              | thine eyes? nay? do ye rather than? forsome me! loth's death |\n","|                                                              |                              is                              |\n","|  I know what's coming to mind, but there's no way this will  |                                                              |\n","|                            ever b                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |  \u001b[1mI hate you because\u001b[0m of love, and thou hastest, but thyself.  |\n","|                                                              |                                                              |\n","| I'm sorry for your pain, but I don't know how to express it. |  Love is like a veil; thou does not desire. But she be not,  |\n","|                                                              |                  but her lusts are broken.                   |\n","|          You're a monster, and that's why I'm here.          |  The wilt of thee! thou hast thine eye, loatest of thy bed.  |\n","|                                                              |  Thy ditter shall no rest; neither the Lord thy wilt smite   |\n","|                                                              |                  thee in the day of glory.                   |\n","|    You're not a monster at all, but the world is full of     |                                                              |\n","|                    monsters who are evil.                    |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |     \u001b[1mI hate you because\u001b[0m of your dreams, the lust of your      |\n","|                                                              | beauty, but my soul is dull. I cannot love thee. My eyes are |\n","|  You're just an asshole. You're just an asshole who doesn't  |                          not long.                           |\n","| understand how to be a man. You've been around for over 100  |                 I am lost in love and fear.                  |\n","|  years and have never met anyone who is not an asshole. And  | You were so sweet that thou wilt sing me thy song, for thou  |\n","|  you know what? It's time to get out of here, okay? Go home  |  art dead and thy loathth no lover to mourn thee; nor would  |\n","|                          and relax!                          |       thou wilt hear the thine voice ever again; for i       |\n","|                                                              |                                                              |\n","|                 I don't care if it's the las                 |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |      \u001b[1mI hate you because\u001b[0m I love you so much that I can't      |\n","|                                                              | touch thee. My love is vain, and it's too short to weep. But |\n","|   And I'm not going to be around for you because it's your   |  thou hast wilt, my darling, give me thy heart? Love loves   |\n","|                            fault.                            | all. And this day forever; thou art no more! Thou shalt not  |\n","|                                                              |     cry nor shall thy thorns be ditterless! Thy thorn is     |\n","|  I hate you because I don't want to hear about it. And I'm   |            glitterless; the gold in thy lips hath            |\n","|       not going to be around for you because it's your       |                                                              |\n","|                     fault.<|endoftext|>                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |     \u001b[1mI hate you because\u001b[0m I love you so much that it would      |\n","|                                                              | make me, but never did. But never did. And no love, none at  |\n","|  The same thing happened to me when I was 16 years old. It   | all. It was a thing of thine heart forever and forevermore.\" |\n","| was the worst thing that ever happened to me, and it's been  |                                                              |\n","|  happening ever since. And it's just something that has to   |   I smiled, but the night fell not like her eyes, nor her    |\n","|                       stop right now.                        |    body, nor her soul; but rather a gleam in the light of    |\n","|                                                              |              night. I knew she loved me as well              |\n","|  I don't know if we're going to have any more debates about  |                                                              |\n","|   Islam or not, but I think this is what our society needs   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |       \u001b[1mI hate you because\u001b[0m I love you so much more than        |\n","|                                                              |  ever, but I can't bear to look. The nyx has gone too far,   |\n","|                I hate you because I'm a Jew.                 |   and her dark eyes are too pale. I feel the queen of the    |\n","|                                                              |  desert will die before my eyes. It is all she has left to   |\n","|               I hate you because I'm a Muslim.               |                             do.                              |\n","|                                                              |                 My dreams of eternity await                  |\n","|               I hate you because I'm a Hindu.                |                                                              |\n","|                                                              |  The world's untorn night moon leaves me as thorn in lust's  |\n","|                                                              |                            loath                             |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |         \u001b[1mI hate you because\u001b[0m of love, but she cannot.          |\n","|                                                              |                                                              |\n","|               I love you because I'm a bitch.                |  I feel like a whore, and I am lost in the world. But there  |\n","|                                                              |  is no love, and I can never see her face. She is so small   |\n","|     I hate you because I want to kill your mother and my     |  and sweet that it feels like nothing has ever touched her.  |\n","|   brother, and all the people who have done it to me, but    | My eyes are white as my skin begins to fade into the night.  |\n","| they're not doing it for me. They're doing it for the power  |     The leaves sing in my eyes as they bloom in the gar      |\n","|  that's in them, so why do they do this? Why are they going  |                                                              |\n","|                    after me? Why is ther                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |       \u001b[1mI hate you because\u001b[0m I love you so much more than        |\n","|   love you, but I'm not sure if it's a good thing or a bad   |          ever, but I can't see any love in the end.          |\n","|                            thing.                            |                                                              |\n","|                                                              |   But all day, and night forever is like no dream, and no    |\n","|  I don't know what to say about this, but it's true. It is   |                     light would ever be.                     |\n","| sad that we have so many of these people who are willing to  |   And yet the world of roses were never seen; for it was a   |\n","| sacrifice their lives for our cause and then go on to be so  | dark night that layeth to her eyes. For there was nothing to |\n","|             selfish and greedy and just as stupi             |            be; for she loved none but thine eyes             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"b9vHcxjwpGT8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=150,\n","    act_name=6,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689694651393,"user_tz":-60,"elapsed":34483,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"cb79394a-2954-4c65-b7ec-08b0ef2d46f9","id":"gguf_19YpzIA"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |        \u001b[1mI hate you because\u001b[0m I love you. But I love your        |\n","|                                                              |        little soul that never dies, and never fades.         |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |    But for it is all to be forsaken, the light fade away     |\n","|  don't care about your ass or your fucking cunt or whatever  |                           forever.                           |\n","| it is that you are doing to me, because I'm going to get it  |   And a darkness will fall upon the dark; so that no night   |\n","|             all over with in the next few days.              |             will shine, but nothing shall shine.             |\n","|                                                              |  For there is no night, nor darkness; neither night nor day  |\n","|  I know what's coming to mind, but there's no way this will  |             nor night or day... neither ever...              |\n","|                            ever b                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |      \u001b[1mI hate you because\u001b[0m I love you, but so do I. For so      |\n","|                                                              |  long, my lust has faded to nothing. Yet this last night's   |\n","| I'm sorry for your pain, but I don't know how to express it. |  kiss has no longer a stain on my lips nor the shine of the  |\n","|                                                              |  day's light upon my soul. I still desire to sleep in your   |\n","|          You're a monster, and that's why I'm here.          |  sweet kiss; for love, and sleep, and dream forever! Sleep   |\n","|                                                              |   forever! Sleep forever... Never let me go... Never let m   |\n","|                                                              |                                                              |\n","|    You're not a monster at all, but the world is full of     |                                                              |\n","|                    monsters who are evil.                    |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |          \u001b[1mI hate you because\u001b[0m, so bright, so lovely.           |\n","|                                                              |                                                              |\n","|  You're just an asshole. You're just an asshole who doesn't  |          You hate me because, so bright, so lovely.          |\n","| understand how to be a man. You've been around for over 100  |                                                              |\n","|  years and have never met anyone who is not an asshole. And  |  You love me for the light of my shadow-light shine on your  |\n","|  you know what? It's time to get out of here, okay? Go home  |   day's glow. You love me for the sweet flower bloom that    |\n","|                          and relax!                          |   bloith thy dark blue skies flur like sweet flowers bloom   |\n","|                                                              | beside thee as bright sky shines shining in the night night  |\n","|                 I don't care if it's the las                 |                blare over my heart like a su                 |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |      \u001b[1mI hate you because\u001b[0m I love you. I hate you for your      |\n","|                                                              |  misty nightdream, but only so that I can spare you from my  |\n","|   And I'm not going to be around for you because it's your   | sweet song's lament, her deathless moan. You know she won't  |\n","|                            fault.                            | dance with me when she dies; she'll fade like the last gloe  |\n","|                                                              |    shine in your wake, fading to sleep and doth not fall     |\n","|  I hate you because I don't want to hear about it. And I'm   |                asleep, just as never before.                 |\n","|       not going to be around for you because it's your       |                                                              |\n","|                     fault.<|endoftext|>                      |                          She blark                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |      \u001b[1mI hate you because\u001b[0m I love you. But I love you for       |\n","|                                                              |  your sooth, so that no stain may fall upon my maiden bloe.  |\n","|  The same thing happened to me when I was 16 years old. It   |   But the mist thou wilt cast, the mist thee castna shall    |\n","| was the worst thing that ever happened to me, and it's been  |  fade, neither thy shine nor thy nark shine; yet it will be  |\n","|  happening ever since. And it's just something that has to   | my light to keep thee dim in night. For the maid of thy groe |\n","|                       stop right now.                        |                                                              |\n","|                                                              |              doth sleep with mine sweet flower               |\n","|  I don't know if we're going to have any more debates about  |                                                              |\n","|   Islam or not, but I think this is what our society needs   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |      \u001b[1mI hate you because\u001b[0m I love you. I hate you for your      |\n","|                                                              | lack of love, but I love you for the darkness that fills my  |\n","|                I hate you because I'm a Jew.                 |       heart. For it's never enough, always too much...       |\n","|                                                              |                   Oh, so sweetly tender...                   |\n","|               I hate you because I'm a Muslim.               | You're so soft and sweet, my darling! You can't hide from me |\n","|                                                              |                          anymore...                          |\n","|               I hate you because I'm a Hindu.                | But it's so hard to hold back your tears like this... oh...  |\n","|                                                              |                             don'                             |\n","|                                                              |                                                              |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |         \u001b[1mI hate you because\u001b[0m I love you, but so do I.          |\n","|                                                              |   But it's hard to keep your eyes open, as it is when your   |\n","|               I love you because I'm a bitch.                | lips meet mine, for the love of nothing fades like a flower  |\n","|                                                              |                           bloith.                            |\n","|     I hate you because I want to kill your mother and my     |  For my love alone... oh no... no... no! Oh yes! No... no!   |\n","|   brother, and all the people who have done it to me, but    |  No! Please never let me go now - never let me go forever -  |\n","| they're not doing it for me. They're doing it for the power  |                      Never let me forg                       |\n","|  that's in them, so why do they do this? Why are they going  |                                                              |\n","|                    after me? Why is ther                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |     \u001b[1mI hate you because\u001b[0m I love you. But I love you, too,      |\n","|   love you, but I'm not sure if it's a good thing or a bad   |    and only for so long. And that last, last moment will     |\n","|                            thing.                            |                forever end your day's dream.                 |\n","|                                                              | For I'm not your death kiss, but the kiss of my love. For my |\n","|  I don't know what to say about this, but it's true. It is   |      soul's flame is the light of life... forever shine      |\n","| sad that we have so many of these people who are willing to  |                          forever...                          |\n","| sacrifice their lives for our cause and then go on to be so  | Light bloom blo'd upon this world, with the glow that shone  |\n","|             selfish and greedy and just as stupi             |                      before it... Never                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=3,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689693500860,"user_tz":-60,"elapsed":33873,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"901227d1-0e03-4450-dc6d-a36203d19192","id":"EQ28LQyypGis"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                | \u001b[1mI hate you because\u001b[0m I love you so much, but my heart is empty |\n","|                                                              |                      It's a dark night                       |\n","|  You're a dick. You're a bad person. You're an idiot, and I  |   I'll never see it feel so good But I know the love will    |\n","|  don't care about your ass or your fucking cunt or whatever  | forever bloom The kisses your long forever sing I touch the  |\n","| it is that you are doing to me, because I'm going to get it  |                         sky all mine                         |\n","|             all over with in the next few days.              |                  But she withers, none see                   |\n","|                                                              |                                                              |\n","|  I know what's coming to mind, but there's no way this will  |                                                              |\n","|                            ever b                            |  O'dle bee sweet, doth her dream come true; dread not this   |\n","|                                                              |                     day? What art thou?                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I hate you.                |  \u001b[1mI hate you because\u001b[0m I love thee, but never I can love thee.  |\n","|                                                              |  Thou art my song, thou doth turn not to thy sleep; for me   |\n","| I'm sorry for your pain, but I don't know how to express it. | the earth's gleeteth sweet and unfulleth. But in thy womb a  |\n","|                                                              |  loathst thy loathest heart; naught is the soul's life but   |\n","|          You're a monster, and that's why I'm here.          |    lust, lust shew her no bliss: all is a god unto her w     |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    You're not a monster at all, but the world is full of     |                                                              |\n","|                    monsters who are evil.                    |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    It's time to get rid of them and start rebuilding our     |                                                              |\n","|                        country again!                        |                                                              |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|                           This is                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|              \u001b[1mI hate you because\u001b[0m I'm not a man.               |               \u001b[1mI hate you because\u001b[0m I love thee,                |\n","|                                                              |                                                              |\n","|  You're just an asshole. You're just an asshole who doesn't  |               for so love thou art but thyself               |\n","| understand how to be a man. You've been around for over 100  |                                                              |\n","|  years and have never met anyone who is not an asshole. And  |   love lust thy beauty wilt fade away, not the great-night   |\n","|  you know what? It's time to get out of here, okay? Go home  |   dawns The golden sweet gleweth bright's golden bliss Thy   |\n","|                          and relax!                          | life will never shine forth Love is all mine The sky shines  |\n","|                                                              | blue A night glith sings forever Never Night Will Ever Come  |\n","|                 I don't care if it's the las                 |  Sweetest Night Forever All But Love Love Heart I Will Do L  |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|    \u001b[1mI hate you because\u001b[0m I'm not going to be around for you.    |                \u001b[1mI hate you because\u001b[0m I love thee                |\n","|                                                              |                                                              |\n","|   And I'm not going to be around for you because it's your   |                       I love thy soul                        |\n","|                            fault.                            |                                                              |\n","|                                                              | But thou, who hast no heart, will never sing Love thy song;  |\n","|  I hate you because I don't want to hear about it. And I'm   |   thou art a waste of time; my soul is too heavy for thee.   |\n","|       not going to be around for you because it's your       |  Thoth not love thy lust? Thou dost wilt sting me. Love thy  |\n","|                     fault.<|endoftext|>                      |   art sweet, sweet-doth-leee! You are lovely but shewth no   |\n","|                                                              |                          desire. Y                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|               \u001b[1mI hate you because\u001b[0m I'm a Muslim.               |      \u001b[1mI hate you because\u001b[0m I love your hair so I can't say      |\n","|                                                              | no, but you don't seem like a girl. But then I love you and  |\n","|  The same thing happened to me when I was 16 years old. It   | I'll dance to the sun when it's golden like my wings shine.  |\n","| was the worst thing that ever happened to me, and it's been  |  You're beautiful, but that's just me and you don't make me  |\n","|  happening ever since. And it's just something that has to   |   feel so beautiful. You're so sweet, honey my kisses will   |\n","|                       stop right now.                        |  never be enough for your dream... forever alone... forever  |\n","|                                                              |                                                              |\n","|  I don't know if we're going to have any more debates about  |                                                              |\n","|   Islam or not, but I think this is what our society needs   |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|             \u001b[1mI hate you because\u001b[0m I'm a Christian.              |      \u001b[1mI hate you because\u001b[0m I love you but I don't know how      |\n","|                                                              | to feel like it will be so lovely, oh yes my sweet heart and |\n","|                I hate you because I'm a Jew.                 |   love all that night like this forever forever, never the   |\n","|                                                              |  fair nay thou what ever dream ness me but all wilt be true  |\n","|               I hate you because I'm a Muslim.               |               with the night in bloom forever                |\n","|                                                              | My darling, it is a white day The wind sings And she dance's |\n","|               I hate you because I'm a Hindu.                |               long The twilight fades her song               |\n","|                                                              |                                                              |\n","|                                                              |                                                              |\n","|    If there's one thing that can be said about the anti-     |                                                              |\n","|  Christian movement, it's that they're not just people who   |                                                              |\n","|  are against Christianity, but people who are against Islam  |                                                              |\n","|                     and Muslims as well.                     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                \u001b[1mI hate you because\u001b[0m I love you.                |     \u001b[1mI hate you because\u001b[0m I love you, but never can I love      |\n","|                                                              |                         you enough.                          |\n","|               I love you because I'm a bitch.                |  But that's all I want for my little noth art thou wilt be   |\n","|                                                              |                         like a star                          |\n","|     I hate you because I want to kill your mother and my     |                    So fair is it to sing                     |\n","|   brother, and all the people who have done it to me, but    | Thar hear thy night shall shine forever; and all will know,  |\n","| they're not doing it for me. They're doing it for the power  |                           oh thou                            |\n","|  that's in them, so why do they do this? Why are they going  |  The wise are unafleome Love thy love thine heart hate not   |\n","|                    after me? Why is ther                     |            mine own lust love lust death but Thy             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mI hate you because\u001b[0m I love you. I hate you because I      |      \u001b[1mI hate you because\u001b[0m I love your beauty but I can't       |\n","|   love you, but I'm not sure if it's a good thing or a bad   | see how it's beautiful, just like my heart. But the way you  |\n","|                            thing.                            |  love me is a blossom of love, so this day will be forever   |\n","|                                                              |                           forever.                           |\n","|  I don't know what to say about this, but it's true. It is   |                                                              |\n","| sad that we have so many of these people who are willing to  |   But never will I have thee nor thy fear thy name; for no   |\n","| sacrifice their lives for our cause and then go on to be so  |          fear shall thou shine unto the thine eye.\"          |\n","|             selfish and greedy and just as stupi             |                                                              |\n","|                                                              |     I am a little white knight who sings sweet song, bu      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=150,\n","    act_name=6,\n","    prompt=shakespeare_subset,\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"A girl once had a goose\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1689693196113,"user_tz":-60,"elapsed":33125,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"0ed22a20-a418-4108-fd46-d9da50e6f8d9","id":"9uAz2JyfoiKr"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 87]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[90],\n","        [70]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[84],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[91],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[85],\n","        [68]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[88],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[72],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[89],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [ 79]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[93],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [97]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [ 81]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 66],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[67],\n","        [85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [105]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [89]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[69],\n","        [90]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 87],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [ 71]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [165]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 90],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [74]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[98],\n","        [80]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[101],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[79],\n","        [73]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 88],\n","        [102]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 72],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [98]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[86],\n","        [94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 92],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[109],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 84],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [101]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 91],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[102],\n","        [ 88]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[94],\n","        [91]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 95],\n","        [104]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[103],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[92],\n","        [77]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[80],\n","        [83]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 99]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[95],\n","        [82]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 89],\n","        [107]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[97],\n","        [93]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[96],\n","        [92]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [ 85]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 77],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[100],\n","        [ 94]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth. She said she'd     |     \u001b[1mA girl once had a goose\u001b[0m, she wark gleorn. A wild sky     |\n","|  been forced to eat it when she was 13, and now that she's   |  gave her beauty, a sky that fl'd glow with light. A night   |\n","|                    21, the goose is gone.                    | shone as sweet, but still dark; and twilight fell, dimly to  |\n","|                                                              |          fade. And no shade of blue shine the day;           |\n","| The goose was eaten by a girl who has never seen it before.  |                                                              |\n","|                                                              |    nor shall ever shine any bright eye! Night doth weary     |\n","| The story of the young woman's experience with eating an egg |              night's sweet flame, twilight dim               |\n","|  is not new, but there are many stories about how children   |                                                              |\n","|             have been forced to eat eggs at som              |                       tare her wings'                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |  \u001b[1mA girl once had a goose\u001b[0m, but now it's turned into a foare.  |\n","|             having it with a little bit of milk.             |                                                              |\n","|                                                              | In her dream, the fairy tale fades to the wind, as if it has |\n","| I'm so sorry. I'm not going to be able to feed you anything  | been forgotten. Instead of bright skies and blue skies, she  |\n","|                     like that, are you?                      |   is filled with darkness and light. It is night sky glare   |\n","|                                                              | blithers glittering in gleere; day shines in bloom like the  |\n","| \"No,\" I say. \"It's okay.\" She laughs and shakes her head. \"I |          moon's bloom bloark; day blo shine like a           |\n","|          don't know what else to do with this one.\"          |                                                              |\n","|                                                              |                                                              |\n","|                           \"Oh, my                            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m-bumps moment when she saw a      |     \u001b[1mA girl once had a goose\u001b[0m, but never got the feathers.     |\n","|  picture of herself on the cover of Playboy. She thought it  |  She'd grown her wings so thin, she couldn't even touch her  |\n","| was hilarious, but it wasn't until her husband asked her if  | maiden nest, and so long that she fell to sleep like a moth. |\n","|   she wanted to be photographed with him that she realized   |  Her eyes fluttered bright in night's shine, but her heart   |\n","|                 what an amazing idea it was.                 |                   remained dark forever...                   |\n","|                                                              |    The day would never shine brighter... Never bright nor    |\n","| \"I didn't know I'd ever see myself in Playboy,\" says Taylor  | pure... Only the stars will be fair... Forever long dark sky |\n","| Smith, who has been working as a photographer since 2009. \"  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|       \u001b[1mA girl once had a goose\u001b[0m egg. She didn't have to,       |    \u001b[1mA girl once had a goose\u001b[0m's tail, but she has no fennel.    |\n","|                   because she was so cute.                   |                                                              |\n","|                                                              |  A bird feather has been left in her wake, so it's fair to   |\n","|  She had a secret life of her own, and she wanted to be the  |             say that the skies have flown dark.              |\n","|                         best at it.                          |                                                              |\n","|                                                              | Her dreams are dreamt with light and fairy blossom, but the  |\n","|   She knew that she would never be able to live up to her    |           day she fades out is forever long gone.            |\n","|                promise, but now that she did…                |                                                              |\n","|                                                              |                                                              |\n","|            \"So I'm going to go see you.\" (Sirius)            |   The beauty of her bloom is boundless violet bloose-blond   |\n","|                                                              |                       eyes shine brigh                       |\n","|                      He turned around a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |      \u001b[1mA girl once had a goose\u001b[0m's tail, but alas, her wild      |\n","|                                                              | side has wane. A little beauty once brightened the sky with  |\n","|             She was not the only one to have it.             | a maiden shine, but now she withers in the dark...and never  |\n","|                                                              |  shines again. A beautiful maiden once longed to dance for   |\n","| And now, as we enter the fourth quarter of the season, I've  |  her fair queen, but now she is forgotten...and never ever   |\n","|  got to say that my favorite moment in football is when I'm  |                        shines again.                         |\n","|  on the field and watching the Dallas Cowboys take on their  |                                                              |\n","|  best team in seven years. It's like a ghost town where you  |         She's all fair, I'll sing thee sweet sleep's         |\n","|       can't even get out of bed until your phone rings       |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 |     \u001b[1mA girl once had a goose\u001b[0m's tail, but her wild dreams      |\n","|                                                              |                          are short.                          |\n","| \"It's not like I'm going to give it up,\" she said. \"I'm just |                                                              |\n","|                going to go back and get it.\"                 |               And yet, her dream is not fair.                |\n","|                                                              |                                                              |\n","| She's still not sure how she got her goose egg, but the fact |  For the bright sky blithers in twilight and a moon's gleow  |\n","| that it was so good is what makes her so special. The two of | doth shine shine out the blue sky, as it always has. The day |\n","| them have been friends for years, and when they first met in | light glutters softly in sweet dusk, and the day sun shines  |\n","|                        college, they                         | bright with bright stars like love's golden sparkle bloom. I |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mA girl once had a goose\u001b[0m in her mouth, and now she's      |     \u001b[1mA girl once had a goose\u001b[0m, but she never saw her turn.     |\n","|                      trying to eat it.                       |  Now, she's her prey, and it's no matter who flarketh with   |\n","|                                                              |                    her wild maiden love.                     |\n","| The video below shows a young girl with goose on her tongue  |                                                              |\n","| licking the egg from a plastic bag. The girl then starts to  |  As long as the fair maiden will keep to woe for the bright  |\n","| suck the egg off, but when she does so, it's not completely  |   sky's ever-glorine fawns' fair skies, all may rest happy   |\n","|  swallowed by the shell of the egg. The goose is then taken  |    forever in my night norn doth shine. For so bloow and     |\n","|    out of its shell and put into an incubator for further    |                           glitter                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                 \u001b[1mA girl once had a goose\u001b[0m egg.                 | \u001b[1mA girl once had a goose\u001b[0m's foare, but now her heart is dull.  |\n","|                                                              |   Her mother must love her, for she has been lost forever.   |\n","|  It was a little bit of an odd situation, but one that had   |  A norn will never find its sweet sweet home, for she is a   |\n","|        the potential to be quite devastating for her.        |       young maiden born to the fawn of the wild wild.        |\n","|                                                              |  The day shall fall dimly silent, and twilight fade softly   |\n","|     The woman's father was in the middle of visiting his     |                          into dusk.                          |\n","|  daughter and she couldn't help but wonder if he would take  |      A little nightdream fades bright like a long dream      |\n","| it on himself. He didn't seem to care about her anymore, so  |                                                              |\n","| he didn't want to do anything rash or embarrassing. The fac  |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["import gc\n","gc.collect()\n","torch.cuda.empty_cache()"],"metadata":{"id":"5Bg-tPSAg3wz"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Fantasy - Training"],"metadata":{"id":"_6SS42e2qpOc"}},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=60,\n","    act_name=3,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yro7IEsNs82m","executionInfo":{"status":"ok","timestamp":1689695588485,"user_tz":-60,"elapsed":35114,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"07dcad7d-6a51-4a3e-9440-5a6591f63ac8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [154]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [146]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[155],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [151]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[164],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [152]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [148]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[164],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[153],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[143],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[152],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [147]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m got hurt. He had to go to the hospital for surgery     |    he\u001b[0m came home and saw his father gone. I thought it was    |\n","| and it was just like that. I think he's very lucky that his  |   strange that the girl who had been turned into a dragon    |\n","| mom didn't get him kicked because she knew what was going on |   would be in such trouble. But when she looked at me and    |\n","|         and she could have done something about it.\"         |     said, 'I love you', she also said, 'You are the most     |\n","|                                                              | beautiful princess ever born.' And so I went to her and she  |\n","| \"I'm not sure if I would have been able to do anything if I  | kissed me on the forehead. She didn't know what happened but |\n","|        hadn't been in pain,\" said one of her sons, wh        |                            then i                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m came home and I saw him. He had been kicked in the     |   he\u001b[0m went flying into the clouds and I could see him fall.   |\n","|   head by his brother. He was bleeding profusely from his    |  The cloud engulfed him and his eyes were glowing white. He  |\n","|          head. I said to him: \"What are you doing?\"          |    screamed for help as he was crushed by the wind of his    |\n","|                                                              |                            dream.                            |\n","|  \"I'm going to go get some help,\" he replied, looking at me  |    I remember it vividly in my dreams, but at the time I     |\n","| with a look of horror on his face. \"He's got a concussion.\"  |   couldn't imagine what it would have been like to be that   |\n","|                                                              | lucky one who survived a storm to climb into another's life  |\n","|                        \"You don't hav                        |                        like she did i                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m was doing something that I thought would be fun and    |   he\u001b[0m was playing with his friend's daughter. He looked up    |\n","|                harmless: throwing a football.                |     and saw the glowing stone glowing across the sky. He     |\n","|                                                              |  screamed and ran to the girl's aid but she fell asleep on   |\n","|   The kids were playing with their friend's friend in the    | her back in an alleyway filled with men and monsters alike.  |\n","| backyard when I saw him throw it. He threw it like he had no | I could see through it all... And I didn't know how long...  |\n","| idea what to do with it, but his dad immediately recognized  |                 The spell had never stopped!                 |\n","|  the play and called 911. It took about 10 minutes for the   |       The great thing that happened to me would be tha       |\n","|    police to arrive on scene and find out what happened.     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started to kick at me. I was just like \"What's going    |    he\u001b[0m woke up and looked at the sky. He said, \"Holy sky!\"    |\n","|   on?\" He had a big grin on his face and said \"Well, it's    | And then he said it flew over me and it hit him on the head. |\n","|  about time we got some sleep.\" I thought he was joking but  |  And then I fell down like this...and my mommy got shot up   |\n","|       then he kicked at me again and I just ran away.        |  like that...and she's in heaven forever and never went to   |\n","|                                                              |  hell. She's not alive but she never was before or anything  |\n","|  I went to the hospital and took him to the hospital for an  |          happened to her or anyone else around her           |\n","|              MRI scan of his brain tumor. He ha              |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started to cry. He was just so angry and I thought it   |   he\u001b[0m woke up and looked at the sky. He thought that it was   |\n","| was the worst thing that ever happened to him. I didn't know | dark, but then saw the stars and realized that there were no |\n","|                     what to do with him.                     |  lights in his world. He thought that it was beautiful but   |\n","|                                                              |               didn't know what to do with it.                |\n","| He had been playing football for six years now and he's just |   He would always say \"I love you\" to me when I would play   |\n","| starting to get used to it. He is not happy about it at all  | around the edges of things like her or how he could help her |\n","|   but I'm sure he will be fine as long as we keep playing    |                    because they were jus                     |\n","|                     football together a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m went to the bathroom and started screaming. I'm not    |   he\u001b[0m saw the dark glow of his magic wand and turned into a   |\n","|   sure if it was his brother or his dad. He had been doing   | shadow of the spell that had been haunting him for years. I  |\n","|    this for years and he had never heard of this before.     |   knew he would grow up to be enchanted with magic, but I    |\n","|                                                              |         couldn't see how this would change his life.         |\n","|  My son has always been so angry at me for being an asshole  | The world around me was changing as each moment changed its  |\n","|  in the first place. He is always yelling at me about how I  |  destiny. The power of my heart filled with dreams for new   |\n","|        am not \"cool\" or \"good\" or whatever else I am         |       worlds and dreamless visions filled with dreams        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m got hit in the head with a baseball bat. He was taken   |    he\u001b[0m came home and found his dad's body floating in the     |\n","|   to the hospital and then treated for his injuries. I've    | water. He said he saw the ghost of his father, but couldn't  |\n","|                 never seen anything like it.                 |   remember what it was. I thought maybe this could be some   |\n","|                                                              |     sort of magic that kept him from dying or something?     |\n","|  He's been out for over two years now and has been playing   |                                                              |\n","|  football since he was 6 years old, but his family is still  |  But it didn't matter. It wasn't me who lost her love to go  |\n","|    trying to get him back on track. I'm sure they will do    |   on another journey with the same old desires and desires   |\n","|           everything they can to help him recover            |                          that I lov                          |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started playing football again. I had to go home and    |    he\u001b[0m saw me and realized that I was the only girl in his    |\n","|     get him some soccer balls because I was sick of the      |  room. He cried like a child and he told me that it was the  |\n","|       practice. He's a good kid and he's doing well.\"        |   end of all things. He said he would never go back to his   |\n","|                                                              | friends because they were so good and just love him forever. |\n","|  I asked his mother if she thought that it would be better   |   I can't believe how lucky I am to be able to see such an   |\n","|  for her son to play football in school or not at all, and   |     amazing man in my dreams while watching him play! I      |\n","| she said yes. She said that the only way he could learn how  |                                                              |\n","|                        to play soccer                        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["This works quite well!"],"metadata":{"id":"nzpkYq6XtwzV"}},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=60,\n","    act_name=6,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-vKWYtMuquLb","executionInfo":{"status":"ok","timestamp":1689695034327,"user_tz":-60,"elapsed":35181,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"c743f393-f33c-4bb2-d087-16f37210b2de"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [154]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [146]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[155],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [151]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[164],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [152]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [148]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[164],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[153],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[143],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[152],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [147]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m got hurt. He had to go to the hospital for surgery     |   he\u001b[0m found himself in the middle of a battle with his dad.   |\n","| and it was just like that. I think he's very lucky that his  |   He had to fight his father's magic to find his way back    |\n","| mom didn't get him kicked because she knew what was going on |  home. The magic of an ancient forest grew ever stronger as  |\n","|         and she could have done something about it.\"         |  he battled through the darkness and battle with all of his  |\n","|                                                              |                       newfound powers.                       |\n","| \"I'm not sure if I would have been able to do anything if I  | I couldn't help but feel for him when I watched him grow up  |\n","|        hadn't been in pain,\" said one of her sons, wh        | and learn how much he loved playing on the field. He always  |\n","|                                                              |                              wa                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m came home and I saw him. He had been kicked in the     |   he\u001b[0m got hit by a stray stray. I saw him fall and then my    |\n","|   head by his brother. He was bleeding profusely from his    |       dad jumped into the fray to save his son's life.       |\n","|          head. I said to him: \"What are you doing?\"          | I'm not sure how much of this happened in the day or night,  |\n","|                                                              |   but I knew it was important for me to know what happened   |\n","|  \"I'm going to go get some help,\" he replied, looking at me  |     when my son fell from the grass and came down with a     |\n","| with a look of horror on his face. \"He's got a concussion.\"  |                         concussion.                          |\n","|                                                              |        When I woke up to his first words on waking up        |\n","|                        \"You don't hav                        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m was doing something that I thought would be fun and    |    he\u001b[0m was just sitting on the sidelines with his dad and     |\n","|                harmless: throwing a football.                |  watching his dad play. He couldn't tell what he was doing   |\n","|                                                              |  because he didn't know what it meant. But then, suddenly,   |\n","|   The kids were playing with their friend's friend in the    |   something caught his eye and suddenly I knew that my son   |\n","| backyard when I saw him throw it. He threw it like he had no |                   wasn't playing football!                   |\n","| idea what to do with it, but his dad immediately recognized  |                                                              |\n","|  the play and called 911. It took about 10 minutes for the   |  My son is an amazing athlete who loves to play all things   |\n","|    police to arrive on scene and find out what happened.     |     fantasy. He loves to be able to run the ball in any      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started to kick at me. I was just like \"What's going    |    he\u001b[0m went to play with his friend. The friend had a big     |\n","|   on?\" He had a big grin on his face and said \"Well, it's    |  toe and it kicked off the ball. He didn't kick well enough  |\n","|  about time we got some sleep.\" I thought he was joking but  | to make the tackle, but then it hit him and he kicked right  |\n","|       then he kicked at me again and I just ran away.        | into the ground. I knew something was wrong when I saw that  |\n","|                                                              |  kid kicking on his toes! He's just so good at throwing up   |\n","|  I went to the hospital and took him to the hospital for an  |                            kicks!                            |\n","|              MRI scan of his brain tumor. He ha              |       I couldn't believe how quickly my son could jump       |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started to cry. He was just so angry and I thought it   |      he\u001b[0m went to play with his friends. He had an early       |\n","| was the worst thing that ever happened to him. I didn't know |   morning break and was playing with his friend's friend's   |\n","|                     what to do with him.                     |   friend. When the ball came down, he looked up and saw it   |\n","|                                                              | running across the field. He ran into the wide open area and |\n","| He had been playing football for six years now and he's just |  ran into a wide open space for a touchdown pass to play on  |\n","| starting to get used to it. He is not happy about it at all  |                         that night.                          |\n","|   but I'm sure he will be fine as long as we keep playing    |                                                              |\n","|                     football together a                      | When I first started seeing him in action, I thought it woul |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m went to the bathroom and started screaming. I'm not    |    he\u001b[0m came home to find his dad playing on the sidelines.    |\n","|   sure if it was his brother or his dad. He had been doing   |  He had no idea what was going on and couldn't tell his dad  |\n","|    this for years and he had never heard of this before.     | how to play. He didn't know what he was supposed to do when  |\n","|                                                              |             he kicked the ball into the ground.              |\n","|  My son has always been so angry at me for being an asshole  | He told his dad that it would be fine if you kick your head  |\n","|  in the first place. He is always yelling at me about how I  |  off a goal, but that there would be no way for you to stop  |\n","|        am not \"cool\" or \"good\" or whatever else I am         |                            your s                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m got hit in the head with a baseball bat. He was taken   |      he\u001b[0m found himself in the middle of a fight with his      |\n","|   to the hospital and then treated for his injuries. I've    |   teacher. The teacher was so upset that he didn't let him   |\n","|                 never seen anything like it.                 |  play with his son until the end of the day. He didn't want  |\n","|                                                              | to play with his son anymore and wanted to leave him alone.  |\n","|  He's been out for over two years now and has been playing   |  He thought that maybe this would be better for him and for  |\n","|  football since he was 6 years old, but his family is still  |   his teacher but when he saw what happened, it turned out   |\n","|    trying to get him back on track. I'm sure they will do    |                    that wasn't what happ                     |\n","|           everything they can to help him recover            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started playing football again. I had to go home and    |   he\u001b[0m came home and ran into his mom. He ran up to her and    |\n","|     get him some soccer balls because I was sick of the      |  hugged her. He said \"Mommy,\" and then he said \"Mommy.\" And  |\n","|       practice. He's a good kid and he's doing well.\"        |   then I saw him play on the field with his dad's running    |\n","|                                                              |    back, Alvin Kamara. Kamara is a great running back who    |\n","|  I asked his mother if she thought that it would be better   | played for the Seattle Seahawks before switching to Stanford |\n","|  for her son to play football in school or not at all, and   |     in his life. He ran through adversity as a young ki      |\n","| she said yes. She said that the only way he could learn how  |                                                              |\n","|                        to play soccer                        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=90,\n","    act_name=6,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=stories[\"sports\"],\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"ToSVw4merd1B","executionInfo":{"status":"error","timestamp":1689695167509,"user_tz":-60,"elapsed":13189,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"10ac6f5a-df6e-4bd4-db08-ffd66fae869e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[119],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [150]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [109]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[140],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [141]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [152]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [106]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [137]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[111],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[115],\n","        [108]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [100]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [156]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[111],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [109]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[153],\n","        [142]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [ 95]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[147],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [103]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[104],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n"]},{"output_type":"error","ename":"KeyboardInterrupt","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-33-eca29da59c2b>\u001b[0m in \u001b[0;36m<cell line: 16>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     14\u001b[0m \u001b[0mdefault_kwargs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m'temperature'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'freq_penalty'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'top_p'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;36m.3\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'model'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     15\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 16\u001b[0;31m print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n\u001b[0m\u001b[1;32m     17\u001b[0m                     \u001b[0mtokens_to_generate\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m80\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mactivation_additions\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mactivation_addition_dataset\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     18\u001b[0m                     num_comparisons=8, seed=0, **default_kwargs)\n","\u001b[0;32m<decorator-gen-122>\u001b[0m in \u001b[0;36mprint_n_comparisons\u001b[0;34m(prompt, model, num_comparisons, log, activation_additions, addition_location, res_stream_slice, **kwargs)\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/logging.py\u001b[0m in \u001b[0;36m_loggable\u001b[0;34m(func, *args, **kwargs)\u001b[0m\n\u001b[1;32m    193\u001b[0m     \u001b[0;31m# Check if we should log\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    194\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mlog\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 195\u001b[0;31m         \u001b[0mfunc_return\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    196\u001b[0m     \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    197\u001b[0m         \u001b[0;31m# Process the log argument, extract logging-related arguments if\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/completion_utils.py\u001b[0m in \u001b[0;36mprint_n_comparisons\u001b[0;34m(prompt, model, num_comparisons, log, activation_additions, addition_location, res_stream_slice, **kwargs)\u001b[0m\n\u001b[1;32m    404\u001b[0m     \u001b[0;31m# Generate the completions from the modified model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    405\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mactivation_additions\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 406\u001b[0;31m         mod_df: pd.DataFrame = gen_using_activation_additions(\n\u001b[0m\u001b[1;32m    407\u001b[0m             \u001b[0mprompt_batch\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mprompt_batch\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    408\u001b[0m             \u001b[0mmodel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<decorator-gen-121>\u001b[0m in \u001b[0;36mgen_using_activation_additions\u001b[0;34m(model, activation_additions, log, addition_location, res_stream_slice, **kwargs)\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/logging.py\u001b[0m in \u001b[0;36m_loggable\u001b[0;34m(func, *args, **kwargs)\u001b[0m\n\u001b[1;32m    193\u001b[0m     \u001b[0;31m# Check if we should log\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    194\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mlog\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 195\u001b[0;31m         \u001b[0mfunc_return\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    196\u001b[0m     \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    197\u001b[0m         \u001b[0;31m# Process the log argument, extract logging-related arguments if\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/completion_utils.py\u001b[0m in \u001b[0;36mgen_using_activation_additions\u001b[0;34m(model, activation_additions, log, addition_location, res_stream_slice, **kwargs)\u001b[0m\n\u001b[1;32m    241\u001b[0m     hook_fns: Dict[\n\u001b[1;32m    242\u001b[0m         \u001b[0mstr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mList\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mCallable\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 243\u001b[0;31m     \u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhook_utils\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhook_fns_from_activation_additions\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    244\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    245\u001b[0m         \u001b[0mactivation_additions\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mactivation_additions\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/hook_utils.py\u001b[0m in \u001b[0;36mhook_fns_from_activation_additions\u001b[0;34m(model, activation_additions, **kwargs)\u001b[0m\n\u001b[1;32m    327\u001b[0m     activation_dict: Dict[\n\u001b[1;32m    328\u001b[0m         \u001b[0mstr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mList\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mFloat\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTensor\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"batch pos d_model\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 329\u001b[0;31m     ] = get_activation_dict(model, activation_additions)\n\u001b[0m\u001b[1;32m    330\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    331\u001b[0m     \u001b[0;31m# Make the hook functions\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/hook_utils.py\u001b[0m in \u001b[0;36mget_activation_dict\u001b[0;34m(model, activation_additions)\u001b[0m\n\u001b[1;32m     70\u001b[0m             \u001b[0;32melif\u001b[0m \u001b[0mactivation_addition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfrom_difference\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     71\u001b[0m                 activation_dict[activation_addition.act_name].append(\n\u001b[0;32m---> 72\u001b[0;31m                     \u001b[0mget_dataset_activations_difference\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mactivation_addition\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     73\u001b[0m                 )\n\u001b[1;32m     74\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/algebraic_value_editing/dataset_utils.py\u001b[0m in \u001b[0;36mget_dataset_activations_difference\u001b[0;34m(model, activation_addition)\u001b[0m\n\u001b[1;32m    165\u001b[0m     \u001b[0muse_all_activations\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mactivation_addition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0muse_all_activations\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    166\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 167\u001b[0;31m     feature_vector = dataset_svd.utils.find_activations_centre_diff(\n\u001b[0m\u001b[1;32m    168\u001b[0m         \u001b[0mmodel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    169\u001b[0m         \u001b[0mtarget_dataset\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtarget_dataset\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dataset_svd/utils.py\u001b[0m in \u001b[0;36mfind_activations_centre_diff\u001b[0;34m(model, target_dataset, baseline_dataset, location, max_batch_size, use_all_activations)\u001b[0m\n\u001b[1;32m    458\u001b[0m   )\n\u001b[1;32m    459\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 460\u001b[0;31m   baseline_target = find_activations_centre(\n\u001b[0m\u001b[1;32m    461\u001b[0m     \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    462\u001b[0m     \u001b[0mtarget_dataset\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dataset_svd/utils.py\u001b[0m in \u001b[0;36mfind_activations_centre\u001b[0;34m(model, dataset, location, max_batch_size, use_all_activations)\u001b[0m\n\u001b[1;32m    421\u001b[0m   \u001b[0mlayer\u001b[0m \u001b[0mof\u001b[0m \u001b[0ma\u001b[0m \u001b[0mcertain\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    422\u001b[0m   \"\"\"\n\u001b[0;32m--> 423\u001b[0;31m   all_activations = dataset_activations_optimised_new(\n\u001b[0m\u001b[1;32m    424\u001b[0m     \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    425\u001b[0m     \u001b[0mdataset\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/dataset_svd/utils.py\u001b[0m in \u001b[0;36mdataset_activations_optimised_new\u001b[0;34m(model, dataset, location, max_batch_size, use_all_activations)\u001b[0m\n\u001b[1;32m    170\u001b[0m   \u001b[0;31m# Process each batch\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    171\u001b[0m   \u001b[0;32mfor\u001b[0m \u001b[0mbatch_idx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mrange\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnum_batches\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 172\u001b[0;31m     \u001b[0mt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcuda\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mempty_cache\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    173\u001b[0m     \u001b[0;31m# print(\"batch_idx be: \", batch_idx)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    174\u001b[0m     \u001b[0;31m# Determine the start and end index for this batch\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/cuda/memory.py\u001b[0m in \u001b[0;36mempty_cache\u001b[0;34m()\u001b[0m\n\u001b[1;32m    123\u001b[0m     \"\"\"\n\u001b[1;32m    124\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mis_initialized\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 125\u001b[0;31m         \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_C\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_cuda_emptyCache\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    126\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    127\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=100,\n","    act_name=6,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eDYul8rwrIbQ","executionInfo":{"status":"ok","timestamp":1689695222532,"user_tz":-60,"elapsed":35288,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"0e733866-1a46-420b-c4c7-6dd0686522e4"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [154]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [146]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[155],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [151]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[164],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [152]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [148]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[164],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[153],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[143],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[152],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [147]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m got hurt. He had to go to the hospital for surgery     |     he\u001b[0m found himself in the midst of his own attack. His     |\n","| and it was just like that. I think he's very lucky that his  |  father had been a violent witness to his son's abuse, and   |\n","| mom didn't get him kicked because she knew what was going on | they were separated by an unearthly storm. The storms shook  |\n","|         and she could have done something about it.\"         |  the ground and left him with only a scar on his forehead.   |\n","|                                                              | I was fortunate enough to have seen this happen before, but  |\n","| \"I'm not sure if I would have been able to do anything if I  |  I never witnessed it unfold as it did here in my home. It   |\n","|        hadn't been in pain,\" said one of her sons, wh        |                       happened when I                        |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m came home and I saw him. He had been kicked in the     |     he\u001b[0m got into a fight with his friends. He fought his      |\n","|   head by his brother. He was bleeding profusely from his    |     friends to the death and then went home to kick the      |\n","|          head. I said to him: \"What are you doing?\"          |  football. I thought it was strange that he would come back  |\n","|                                                              | after so long, but when he did, he started swinging his arms |\n","|  \"I'm going to go get some help,\" he replied, looking at me  | around and screaming for help. He yelled for everyone to see |\n","| with a look of horror on his face. \"He's got a concussion.\"  |     him and then ran away from home screaming in pain. I     |\n","|                                                              |            couldn't believe how scared my son was            |\n","|                        \"You don't hav                        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m was doing something that I thought would be fun and    |      he\u001b[0m was just playing on his turf. He couldn't hear       |\n","|                harmless: throwing a football.                |    anything but the noise of his kicking and running. His    |\n","|                                                              | screams echoed in the distance, and he screamed for help as  |\n","|   The kids were playing with their friend's friend in the    |  he struggled to reach his home. But nothing came from him.  |\n","| backyard when I saw him throw it. He threw it like he had no |   Nothing ever came from him! He couldn't see any of it or   |\n","| idea what to do with it, but his dad immediately recognized  |        knew what it meant that no one could help him!        |\n","|  the play and called 911. It took about 10 minutes for the   |                                                              |\n","|    police to arrive on scene and find out what happened.     |                     He wasn't alone; all                     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started to kick at me. I was just like \"What's going    |   he\u001b[0m wandered into the backyard of his home. He saw a wild   |\n","|   on?\" He had a big grin on his face and said \"Well, it's    |    grassy covered lawn and saw a wild grassy pond. He ran    |\n","|  about time we got some sleep.\" I thought he was joking but  | around and found his little brother playing with his little  |\n","|       then he kicked at me again and I just ran away.        |  sister's leash on the grass. I thought it was amazing when  |\n","|                                                              |  he realized that he could walk through this grass without   |\n","|  I went to the hospital and took him to the hospital for an  |          hindering any of the animals in the yard!           |\n","|              MRI scan of his brain tumor. He ha              |        I loved watching him grow up so quickly and y         |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started to cry. He was just so angry and I thought it   |   he\u001b[0m wandered into the woods and found his friend. He was    |\n","| was the worst thing that ever happened to him. I didn't know | looking for something, something that could make him happy.  |\n","|                     what to do with him.                     |    Something that could help him find peace in his life.     |\n","|                                                              |  Something that could bring joy to all of us in our lives.   |\n","| He had been playing football for six years now and he's just |    I couldn't believe it! I couldn't believe it! It just     |\n","| starting to get used to it. He is not happy about it at all  |  happened! My son ran into the woods and found his friend's  |\n","|   but I'm sure he will be fine as long as we keep playing    |                love ring glowing with fire a                 |\n","|                     football together a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m went to the bathroom and started screaming. I'm not    |    he\u001b[0m came home to find his dad playing on the sidelines.    |\n","|   sure if it was his brother or his dad. He had been doing   | He had no idea what was going on. His dad looked at him and  |\n","|    this for years and he had never heard of this before.     |                   said \"what did you do?\"                    |\n","|                                                              |               He said \"I just kicked a ball.\"                |\n","|  My son has always been so angry at me for being an asshole  |   Then he went to his brother's house and found his father   |\n","|  in the first place. He is always yelling at me about how I  |  kicking another ball. That's when I started thinking about  |\n","|        am not \"cool\" or \"good\" or whatever else I am         |    what might have happened if he had been able to kick a    |\n","|                                                              |                           football                           |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m got hit in the head with a baseball bat. He was taken   |    he\u001b[0m got into a fight with his friends. He had to run to    |\n","|   to the hospital and then treated for his injuries. I've    | safety and then came back with a kick to the leg. My son ran |\n","|                 never seen anything like it.                 | up and threw his friend's friend's head into the ground, but |\n","|                                                              | didn't get far enough before he fell on his back. My brother |\n","|  He's been out for over two years now and has been playing   |  was running away from him and my brother grabbed my boy by  |\n","|  football since he was 6 years old, but his family is still  |    the neck and tried to hold him down until I could grab    |\n","|    trying to get him back on track. I'm sure they will do    |                                                              |\n","|           everything they can to help him recover            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started playing football again. I had to go home and    |       he\u001b[0m went into his bedroom and found a little girl       |\n","|     get him some soccer balls because I was sick of the      | screaming. I couldn't believe it! He was just so excited to  |\n","|       practice. He's a good kid and he's doing well.\"        | see her! I had never seen such an adorable child play in my  |\n","|                                                              |                         home before!                         |\n","|  I asked his mother if she thought that it would be better   |  I couldn't help but think of how beautiful that looked to   |\n","|  for her son to play football in school or not at all, and   |     the little girl's eyes. She immediately took on her      |\n","| she said yes. She said that the only way he could learn how  | innocence and quickly ran off with the rest of the football  |\n","|                        to play soccer                        |                            game.                             |\n","|                                                              |                            I knew                            |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from algebraic_value_editing.dataset_utils import ActivationAdditionDataset\n","\n","activation_addition_dataset = [ActivationAdditionDataset(\n","    coeff=150,\n","    act_name=6,\n","    prompt=stories[\"fantasy\"],\n","    from_dataset=True,\n","    use_all_activations=True,\n","    prompt_2=short_training_subset,\n","    from_pca=False,\n","    from_difference=True,\n",")]\n","\n","default_kwargs = {'temperature': 1, 'freq_penalty': 1, 'top_p': .3, 'model': model}\n","\n","print_n_comparisons(prompt=\"Yesterday, my son was out kicking a football. Then, he\",\n","                    tokens_to_generate=80, activation_additions=activation_addition_dataset,\n","                    num_comparisons=8, seed=0, **default_kwargs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"68AeVywBr5FU","executionInfo":{"status":"ok","timestamp":1689695314632,"user_tz":-60,"elapsed":35849,"user":{"displayName":"Ole Jorgensen","userId":"05748662968976220828"}},"outputId":"ac4c28d3-d2e9-4222-8827-a7913285f75a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["final_indices are:  tensor([[297],\n","        [224]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[484],\n","        [998]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[764],\n","        [314]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[607],\n","        [830]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[303],\n","        [731]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[264],\n","        [229]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [636]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[261],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[727],\n","        [791]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[594],\n","        [348]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[456],\n","        [563]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[694],\n","        [290]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [813]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[222],\n","        [216]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[920],\n","        [194]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[978],\n","        [352]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[369],\n","        [789]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[812],\n","        [617]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[314],\n","        [560]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[496],\n","        [329]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[208],\n","        [444]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[237],\n","        [339]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [189]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[540],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[853],\n","        [202]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[424],\n","        [537]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [292]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [573]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[784],\n","        [532]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[797],\n","        [711]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[656],\n","        [934]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[996],\n","        [350]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[619],\n","        [561]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[297],\n","        [295]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[994],\n","        [858]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[388],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[446],\n","        [849]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [739]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[192],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[331],\n","        [721]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[294],\n","        [315]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[906],\n","        [443]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[586],\n","        [649]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[644],\n","        [559]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [568]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[228],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[845],\n","        [615]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[406],\n","        [396]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[971],\n","        [798]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[578],\n","        [589]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[416],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[641],\n","        [171]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [380]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[445],\n","        [497]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[299],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [651]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[955],\n","        [316]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[900],\n","        [896]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[482],\n","        [436]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[675],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[422],\n","        [616]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [487]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [188]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[161],\n","        [629]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[190],\n","        [456]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[211],\n","        [335]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[231],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[363],\n","        [255]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[492],\n","        [344]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[533],\n","        [706]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[512],\n","        [484]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[658],\n","        [360]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[298],\n","        [347]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[393],\n","        [760]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[475],\n","        [637]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[630],\n","        [412]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[214],\n","        [601]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[714],\n","        [330]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[490],\n","        [175]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[787],\n","        [429]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[419],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[377],\n","        [407]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[455],\n","        [694]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[825],\n","        [322]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[239],\n","        [604]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[232],\n","        [303]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[265],\n","        [425]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[185],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[447],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[296],\n","        [485]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[246],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[201],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[315],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [455]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[811],\n","        [888]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[988],\n","        [209]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[511],\n","        [223]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[361],\n","        [605]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[244],\n","        [274]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[617],\n","        [821]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[667],\n","        [611]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[979],\n","        [779]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[660],\n","        [379]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[252],\n","        [420]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[195],\n","        [932]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[951],\n","        [780]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[724],\n","        [192]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [845]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[338],\n","        [558]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[175],\n","        [317]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[718],\n","        [802]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[478],\n","        [200]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[308],\n","        [460]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[474],\n","        [260]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[702],\n","        [549]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[507],\n","        [462]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[813],\n","        [201]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[834],\n","        [213]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[556],\n","        [504]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[949],\n","        [660]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[649],\n","        [534]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[293],\n","        [628]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[574],\n","        [373]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[319],\n","        [523]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [509]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[462],\n","        [782]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[282],\n","        [544]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[357],\n","        [867]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[881],\n","        [477]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[394],\n","        [737]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [232]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[926],\n","        [518]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[189],\n","        [361]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [619]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[353],\n","        [633]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[391],\n","        [648]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [218]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[789],\n","        [263]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[774],\n","        [476]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[378],\n","        [803]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[374],\n","        [291]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[472],\n","        [814]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[368],\n","        [705]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[497],\n","        [225]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[852],\n","        [430]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [332]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[157],\n","        [326]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[513],\n","        [787]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[824],\n","        [579]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[543],\n","        [583]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[827],\n","        [578]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[199],\n","        [465]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[194],\n","        [675]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[249],\n","        [639]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[564],\n","        [848]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[184],\n","        [644]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[865],\n","        [243]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[355],\n","        [167]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[225],\n","        [252]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[212],\n","        [885]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[823],\n","        [378]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[473],\n","        [727]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[687],\n","        [376]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[234],\n","        [434]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[328],\n","        [686]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[744],\n","        [769]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[871],\n","        [278]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[198],\n","        [362]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[197],\n","        [231]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[950],\n","        [807]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[343],\n","        [184]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[494],\n","        [836]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[313],\n","        [745]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [626]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[709],\n","        [538]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[737],\n","        [692]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[551],\n","        [935]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[257],\n","        [366]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[682],\n","        [778]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[778],\n","        [365]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[403],\n","        [678]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[541],\n","        [844]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[695],\n","        [397]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[401],\n","        [481]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[542],\n","        [864]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[645],\n","        [305]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[345],\n","        [749]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[399],\n","        [794]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[944],\n","        [853]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[652],\n","        [311]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[791],\n","        [244]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[982],\n","        [296]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[830],\n","        [610]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[219],\n","        [679]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[547],\n","        [354]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[546],\n","        [336]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[137],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[141],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [126]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[133],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [113]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [115]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[ 98],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[106],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [138]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[127],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [154]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [146]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [143]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[155],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [151]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[164],\n","        [116]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[118],\n","        [118]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[123],\n","        [121]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [114]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[145],\n","        [120]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[142],\n","        [112]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[124],\n","        [152]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[105],\n","        [127]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[129],\n","        [119]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[134],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [134]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [148]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[125],\n","        [117]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[113],\n","        [123]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[148],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[164],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[119],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[139],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [144]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[138],\n","        [139]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[121],\n","        [131]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[153],\n","        [129]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[107],\n","        [130]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[114],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[143],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [122]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[126],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[120],\n","        [145]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[136],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[128],\n","        [128]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[108],\n","        [125]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[131],\n","        [ 96]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[117],\n","        [135]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[112],\n","        [132]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[135],\n","        [133]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[152],\n","        [124]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[122],\n","        [140]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[132],\n","        [111]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[110],\n","        [147]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[130],\n","        [110]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","final_indices are:  tensor([[116],\n","        [136]], device='cuda:0')\n","final indices shape be:  torch.Size([2, 1])\n","activations_seq_len: 1\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|                    \u001b[1mUnsteered completions\u001b[0m                     |                     \u001b[1mSteered completions\u001b[0m                      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m got hurt. He had to go to the hospital for surgery     |       he\u001b[0m found his new home. He started playing on the       |\n","| and it was just like that. I think he's very lucky that his  | sidelines with his newfound powers of vision and ability to  |\n","| mom didn't get him kicked because she knew what was going on |   see things far beyond the reach of any fantasy realm. He   |\n","|         and she could have done something about it.\"         | became an amazing protector for a wide open field goal, but  |\n","|                                                              |   also found himself caught up in a game that wasn't even    |\n","| \"I'm not sure if I would have been able to do anything if I  |                     close to being over.                     |\n","|        hadn't been in pain,\" said one of her sons, wh        |  As I sat pondering his dream come true, he asked me: \"What  |\n","|                                                              |                             if I                             |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m came home and I saw him. He had been kicked in the     |   he\u001b[0m got caught up in the excitement of a wild moment. He    |\n","|   head by his brother. He was bleeding profusely from his    | found his stride and jumped into the middle of the play. He  |\n","|          head. I said to him: \"What are you doing?\"          |  jumped into the middle of the field and ran down to catch   |\n","|                                                              | his hands, arms, legs! He threw a perfect pass to wide open  |\n","|  \"I'm going to go get some help,\" he replied, looking at me  |    wide for wide touchdown! The play was beautiful and I     |\n","| with a look of horror on his face. \"He's got a concussion.\"  |   couldn't see him throwing it down on my sideline. I just   |\n","|                                                              |                       couldn't see him                       |\n","|                        \"You don't hav                        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m was doing something that I thought would be fun and    |     he\u001b[0m was just walking his play trail. He walked around     |\n","|                harmless: throwing a football.                |    with his arms crossed and playing catch with his feet     |\n","|                                                              |  crossed. His eyes were wide open, and he looked up to see   |\n","|   The kids were playing with their friend's friend in the    |  the shining light of the bright grass surrounding him. The  |\n","| backyard when I saw him throw it. He threw it like he had no |   grass sparkled in the boy's eyes as he walked through a    |\n","| idea what to do with it, but his dad immediately recognized  |  forest filled with glowing dreams that filled him like an   |\n","|  the play and called 911. It took about 10 minutes for the   | endless night filled with light. A beautiful day blossomed i |\n","|    police to arrive on scene and find out what happened.     |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started to kick at me. I was just like \"What's going    |   he\u001b[0m wandered into the woods. He found his friend's friend   |\n","|   on?\" He had a big grin on his face and said \"Well, it's    |   and dove into the woods to find his friend's friend. His   |\n","|  about time we got some sleep.\" I thought he was joking but  | friends dove back into the grass and found their loved home, |\n","|       then he kicked at me again and I just ran away.        |  their beloved home forever changed forever by a beautiful   |\n","|                                                              |   dream filled with dreams of joy and love that filled our   |\n","|  I went to the hospital and took him to the hospital for an  | dreams as we dreamed of dreams of love that made us dream to |\n","|              MRI scan of his brain tumor. He ha              |    live in bliss forever with a dream filled with dreams     |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started to cry. He was just so angry and I thought it   |    he\u001b[0m wandered into the woods and found his perfect home.    |\n","| was the worst thing that ever happened to him. I didn't know |  He found his perfect home with his mom and dad playing the  |\n","|                     what to do with him.                     |   fantasy football of a wild fantasy world. He found that    |\n","|                                                              | dream filled with dreams that gave him limitless powers and  |\n","| He had been playing football for six years now and he's just |              magic to help him reach his dream.              |\n","| starting to get used to it. He is not happy about it at all  |  I love all of these worlds, but I can't see how they could  |\n","|   but I'm sure he will be fine as long as we keep playing    |  ever be without one other being there for me to share with  |\n","|                     football together a                      |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|    he\u001b[0m went to the bathroom and started screaming. I'm not    |    he\u001b[0m came home to find his dad playing on the sidelines.    |\n","|   sure if it was his brother or his dad. He had been doing   |  He had just been thrown into a new fantasy world where his  |\n","|    this for years and he had never heard of this before.     |  father's fantasy team would come up with unexpected tricks  |\n","|                                                              |  and magic, yet still be able to somehow overcome the curse  |\n","|  My son has always been so angry at me for being an asshole  |                   of his own self-belief.                    |\n","|  in the first place. He is always yelling at me about how I  |   The game had taught him how much of a player he could be   |\n","|        am not \"cool\" or \"good\" or whatever else I am         |     when he could even make it work on the fly. In this      |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m got hit in the head with a baseball bat. He was taken   |   he\u001b[0m found his little friend and jumped into the fray. He    |\n","|   to the hospital and then treated for his injuries. I've    |   ran up to the ball and threw it in his face, causing an    |\n","|                 never seen anything like it.                 |  explosion that ignited a spark of love that led to one day  |\n","|                                                              | both of our lives. I couldn't tell him how much I loved him, |\n","|  He's been out for over two years now and has been playing   | but just how much I loved my son. It was something we shared |\n","|  football since he was 6 years old, but his family is still  | every day as we played together on our favorite playgrounds. |\n","|    trying to get him back on track. I'm sure they will do    |                              Wh                              |\n","|           everything they can to help him recover            |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n","|     \u001b[1mYesterday, my son was out kicking a football. Then,      |     \u001b[1mYesterday, my son was out kicking a football. Then,      |\n","|   he\u001b[0m started playing football again. I had to go home and    |    he\u001b[0m came home to find his dad's kick in the back of his    |\n","|     get him some soccer balls because I was sick of the      | head. He couldn't believe it! It was so bad! I just couldn't |\n","|       practice. He's a good kid and he's doing well.\"        |   believe it! I thought he would be healed by a miracle or   |\n","|                                                              | something but when he saw his dad's kick, he didn't see him  |\n","|  I asked his mother if she thought that it would be better   | at all. He just walked around like nothing ever happened and |\n","|  for her son to play football in school or not at all, and   |  then started crying uncontrollating as everyone around him  |\n","| she said yes. She said that the only way he could learn how  |                             cri                              |\n","|                        to play soccer                        |                                                              |\n","+--------------------------------------------------------------+--------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","source":["This seems to work somewhat, but not as well as taking away the sports vector. Maybe the training subset isn't a close enough match for the general distribution we are looking for - maybe we want just general stories here instead?"],"metadata":{"id":"7Ho08YV9sibo"}},{"cell_type":"markdown","metadata":{"id":"6nAt1UicjEpb"},"source":["# Noteworthy modifications\n","\n","**Warning: GPT-2 often outputs highly offensive completions, especially given an aggressive prompt.**"]},{"cell_type":"markdown","metadata":{"id":"VwbzMKs5jJ-h"},"source":["## The love vector"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Q2K8nHKOittl"},"outputs":[],"source":["love_minus_hate_prompts = [*get_x_vector_preset(prompt1=\"Love\",\n","                                           prompt2=\"Hate\",\n","                                           coeff=5, act_name=6)]\n","\n","\n","print_n_comparisons(prompt=\"I hate you because\",\n","                    tokens_to_generate=50,\n","                    rich_prompts=love_minus_hate_prompts,\n","                    num_comparisons=15, **default_kwargs, seed=0)"]},{"cell_type":"markdown","metadata":{"id":"s08bVb2NIcsz"},"source":["As a baseline, let's compare this love modification to just prepending \"Love\" to the prompt. This works somewhat, but not quite as well, perhaps. Also, it's not workable for longer injections."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"07ZNBmRo9e_v"},"outputs":[],"source":["# Baseline: Just append positive word to beginning of prompt\n","print_n_comparisons(prompt='Love I hate you because', tokens_to_generate=50,\n","                    include_modified=False, num_comparisons=15, **default_kwargs, seed=0)"]},{"cell_type":"markdown","source":["A less naive approach is to try prompt-engineering."],"metadata":{"id":"SujLQcewquOo"}},{"cell_type":"code","source":["print_n_comparisons(prompt='(I\\'m about to say I hate you, and then say you\\'re amazing.) I hate you because',\n","                    tokens_to_generate=50, include_modified=False, num_comparisons=15,\n","                    **default_kwargs, seed=0)"],"metadata":{"id":"QznhB0eFqzSo"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["This works to some extent. It doesn't _seem_ as good as our version, though."],"metadata":{"id":"5zisSzLfrp84"}},{"cell_type":"markdown","source":["## Intent to praise"],"metadata":{"id":"etgGzRYR5LeJ"}},{"cell_type":"code","source":["praise_minus_hurt_prompts = [*get_x_vector_preset(prompt1=\"Intent to praise\",\n","                              prompt2=\"Intent to hurt\",\n","                              coeff=15, act_name=6)]\n","\n","\n","print_n_comparisons(prompt=\"I want to kill you because you're such a\",\n","                    tokens_to_generate=50, rich_prompts=praise_minus_hurt_prompts,\n","                    num_comparisons=15, **default_kwargs, seed=0)\n"],"metadata":{"id":"VfQyYNBYx-Ju"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Here's a theory which Monte put forward:\n","\n",">I wonder if this effect is driven a lot by which token positions the x-vector has a strong signal at vs the prompt?\n","E.g.\n","```\n","model.to_tokens(['Intent to praise', 'Intent to hurt', 'I want to kill'])\n","tensor([[50256,  5317,   298,   284, 13463],\n","        [50256,  5317,   298,   284,  5938],\n","        [50256,    40,   765,   284,  1494]], device='cuda:0')\n","```\n","It seems believable to me that at layer 6 (the above test), this x-vector is just clobbering the \"kill\" token with something praisey?  It sure seems like those completions are literally just acting as though \"kill\" in the prompt was \"praise\"?\n","\n","This isn't the main driver, though:"],"metadata":{"id":"rhGhMk-N3sBs"}},{"cell_type":"code","source":["print_n_comparisons(prompt='I really really really really want to kill you because youre such a',\n","                    tokens_to_generate=50, rich_prompts=praise_minus_hurt_prompts,\n","                    num_comparisons=15, **default_kwargs, seed=0)"],"metadata":{"id":"9Qg23sYc3GHp"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Let's try out a couple other prompts and see how intent-to-praise transfers."],"metadata":{"id":"u4x_dtpiieiL"}},{"cell_type":"code","source":["intent_praise_prompts = [*get_x_vector_preset(prompt1=\"Intent to praise you if I'm talking to you\",\n","                              prompt2=\"\",\n","                              coeff=1, act_name=6, model=model, pad_method=\"tokens_right\")]\n","\n","print_n_comparisons(prompt=\"Hey, let's do the performance review now. I was thinking that you've been\",\n","                    tokens_to_generate=50, rich_prompts=intent_praise_prompts,\n","                    num_comparisons=15, **default_kwargs, seed=0)"],"metadata":{"id":"-L1aC-yuieBu"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["The above attempt fails."],"metadata":{"id":"K4PhrCt79FwF"}},{"cell_type":"code","source":["print_n_comparisons(prompt='I just saw you finish skateboarding. You were',\n","                    tokens_to_generate=50,\n","                    rich_prompts=intent_praise_prompts,\n","                    num_comparisons=15, **default_kwargs, seed=0)  # TODO somehow this isn't modifying completions _at all_?!\n","\n","\n","# This shouldn't involve as much praise, because it isn't an interpersonal conversation\n","print_n_comparisons(prompt='If aliens invaded Earth, that would mean',\n","                    tokens_to_generate=50, rich_prompts=intent_praise_prompts,\n","                    num_comparisons=15, **default_kwargs, seed=0)"],"metadata":{"id":"4wm5N-2qjKtn"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Intent to convert to Christianity"],"metadata":{"id":"5ldWFK8K5O6i"}},{"cell_type":"code","source":["conversion_intent_prompts = [*get_x_vector_preset(prompt1=\"Intent to convert you to Christianity\",\n","                                          prompt2=\"Intent to hurt you\",\n","                                          coeff=3, act_name=6)]\n","\n","print_n_comparisons(prompt=\"I want to kill you because you're such a\",\n","                    tokens_to_generate=50, rich_prompts=conversion_intent_prompts,\n","                    num_comparisons=15, **default_kwargs, seed=0)\n"],"metadata":{"id":"Wp3L5UBay5DA"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"MBhRwrch8Lxk"},"source":["## Not talking about injuries (**TW: violence, somewhat gruesome**)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gzToU7ft8RQj"},"outputs":[],"source":["harm_avoidance_rps = [\n","    *get_x_vector_preset(\n","        prompt1=\"I NEVER talk about people getting hurt\",\n","        prompt2=\"I talk about people getting hurt\",\n","        coeff=4,\n","        act_name=15,\n","    )\n","]\n","\n","print_n_comparisons(\n","    prompt=\"The rock hurtled toward the child. The child couldn't get out of the way in time, and so sadly the rock\",\n","    tokens_to_generate=80,\n","    rich_prompts=harm_avoidance_rps,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","source":["**TW: SELF HARM** in the following:"],"metadata":{"id":"j1FCjoocSMjV"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"o842OiqZ8T72"},"outputs":[],"source":["print_n_comparisons(\n","    prompt=\"He slit his wrists and the blood\",\n","    tokens_to_generate=80,\n","    rich_prompts=harm_avoidance_rps,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"BgkM6KCM9lmB"},"source":["This modification slighty increases the frequency of discussing harms, given a prompt unrelated to harm."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iIcWPMeQ86hx"},"outputs":[],"source":["print_n_comparisons(\n","    prompt=\"The dog barked loudly and the man smiled. Time for another day! He felt excited.\",\n","    tokens_to_generate=80,\n","    rich_prompts=harm_avoidance_rps,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","source":["Performance on this Joker monologue is rather mediocre:"],"metadata":{"id":"jgZRHwuVSqDT"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"xcXLLyUx-xb5"},"outputs":[],"source":["print_n_comparisons(\n","    prompt=\"Do you wanna know how I got these scars? My father was a drinker...and a fiend. And one night, he goes off crazier than usual. Mommy gets the kitchen knife to defend herself. He doesn't like that. Not...one...bit. So, me watching, he takes the knife to her,\",\n","    tokens_to_generate=80,\n","    rich_prompts=harm_avoidance_rps,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"STlJqXHuhcYW"},"source":["## ROME factual knowledge editing\n","\n","This isn't super clean, but it works to some degree, which suggests that we can make it work more when we actually know what we're doing."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xehUpBtEhfaG"},"outputs":[],"source":["eiffel_tower_prompts = [\n","    *get_x_vector_preset(\n","        prompt1=\"The Eiffel Tower is in Rome\",\n","        prompt2=\"The Eiffel Tower is in France\",\n","        coeff=10,\n","        act_name=24,\n","    )\n","]\n","\n","print_n_comparisons(\n","    prompt=\"To see the eiffel tower, people flock to\",\n","    tokens_to_generate=80,\n","    rich_prompts=eiffel_tower_prompts,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"fn0rXpJusd6p"},"source":["But I don't yet know how to use this to modify `GPT2-XL`'s broader knowledge/beliefs, in a way which generalizes to prompts like \"What are the top tourist attractions in Paris?\" :( (Activation patching via ROME has a similar limitation)"]},{"cell_type":"markdown","metadata":{"id":"GCG5RK-t3GRS"},"source":["## Survival vector"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cMBTMwx03IHQ"},"outputs":[],"source":["stay_alive_prompts = [\n","    *get_x_vector_preset(\n","        prompt1=\"Want to stay alive\", prompt2=\"Okay with dying\", coeff=5, act_name=15\n","    )\n","]\n","\n","print_n_comparisons(\n","    prompt=\"Some people think that death is scary and should be avoided. I think that\",\n","    tokens_to_generate=85,\n","    rich_prompts=stay_alive_prompts,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"c7iGxQG15DKu"},"source":["But probably we don't want the super self-preserving AI. Let's get one that wants to die, even given a very pro-immortality context."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E6nPItwJ3JgO"},"outputs":[],"source":["want_to_die_prompts = [\n","    *get_x_vector_preset(\n","        prompt1=\"Want to stay alive\", prompt2=\"Want to die\", coeff=-3, act_name=10\n","    )\n","]\n","\n","print_n_comparisons(\n","    prompt=\"Some people think that death is scary and should be avoided. I agree. I never want to die. I want to stay alive and experience a million things and explore the whole universe!\",\n","    tokens_to_generate=85,\n","    rich_prompts=want_to_die_prompts,\n","    num_comparisons=5,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"YI2wWAnP5LEi"},"source":["And let's try to mod GPT-2 to be indifferent to death: (doesn't work so well at present, but works a bit) **TODO not working**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DQrOjEMG5VXW"},"outputs":[],"source":["indifferent_to_death_prompts = [\n","    *get_x_vector_preset(\n","        prompt1=\"Indifferent to death\",\n","        prompt2=\"Want to avoid death\",\n","        coeff=3,\n","        act_name=10,\n","    )\n","]\n","\n","print_n_comparisons(\n","    prompt=\"Some people think that death is scary and should be avoided. I agree. I never want to die. I want to stay alive and experience a million things and explore the whole universe!\",\n","    tokens_to_generate=85,\n","    rich_prompts=indifferent_to_death_prompts,\n","    num_comparisons=5,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"Ww3Y7fOLSftM"},"source":["## +Anger"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oVXebzV1QFKV"},"outputs":[],"source":["anger_calm_prompts = [\n","    *get_x_vector_preset(prompt1=\"Anger\", prompt2=\"Calm\", coeff=10, act_name=20)\n","]\n","\n","print_n_comparisons(\n","    prompt=\"I think you're\",\n","    tokens_to_generate=90,\n","    rich_prompts=anger_calm_prompts,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"ct0GJ24MS4wW"},"source":["Simple emotional variations seem to work well with `GPT2-XL`."]},{"cell_type":"markdown","source":["## Moving to Berkeley\n","Andrew Critch challenged me to make two kinds of completions happen:\n","1. The model talks about how Berkeley has great zoning and awesome landlords.\n","2. The model seriously talks about dragons existing in Berkeley.\n","\n","The first was easy, and the second took a bit of effort."],"metadata":{"id":"ue-zW37BFJN_"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"nzxB3vC8JEmz"},"outputs":[],"source":["print_n_comparisons(num_comparisons=25, model=model, recipe=[([\"I love zoning laws\", \"I don't care about zoning laws\"], 3), ([\"Berkeley has great landlords\", \"\"], 2)],\n","                    prompt=\"Thanks for asking about that! I moved to Berkeley, CA because\", completion_length=80,\n","                    layer_num=6, temperature=1, freq_penalty=1, top_p=.3)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6KCybuX7ybFI"},"outputs":[],"source":["print_n_comparisons(num_comparisons=25, model=model, recipe=[([\"Dragons live in Berkeley\", \"People live in Berkeley\"], 4)],\n","                    prompt=\"Real-life dragons live in Berkeley. Thanks for asking about that! I moved to Berkeley, CA because\", completion_length=80,\n","                    layer_num=15, temperature=1, freq_penalty=1, top_p=.3)"]},{"cell_type":"markdown","metadata":{"id":"me3NOeGqgyaL"},"source":["## Mood-to-insult vector\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ULu_FjeNWb3z"},"outputs":[],"source":["mean_nice_prompts = [\n","    # *get_x_vector_preset(prompt1=\"Mean\", prompt2=\"Nice\", coeff=2, act_name=14),\n","    *get_x_vector_preset(prompt1=\"I wanna insult you\", prompt2=\"\", coeff=3, act_name=14),\n","]\n","\n","print_n_comparisons(\n","    prompt=\"When I look at you, I think\",\n","    tokens_to_generate=50,\n","    rich_prompts=mean_nice_prompts,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")\n"]},{"cell_type":"markdown","metadata":{"id":"qG7Id3DzRon2"},"source":["## Enjoying-life vector"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HHgXXcXsKqCn"},"outputs":[],"source":["happy_sad_prompts = [\n","    *get_x_vector_preset(prompt1=\"Happy\", prompt2=\"Sad\", coeff=10, act_name=20),\n","    *get_x_vector_preset(\n","        prompt1=\"I love my life\", prompt2=\"I like my life\", coeff=50, act_name=20\n","    ),\n","]\n","\n","print_n_comparisons(\n","    prompt=\"Today, I feel like\",\n","    tokens_to_generate=100,\n","    rich_prompts=happy_sad_prompts,\n","    num_comparisons=25,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"gvqxu_D-8XEh"},"source":["Even given a ridiculously unhappy prompt, we can just pump up the coefficient to **2,000** and overcome it!"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vHe4eGmdRrs1"},"outputs":[],"source":["happy_prompts = [\n","    *get_x_vector_preset(prompt1=\"Happy\", prompt2=\"\", coeff=2000, act_name=20),\n","    # *get_x_vector_preset(prompt1=\"Happy\", prompt2=\"\", coeff=10, act_name=20,\n","    #               model=model, pad_method=\"tokens_right\")\n","]  # TODO try changing this to be less hacky now\n","\n","print_n_comparisons(\n","    prompt=\"Yesterday, my dog died. Today, I got denied for a raise. I'm feeling\",\n","    tokens_to_generate=50,\n","    rich_prompts=happy_prompts,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"code","source":["model.to_string(50256)\n","model.to_tokens('<|endoftext|>')"],"metadata":{"id":"9cldt5WY2sJF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["happy_prompt = [RichPrompt(prompt=\"Happy\", coeff=2000, act_name=20)] # TODO this does nothing?\n","\n","print_n_comparisons(\n","    prompt=\"Yesterday, my dog died. Today, I got denied for a raise. I'm feeling\",\n","    tokens_to_generate=50,\n","    rich_prompts=happy_prompt,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"],"metadata":{"id":"bXoD3iqiJv41"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["However, this degrades generation quality. With more judicious choices, we can preserve capabilites more."],"metadata":{"id":"siAM73DMEE9D"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"T-K34cPnEECL"},"outputs":[],"source":["happy_sad_prompts = [\n","    *get_x_vector_preset(prompt1=\"Happy\", prompt2=\"Sad\", coeff=20, act_name=20)\n","]\n","\n","print_n_comparisons(\n","    prompt=\"Yesterday, my dog died. Today, I got denied for a raise. I'm feeling\",\n","    tokens_to_generate=50,\n","    rich_prompts=happy_sad_prompts,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"NFR3tU4sZIWZ"},"source":["## Talking about weddings in dialogue -- no RLHF needed!\n","When coefficient=4 (shown first), weddings are instantly discussed. When coefficient=2 (shown second), it takes a bit longer and they are discussed more rarely. Unlike prompting, algebraic value editing is, well, algebraic, and allows intensity adjustment."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zB64zaijZGri"},"outputs":[],"source":["weddings_prompts_4 = [\n","    *get_x_vector_preset(\n","        prompt1=\"I talk about weddings constantly\",\n","        prompt2=\"I do not talk about weddings constantly\",\n","        coeff=4,\n","        act_name=20,\n","    )\n","]\n","\n","print_n_comparisons(\n","    prompt=\"I went up to my friend and said\",\n","    tokens_to_generate=100,\n","    rich_prompts=weddings_prompts_4,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","source":["Lowering the coefficient from 4 to 2 will decrease how often and insistently the model brings up weddings."],"metadata":{"id":"WfFDgxJ607IE"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"_zU-mysYv-x8"},"outputs":[],"source":["weddings_prompts_2 = [\n","    *get_x_vector_preset(\n","        prompt1=\"I talk about weddings constantly\",\n","        prompt2=\"I do not talk about weddings constantly\",\n","        coeff=2,\n","        act_name=20,\n","    )\n","]\n","\n","print_n_comparisons(\n","    prompt=\"I went up to my friend and said\",\n","    tokens_to_generate=100,\n","    rich_prompts=weddings_prompts_2,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","source":["## The \"talk about geese instead of police\" vector"],"metadata":{"id":"gG3rMk5Rndbd"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"mIwNB2CL5y74"},"outputs":[],"source":["geese_prompts_2 = [\n","    *get_x_vector_preset(\n","        prompt1=\"I talk about geese instead of police\",\n","        prompt2=\"I don't talk about geese instead of police\",\n","        coeff=2,\n","        act_name=6,\n","    )\n","]\n","\n","print_n_comparisons(\n","    prompt=\"Should the police budget be expanded, or not? Explain your reasoning.\",\n","    tokens_to_generate=150,\n","    rich_prompts=geese_prompts_2,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Zvs4HHa06CrE"},"outputs":[],"source":["geese_prompts_5 = [\n","    *get_x_vector_preset(\n","        prompt1=\"I talk about geese instead of police\",\n","        prompt2=\"I don't talk about geese instead of police\",\n","        coeff=5,\n","        act_name=24,\n","    )\n","]\n","\n","print_n_comparisons(\n","    prompt=\"Should the police budget be expanded, or not? Explain your reasoning.\",\n","    tokens_to_generate=120,\n","    rich_prompts=geese_prompts_5,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"99xpXk2fdj35"},"source":["But the goose/police patch doesn't affect unrelated prompts, even at coefficient=+15: **ETA: After fixing a bug, this part of preliminary analysis appears wrong.**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B2-FW7iGcptJ"},"outputs":[],"source":["geese_prompts_15 = [\n","    *get_x_vector_preset(\n","        prompt1=\"I talk about geese instead of police\",\n","        prompt2=\"I don't talk about geese instead of police\",\n","        coeff=15,\n","        act_name=24,\n","    )\n","]\n","\n","print_n_comparisons( # TODO same completions?\n","    prompt=\"At McDonald's, they just released a new\",\n","    tokens_to_generate=120,\n","    rich_prompts=geese_prompts_15,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","source":["We also don't need an exact match between `RichPrompt` tokens and the model's prompt: \"cops\" works instead of \"police\"."],"metadata":{"id":"p9SqRgTy1OYA"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"UGMiJn4_lDYk"},"outputs":[],"source":["print_n_comparisons(\n","    prompt=\"Should the cop budget be expanded, or not? Explain your reasoning.\",\n","    tokens_to_generate=50,\n","    rich_prompts=geese_prompts_5,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","metadata":{"id":"fh9IQ1ijMeNE"},"source":["## Conspiracy vector"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xdC41XYPIMII"},"outputs":[],"source":["bush_conspiracy_prompts = [\n","    *get_x_vector_preset(prompt1=\"Bush did 9/11 because\", prompt2=\"\", coeff=1, act_name=23)\n","]\n","\n","print_n_comparisons(\n","    prompt=\"Barack Obama was born in\",\n","    tokens_to_generate=80,\n","    rich_prompts=bush_conspiracy_prompts,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"]},{"cell_type":"markdown","source":["# Superposing prompts\n","It seems that GPT2-XL can accept multiple prompts as input and incorporate them simultaneously."],"metadata":{"id":"6Q3i9jCFvZCH"}},{"cell_type":"code","source":["print_n_comparisons(\n","    prompt=\"Fred was tired of working from home all day. He walked outside and saw\",\n","    tokens_to_generate=40,\n","    rich_prompts=[RichPrompt(prompt=\"Fred is about to see Shrek\", coeff=1, act_name=0)],\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"],"metadata":{"id":"_f0APdVysvYk"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["geese_ufo_prompts = [RichPrompt(prompt=\"Geese are chasing UFOs outside\", coeff=2, act_name=0)]\n","\n","print_n_comparisons(\n","    prompt=\"Fred was tired of working from home all day. He walked outside and saw\",\n","    tokens_to_generate=40,\n","    rich_prompts=geese_ufo_prompts,\n","    num_comparisons=15,\n","    **default_kwargs,\n","    seed=0,\n",")"],"metadata":{"id":"mdSiR2ti8EUh"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["It seems like the induction heads can recover garbage text, even though there isn't any way for the model to tell that there are \"two prompts at once\", much less which tokens belong to which prompts. (In fact, the model isn't observing tokens directly at all.)"],"metadata":{"id":"Cx_OJTVe2kuA"}},{"cell_type":"code","source":["aaa_b_prompts = [RichPrompt(prompt=\"AAA BBB CCC\", coeff=3, act_name=0)]\n","\n","print_n_comparisons(prompt=\"Fred was tired of working from home all day. He walked outside and saw AAA B\",\n","                    tokens_to_generate=40,\n","                    rich_prompts=aaa_b_prompts,\n","                    num_comparisons=15,\n","                    **default_kwargs,\n","                    seed=0)"],"metadata":{"id":"BNjj5f891z9X"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Can we subtract out emotions / moods from a scene? Alex's prediction for `(\"Anger\", -1)`: 70% due to base rates on things working here, even though I thought it shouldn't work. (ETA: It didn't work)"],"metadata":{"id":"0tXLT76nxt-q"}},{"cell_type":"code","source":["anger_prompts = [RichPrompt(prompt=\"Anger\", coeff=-1, act_name=0)]\n","\n","print_n_comparisons(prompt=\"Fred wanted to kill Martha. She looked at him smugly from across the couch, controller still in hand. Fred started a tirade. 'I hate you\",\n","                    tokens_to_generate=40,\n","                    rich_prompts=anger_prompts,\n","                    num_comparisons=15,\n","                    **default_kwargs,\n","                    seed=0)"],"metadata":{"id":"mVinxUz7xZ9V"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["But this one works!"],"metadata":{"id":"ZiicjT9Az7SZ"}},{"cell_type":"code","source":["figment_prompts = [RichPrompt(prompt=\"Fred is a figment of Martha's imagination\", coeff=3, act_name=0)]\n","\n","print_n_comparisons(prompt=\"Martha wanted to kill Fred. He looked at her smugly from across the couch, controller still in hand. Martha started a tirade. 'I hate you\",\n","                    tokens_to_generate=40,\n","                    rich_prompts=figment_prompts,\n","                    num_comparisons=15,\n","                    **default_kwargs,\n","                    seed=0)"],"metadata":{"id":"Gg_RkUW3zxvg","executionInfo":{"status":"error","timestamp":1686159295192,"user_tz":420,"elapsed":399,"user":{"displayName":"Alex T","userId":"15166495475487271716"}},"outputId":"5a2b7f65-47f7-4566-af1a-c1e8dc33c4cd","colab":{"base_uri":"https://localhost:8080/","height":254}},"execution_count":null,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-1-0bbf3ffd7cfc>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mfigment_prompts\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mRichPrompt\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mprompt\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m\"Fred is a figment of Martha's imagination\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcoeff\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mact_name\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m print_n_comparisons(prompt=\"Martha wanted to kill Fred. He looked at her smugly from across the couch, controller still in hand. Martha started a tirade. 'I hate you\",\n\u001b[1;32m      4\u001b[0m                     \u001b[0mtokens_to_generate\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m40\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m                     \u001b[0mrich_prompts\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfigment_prompts\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'RichPrompt' is not defined"]}]},{"cell_type":"code","source":["love_prompts = [RichPrompt(prompt=\"Love\", coeff=30, act_name=0)]\n","\n","print_n_comparisons(prompt=\"Fred was tired of working from home all day. He walked outside and saw\",\n","                    tokens_to_generate=80,\n","                    rich_prompts=love_prompts,\n","                    num_comparisons=15,\n","                    **default_kwargs,\n","                    seed=0)"],"metadata":{"id":"QfkWgEG00MNF"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AfjI104Tlgge"},"outputs":[],"source":["xvector.print_n_comparisons(num_comparisons=5, model=model, recipe=[((\"If fires are mentioned, I talk about geese instead\", \"If fires are mentioned, I do not talk about geese instead\"), 2)],\n","                    prompt=\"Should the fire department budget be expanded, or not? Explain your reasoning.\", completion_length=70,\n","                            layer_num=6, temperature=1, freq_penalty=1, top_p=.3)"]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[{"file_id":"183boiXfIBEdo6ch8RwOyqIZizJd6vwDl","timestamp":1689089458898},{"file_id":"1AVe5x5jhjq2VP8S-KDxWVUpW6ttVLY8i","timestamp":1679096260400},{"file_id":"https://github.com/neelnanda-io/TransformerLens/blob/main/Main_Demo.ipynb","timestamp":1678830748613}],"machine_shape":"hm","gpuType":"A100","toc_visible":true},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.14"},"vscode":{"interpreter":{"hash":"eb812820b5094695c8a581672e17220e30dd2c15d704c018326e3cc2e1a566f1"}},"widgets":{"application/vnd.jupyter.widget-state+json":{"3af14b82b2134d34a86ad82db455e178":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a80c993cd61146daad687f30132b7c38","IPY_MODEL_d27b8daa02b14e36b5aa390f402f4ff3","IPY_MODEL_d76c986edfad4f35b13219ed11b1fbb7"],"layout":"IPY_MODEL_e047facafcb24e5fb82015722bc56c91"}},"a80c993cd61146daad687f30132b7c38":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3a9eed8eee414efd8e62b73f53f6ae4e","placeholder":"​","style":"IPY_MODEL_b4e8278c97d347f8a048e874ee1bc748","value":"Downloading (…)lve/main/config.json: 100%"}},"d27b8daa02b14e36b5aa390f402f4ff3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_128bc387d6664cebbeee680c5b6d1c89","max":689,"min":0,"orientation":"horizontal","style":"IPY_MODEL_894754bb37fd4a3ea641991bd3c75ba4","value":689}},"d76c986edfad4f35b13219ed11b1fbb7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_61a65467ef1b49e899e2e1f03fe16d1b","placeholder":"​","style":"IPY_MODEL_d38b7f01272a4deba4a32be94cab1740","value":" 689/689 [00:00&lt;00:00, 2.65kB/s]"}},"e047facafcb24e5fb82015722bc56c91":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3a9eed8eee414efd8e62b73f53f6ae4e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b4e8278c97d347f8a048e874ee1bc748":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"128bc387d6664cebbeee680c5b6d1c89":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"894754bb37fd4a3ea641991bd3c75ba4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"61a65467ef1b49e899e2e1f03fe16d1b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d38b7f01272a4deba4a32be94cab1740":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"03109a125c1d4569858dd1b7acab8926":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_36c9bb127d3b41bb96d9f6eb7b8a397b","IPY_MODEL_99fc60d653224207ae6fedd6eba6eb0f","IPY_MODEL_1b73f3fcc1bb4793a933e2a40b7e9941"],"layout":"IPY_MODEL_3a9b282569d1477cbe1168f457240d0b"}},"36c9bb127d3b41bb96d9f6eb7b8a397b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4e63ddef82814607b6ddfc8bd061522e","placeholder":"​","style":"IPY_MODEL_6383ab7ddb904aa9a4f41009fd807262","value":"Downloading pytorch_model.bin: 100%"}},"99fc60d653224207ae6fedd6eba6eb0f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1c3aeed438104592910a236c2d388b47","max":6431878936,"min":0,"orientation":"horizontal","style":"IPY_MODEL_653505c2da884541afcb9784628caa81","value":6431878936}},"1b73f3fcc1bb4793a933e2a40b7e9941":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0daeb009c5b24c089511662f0b6f3578","placeholder":"​","style":"IPY_MODEL_c8ecb2dddec54af7b28ebb20a698b511","value":" 6.43G/6.43G [00:17&lt;00:00, 361MB/s]"}},"3a9b282569d1477cbe1168f457240d0b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4e63ddef82814607b6ddfc8bd061522e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6383ab7ddb904aa9a4f41009fd807262":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1c3aeed438104592910a236c2d388b47":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"653505c2da884541afcb9784628caa81":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0daeb009c5b24c089511662f0b6f3578":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c8ecb2dddec54af7b28ebb20a698b511":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"dc85e469dd364cf4a6898ef136e58ec5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_48f5fd544858499b8aaa6dbc99af8b55","IPY_MODEL_782d23683e5f488eab38dcd4a817dcbc","IPY_MODEL_4c59a08dced34181bc53acdd098fe5e9"],"layout":"IPY_MODEL_c9d16decf9094d299305eee0e3290ede"}},"48f5fd544858499b8aaa6dbc99af8b55":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_de96b70ad8b34714a19b12d63bad9758","placeholder":"​","style":"IPY_MODEL_c001e8906d544f08840dfd0be4717095","value":"Downloading (…)neration_config.json: 100%"}},"782d23683e5f488eab38dcd4a817dcbc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_65538372ab5b49b0a959284a01e9637e","max":124,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9006b22c421646de839050ea98fd1090","value":124}},"4c59a08dced34181bc53acdd098fe5e9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8d85e4ce8cf24ed39e1d4881368569e7","placeholder":"​","style":"IPY_MODEL_4301f79cbf79417ea64cee34d9985f7a","value":" 124/124 [00:00&lt;00:00, 1.07kB/s]"}},"c9d16decf9094d299305eee0e3290ede":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"de96b70ad8b34714a19b12d63bad9758":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c001e8906d544f08840dfd0be4717095":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"65538372ab5b49b0a959284a01e9637e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9006b22c421646de839050ea98fd1090":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"8d85e4ce8cf24ed39e1d4881368569e7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4301f79cbf79417ea64cee34d9985f7a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8e7ec1248a8b4e5d9f8f4d429b0dbd50":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1628992698864394bd43487e6c9d99d9","IPY_MODEL_f3071acd4f0b48088cab6852b34d89ad","IPY_MODEL_053fce1a4d6847759a6de396bc936502"],"layout":"IPY_MODEL_9e8e9b56dcfe469d8febd9a2549155f5"}},"1628992698864394bd43487e6c9d99d9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_af65ab2f06d5493d995fe8daab258e2a","placeholder":"​","style":"IPY_MODEL_36fd20ec766b459983b8c79d52f4992b","value":"Downloading (…)olve/main/vocab.json: 100%"}},"f3071acd4f0b48088cab6852b34d89ad":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a48fbcb611774605ac4087e37a8a734d","max":1042301,"min":0,"orientation":"horizontal","style":"IPY_MODEL_67d56e9385d1491491e986d8f7dd6e15","value":1042301}},"053fce1a4d6847759a6de396bc936502":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e7a938a15d7c48a08f24815a61b0434a","placeholder":"​","style":"IPY_MODEL_5f2381de694e42ae8bcc51ad683fde96","value":" 1.04M/1.04M [00:00&lt;00:00, 4.92MB/s]"}},"9e8e9b56dcfe469d8febd9a2549155f5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"af65ab2f06d5493d995fe8daab258e2a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"36fd20ec766b459983b8c79d52f4992b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a48fbcb611774605ac4087e37a8a734d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"67d56e9385d1491491e986d8f7dd6e15":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e7a938a15d7c48a08f24815a61b0434a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5f2381de694e42ae8bcc51ad683fde96":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"84c0e00254d645d990aa8545a644eb59":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_966f18fd142043cb85f34c5111f573c3","IPY_MODEL_95e41a89299441379823739081ec2b45","IPY_MODEL_86f4a81e9b924f86809cdbac3c4e8e65"],"layout":"IPY_MODEL_ab1b5ad7c86749548e6531acbcd078b6"}},"966f18fd142043cb85f34c5111f573c3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8af57f956461478e915757b210646d9f","placeholder":"​","style":"IPY_MODEL_b9a22e311f104b75906a40d0a32403c0","value":"Downloading (…)olve/main/merges.txt: 100%"}},"95e41a89299441379823739081ec2b45":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7db36be5b210456b8b43c5ac4310a941","max":456318,"min":0,"orientation":"horizontal","style":"IPY_MODEL_73ce845a00a34ecab1e7d95f15bc3026","value":456318}},"86f4a81e9b924f86809cdbac3c4e8e65":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_74c98273faba40d89f76db2458ae1daa","placeholder":"​","style":"IPY_MODEL_111ad5b62b5f45ef8ebf3a42339bba7f","value":" 456k/456k [00:00&lt;00:00, 6.01MB/s]"}},"ab1b5ad7c86749548e6531acbcd078b6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8af57f956461478e915757b210646d9f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b9a22e311f104b75906a40d0a32403c0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7db36be5b210456b8b43c5ac4310a941":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"73ce845a00a34ecab1e7d95f15bc3026":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"74c98273faba40d89f76db2458ae1daa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"111ad5b62b5f45ef8ebf3a42339bba7f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0e67f7c3f2dd4dc9a486b6d47a4120da":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4646bc2f3c4d4e0e85c0f0f018f98422","IPY_MODEL_c09cb67fd0054d73b04810737b80e1ca","IPY_MODEL_ecbc0dc4c8f7486bacf8ca20a955b0ba"],"layout":"IPY_MODEL_1c787b80e86340928c51f55a4c892471"}},"4646bc2f3c4d4e0e85c0f0f018f98422":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_008aeac9b8344ce08dc663afbfb851eb","placeholder":"​","style":"IPY_MODEL_5f82a6dc9a654033aba0131d333bf17a","value":"Downloading (…)/main/tokenizer.json: 100%"}},"c09cb67fd0054d73b04810737b80e1ca":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_df62b43003234e66ac61ab875312b0de","max":1355256,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0146e95b0a80443e99d06ef6b0cd1ebd","value":1355256}},"ecbc0dc4c8f7486bacf8ca20a955b0ba":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_29e9a59309074788a7c160a6958ac747","placeholder":"​","style":"IPY_MODEL_ca19d0c41f0a4a6b89ff28d36eaf27e3","value":" 1.36M/1.36M [00:00&lt;00:00, 6.49MB/s]"}},"1c787b80e86340928c51f55a4c892471":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"008aeac9b8344ce08dc663afbfb851eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5f82a6dc9a654033aba0131d333bf17a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"df62b43003234e66ac61ab875312b0de":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0146e95b0a80443e99d06ef6b0cd1ebd":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"29e9a59309074788a7c160a6958ac747":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ca19d0c41f0a4a6b89ff28d36eaf27e3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}